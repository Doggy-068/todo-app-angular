(self.webpackChunktodo_app=self.webpackChunktodo_app||[]).push([[179],{435:(Ch,Ou,Mp)=>{"use strict";function Sr(i){return"function"==typeof i}function Oe(i){const e=i(n=>{Error.call(n),n.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const Rv=Oe(i=>function(e){i(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function g(i,t){if(i){const e=i.indexOf(t);0<=e&&i.splice(e,1)}}class gt{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:n}=this;if(Sr(n))try{n()}catch(o){t=o instanceof Rv?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{Hn(o)}catch(a){t=t??[],a instanceof Rv?t=[...t,...a.errors]:t.push(a)}}if(t)throw new Rv(t)}}add(t){var e;if(t&&t!==this)if(this.closed)Hn(t);else{if(t instanceof gt){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&g(e,t)}remove(t){const{_finalizers:e}=this;e&&g(e,t),t instanceof gt&&t._removeParent(this)}}gt.EMPTY=(()=>{const i=new gt;return i.closed=!0,i})();const xs=gt.EMPTY;function _c(i){return i instanceof gt||i&&"closed"in i&&Sr(i.remove)&&Sr(i.add)&&Sr(i.unsubscribe)}function Hn(i){Sr(i)?i():i.unsubscribe()}const jn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},hs={setTimeout(i,t,...e){const{delegate:n}=hs;return n?.setTimeout?n.setTimeout(i,t,...e):setTimeout(i,t,...e)},clearTimeout(i){const{delegate:t}=hs;return(t?.clearTimeout||clearTimeout)(i)},delegate:void 0};function ps(i){hs.setTimeout(()=>{const{onUnhandledError:t}=jn;if(!t)throw i;t(i)})}function Yl(){}const Cl=Jo("C",void 0,void 0);function Jo(i,t,e){return{kind:i,value:t,error:e}}let ta=null;function nl(i){if(jn.useDeprecatedSynchronousErrorHandling){const t=!ta;if(t&&(ta={errorThrown:!1,error:null}),i(),t){const{errorThrown:e,error:n}=ta;if(ta=null,e)throw n}}else i()}class Sl extends gt{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,_c(t)&&t.add(this)):this.destination=hm}static create(t,e,n){return new jc(t,e,n)}next(t){this.isStopped?mf(function Gd(i){return Jo("N",i,void 0)}(t),this):this._next(t)}error(t){this.isStopped?mf(function pd(i){return Jo("E",void 0,i)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?mf(Cl,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Rs=Function.prototype.bind;function pi(i,t){return Rs.call(i,t)}class Gc{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(n){er(n)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(n){er(n)}else er(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){er(e)}}}class jc extends Sl{constructor(t,e,n){let r;if(super(),Sr(t)||!t)r={next:t??void 0,error:e??void 0,complete:n??void 0};else{let o;this&&jn.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&pi(t.next,o),error:t.error&&pi(t.error,o),complete:t.complete&&pi(t.complete,o)}):r=t}this.destination=new Gc(r)}}function er(i){jn.useDeprecatedSynchronousErrorHandling?function ka(i){jn.useDeprecatedSynchronousErrorHandling&&ta&&(ta.errorThrown=!0,ta.error=i)}(i):ps(i)}function mf(i,t){const{onStoppedNotification:e}=jn;e&&hs.setTimeout(()=>e(i,t))}const hm={closed:!0,next:Yl,error:function ia(i){throw i},complete:Yl},Sh="function"==typeof Symbol&&Symbol.observable||"@@observable";function yc(i){return i}function Th(i){return 0===i.length?yc:1===i.length?i[0]:function(e){return i.reduce((n,r)=>r(n),e)}}let Cn=(()=>{class i{constructor(e){e&&(this._subscribe=e)}lift(e){const n=new i;return n.source=this,n.operator=e,n}subscribe(e,n,r){const o=function Qo(i){return i&&i instanceof Sl||function Nu(i){return i&&Sr(i.next)&&Sr(i.error)&&Sr(i.complete)}(i)&&_c(i)}(e)?e:new jc(e,n,r);return nl(()=>{const{operator:a,source:u}=this;o.add(a?a.call(o,u):u?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(n){e.error(n)}}forEach(e,n){return new(n=Bo(n))((r,o)=>{const a=new jc({next:u=>{try{e(u)}catch(f){o(f),a.unsubscribe()}},error:o,complete:r});this.subscribe(a)})}_subscribe(e){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(e)}[Sh](){return this}pipe(...e){return Th(e)(this)}toPromise(e){return new(e=Bo(e))((n,r)=>{let o;this.subscribe(a=>o=a,a=>r(a),()=>n(o))})}}return i.create=t=>new i(t),i})();function Bo(i){var t;return null!==(t=i??jn.Promise)&&void 0!==t?t:Promise}const xa=Oe(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Fi=(()=>{class i extends Cn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const n=new jd(this,this);return n.operator=e,n}_throwIfClosed(){if(this.closed)throw new xa}next(e){nl(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(e)}})}error(e){nl(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:n}=this;for(;n.length;)n.shift().error(e)}})}complete(){nl(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:n,isStopped:r,observers:o}=this;return n||r?xs:(this.currentObservers=null,o.push(e),new gt(()=>{this.currentObservers=null,g(o,e)}))}_checkFinalizedStatuses(e){const{hasError:n,thrownError:r,isStopped:o}=this;n?e.error(r):o&&e.complete()}asObservable(){const e=new Cn;return e.source=this,e}}return i.create=(t,e)=>new jd(t,e),i})();class jd extends Fi{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,t)}error(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==n?n:xs}}class ws extends Fi{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:n}=this;if(t)throw e;return this._throwIfClosed(),n}next(t){super.next(this._value=t)}}function fd(i){return Sr(i?.lift)}function to(i){return t=>{if(fd(t))return t.lift(function(e){try{return i(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function go(i,t,e,n,r){return new rr(i,t,e,n,r)}class rr extends Sl{constructor(t,e,n,r,o,a){super(t),this.onFinalize=o,this.shouldUnsubscribe=a,this._next=e?function(u){try{e(u)}catch(f){t.error(f)}}:super._next,this._error=r?function(u){try{r(u)}catch(f){t.error(f)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function vn(i,t){return to((e,n)=>{let r=0;e.subscribe(go(n,o=>{n.next(i.call(t,o,r++))}))})}function Ra(i){return this instanceof Ra?(this.v=i,this):new Ra(i)}function md(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=i[Symbol.asyncIterator];return t?t.call(i):(i=function Al(i){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(o){e[o]=i[o]&&function(a){return new Promise(function(u,f){!function r(o,a,u,f){Promise.resolve(f).then(function(y){o({value:y,done:u})},a)}(u,f,(a=i[o](a)).done,a.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const lt=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function ri(i){return Sr(i?.then)}function fi(i){return Sr(i[Sh])}function Kt(i){return Symbol.asyncIterator&&Sr(i?.[Symbol.asyncIterator])}function On(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const An=function or(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function tr(i){return Sr(i?.[An])}function dr(i){return function qc(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=e.apply(i,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(I){n[I]&&(r[I]=function(R){return new Promise(function(O,H){o.push([I,R,O,H])>1||u(I,R)})})}function u(I,R){try{!function f(I){I.value instanceof Ra?Promise.resolve(I.value.v).then(y,M):A(o[0][2],I)}(n[I](R))}catch(O){A(o[0][3],O)}}function y(I){u("next",I)}function M(I){u("throw",I)}function A(I,R){I(R),o.shift(),o.length&&u(o[0][0],o[0][1])}}(this,arguments,function*(){const e=i.getReader();try{for(;;){const{value:n,done:r}=yield Ra(e.read());if(r)return yield Ra(void 0);yield yield Ra(n)}}finally{e.releaseLock()}})}function zo(i){return Sr(i?.getReader)}function Tr(i){if(i instanceof Cn)return i;if(null!=i){if(fi(i))return function Pa(i){return new Cn(t=>{const e=i[Sh]();if(Sr(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(lt(i))return function Ps(i){return new Cn(t=>{for(let e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()})}(i);if(ri(i))return function gd(i){return new Cn(t=>{i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,ps)})}(i);if(Kt(i))return La(i);if(tr(i))return function na(i){return new Cn(t=>{for(const e of i)if(t.next(e),t.closed)return;t.complete()})}(i);if(zo(i))return function Tp(i){return La(dr(i))}(i)}throw On(i)}function La(i){return new Cn(t=>{(function q_(i,t){var e,n,r,o;return function wa(i,t,e,n){return new(e||(e=Promise))(function(o,a){function u(M){try{y(n.next(M))}catch(A){a(A)}}function f(M){try{y(n.throw(M))}catch(A){a(A)}}function y(M){M.done?o(M.value):function r(o){return o instanceof e?o:new e(function(a){a(o)})}(M.value).then(u,f)}y((n=n.apply(i,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=md(i);!(n=yield e.next()).done;)if(t.next(n.value),t.closed)return}catch(a){r={error:a}}finally{try{n&&!n.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}t.complete()})})(i,t).catch(e=>t.error(e))})}function _d(i,t,e,n=0,r=!1){const o=t.schedule(function(){e(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(o),!r)return o}function Ms(i,t,e=1/0){return Sr(t)?Ms((n,r)=>vn((o,a)=>t(n,o,r,a))(Tr(i(n,r))),e):("number"==typeof t&&(e=t),to((n,r)=>function Gr(i,t,e,n,r,o,a,u){const f=[];let y=0,M=0,A=!1;const I=()=>{A&&!f.length&&!y&&t.complete()},R=H=>y<n?O(H):f.push(H),O=H=>{o&&t.next(H),y++;let U=!1;Tr(e(H,M++)).subscribe(go(t,B=>{r?.(B),o?R(B):t.next(B)},()=>{U=!0},void 0,()=>{if(U)try{for(y--;f.length&&y<n;){const B=f.shift();a?_d(t,a,()=>O(B)):O(B)}I()}catch(B){t.error(B)}}))};return i.subscribe(go(t,R,()=>{A=!0,I()})),()=>{u?.()}}(n,r,i,e)))}function yd(i=1/0){return Ms(yc,i)}const Ql=new Cn(i=>i.complete());function vd(i){return i&&Sr(i.schedule)}function Vu(i){return i[i.length-1]}function fm(i){return Sr(Vu(i))?i.pop():void 0}function Xc(i){return vd(Vu(i))?i.pop():void 0}function Dh(i,t=0){return to((e,n)=>{e.subscribe(go(n,r=>_d(n,i,()=>n.next(r),t),()=>_d(n,i,()=>n.complete(),t),r=>_d(n,i,()=>n.error(r),t)))})}function yt(i,t=0){return to((e,n)=>{n.add(i.schedule(()=>e.subscribe(n),t))})}function Zc(i,t){if(!i)throw new Error("Iterable cannot be null");return new Cn(e=>{_d(e,t,()=>{const n=i[Symbol.asyncIterator]();_d(e,t,()=>{n.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Zo(i,t){return t?function wg(i,t){if(null!=i){if(fi(i))return function bd(i,t){return Tr(i).pipe(yt(t),Dh(t))}(i,t);if(lt(i))return function ra(i,t){return new Cn(e=>{let n=0;return t.schedule(function(){n===i.length?e.complete():(e.next(i[n++]),e.closed||this.schedule())})})}(i,t);if(ri(i))return function Es(i,t){return Tr(i).pipe(yt(t),Dh(t))}(i,t);if(Kt(i))return Zc(i,t);if(tr(i))return function X_(i,t){return new Cn(e=>{let n;return _d(e,t,()=>{n=i[An](),_d(e,t,()=>{let r,o;try{({value:r,done:o}=n.next())}catch(a){return void e.error(a)}o?e.complete():e.next(r)},0,!0)}),()=>Sr(n?.return)&&n.return()})}(i,t);if(zo(i))return function mm(i,t){return Zc(dr(i),t)}(i,t)}throw On(i)}(i,t):Tr(i)}function oi(...i){const t=Xc(i),e=function qd(i,t){return"number"==typeof Vu(i)?i.pop():t}(i,1/0),n=i;return n.length?1===n.length?Tr(n[0]):yd(e)(Zo(n,t)):Ql}function Jt(...i){return Zo(i,Xc(i))}function Wn(i={}){const{connector:t=(()=>new Fi),resetOnError:e=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return o=>{let a,u,f,y=0,M=!1,A=!1;const I=()=>{u?.unsubscribe(),u=void 0},R=()=>{I(),a=f=void 0,M=A=!1},O=()=>{const H=a;R(),H?.unsubscribe()};return to((H,U)=>{y++,!A&&!M&&I();const B=f=f??t();U.add(()=>{y--,0===y&&!A&&!M&&(u=oa(O,r))}),B.subscribe(U),!a&&y>0&&(a=new jc({next:Z=>B.next(Z),error:Z=>{A=!0,I(),u=oa(R,e,Z),B.error(Z)},complete:()=>{M=!0,I(),u=oa(R,n),B.complete()}}),Tr(H).subscribe(a))})(o)}}function oa(i,t,...e){if(!0===t)return void i();if(!1===t)return;const n=new jc({next:()=>{n.unsubscribe(),i()}});return Tr(t(...e)).subscribe(n)}function Co(i,t){return to((e,n)=>{let r=null,o=0,a=!1;const u=()=>a&&!r&&n.complete();e.subscribe(go(n,f=>{r?.unsubscribe();let y=0;const M=o++;Tr(i(f,M)).subscribe(r=go(n,A=>n.next(t?t(f,A,M,y++):A),()=>{r=null,u()}))},()=>{a=!0,u()}))})}function Jn(i,t=yc){return i=i??Dl,to((e,n)=>{let r,o=!0;e.subscribe(go(n,a=>{const u=t(a);(o||!i(r,u))&&(o=!1,r=u,n.next(a))}))})}function Dl(i,t){return i===t}function jr(i){for(let t in i)if(i[t]===jr)return t;throw Error("Could not find renamed property on target object.")}function Mc(i,t){for(const e in t)t.hasOwnProperty(e)&&!i.hasOwnProperty(e)&&(i[e]=t[e])}function yo(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(yo).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const t=i.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function So(i,t){return null==i||""===i?null===t?"":t:null==t||""===t?i:i+" "+t}const gm=jr({__forward_ref__:jr});function ir(i){return i.__forward_ref__=ir,i.toString=function(){return yo(this())},i}function _n(i){return Hu(i)?i():i}function Hu(i){return"function"==typeof i&&i.hasOwnProperty(gm)&&i.__forward_ref__===ir}function Ap(i){return i&&!!i.\u0275providers}const Ih="https://g.co/ng/security#xss";class Ct extends Error{constructor(t,e){super(function Gu(i,t){return`NG0${Math.abs(i)}${t?": "+t:""}`}(t,e)),this.code=t}}function Dn(i){return"string"==typeof i?i:null==i?"":String(i)}function Ma(i,t){throw new Ct(-201,!1)}function Cc(i,t){null==i&&function io(i,t,e,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${e} ${n} ${t} <=Actual]`))}(t,i,null,"!=")}function Qt(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Rn(i){return{providers:i.providers||[],imports:i.imports||[]}}function Oa(i){return Zd(i,Wu)||Zd(i,vf)}function Zd(i,t){return i.hasOwnProperty(t)?i[t]:null}function ym(i){return i&&(i.hasOwnProperty(Ip)||i.hasOwnProperty(kh))?i[Ip]:null}const Wu=jr({\u0275prov:jr}),Ip=jr({\u0275inj:jr}),vf=jr({ngInjectableDef:jr}),kh=jr({ngInjectorDef:jr});var xi=(()=>((xi=xi||{})[xi.Default=0]="Default",xi[xi.Host=1]="Host",xi[xi.Self=2]="Self",xi[xi.SkipSelf=4]="SkipSelf",xi[xi.Optional=8]="Optional",xi))();let ol;function Uo(i){const t=ol;return ol=i,t}function bm(i,t,e){const n=Oa(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:e&xi.Optional?null:void 0!==t?t:void Ma(yo(i))}const Nr=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Ls={},Yc="__NG_DI_FLAG__",Rh="ngTempTokenPath",xf=/\n/gm,wm="__source";let xd;function sl(i){const t=xd;return xd=i,t}function Mr(i,t=xi.Default){if(void 0===xd)throw new Ct(-203,!1);return null===xd?bm(i,void 0,t):xd.get(i,t&xi.Optional?null:void 0,t)}function it(i,t=xi.Default){return(function vm(){return ol}()||Mr)(_n(i),t)}function mi(i,t=xi.Default){return it(i,Lh(t))}function Lh(i){return typeof i>"u"||"number"==typeof i?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function wd(i){const t=[];for(let e=0;e<i.length;e++){const n=_n(i[e]);if(Array.isArray(n)){if(0===n.length)throw new Ct(900,!1);let r,o=xi.Default;for(let a=0;a<n.length;a++){const u=n[a],f=Sg(u);"number"==typeof f?-1===f?r=u.token:o|=f:r=u}t.push(it(r,o))}else t.push(it(n))}return t}function Fh(i,t){return i[Yc]=t,i.prototype[Yc]=t,i}function Sg(i){return i[Yc]}function Sc(i){return{toString:i}.toString()}var ns=(()=>((ns=ns||{})[ns.OnPush=0]="OnPush",ns[ns.Default=1]="Default",ns))(),sa=(()=>{return(i=sa||(sa={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",sa;var i})();const Ea={},Wr=[],kp=jr({\u0275cmp:jr}),Ag=jr({\u0275dir:jr}),Oh=jr({\u0275pipe:jr}),Nh=jr({\u0275mod:jr}),Kc=jr({\u0275fac:jr}),Yd=jr({__NG_ELEMENT_ID__:jr}),Kd=jr({__NG_ENV_ID__:jr});function Jc(i,t,e){let n=i.length;for(;;){const r=i.indexOf(t,e);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const o=t.length;if(r+o===n||i.charCodeAt(r+o)<=32)return r}e=r+1}}function Rp(i,t,e){let n=0;for(;n<e.length;){const r=e[n];if("number"==typeof r){if(0!==r)break;n++;const o=e[n++],a=e[n++],u=e[n++];i.setAttribute(t,a,u,o)}else{const o=r,a=e[++n];Lp(o)?i.setProperty(t,o,a):i.setAttribute(t,o,a),n++}}return n}function Pp(i){return 3===i||4===i||6===i}function Lp(i){return 64===i.charCodeAt(0)}function tc(i,t){if(null!==t&&0!==t.length)if(null===i||0===i.length)i=t.slice();else{let e=-1;for(let n=0;n<t.length;n++){const r=t[n];"number"==typeof r?e=r:0===e||Bh(i,e,r,null,-1===e||2===e?t[++n]:null)}}return i}function Bh(i,t,e,n,r){let o=0,a=i.length;if(-1===t)a=-1;else for(;o<i.length;){const u=i[o++];if("number"==typeof u){if(u===t){a=-1;break}if(u>t){a=o-1;break}}}for(;o<i.length;){const u=i[o];if("number"==typeof u)break;if(u===e){if(null===n)return void(null!==r&&(i[o+1]=r));if(n===i[o+1])return void(i[o+2]=r)}o++,null!==n&&o++,null!==r&&o++}-1!==a&&(i.splice(a,0,t),o=a+1),i.splice(o++,0,e),null!==n&&i.splice(o++,0,n),null!==r&&i.splice(o++,0,r)}const Q_="ng-template";function Dg(i,t,e){let n=0,r=!0;for(;n<i.length;){let o=i[n++];if("string"==typeof o&&r){const a=i[n++];if(e&&"class"===o&&-1!==Jc(a.toLowerCase(),t,0))return!0}else{if(1===o){for(;n<i.length&&"string"==typeof(o=i[n++]);)if(o.toLowerCase()===t)return!0;return!1}"number"==typeof o&&(r=!1)}}return!1}function wf(i){return 4===i.type&&i.value!==Q_}function Md(i,t,e){return t===(4!==i.type||e?i.value:Q_)}function Tc(i,t,e){let n=4;const r=i.attrs||[],o=function Mf(i){for(let t=0;t<i.length;t++)if(Pp(i[t]))return t;return i.length}(r);let a=!1;for(let u=0;u<t.length;u++){const f=t[u];if("number"!=typeof f){if(!a)if(4&n){if(n=2|1&n,""!==f&&!Md(i,f,e)||""===f&&1===t.length){if(Il(n))return!1;a=!0}}else{const y=8&n?f:t[++u];if(8&n&&null!==i.attrs){if(!Dg(i.attrs,y,e)){if(Il(n))return!1;a=!0}continue}const A=Ov(8&n?"class":f,r,wf(i),e);if(-1===A){if(Il(n))return!1;a=!0;continue}if(""!==y){let I;I=A>o?"":r[A+1].toLowerCase();const R=8&n?I:null;if(R&&-1!==Jc(R,y,0)||2&n&&y!==I){if(Il(n))return!1;a=!0}}}}else{if(!a&&!Il(n)&&!Il(f))return!1;if(a&&Il(f))continue;a=!1,n=f|1&n}}return Il(n)||a}function Il(i){return 0==(1&i)}function Ov(i,t,e,n){if(null===t)return-1;let r=0;if(n||!e){let o=!1;for(;r<t.length;){const a=t[r];if(a===i)return r;if(3===a||6===a)o=!0;else{if(1===a||2===a){let u=t[++r];for(;"string"==typeof u;)u=t[++r];continue}if(4===a)break;if(0===a){r+=4;continue}}r+=o?1:2}return-1}return function ty(i,t){let e=i.indexOf(4);if(e>-1)for(e++;e<i.length;){const n=i[e];if("number"==typeof n)return-1;if(n===t)return e;e++}return-1}(t,i)}function Em(i,t,e=!1){for(let n=0;n<t.length;n++)if(Tc(i,t[n],e))return!0;return!1}function zh(i,t){e:for(let e=0;e<t.length;e++){const n=t[e];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function Xe(i,t){return i?":not("+t.trim()+")":t}function kt(i){let t=i[0],e=1,n=2,r="",o=!1;for(;e<i.length;){let a=i[e];if("string"==typeof a)if(2&n){const u=i[++e];r+="["+a+(u.length>0?'="'+u+'"':"")+"]"}else 8&n?r+="."+a:4&n&&(r+=" "+a);else""!==r&&!Il(a)&&(t+=Xe(o,r),r=""),n=a,o=o||!Il(n);e++}return""!==r&&(t+=Xe(o,r)),t}function ui(i){return Sc(()=>{const t=qu(i),e={...t,decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===ns.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&i.dependencies||null,getStandaloneInjector:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||sa.Emulated,styles:i.styles||Wr,_:null,schemas:i.schemas||null,tView:null,id:""};Xu(e);const n=i.dependencies;return e.directiveDefs=Uh(n,!1),e.pipeDefs=Uh(n,!0),e.id=function Ef(i){let t=0;const e=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,i.consts,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery].join("|");for(const r of e)t=Math.imul(31,t)+r.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(e),e})}function js(i){return vr(i)||vo(i)}function Po(i){return null!==i}function Nn(i){return Sc(()=>({type:i.type,bootstrap:i.bootstrap||Wr,declarations:i.declarations||Wr,imports:i.imports||Wr,exports:i.exports||Wr,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function kl(i,t){if(null==i)return Ea;const e={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=n,t&&(t[r]=o)}return e}function si(i){return Sc(()=>{const t=qu(i);return Xu(t),t})}function as(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,standalone:!0===i.standalone,onDestroy:i.type.prototype.ngOnDestroy||null}}function vr(i){return i[kp]||null}function vo(i){return i[Ag]||null}function Cs(i){return i[Oh]||null}function Ws(i,t){const e=i[Nh]||null;if(!e&&!0===t)throw new Error(`Type ${yo(i)} does not have '\u0275mod' property.`);return e}function qu(i){const t={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:i.inputs||Ea,exportAs:i.exportAs||null,standalone:!0===i.standalone,signals:!0===i.signals,selectors:i.selectors||Wr,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:kl(i.inputs,t),outputs:kl(i.outputs)}}function Xu(i){i.features?.forEach(t=>t(i))}function Uh(i,t){if(!i)return null;const e=t?Cs:js;return()=>("function"==typeof i?i():i).map(n=>e(n)).filter(Po)}const ls=0,Si=1,Sn=2,Yo=3,Ca=4,Rl=5,aa=6,Ac=7,Vo=8,al=9,ll=10,In=11,Jd=12,Cf=13,Qd=14,ii=15,la=16,eu=17,Pl=18,Ed=19,$s=20,Dc=21,bo=22,Ss=23,Vh=24,Er=25,Zu=1,Op=2,Ll=7,Ba=9,ms=11;function Ts(i){return Array.isArray(i)&&"object"==typeof i[Zu]}function ca(i){return Array.isArray(i)&&!0===i[Zu]}function Gh(i){return 0!=(4&i.flags)}function tu(i){return i.componentOffset>-1}function Tf(i){return 1==(1&i.flags)}function ic(i){return!!i.template}function jh(i){return 0!=(512&i[Sn])}function Sa(i,t){return i.hasOwnProperty(Kc)?i[Kc]:null}let Ku=Nr.WeakRef??class zv{constructor(t){this.ref=t}deref(){return this.ref}},kc=0,Cd=null,Tm=!1;function Fs(i){const t=Cd;return Cd=i,t}class Am{constructor(){this.id=kc++,this.ref=function Rg(i){return new Ku(i)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[t,e]of this.producers){const n=e.producerNode.deref();if(void 0!==n&&e.atTrackingVersion===this.trackingVersion){if(n.producerPollStatus(e.seenValueVersion))return!0}else this.producers.delete(t),n?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const t=Tm;Tm=!0;try{for(const[e,n]of this.consumers){const r=n.consumerNode.deref();void 0!==r&&r.trackingVersion===n.atTrackingVersion?r.onConsumerDependencyMayHaveChanged():(this.consumers.delete(e),r?.producers.delete(this.id))}}finally{Tm=t}}producerAccessed(){if(Tm)throw new Error("");if(null===Cd)return;let t=Cd.producers.get(this.id);void 0===t?(t={consumerNode:Cd.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Cd.trackingVersion},Cd.producers.set(this.id,t),this.consumers.set(Cd.id,t)):(t.seenValueVersion=this.valueVersion,t.atTrackingVersion=Cd.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Cd?.consumerAllowSignalWrites}producerPollStatus(t){return this.valueVersion!==t||(this.onProducerUpdateValueVersion(),this.valueVersion!==t)}}let C=null;const ne=()=>{};class he extends Am{constructor(t,e,n){super(),this.watch=t,this.schedule=e,this.dirty=!1,this.cleanupFn=ne,this.registerOnCleanup=r=>{this.cleanupFn=r},this.consumerAllowSignalWrites=n}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const t=Fs(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=ne,this.watch(this.registerOnCleanup)}finally{Fs(t)}}cleanup(){this.cleanupFn()}}class pe{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function le(){return me}function me(i){return i.type.prototype.ngOnChanges&&(i.setInput=de),J}function J(){const i=xe(this),t=i?.current;if(t){const e=i.previous;if(e===Ea)i.previous=t;else for(let n in t)e[n]=t[n];i.current=null,this.ngOnChanges(t)}}function de(i,t,e,n){const r=this.declaredInputs[e],o=xe(i)||function Ne(i,t){return i[be]=t}(i,{previous:Ea,current:null}),a=o.current||(o.current={}),u=o.previous,f=u[r];a[r]=new pe(f&&f.currentValue,t,u===Ea),i[n]=t}le.ngInherit=!0;const be="__ngSimpleChanges__";function xe(i){return i[be]||null}const We=function(i,t,e){},$e="svg";function St(i){for(;Array.isArray(i);)i=i[ls];return i}function vt(i,t){return St(t[i])}function et(i,t){return St(t[i.index])}function tt(i,t){return i.data[t]}function Mt(i,t){return i[t]}function Nt(i,t){const e=t[i];return Ts(e)?e:e[ls]}function Qi(i,t){return null==t?null:i[t]}function Ai(i){i[eu]=0}function nn(i){1024&i[Sn]||(i[Sn]|=1024,Bn(i,1))}function sr(i){1024&i[Sn]&&(i[Sn]&=-1025,Bn(i,-1))}function Bn(i,t){let e=i[Yo];if(null===e)return;e[Rl]+=t;let n=e;for(e=e[Yo];null!==e&&(1===t&&1===n[Rl]||-1===t&&0===n[Rl]);)e[Rl]+=t,n=e,e=e[Yo]}const Di={lFrame:ou(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function oc(){return Di.bindingsEnabled}function ao(){return null!==Di.skipHydrationRootTNode}function Ut(){return Di.lFrame.lView}function xr(){return Di.lFrame.tView}function $r(i){return Di.lFrame.contextLView=i,i[Vo]}function lo(i){return Di.lFrame.contextLView=null,i}function Ho(){let i=nu();for(;null!==i&&64===i.type;)i=i.parent;return i}function nu(){return Di.lFrame.currentTNode}function Fl(i,t){const e=Di.lFrame;e.currentTNode=i,e.isParent=t}function ru(){return Di.lFrame.isParent}function Df(){Di.lFrame.isParent=!1}function zp(){return Di.lFrame.bindingIndex++}function Sd(i){const t=Di.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+i,e}function Lg(i,t){const e=Di.lFrame;e.bindingIndex=e.bindingRootIndex=i,ay(t)}function ay(i){Di.lFrame.currentDirectiveIndex=i}function ly(i){const t=Di.lFrame.currentDirectiveIndex;return-1===t?null:i[t]}function Rc(){return Di.lFrame.currentQueryIndex}function Td(i){Di.lFrame.currentQueryIndex=i}function If(i){const t=i[Si];return 2===t.type?t.declTNode:1===t.type?i[aa]:null}function Up(i,t,e){if(e&xi.SkipSelf){let r=t,o=i;for(;!(r=r.parent,null!==r||e&xi.Host||(r=If(o),null===r||(o=o[Qd],10&r.type))););if(null===r)return!1;t=r,i=o}const n=Di.lFrame=id();return n.currentTNode=t,n.lView=i,!0}function Pc(i){const t=id(),e=i[Si];Di.lFrame=t,t.currentTNode=e.firstChild,t.lView=i,t.tView=e,t.contextLView=i,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function id(){const i=Di.lFrame,t=null===i?null:i.child;return null===t?ou(i):t}function ou(i){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=t),t}function Ju(){const i=Di.lFrame;return Di.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const Qu=Ju;function Fg(){const i=Ju();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Os(){return Di.lFrame.selectedIndex}function qh(i){Di.lFrame.selectedIndex=i}function cs(){const i=Di.lFrame;return tt(i.tView,i.selectedIndex)}function qs(){Di.lFrame.currentNamespace=$e}function Og(){!function As(){Di.lFrame.currentNamespace=null}()}let eh=!0;function kf(){return eh}function Ns(i){eh=i}function Va(i,t){for(let e=t.directiveStart,n=t.directiveEnd;e<n;e++){const o=i.data[e].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:u,ngAfterViewInit:f,ngAfterViewChecked:y,ngOnDestroy:M}=o;a&&(i.contentHooks??=[]).push(-e,a),u&&((i.contentHooks??=[]).push(e,u),(i.contentCheckHooks??=[]).push(e,u)),f&&(i.viewHooks??=[]).push(-e,f),y&&((i.viewHooks??=[]).push(e,y),(i.viewCheckHooks??=[]).push(e,y)),null!=M&&(i.destroyHooks??=[]).push(e,M)}}function Ds(i,t,e){Zh(i,t,3,e)}function Dm(i,t,e,n){(3&i[Sn])===e&&Zh(i,t,e,n)}function Xh(i,t){let e=i[Sn];(3&e)===t&&(e&=8191,e+=1,i[Sn]=e)}function Zh(i,t,e,n){const o=n??-1,a=t.length-1;let u=0;for(let f=void 0!==n?65535&i[eu]:0;f<a;f++)if("number"==typeof t[f+1]){if(u=t[f],null!=n&&u>=n)break}else t[f]<0&&(i[eu]+=65536),(u<o||-1==o)&&(cy(i,e,t,f),i[eu]=(4294901760&i[eu])+f+2),f++}function nd(i,t){We(4,i,t);const e=Fs(null);try{t.call(i)}finally{Fs(e),We(5,i,t)}}function cy(i,t,e,n){const r=e[n]<0,o=e[n+1],u=i[r?-e[n]:e[n]];r?i[Sn]>>13<i[eu]>>16&&(3&i[Sn])===t&&(i[Sn]+=8192,nd(u,o)):nd(u,o)}const th=-1;class Im{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function Rm(i){return i!==th}function ih(i){return 32767&i}function Nl(i,t){let e=function Hp(i){return i>>16}(i),n=t;for(;e>0;)n=n[Qd],e--;return n}let Gp=!0;function Bs(i){const t=Gp;return Gp=i,t}const Pm=255,ds=5;let jv=0;const zs={};function Bg(i,t){const e=dy(i,t);if(-1!==e)return e;const n=t[Si];n.firstCreatePass&&(i.injectorIndex=t.length,Wv(n.data,i),Wv(t,null),Wv(n.blueprint,null));const r=uy(i,t),o=i.injectorIndex;if(Rm(r)){const a=ih(r),u=Nl(r,t),f=u[Si].data;for(let y=0;y<8;y++)t[o+y]=u[a+y]|f[a+y]}return t[o+8]=r,o}function Wv(i,t){i.push(0,0,0,0,0,0,0,0,t)}function dy(i,t){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===t[i.injectorIndex+8]?-1:i.injectorIndex}function uy(i,t){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let e=0,n=null,r=t;for(;null!==r;){if(n=$v(r),null===n)return th;if(e++,r=r[Qd],-1!==n.injectorIndex)return n.injectorIndex|e<<16}return th}function Kh(i,t,e){!function Dd(i,t,e){let n;"string"==typeof e?n=e.charCodeAt(0)||0:e.hasOwnProperty(Yd)&&(n=e[Yd]),null==n&&(n=e[Yd]=jv++);const r=n&Pm;t.data[i+(r>>ds)]|=1<<r}(i,t,e)}function zg(i,t,e){if(e&xi.Optional||void 0!==i)return i;Ma()}function Ug(i,t,e,n){if(e&xi.Optional&&void 0===n&&(n=null),!(e&(xi.Self|xi.Host))){const r=i[al],o=Uo(void 0);try{return r?r.get(t,n,e&xi.Optional):bm(t,n,e&xi.Optional)}finally{Uo(o)}}return zg(n,0,e)}function Vg(i,t,e,n=xi.Default,r){if(null!==i){if(2048&t[Sn]&&!(n&xi.Self)){const a=function sh(i,t,e,n,r){let o=i,a=t;for(;null!==o&&null!==a&&2048&a[Sn]&&!(512&a[Sn]);){const u=Hg(o,a,e,n|xi.Self,zs);if(u!==zs)return u;let f=o.parent;if(!f){const y=a[$s];if(y){const M=y.get(e,zs,n);if(M!==zs)return M}f=$v(a),a=a[Qd]}o=f}return r}(i,t,e,n,zs);if(a!==zs)return a}const o=Hg(i,t,e,n,zs);if(o!==zs)return o}return Ug(t,e,n,r)}function Hg(i,t,e,n,r){const o=function Pf(i){if("string"==typeof i)return i.charCodeAt(0)||0;const t=i.hasOwnProperty(Yd)?i[Yd]:void 0;return"number"==typeof t?t>=0?t&Pm:ul:t}(e);if("function"==typeof o){if(!Up(t,i,n))return n&xi.Host?zg(r,0,n):Ug(t,e,n,r);try{const a=o(n);if(null!=a||n&xi.Optional)return a;Ma()}finally{Qu()}}else if("number"==typeof o){let a=null,u=dy(i,t),f=th,y=n&xi.Host?t[ii][aa]:null;for((-1===u||n&xi.SkipSelf)&&(f=-1===u?uy(i,t):t[u+8],f!==th&&hy(n,!1)?(a=t[Si],u=ih(f),t=Nl(f,t)):u=-1);-1!==u;){const M=t[Si];if(rh(o,u,M.data)){const A=Lm(u,t,e,a,n,y);if(A!==zs)return A}f=t[u+8],f!==th&&hy(n,t[Si].data[u+8]===y)&&rh(o,u,t)?(a=M,u=ih(f),t=Nl(f,t)):u=-1}}return r}function Lm(i,t,e,n,r,o){const a=t[Si],u=a.data[i+8],M=wn(u,a,e,null==n?tu(u)&&Gp:n!=a&&0!=(3&u.type),r&xi.Host&&o===u);return null!==M?au(t,a,M,u):zs}function wn(i,t,e,n,r){const o=i.providerIndexes,a=t.data,u=1048575&o,f=i.directiveStart,M=o>>20,I=r?u+M:i.directiveEnd;for(let R=n?u:u+M;R<I;R++){const O=a[R];if(R<f&&e===O||R>=f&&O.type===e)return R}if(r){const R=a[f];if(R&&ic(R)&&R.type===e)return f}return null}function au(i,t,e,n){let r=i[e];const o=t.data;if(function Hv(i){return i instanceof Im}(r)){const a=r;a.resolving&&function fs(i,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${i}`:"";throw new Ct(-200,`Circular dependency in DI detected for ${i}${e}`)}(function ur(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Dn(i)}(o[e]));const u=Bs(a.canSeeViewProviders);a.resolving=!0;const f=a.injectImpl?Uo(a.injectImpl):null;Up(i,n,xi.Default);try{r=i[e]=a.factory(void 0,o,i,n),t.firstCreatePass&&e>=n.directiveStart&&function Vv(i,t,e){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:o}=t.type.prototype;if(n){const a=me(t);(e.preOrderHooks??=[]).push(i,a),(e.preOrderCheckHooks??=[]).push(i,a)}r&&(e.preOrderHooks??=[]).push(0-i,r),o&&((e.preOrderHooks??=[]).push(i,o),(e.preOrderCheckHooks??=[]).push(i,o))}(e,o[e],t)}finally{null!==f&&Uo(f),Bs(u),a.resolving=!1,Qu()}}return r}function rh(i,t,e){return!!(e[t+(i>>ds)]&1<<i)}function hy(i,t){return!(i&xi.Self||i&xi.Host&&t)}class oh{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,n){return Vg(this._tNode,this._lView,t,Lh(n),e)}}function ul(){return new oh(Ho(),Ut())}function Gn(i){return Sc(()=>{const t=i.prototype.constructor,e=t[Kc]||py(t),n=Object.prototype;let r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){const o=r[Kc]||py(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function py(i){return Hu(i)?()=>{const t=py(_n(i));return t&&t()}:Sa(i)}function $v(i){const t=i[Si],e=t.type;return 2===e?t.declTNode:1===e?i[aa]:null}function Bl(i){return function nh(i,t){if("class"===t)return i.classes;if("style"===t)return i.styles;const e=i.attrs;if(e){const n=e.length;let r=0;for(;r<n;){const o=e[r];if(Pp(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<n&&"string"==typeof e[r];)r++;else{if(o===t)return e[r+1];r+=2}}}return null}(Ho(),i)}const hl="__parameters__";function Xs(i,t,e){return Sc(()=>{const n=function Lc(i){return function(...e){if(i){const n=i(...e);for(const r in n)this[r]=n[r]}}}(t);function r(...o){if(this instanceof r)return n.apply(this,o),this;const a=new r(...o);return u.annotation=a,u;function u(f,y,M){const A=f.hasOwnProperty(hl)?f[hl]:Object.defineProperty(f,hl,{value:[]})[hl];for(;A.length<=M;)A.push(null);return(A[M]=A[M]||[]).push(a),f}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}function Of(i,t){i.forEach(e=>Array.isArray(e)?Of(e,t):t(e))}function du(i,t,e){t>=i.length?i.push(e):i.splice(t,0,e)}function Nf(i,t){return t>=i.length-1?i.pop():i.splice(t,1)[0]}function jp(i,t){const e=[];for(let n=0;n<i;n++)e.push(t);return e}function pa(i,t,e){let n=kr(i,t);return n>=0?i[1|n]=e:(n=~n,function yx(i,t,e,n){let r=i.length;if(r==t)i.push(e,n);else if(1===r)i.push(n,i[0]),i[0]=e;else{for(r--,i.push(i[r-1],i[r]);r>t;)i[r]=i[r-2],r--;i[t]=e,i[t+1]=n}}(i,n,t,e)),n}function ah(i,t){const e=kr(i,t);if(e>=0)return i[1|e]}function kr(i,t){return function uu(i,t,e){let n=0,r=i.length>>e;for(;r!==n;){const o=n+(r-n>>1),a=i[o<<e];if(t===a)return o<<e;a>t?r=o:n=o+1}return~(r<<e)}(i,t,1)}const Id=Fh(Xs("Optional"),8),Qh=Fh(Xs("SkipSelf"),4);function Zg(i){return 128==(128&i.flags)}var ja=(()=>((ja=ja||{})[ja.Important=1]="Important",ja[ja.DashCase=2]="DashCase",ja))();const lb=new Map;let Ey=0;const zm="__ngContext__";function Ta(i,t){Ts(t)?(i[zm]=t[Ed],function cb(i){lb.set(i[Ed],i)}(t)):i[zm]=t}let Qg;function Um(i,t){return Qg(i,t)}function Uf(i){const t=i[Yo];return ca(t)?t[Yo]:t}function Ax(i){return Ix(i[Jd])}function Dx(i){return Ix(i[Ca])}function Ix(i){for(;null!==i&&!ca(i);)i=i[Ca];return i}function Vm(i,t,e,n,r){if(null!=n){let o,a=!1;ca(n)?o=n:Ts(n)&&(a=!0,n=n[ls]);const u=St(n);0===i&&null!==e?null==r?Xp(t,e,u):pu(t,e,u,r||null,!0):1===i&&null!==e?pu(t,e,u,r||null,!0):2===i?function r_(i,t,e){const n=ky(i,t);n&&function i_(i,t,e,n){i.removeChild(t,e,n)}(i,n,t,e)}(t,u,a):3===i&&t.destroyNode(u),null!=o&&function Us(i,t,e,n,r){const o=e[Ll];o!==St(e)&&Vm(t,i,n,o,r);for(let u=ms;u<e.length;u++){const f=e[u];Pn(f[Si],f,i,t,n,o)}}(t,i,o,e,r)}}function qp(i,t,e){return i.createElement(t,e)}function bb(i,t){const e=i[Ba],n=e.indexOf(t);sr(t),e.splice(n,1)}function Ay(i,t){if(i.length<=ms)return;const e=ms+t,n=i[e];if(n){const r=n[la];null!==r&&r!==i&&bb(r,n),t>0&&(i[e-1][Ca]=n[Ca]);const o=Nf(i,ms+t);!function Hm(i,t){Pn(i,t,t[In],2,null,null),t[ls]=null,t[aa]=null}(n[Si],n);const a=o[Pl];null!==a&&a.detachView(o[Si]),n[Yo]=null,n[Ca]=null,n[Sn]&=-129}return n}function Px(i,t){if(!(256&t[Sn])){const e=t[In];t[Ss]?.destroy(),t[Vh]?.destroy(),e.destroyNode&&Pn(i,t,e,3,null,null),function _b(i){let t=i[Jd];if(!t)return t_(i[Si],i);for(;t;){let e=null;if(Ts(t))e=t[Jd];else{const n=t[ms];n&&(e=n)}if(!e){for(;t&&!t[Ca]&&t!==i;)Ts(t)&&t_(t[Si],t),t=t[Yo];null===t&&(t=i),Ts(t)&&t_(t[Si],t),e=t&&t[Ca]}t=e}}(t)}}function t_(i,t){if(!(256&t[Sn])){t[Sn]&=-129,t[Sn]|=256,function Vf(i,t){let e;if(null!=i&&null!=(e=i.destroyHooks))for(let n=0;n<e.length;n+=2){const r=t[e[n]];if(!(r instanceof Im)){const o=e[n+1];if(Array.isArray(o))for(let a=0;a<o.length;a+=2){const u=r[o[a]],f=o[a+1];We(4,u,f);try{f.call(u)}finally{We(5,u,f)}}else{We(4,r,o);try{o.call(r)}finally{We(5,r,o)}}}}}(i,t),function Dy(i,t){const e=i.cleanup,n=t[Ac];if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const a=e[o+3];a>=0?n[a]():n[-a].unsubscribe(),o+=2}else e[o].call(n[e[o+1]]);null!==n&&(t[Ac]=null);const r=t[Dc];if(null!==r){t[Dc]=null;for(let o=0;o<r.length;o++)(0,r[o])()}}(i,t),1===t[Si].type&&t[In].destroy();const e=t[la];if(null!==e&&ca(t[Yo])){e!==t[Yo]&&bb(e,t);const n=t[Pl];null!==n&&n.detachView(i)}!function Nm(i){lb.delete(i[Ed])}(t)}}function Gm(i,t,e){return function Lx(i,t,e){let n=t;for(;null!==n&&40&n.type;)n=(t=n).parent;if(null===n)return e[ls];{const{componentOffset:r}=n;if(r>-1){const{encapsulation:o}=i.data[n.directiveStart+r];if(o===sa.None||o===sa.Emulated)return null}return et(n,e)}}(i,t.parent,e)}function pu(i,t,e,n,r){i.insertBefore(t,e,n,r)}function Xp(i,t,e){i.appendChild(t,e)}function Iy(i,t,e,n,r){null!==n?pu(i,t,e,n,r):Xp(i,t,e)}function ky(i,t){return i.parentNode(t)}function xb(i,t,e){return Mb(i,t,e)}let Ry,Ly,jm,Mb=function wb(i,t,e){return 40&i.type?et(i,e):null};function Py(i,t,e,n){const r=Gm(i,n,t),o=t[In],u=xb(n.parent||t[aa],n,t);if(null!=r)if(Array.isArray(e))for(let f=0;f<e.length;f++)Iy(o,r,e[f],u,!1);else Iy(o,r,e,u,!1);void 0!==Ry&&Ry(o,n,t,e,r)}function n_(i,t){if(null!==t){const e=t.type;if(3&e)return et(t,i);if(4&e)return Ul(-1,i[t.index]);if(8&e){const n=t.child;if(null!==n)return n_(i,n);{const r=i[t.index];return ca(r)?Ul(-1,r):St(r)}}if(32&e)return Um(t,i)()||St(i[t.index]);{const n=Cb(i,t);return null!==n?Array.isArray(n)?n[0]:n_(Uf(i[ii]),n):n_(i,t.next)}}return null}function Cb(i,t){return null!==t?i[ii][aa].projection[t.projection]:null}function Ul(i,t){const e=ms+i+1;if(e<t.length){const n=t[e],r=n[Si].firstChild;if(null!==r)return n_(n,r)}return t[Ll]}function ad(i,t,e,n,r,o,a){for(;null!=e;){const u=n[e.index],f=e.type;if(a&&0===t&&(u&&Ta(St(u),n),e.flags|=2),32!=(32&e.flags))if(8&f)ad(i,t,e.child,n,r,o,!1),Vm(t,i,r,u,o);else if(32&f){const y=Um(e,n);let M;for(;M=y();)Vm(t,i,r,M,o);Vm(t,i,r,u,o)}else 16&f?Vl(i,t,n,e,r,o):Vm(t,i,r,u,o);e=a?e.projectionNext:e.next}}function Pn(i,t,e,n,r,o){ad(e,n,i.firstChild,t,r,o,!1)}function Vl(i,t,e,n,r,o){const a=e[ii],f=a[aa].projection[n.projection];if(Array.isArray(f))for(let y=0;y<f.length;y++)Vm(t,i,r,f[y],o);else{let y=f;const M=a[Yo];Zg(n)&&(y.flags|=128),ad(i,t,y,M,r,o,!0)}}function Ox(i,t,e){""===e?i.removeAttribute(t,"class"):i.setAttribute(t,"class",e)}function Nx(i,t,e){const{mergedAttrs:n,classes:r,styles:o}=e;null!==n&&Rp(i,t,n),null!==r&&Ox(i,t,r),null!==o&&function Zp(i,t,e){i.setAttribute(t,"style",e)}(i,t,o)}function ip(i){return function Sb(){if(void 0===Ly&&(Ly=null,Nr.trustedTypes))try{Ly=Nr.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return Ly}()?.createHTML(i)||i}class gl{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ih})`}}class kb extends gl{getTypeName(){return"HTML"}}class a_ extends gl{getTypeName(){return"Style"}}class uh extends gl{getTypeName(){return"Script"}}class Rb extends gl{getTypeName(){return"URL"}}class pM extends gl{getTypeName(){return"ResourceURL"}}function Wa(i){return i instanceof gl?i.changingThisBreaksApplicationSecurity:i}function ld(i,t){const e=function cd(i){return i instanceof gl&&i.getTypeName()||null}(i);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${Ih})`)}return e===t}class Fb{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(ip(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class _l{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const e=this.inertDocument.createElement("template");return e.innerHTML=ip(t),e}}const Ob=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function ac(i){return(i=String(i)).match(Ob)?i:"unsafe:"+i}function hh(i){const t={};for(const e of i.split(","))t[e]=!0;return t}function l_(...i){const t={};for(const e of i)for(const n in e)e.hasOwnProperty(n)&&(t[n]=!0);return t}const Do=hh("area,br,col,hr,img,wbr"),Hx=hh("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Nb=hh("rp,rt"),Wm=l_(Do,l_(Hx,hh("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),l_(Nb,hh("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),l_(Nb,Hx)),Yp=hh("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Fy=l_(Yp,hh("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),hh("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),mM=hh("script,style,template");class gM{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Wm.hasOwnProperty(e))return this.sanitizedSomething=!0,!mM.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let r=0;r<n.length;r++){const o=n.item(r),a=o.name,u=a.toLowerCase();if(!Fy.hasOwnProperty(u)){this.sanitizedSomething=!0;continue}let f=o.value;Yp[u]&&(f=ac(f)),this.buf.push(" ",a,'="',Oy(f),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Wm.hasOwnProperty(e)&&!Do.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Oy(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const _M=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Gx=/([^\#-~ |!])/g;function Oy(i){return i.replace(/&/g,"&amp;").replace(_M,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Gx,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let $a;function $m(i,t){let e=null;try{$a=$a||function Lb(i){const t=new _l(i);return function ar(){try{return!!(new window.DOMParser).parseFromString(ip(""),"text/html")}catch{return!1}}()?new Fb(t):t}(i);let n=t?String(t):"";e=$a.getInertBodyElement(n);let r=5,o=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=o,o=e.innerHTML,e=$a.getInertBodyElement(n)}while(n!==o);return ip((new gM).sanitizeChildren(Ny(e)||e))}finally{if(e){const n=Ny(e)||e;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function Ny(i){return"content"in i&&function lc(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var wo=(()=>((wo=wo||{})[wo.NONE=0]="NONE",wo[wo.HTML=1]="HTML",wo[wo.STYLE=2]="STYLE",wo[wo.SCRIPT=3]="SCRIPT",wo[wo.URL=4]="URL",wo[wo.RESOURCE_URL=5]="RESOURCE_URL",wo))();class Ot{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Qt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Xm=new Ot("ENVIRONMENT_INITIALIZER"),ph=new Ot("INJECTOR",-1),By=new Ot("INJECTOR_DEF_TYPES");class zy{get(t,e=Ls){if(e===Ls){const n=new Error(`NullInjectorError: No provider for ${yo(t)}!`);throw n.name="NullInjectorError",n}return e}}function Xx(...i){return{\u0275providers:Zx(0,i),\u0275fromNgModule:!0}}function Zx(i,...t){const e=[],n=new Set;let r;return Of(t,o=>{const a=o;rp(a,e,[],n)&&(r||=[],r.push(a))}),void 0!==r&&Yx(r,e),e}function Yx(i,t){for(let e=0;e<i.length;e++){const{providers:r}=i[e];jf(r,o=>{t.push(o)})}}function rp(i,t,e,n){if(!(i=_n(i)))return!1;let r=null,o=ym(i);const a=!o&&vr(i);if(o||a){if(a&&!a.standalone)return!1;r=i}else{const f=i.ngModule;if(o=ym(f),!o)return!1;r=f}const u=n.has(r);if(a){if(u)return!1;if(n.add(r),a.dependencies){const f="function"==typeof a.dependencies?a.dependencies():a.dependencies;for(const y of f)rp(y,t,e,n)}}else{if(!o)return!1;{if(null!=o.imports&&!u){let y;n.add(r);try{Of(o.imports,M=>{rp(M,t,e,n)&&(y||=[],y.push(M))})}finally{}void 0!==y&&Yx(y,t)}if(!u){const y=Sa(r)||(()=>new r);t.push({provide:r,useFactory:y,deps:Wr},{provide:By,useValue:r,multi:!0},{provide:Xm,useValue:()=>it(r),multi:!0})}const f=o.providers;null==f||u||jf(f,M=>{t.push(M)})}}return r!==i&&void 0!==i.providers}function jf(i,t){for(let e of i)Ap(e)&&(e=e.\u0275providers),Array.isArray(e)?jf(e,t):t(e)}const Kx=jr({provide:String,useValue:jr});function Vy(i){return null!==i&&"object"==typeof i&&Kx in i}function dd(i){return"function"==typeof i}const Hy=new Ot("Set Injector scope."),Wf={},Jx={};let Ym;function $f(){return void 0===Ym&&(Ym=new zy),Ym}class fh{}class Vb extends fh{get destroyed(){return this._destroyed}constructor(t,e,n,r){super(),this.parent=e,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,jb(t,a=>this.processProvider(a)),this.records.set(ph,fu(void 0,this)),r.has("environment")&&this.records.set(fh,fu(void 0,this));const o=this.records.get(Hy);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(By.multi,Wr,xi.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const e of t)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const e=sl(this),n=Uo(void 0);try{return t()}finally{sl(e),Uo(n)}}get(t,e=Ls,n=xi.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(Kd))return t[Kd](this);n=Lh(n);const r=sl(this),o=Uo(void 0);try{if(!(n&xi.SkipSelf)){let u=this.records.get(t);if(void 0===u){const f=function Qx(i){return"function"==typeof i||"object"==typeof i&&i instanceof Ot}(t)&&Oa(t);u=f&&this.injectableDefInScope(f)?fu(Hb(t),Wf):null,this.records.set(t,u)}if(null!=u)return this.hydrate(t,u)}return(n&xi.Self?$f():this.parent).get(t,e=n&xi.Optional&&e===Ls?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[Rh]=a[Rh]||[]).unshift(yo(t)),r)throw a;return function Tg(i,t,e,n){const r=i[Rh];throw t[wm]&&r.unshift(t[wm]),i.message=function Fv(i,t,e,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.slice(2):i;let r=yo(t);if(Array.isArray(t))r=t.map(yo).join(" -> ");else if("object"==typeof t){let o=[];for(let a in t)if(t.hasOwnProperty(a)){let u=t[a];o.push(a+":"+("string"==typeof u?JSON.stringify(u):yo(u)))}r=`{${o.join(", ")}}`}return`${e}${n?"("+n+")":""}[${r}]: ${i.replace(xf,"\n  ")}`}("\n"+i.message,r,e,n),i.ngTokenPath=r,i[Rh]=null,i}(a,t,"R3InjectorError",this.source)}throw a}finally{Uo(o),sl(r)}}resolveInjectorInitializers(){const t=sl(this),e=Uo(void 0);try{const n=this.get(Xm.multi,Wr,xi.Self);for(const r of n)r()}finally{sl(t),Uo(e)}}toString(){const t=[],e=this.records;for(const n of e.keys())t.push(yo(n));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ct(205,!1)}processProvider(t){let e=dd(t=_n(t))?t:_n(t&&t.provide);const n=function wM(i){return Vy(i)?fu(void 0,i.useValue):fu(qf(i),Wf)}(t);if(dd(t)||!0!==t.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=fu(void 0,Wf,!0),r.factory=()=>wd(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,n)}hydrate(t,e){return e.value===Wf&&(e.value=Jx,e.value=e.factory()),"object"==typeof e.value&&e.value&&function MM(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=_n(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){const e=this._onDestroyHooks.indexOf(t);-1!==e&&this._onDestroyHooks.splice(e,1)}}function Hb(i){const t=Oa(i),e=null!==t?t.factory:Sa(i);if(null!==e)return e;if(i instanceof Ot)throw new Ct(204,!1);if(i instanceof Function)return function xM(i){const t=i.length;if(t>0)throw jp(t,"?"),new Ct(204,!1);const e=function Na(i){return i&&(i[Wu]||i[vf])||null}(i);return null!==e?()=>e.factory(i):()=>new i}(i);throw new Ct(204,!1)}function qf(i,t,e){let n;if(dd(i)){const r=_n(i);return Sa(r)||Hb(r)}if(Vy(i))n=()=>_n(i.useValue);else if(function d_(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...wd(i.deps||[]));else if(function Rd(i){return!(!i||!i.useExisting)}(i))n=()=>it(_n(i.useExisting));else{const r=_n(i&&(i.useClass||i.provide));if(!function Gb(i){return!!i.deps}(i))return Sa(r)||Hb(r);n=()=>new r(...wd(i.deps))}return n}function fu(i,t,e=!1){return{factory:i,value:t,multi:e?[]:void 0}}function jb(i,t){for(const e of i)Array.isArray(e)?jb(e,t):e&&Ap(e)?jb(e.\u0275providers,t):t(e)}const Km=new Ot("AppId",{providedIn:"root",factory:()=>EM}),EM="ng",Jm=new Ot("Platform Initializer"),cc=new Ot("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),ma=new Ot("AnimationModuleType"),Qm=new Ot("CSP nonce",{providedIn:"root",factory:()=>function rs(){if(void 0!==jm)return jm;if(typeof document<"u")return document;throw new Ct(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let jy=(i,t)=>null;function qb(i,t){return jy(i,t)}class IM{}class qy{}class kM{resolveComponentFactory(t){throw function ow(i){const t=Error(`No component factory found for ${yo(i)}.`);return t.ngComponent=i,t}(t)}}let tg=(()=>{class i{}return i.NULL=new kM,i})();function RM(){return ef(Ho(),Ut())}function ef(i,t){return new tn(et(i,t))}let tn=(()=>{class i{constructor(e){this.nativeElement=e}}return i.__NG_ELEMENT_ID__=RM,i})();function p_(i){return i instanceof tn?i.nativeElement:i}class f_{}let sp=(()=>{class i{constructor(){this.destroyNode=null}}return i.__NG_ELEMENT_ID__=()=>function sw(){const i=Ut(),e=Nt(Ho().index,i);return(Ts(e)?e:i)[In]}(),i})(),PM=(()=>{class i{}return i.\u0275prov=Qt({token:i,providedIn:"root",factory:()=>null}),i})();class tf{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Pd=new tf("16.1.3"),_={};function E(i){for(;i;){i[Sn]|=64;const t=Uf(i);if(jh(i)&&!t)return i;i=t}return null}function te(i){return i.ngOriginalError}class fe{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&te(t);for(;e&&te(e);)e=te(e);return e||null}}const Qe=new Ot("",{providedIn:"root",factory:()=>!1});function Ln(i){return i instanceof Function?i():i}class ap extends Am{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(t){this._lView=t}onConsumerDependencyMayHaveChanged(){E(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(t,e,n){const r=Fs(this);this.trackingVersion++;try{t(e,n)}finally{Fs(r)}}destroy(){this.trackingVersion++}}let Xy=null;function aw(){return Xy??=new ap,Xy}function gh(i,t){return i[t]??aw()}function ig(i,t){const e=aw();e.hasReadASignal&&(i[t]=Xy,e.lView=i,Xy=new ap)}const fr={};function ft(i){Zy(xr(),Ut(),Os()+i,!1)}function Zy(i,t,e,n){if(!n)if(3==(3&t[Sn])){const o=i.preOrderCheckHooks;null!==o&&Ds(t,o,e)}else{const o=i.preOrderHooks;null!==o&&Dm(t,o,0,e)}qh(e)}function BM(i,t=null,e=null,n){const r=lw(i,t,e,n);return r.resolveInjectorInitializers(),r}function lw(i,t=null,e=null,n,r=new Set){const o=[e||Wr,Xx(i)];return n=n||("object"==typeof i?void 0:yo(i)),new Vb(o,t||$f(),n||null,r)}let vl=(()=>{class i{static create(e,n){if(Array.isArray(e))return BM({name:""},n,e,"");{const r=e.name??"";return BM({name:r},e.parent,e.providers,r)}}}return i.THROW_IF_NOT_FOUND=Ls,i.NULL=new zy,i.\u0275prov=Qt({token:i,providedIn:"any",factory:()=>it(ph)}),i.__NG_ELEMENT_ID__=-1,i})();function oe(i,t=xi.Default){const e=Ut();return null===e?it(i,t):Vg(Ho(),e,_n(i),t)}function lp(){throw new Error("invalid")}function Yb(i,t,e,n,r,o,a,u,f,y,M){const A=t.blueprint.slice();return A[ls]=r,A[Sn]=140|n,(null!==y||i&&2048&i[Sn])&&(A[Sn]|=2048),Ai(A),A[Yo]=A[Qd]=i,A[Vo]=e,A[ll]=a||i&&i[ll],A[In]=u||i&&i[In],A[al]=f||i&&i[al]||null,A[aa]=o,A[Ed]=function aM(){return Ey++}(),A[bo]=M,A[$s]=y,A[ii]=2==t.type?i[ii]:A,A}function l(i,t,e,n,r){let o=i.data[t];if(null===o)o=function s(i,t,e,n,r){const o=nu(),a=ru(),f=i.data[t]=function ae(i,t,e,n,r,o){let a=t?t.injectorIndex:-1,u=0;return ao()&&(u|=128),{type:e,index:n,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:u,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?o:o&&o.parent,e,t,n,r);return null===i.firstChild&&(i.firstChild=f),null!==o&&(a?null==o.child&&null!==f.parent&&(o.child=f):null===o.next&&(o.next=f,f.prev=o)),f}(i,t,e,n,r),function ha(){return Di.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=n,o.attrs=r;const a=function sc(){const i=Di.lFrame,t=i.currentTNode;return i.isParent?t:t.parent}();o.injectorIndex=null===a?-1:a.injectorIndex}return Fl(o,!0),o}function c(i,t,e,n){if(0===e)return-1;const r=t.length;for(let o=0;o<e;o++)t.push(n),i.blueprint.push(n),i.data.push(null);return r}function h(i,t,e,n,r){const o=gh(t,Ss),a=Os(),u=2&n;try{if(qh(-1),u&&t.length>Er&&Zy(i,t,Er,!1),We(u?2:0,r),u)o.runInContext(e,n,r);else{const y=Fs(null);try{e(n,r)}finally{Fs(y)}}}finally{u&&null===t[Ss]&&ig(t,Ss),qh(a),We(u?3:1,r)}}function m(i,t,e){if(Gh(t)){const n=Fs(null);try{const o=t.directiveEnd;for(let a=t.directiveStart;a<o;a++){const u=i.data[a];u.contentQueries&&u.contentQueries(1,e[a],a)}}finally{Fs(n)}}}function b(i,t,e){oc()&&(function Lt(i,t,e,n){const r=e.directiveStart,o=e.directiveEnd;tu(e)&&function en(i,t,e){const n=et(t,i),r=S(e);let a=16;e.signals?a=4096:e.onPush&&(a=64);const u=co(i,Yb(i,r,null,a,n,t,null,i[ll].rendererFactory.createRenderer(n,e),null,null,null));i[t.index]=u}(t,e,i.data[r+e.componentOffset]),i.firstCreatePass||Bg(e,t),Ta(n,t);const a=e.initialInputs;for(let u=r;u<o;u++){const f=i.data[u],y=au(t,i,u,e);Ta(y,t),null!==a&&qn(0,u-r,y,f,0,a),ic(f)&&(Nt(e.index,t)[Vo]=au(t,i,u,e))}}(i,t,e,et(e,t)),64==(64&e.flags)&&Gt(i,t,e))}function w(i,t,e=et){const n=t.localNames;if(null!==n){let r=t.index+1;for(let o=0;o<n.length;o+=2){const a=n[o+1],u=-1===a?e(t,i):i[a];i[r++]=u}}}function S(i){const t=i.tView;return null===t||t.incompleteFirstPass?i.tView=D(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):t}function D(i,t,e,n,r,o,a,u,f,y,M){const A=Er+n,I=A+r,R=function k(i,t){const e=[];for(let n=0;n<t;n++)e.push(n<i?null:fr);return e}(A,I),O="function"==typeof y?y():y;return R[Si]={type:i,blueprint:R,template:e,queries:null,viewQuery:u,declTNode:t,data:R.slice().fill(null,A),bindingStartIndex:A,expandoStartIndex:I,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:f,consts:O,incompleteFirstPass:!1,ssrId:M}}let G=i=>null;function ge(i,t,e,n){for(let r in i)if(i.hasOwnProperty(r)){e=null===e?{}:e;const o=i[r];null===n?De(e,t,r,o):n.hasOwnProperty(r)&&De(e,t,n[r],o)}return e}function De(i,t,e,n){i.hasOwnProperty(e)?i[e].push(t,n):i[e]=[t,n]}function Ie(i,t,e,n,r,o,a,u){const f=et(t,e);let M,y=t.inputs;!u&&null!=y&&(M=y[n])?(Mo(i,e,M,n,r),tu(t)&&function Le(i,t){const e=Nt(t,i);16&e[Sn]||(e[Sn]|=64)}(e,t.index)):3&t.type&&(n=function Ae(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),r=null!=a?a(r,t.value||"",n):r,o.setProperty(f,n,r))}function Et(i,t,e,n){if(oc()){const r=null===n?null:{"":-1},o=function bt(i,t){const e=i.directiveRegistry;let n=null,r=null;if(e)for(let o=0;o<e.length;o++){const a=e[o];if(Em(t,a.selectors,!1))if(n||(n=[]),ic(a))if(null!==a.findHostDirectiveDefs){const u=[];r=r||new Map,a.findHostDirectiveDefs(a,u,r),n.unshift(...u,a),_i(i,t,u.length)}else n.unshift(a),_i(i,t,0);else r=r||new Map,a.findHostDirectiveDefs?.(a,n,r),n.push(a)}return null===n?null:[n,r]}(i,e);let a,u;null===o?a=u=null:[a,u]=o,null!==a&&Yt(i,t,e,a,r,u),r&&function Ri(i,t,e){if(t){const n=i.localNames=[];for(let r=0;r<t.length;r+=2){const o=e[t[r+1]];if(null==o)throw new Ct(-301,!1);n.push(t[r],o)}}}(e,n,r)}e.mergedAttrs=tc(e.mergedAttrs,e.attrs)}function Yt(i,t,e,n,r,o){for(let y=0;y<n.length;y++)Kh(Bg(e,t),i,n[y].type);!function $n(i,t,e){i.flags|=1,i.directiveStart=t,i.directiveEnd=t+e,i.providerIndexes=t}(e,i.data.length,n.length);for(let y=0;y<n.length;y++){const M=n[y];M.providersResolver&&M.providersResolver(M)}let a=!1,u=!1,f=c(i,t,n.length,null);for(let y=0;y<n.length;y++){const M=n[y];e.mergedAttrs=tc(e.mergedAttrs,M.hostAttrs),li(i,e,t,f,M),bi(f,M,r),null!==M.contentQueries&&(e.flags|=4),(null!==M.hostBindings||null!==M.hostAttrs||0!==M.hostVars)&&(e.flags|=64);const A=M.type.prototype;!a&&(A.ngOnChanges||A.ngOnInit||A.ngDoCheck)&&((i.preOrderHooks??=[]).push(e.index),a=!0),!u&&(A.ngOnChanges||A.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(e.index),u=!0),f++}!function _e(i,t,e){const r=t.directiveEnd,o=i.data,a=t.attrs,u=[];let f=null,y=null;for(let M=t.directiveStart;M<r;M++){const A=o[M],I=e?e.get(A):null,O=I?I.outputs:null;f=ge(A.inputs,M,f,I?I.inputs:null),y=ge(A.outputs,M,y,O);const H=null===f||null===a||wf(t)?null:Go(f,M,a);u.push(H)}null!==f&&(f.hasOwnProperty("class")&&(t.flags|=8),f.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=u,t.inputs=f,t.outputs=y}(i,e,o)}function Gt(i,t,e){const n=e.directiveStart,r=e.directiveEnd,o=e.index,a=function sy(){return Di.lFrame.currentDirectiveIndex}();try{qh(o);for(let u=n;u<r;u++){const f=i.data[u],y=t[u];ay(u),(null!==f.hostBindings||0!==f.hostVars||null!==f.hostAttrs)&&ai(f,y)}}finally{qh(-1),ay(a)}}function ai(i,t){null!==i.hostBindings&&i.hostBindings(1,t)}function _i(i,t,e){t.componentOffset=e,(i.components??=[]).push(t.index)}function bi(i,t,e){if(e){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)e[t.exportAs[n]]=i;ic(t)&&(e[""]=i)}}function li(i,t,e,n,r){i.data[n]=r;const o=r.factory||(r.factory=Sa(r.type)),a=new Im(o,ic(r),oe);i.blueprint[n]=a,e[n]=a,function ct(i,t,e,n,r){const o=r.hostBindings;if(o){let a=i.hostBindingOpCodes;null===a&&(a=i.hostBindingOpCodes=[]);const u=~t.index;(function Pt(i){let t=i.length;for(;t>0;){const e=i[--t];if("number"==typeof e&&e<0)return e}return 0})(a)!=u&&a.push(u),a.push(e,n,o)}}(i,t,n,c(i,e,r.hostVars,fr),r)}function fn(i,t,e,n,r,o){const a=et(i,t);!function Rr(i,t,e,n,r,o,a){if(null==o)i.removeAttribute(t,r,e);else{const u=null==a?Dn(o):a(o,n||"",r);i.setAttribute(t,r,u,e)}}(t[In],a,o,i.value,e,n,r)}function qn(i,t,e,n,r,o){const a=o[t];if(null!==a)for(let u=0;u<a.length;)cn(n,e,a[u++],a[u++],a[u++])}function cn(i,t,e,n,r){const o=Fs(null);try{const a=i.inputTransforms;null!==a&&a.hasOwnProperty(n)&&(r=a[n].call(t,r)),null!==i.setInput?i.setInput(t,r,e,n):t[n]=r}finally{Fs(o)}}function Go(i,t,e){let n=null,r=0;for(;r<e.length;){const o=e[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(i.hasOwnProperty(o)){null===n&&(n=[]);const a=i[o];for(let u=0;u<a.length;u+=2)if(a[u]===t){n.push(o,a[u+1],e[r+1]);break}}r+=2}else r+=2;else r+=4}return n}function Xn(i,t,e,n){return[i,!0,!1,t,null,0,n,e,null,null,null]}function Zn(i,t){const e=i.contentQueries;if(null!==e)for(let n=0;n<e.length;n+=2){const o=e[n+1];if(-1!==o){const a=i.data[o];Td(e[n]),a.contentQueries(2,t[o],o)}}}function co(i,t){return i[Jd]?i[Cf][Ca]=t:i[Jd]=t,i[Cf]=t,t}function Io(i,t,e){Td(0);const n=Fs(null);try{t(i,e)}finally{Fs(n)}}function ko(i){return i[Ac]||(i[Ac]=[])}function os(i){return i.cleanup||(i.cleanup=[])}function _s(i,t,e){return(null===i||ic(i))&&(e=function Je(i){for(;Array.isArray(i);){if("object"==typeof i[Zu])return i;i=i[ls]}return null}(e[t.index])),e[In]}function Vs(i,t){const e=i[al],n=e?e.get(fe,null):null;n&&n.handleError(t)}function Mo(i,t,e,n,r){for(let o=0;o<e.length;){const a=e[o++],u=e[o++];cn(i.data[a],t[a],n,u,r)}}function Ys(i,t){const e=Nt(t,i),n=e[Si];!function ys(i,t){for(let e=t.length;e<i.blueprint.length;e++)t.push(i.blueprint[e])}(n,e);const r=e[ls];null!==r&&null===e[bo]&&(e[bo]=qb(r,e[al])),Ur(n,e,e[Vo])}function Ur(i,t,e){Pc(t);try{const n=i.viewQuery;null!==n&&Io(1,n,e);const r=i.template;null!==r&&h(i,t,r,1,e),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&Zn(i,t),i.staticViewQueries&&Io(2,i.viewQuery,e);const o=i.components;null!==o&&function Ks(i,t){for(let e=0;e<t.length;e++)Ys(i,t[e])}(t,o)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{t[Sn]&=-5,Fg()}}let Xa=(()=>{class i{constructor(){this.all=new Set,this.queue=new Map}create(e,n,r){const o=typeof Zone>"u"?null:Zone.current,a=new he(e,y=>{this.all.has(y)&&this.queue.set(y,o)},r);let u;this.all.add(a),a.notify();const f=()=>{a.cleanup(),u?.(),this.all.delete(a),this.queue.delete(a)};return u=n?.onDestroy(f),{destroy:f}}flush(){if(0!==this.queue.size)for(const[e,n]of this.queue)this.queue.delete(e),n?n.run(()=>e.run()):e.run()}get isQueueEmpty(){return 0===this.queue.size}}return i.\u0275prov=Qt({token:i,providedIn:"root",factory:()=>new i}),i})();function bl(i,t,e){let n=e?i.styles:null,r=e?i.classes:null,o=0;if(null!==t)for(let a=0;a<t.length;a++){const u=t[a];"number"==typeof u?o=u:1==o?r=So(r,u):2==o&&(n=So(n,u+": "+t[++a]+";"))}e?i.styles=n:i.stylesWithoutHost=n,e?i.classes=r:i.classesWithoutHost=r}function Hs(i,t,e,n,r=!1){for(;null!==e;){const o=t[e.index];if(null!==o&&n.push(St(o)),ca(o)){for(let u=ms;u<o.length;u++){const f=o[u],y=f[Si].firstChild;null!==y&&Hs(f[Si],f,y,n)}o[Ll]!==o[ls]&&n.push(o[Ll])}const a=e.type;if(8&a)Hs(i,t,e.child,n);else if(32&a){const u=Um(e,t);let f;for(;f=u();)n.push(f)}else if(16&a){const u=Cb(t,e);if(Array.isArray(u))n.push(...u);else{const f=Uf(t[ii]);Hs(f[Si],f,u,n,!0)}}e=r?e.projectionNext:e.next}return n}function Od(i,t,e,n=!0){const r=t[ll].rendererFactory;r.begin&&r.begin();try{Yy(i,t,i.template,e)}catch(a){throw n&&Vs(t,a),a}finally{r.end&&r.end(),t[ll].effectManager?.flush()}}function Yy(i,t,e,n){const r=t[Sn];if(256!=(256&r)){t[ll].effectManager?.flush(),Pc(t);try{Ai(t),function oy(i){return Di.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==e&&h(i,t,e,2,n);const a=3==(3&r);if(a){const y=i.preOrderCheckHooks;null!==y&&Ds(t,y,null)}else{const y=i.preOrderHooks;null!==y&&Dm(t,y,0,null),Xh(t,0)}if(function cS(i){for(let t=Ax(i);null!==t;t=Dx(t)){if(!t[Op])continue;const e=t[Ba];for(let n=0;n<e.length;n++){nn(e[n])}}}(t),UM(t,2),null!==i.contentQueries&&Zn(i,t),a){const y=i.contentCheckHooks;null!==y&&Ds(t,y)}else{const y=i.contentHooks;null!==y&&Dm(t,y,1),Xh(t,1)}!function zM(i,t){const e=i.hostBindingOpCodes;if(null===e)return;const n=gh(t,Vh);try{for(let r=0;r<e.length;r++){const o=e[r];if(o<0)qh(~o);else{const a=o,u=e[++r],f=e[++r];Lg(u,a),n.runInContext(f,2,t[a])}}}finally{null===t[Vh]&&ig(t,Vh),qh(-1)}}(i,t);const u=i.components;null!==u&&cw(t,u,0);const f=i.viewQuery;if(null!==f&&Io(2,f,n),a){const y=i.viewCheckHooks;null!==y&&Ds(t,y)}else{const y=i.viewHooks;null!==y&&Dm(t,y,2),Xh(t,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),t[Sn]&=-73,sr(t)}finally{Fg()}}}function UM(i,t){for(let e=Ax(i);null!==e;e=Dx(e))for(let n=ms;n<e.length;n++)VM(e[n],t)}function dS(i,t,e){VM(Nt(t,i),e)}function VM(i,t){if(!function Zt(i){return 128==(128&i[Sn])}(i))return;const e=i[Si];if(80&i[Sn]&&0===t||1024&i[Sn]||2===t)Yy(e,i,e.template,i[Vo]);else if(i[Rl]>0){UM(i,1);const r=i[Si].components;null!==r&&cw(i,r,1)}}function cw(i,t,e){for(let n=0;n<t.length;n++)dS(i,t[n],e)}class m_{get rootNodes(){const t=this._lView,e=t[Si];return Hs(e,t,e.firstChild,[])}constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Vo]}set context(t){this._lView[Vo]=t}get destroyed(){return 256==(256&this._lView[Sn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[Yo];if(ca(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(Ay(t,n),Nf(e,n))}this._attachedToViewContainer=!1}Px(this._lView[Si],this._lView)}onDestroy(t){!function Bi(i,t){if(256==(256&i[Sn]))throw new Ct(911,!1);null===i[Dc]&&(i[Dc]=[]),i[Dc].push(t)}(this._lView,t)}markForCheck(){E(this._cdRefInjectingView||this._lView)}detach(){this._lView[Sn]&=-129}reattach(){this._lView[Sn]|=128}detectChanges(){Od(this._lView[Si],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ct(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Rx(i,t){Pn(i,t,t[In],2,null,null)}(this._lView[Si],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ct(902,!1);this._appRef=t}}class nf extends m_{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Od(t[Si],t,t[Vo],!1)}checkNoChanges(){}get context(){return null}}class HM extends tg{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=vr(t);return new _h(e,this.ngModule)}}function ng(i){const t=[];for(let e in i)i.hasOwnProperty(e)&&t.push({propName:i[e],templateName:e});return t}class jM{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,n){n=Lh(n);const r=this.injector.get(t,_,n);return r!==_||e===_?r:this.parentInjector.get(t,e,n)}}class _h extends qy{get inputs(){const t=this.componentDef,e=t.inputTransforms,n=ng(t.inputs);if(null!==e)for(const r of n)e.hasOwnProperty(r.propName)&&(r.transform=e[r.propName]);return n}get outputs(){return ng(this.componentDef.outputs)}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function wt(i){return i.map(kt).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}create(t,e,n,r){let o=(r=r||this.ngModule)instanceof fh?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const a=o?new jM(t,o):t,u=a.get(f_,null);if(null===u)throw new Ct(407,!1);const M={rendererFactory:u,sanitizer:a.get(PM,null),effectManager:a.get(Xa,null)},A=u.createRenderer(null,this.componentDef),I=this.componentDef.selectors[0][0]||"div",R=n?function N(i,t,e,n){const o=n.get(Qe,!1)||e===sa.ShadowDom,a=i.selectRootElement(t,o);return function V(i){G(i)}(a),a}(A,n,this.componentDef.encapsulation,a):qp(A,I,function GM(i){const t=i.toLowerCase();return"svg"===t?$e:"math"===t?"math":null}(I)),U=this.componentDef.signals?4608:this.componentDef.onPush?576:528,B=D(0,null,null,1,0,null,null,null,null,null,null),Z=Yb(null,B,null,U,null,null,M,A,a,null,null);let X,ee;Pc(Z);try{const se=this.componentDef;let ve,Ce=null;se.findHostDirectiveDefs?(ve=[],Ce=new Map,se.findHostDirectiveDefs(se,ve,Ce),ve.push(se)):ve=[se];const Ve=function Nd(i,t){const e=i[Si],n=Er;return i[n]=t,l(e,n,2,"#host",null)}(Z,R),ce=function Bd(i,t,e,n,r,o,a){const u=r[Si];!function Qb(i,t,e,n){for(const r of i)t.mergedAttrs=tc(t.mergedAttrs,r.hostAttrs);null!==t.mergedAttrs&&(bl(t,t.mergedAttrs,!0),null!==e&&Nx(n,e,t))}(n,i,t,a);let f=null;null!==t&&(f=qb(t,r[al]));const y=o.rendererFactory.createRenderer(t,e);let M=16;e.signals?M=4096:e.onPush&&(M=64);const A=Yb(r,S(e),null,M,r[i.index],i,o,y,null,null,f);return u.firstCreatePass&&_i(u,i,n.length-1),co(r,A),r[i.index]=A}(Ve,R,se,ve,Z,M,A);ee=tt(B,Er),R&&function uS(i,t,e,n){if(n)Rp(i,e,["ng-version",Pd.full]);else{const{attrs:r,classes:o}=function Gi(i){const t=[],e=[];let n=1,r=2;for(;n<i.length;){let o=i[n];if("string"==typeof o)2===r?""!==o&&t.push(o,i[++n]):8===r&&e.push(o);else{if(!Il(r))break;r=o}n++}return{attrs:t,classes:e}}(t.selectors[0]);r&&Rp(i,e,r),o&&o.length>0&&Ox(i,e,o.join(" "))}}(A,se,R,n),void 0!==e&&function g_(i,t,e){const n=i.projection=[];for(let r=0;r<t.length;r++){const o=e[r];n.push(null!=o?Array.from(o):null)}}(ee,this.ngContentSelectors,e),X=function $M(i,t,e,n,r,o){const a=Ho(),u=r[Si],f=et(a,r);Yt(u,r,a,e,null,n);for(let M=0;M<e.length;M++)Ta(au(r,u,a.directiveStart+M,a),r);Gt(u,r,a),f&&Ta(f,r);const y=au(r,u,a.directiveStart+a.componentOffset,a);if(i[Vo]=r[Vo]=y,null!==o)for(const M of o)M(y,t);return m(u,a,i),y}(ce,se,ve,Ce,Z,[NG]),Ur(B,Z,null)}finally{Fg()}return new WM(this.componentType,X,ef(ee,Z),Z,ee)}}class WM extends IM{constructor(t,e,n,r,o){super(),this.location=n,this._rootLView=r,this._tNode=o,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new nf(r),this.componentType=t}setInput(t,e){const n=this._tNode.inputs;let r;if(null!==n&&(r=n[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;const o=this._rootLView;Mo(o[Si],o,r,t,e),this.previousInputValues.set(t,e),E(Nt(this._tNode.index,o))}}get injector(){return new oh(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function NG(){const i=Ho();Va(Ut()[Si],i)}function Zi(i){let t=function RL(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),e=!0;const n=[i];for(;t;){let r;if(ic(i))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Ct(903,!1);r=t.\u0275dir}if(r){if(e){n.push(r);const a=i;a.inputs=hS(i.inputs),a.inputTransforms=hS(i.inputTransforms),a.declaredInputs=hS(i.declaredInputs),a.outputs=hS(i.outputs);const u=r.hostBindings;u&&VG(i,u);const f=r.viewQuery,y=r.contentQueries;if(f&&zG(i,f),y&&UG(i,y),Mc(i.inputs,r.inputs),Mc(i.declaredInputs,r.declaredInputs),Mc(i.outputs,r.outputs),null!==r.inputTransforms&&(null===a.inputTransforms&&(a.inputTransforms={}),Mc(a.inputTransforms,r.inputTransforms)),ic(r)&&r.data.animation){const M=i.data;M.animation=(M.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let a=0;a<o.length;a++){const u=o[a];u&&u.ngInherit&&u(i),u===Zi&&(e=!1)}}t=Object.getPrototypeOf(t)}!function BG(i){let t=0,e=null;for(let n=i.length-1;n>=0;n--){const r=i[n];r.hostVars=t+=r.hostVars,r.hostAttrs=tc(r.hostAttrs,e=tc(e,r.hostAttrs))}}(n)}function hS(i){return i===Ea?{}:i===Wr?[]:i}function zG(i,t){const e=i.viewQuery;i.viewQuery=e?(n,r)=>{t(n,r),e(n,r)}:t}function UG(i,t){const e=i.contentQueries;i.contentQueries=e?(n,r,o)=>{t(n,r,o),e(n,r,o)}:t}function VG(i,t){const e=i.hostBindings;i.hostBindings=e?(n,r)=>{t(n,r),e(n,r)}:t}function pS(i){return!!WD(i)&&(Array.isArray(i)||!(i instanceof Map)&&Symbol.iterator in i)}function WD(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function zd(i,t,e){return!Object.is(i[t],e)&&(i[t]=e,!0)}function Mn(i,t,e,n){const r=Ut();return zd(r,zp(),t)&&(xr(),fn(cs(),r,i,t,e,n)),Mn}function uw(i,t,e,n){return zd(i,zp(),e)?t+Dn(e)+n:fr}function Oi(i,t,e,n,r,o,a,u){const f=Ut(),y=xr(),M=i+Er,A=y.firstCreatePass?function h8(i,t,e,n,r,o,a,u,f){const y=t.consts,M=l(t,i,4,a||null,Qi(y,u));Et(t,e,M,Qi(y,f)),Va(t,M);const A=M.tView=D(2,M,n,r,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,y,null);return null!==t.queries&&(t.queries.template(t,M),A.queries=t.queries.embeddedTView(M)),M}(M,y,f,t,e,n,r,o,a):y.data[M];Fl(A,!1);const I=ZL(y,f,A,i);kf()&&Py(y,f,I,A),Ta(I,f),co(f,f[M]=Xn(I,f,I,A)),Tf(A)&&b(y,f,A),null!=a&&w(f,A,u)}let ZL=function YL(i,t,e,n){return Ns(!0),t[In].createComment("")};function yu(i){return Mt(function ry(){return Di.lFrame.contextLView}(),Er+i)}function Vt(i,t,e){const n=Ut();return zd(n,zp(),t)&&Ie(xr(),cs(),n,i,t,n[In],e,!1),Vt}function KD(i,t,e,n,r){const a=r?"class":"style";Mo(i,e,t.inputs[a],a,n)}function rt(i,t,e,n){const r=Ut(),o=xr(),a=Er+i,u=r[In],f=o.firstCreatePass?function g8(i,t,e,n,r,o){const a=t.consts,f=l(t,i,2,n,Qi(a,r));return Et(t,e,f,Qi(a,o)),null!==f.attrs&&bl(f,f.attrs,!1),null!==f.mergedAttrs&&bl(f,f.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,f),f}(a,o,r,t,e,n):o.data[a],y=KL(o,r,f,u,t,i);r[a]=y;const M=Tf(f);return Fl(f,!0),Nx(u,y,f),32!=(32&f.flags)&&kf()&&Py(o,r,y,f),0===function za(){return Di.lFrame.elementDepthCount}()&&Ta(y,r),function ua(){Di.lFrame.elementDepthCount++}(),M&&(b(o,r,f),m(o,f,r)),null!==n&&w(r,f),rt}function mt(){let i=Ho();ru()?Df():(i=i.parent,Fl(i,!1));const t=i;(function ro(i){return Di.skipHydrationRootTNode===i})(t)&&function xo(){Di.skipHydrationRootTNode=null}(),function rc(){Di.lFrame.elementDepthCount--}();const e=xr();return e.firstCreatePass&&(Va(e,i),Gh(i)&&e.queries.elementEnd(i)),null!=t.classesWithoutHost&&function km(i){return 0!=(8&i.flags)}(t)&&KD(e,t,Ut(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Rf(i){return 0!=(16&i.flags)}(t)&&KD(e,t,Ut(),t.stylesWithoutHost,!1),mt}function En(i,t,e,n){return rt(i,t,e,n),mt(),En}let KL=(i,t,e,n,r,o)=>(Ns(!0),qp(n,r,function Xi(){return Di.lFrame.currentNamespace}()));function yh(){return Ut()}function KM(i){return!!i&&"function"==typeof i.then}function eF(i){return!!i&&"function"==typeof i.subscribe}function ji(i,t,e,n){const r=Ut(),o=xr(),a=Ho();return tF(o,r,r[In],a,i,t,n),ji}function yS(i,t){const e=Ho(),n=Ut(),r=xr();return tF(r,n,_s(ly(r.data),e,n),e,i,t),yS}function tF(i,t,e,n,r,o,a){const u=Tf(n),y=i.firstCreatePass&&os(i),M=t[Vo],A=ko(t);let I=!0;if(3&n.type||a){const H=et(n,t),U=a?a(H):H,B=A.length,Z=a?ee=>a(St(ee[n.index])):n.index;let X=null;if(!a&&u&&(X=function w8(i,t,e,n){const r=i.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const a=r[o];if(a===e&&r[o+1]===n){const u=t[Ac],f=r[o+2];return u.length>f?u[f]:null}"string"==typeof a&&(o+=2)}return null}(i,t,r,n.index)),null!==X)(X.__ngLastListenerFn__||X).__ngNextListenerFn__=o,X.__ngLastListenerFn__=o,I=!1;else{o=nF(n,t,M,o,!1);const ee=e.listen(U,r,o);A.push(o,ee),y&&y.push(r,Z,B,B+1)}}else o=nF(n,t,M,o,!1);const R=n.outputs;let O;if(I&&null!==R&&(O=R[r])){const H=O.length;if(H)for(let U=0;U<H;U+=2){const se=t[O[U]][O[U+1]].subscribe(o),ve=A.length;A.push(o,se),y&&y.push(r,n.index,ve,-(ve+1))}}}function iF(i,t,e,n){try{return We(6,t,e),!1!==e(n)}catch(r){return Vs(i,r),!1}finally{We(7,t,e)}}function nF(i,t,e,n,r){return function o(a){if(a===Function)return n;E(i.componentOffset>-1?Nt(i.index,t):t);let f=iF(t,e,n,a),y=o.__ngNextListenerFn__;for(;y;)f=iF(t,e,y,a)&&f,y=y.__ngNextListenerFn__;return r&&!1===f&&a.preventDefault(),f}}function ln(i=1){return function Vp(i){return(Di.lFrame.contextLView=function W1(i,t){for(;i>0;)t=t[Qd],i--;return t}(i,Di.lFrame.contextLView))[Vo]}(i)}function M8(i,t){let e=null;const n=function ey(i){const t=i.attrs;if(null!=t){const e=t.indexOf(5);if(!(1&e))return t[e+1]}return null}(i);for(let r=0;r<t.length;r++){const o=t[r];if("*"!==o){if(null===n?Em(i,o,!0):zh(n,o))return r}else e=r}return e}function Lo(i){const t=Ut()[ii][aa];if(!t.projection){const n=t.projection=jp(i?i.length:1,null),r=n.slice();let o=t.child;for(;null!==o;){const a=i?M8(o,i):0;null!==a&&(r[a]?r[a].projectionNext=o:n[a]=o,r[a]=o),o=o.next}}}function Hi(i,t=0,e){const n=Ut(),r=xr(),o=l(r,Er+i,16,null,e||null);null===o.projection&&(o.projection=t),Df(),(!n[bo]||ao())&&32!=(32&o.flags)&&function o_(i,t,e){Vl(t[In],0,t,e,Gm(i,e,t),xb(e.parent||t[aa],e,t))}(r,n,o)}function vS(i,t){return i<<17|t<<2}function Ky(i){return i>>17&32767}function QD(i){return 2|i}function t0(i){return(131068&i)>>2}function eI(i,t){return-131069&i|t<<2}function tI(i){return 1|i}function pF(i,t,e,n,r){const o=i[e+1],a=null===t;let u=n?Ky(o):t0(o),f=!1;for(;0!==u&&(!1===f||a);){const M=i[u+1];D8(i[u],t)&&(f=!0,i[u+1]=n?tI(M):QD(M)),u=n?Ky(M):t0(M)}f&&(i[e+1]=n?QD(o):tI(o))}function D8(i,t){return null===i||null==t||(Array.isArray(i)?i[1]:i)===t||!(!Array.isArray(i)||"string"!=typeof t)&&kr(i,t)>=0}const hc={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function fF(i){return i.substring(hc.key,hc.keyEnd)}function mF(i,t){const e=hc.textEnd;return e===t?-1:(t=hc.keyEnd=function P8(i,t,e){for(;t<e&&i.charCodeAt(t)>32;)t++;return t}(i,hc.key=t,e),xw(i,t,e))}function xw(i,t,e){for(;t<e&&i.charCodeAt(t)<=32;)t++;return t}function Jf(i,t,e){return Qf(i,t,e,!1),Jf}function Un(i,t){return Qf(i,t,null,!0),Un}function sg(i,t){for(let e=function k8(i){return function _F(i){hc.key=0,hc.keyEnd=0,hc.value=0,hc.valueEnd=0,hc.textEnd=i.length}(i),mF(i,xw(i,0,hc.textEnd))}(t);e>=0;e=mF(t,e))pa(i,fF(t),!0)}function Qf(i,t,e,n){const r=Ut(),o=xr(),a=Sd(2);o.firstUpdatePass&&xF(o,i,a,n),t!==fr&&zd(r,a,t)&&MF(o,o.data[Os()],r,r[In],i,r[a+1]=function W8(i,t){return null==i||""===i||("string"==typeof t?i+=t:"object"==typeof i&&(i=yo(Wa(i)))),i}(t,e),n,a)}function bF(i,t){return t>=i.expandoStartIndex}function xF(i,t,e,n){const r=i.data;if(null===r[e+1]){const o=r[Os()],a=bF(i,e);CF(o,n)&&null===t&&!a&&(t=!1),t=function B8(i,t,e,n){const r=ly(i);let o=n?t.residualClasses:t.residualStyles;if(null===r)0===(n?t.classBindings:t.styleBindings)&&(e=JM(e=iI(null,i,t,e,n),t.attrs,n),o=null);else{const a=t.directiveStylingLast;if(-1===a||i[a]!==r)if(e=iI(r,i,t,e,n),null===o){let f=function z8(i,t,e){const n=e?t.classBindings:t.styleBindings;if(0!==t0(n))return i[Ky(n)]}(i,t,n);void 0!==f&&Array.isArray(f)&&(f=iI(null,i,t,f[1],n),f=JM(f,t.attrs,n),function U8(i,t,e,n){i[Ky(e?t.classBindings:t.styleBindings)]=n}(i,t,n,f))}else o=function V8(i,t,e){let n;const r=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<r;o++)n=JM(n,i[o].hostAttrs,e);return JM(n,t.attrs,e)}(i,t,n)}return void 0!==o&&(n?t.residualClasses=o:t.residualStyles=o),e}(r,o,t,n),function T8(i,t,e,n,r,o){let a=o?t.classBindings:t.styleBindings,u=Ky(a),f=t0(a);i[n]=e;let M,y=!1;if(Array.isArray(e)?(M=e[1],(null===M||kr(e,M)>0)&&(y=!0)):M=e,r)if(0!==f){const I=Ky(i[u+1]);i[n+1]=vS(I,u),0!==I&&(i[I+1]=eI(i[I+1],n)),i[u+1]=function C8(i,t){return 131071&i|t<<17}(i[u+1],n)}else i[n+1]=vS(u,0),0!==u&&(i[u+1]=eI(i[u+1],n)),u=n;else i[n+1]=vS(f,0),0===u?u=n:i[f+1]=eI(i[f+1],n),f=n;y&&(i[n+1]=QD(i[n+1])),pF(i,M,n,!0),pF(i,M,n,!1),function A8(i,t,e,n,r){const o=r?i.residualClasses:i.residualStyles;null!=o&&"string"==typeof t&&kr(o,t)>=0&&(e[n+1]=tI(e[n+1]))}(t,M,i,n,o),a=vS(u,f),o?t.classBindings=a:t.styleBindings=a}(r,o,t,e,a,n)}}function iI(i,t,e,n,r){let o=null;const a=e.directiveEnd;let u=e.directiveStylingLast;for(-1===u?u=e.directiveStart:u++;u<a&&(o=t[u],n=JM(n,o.hostAttrs,r),o!==i);)u++;return null!==i&&(e.directiveStylingLast=u),n}function JM(i,t,e){const n=e?1:2;let r=-1;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?r=a:r===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),pa(i,a,!!e||t[++o]))}return void 0===i?null:i}function MF(i,t,e,n,r,o,a,u){if(!(3&t.type))return;const f=i.data,y=f[u+1],M=function S8(i){return 1==(1&i)}(y)?EF(f,t,e,r,t0(y),a):void 0;bS(M)||(bS(o)||function E8(i){return 2==(2&i)}(y)&&(o=EF(f,null,e,r,u,a)),function hM(i,t,e,n,r){if(t)r?i.addClass(e,n):i.removeClass(e,n);else{let o=-1===n.indexOf("-")?void 0:ja.DashCase;null==r?i.removeStyle(e,n,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=ja.Important),i.setStyle(e,n,r,o))}}(n,a,vt(Os(),e),r,o))}function EF(i,t,e,n,r,o){const a=null===t;let u;for(;r>0;){const f=i[r],y=Array.isArray(f),M=y?f[1]:f,A=null===M;let I=e[r+1];I===fr&&(I=A?Wr:void 0);let R=A?ah(I,n):M===n?I:void 0;if(y&&!bS(R)&&(R=ah(f,n)),bS(R)&&(u=R,a))return u;const O=i[r+1];r=a?Ky(O):t0(O)}if(null!==t){let f=o?t.residualClasses:t.residualStyles;null!=f&&(u=ah(f,n))}return u}function bS(i){return void 0!==i}function CF(i,t){return 0!=(i.flags&(t?8:16))}function sn(i,t=""){const e=Ut(),n=xr(),r=i+Er,o=n.firstCreatePass?l(n,r,1,t,null):n.data[r],a=SF(n,e,o,t,i);e[r]=a,kf()&&Py(n,e,a,o),Fl(o,!1)}let SF=(i,t,e,n,r)=>(Ns(!0),function Ty(i,t){return i.createText(t)}(t[In],n));function Pr(i){return __("",i,""),Pr}function __(i,t,e){const n=Ut(),r=uw(n,i,t,e);return r!==fr&&function Wo(i,t,e){const n=vt(t,i);!function e_(i,t,e){i.setValue(t,e)}(i[In],n,e)}(n,Os(),r),__}function FF(i,t,e){!function em(i,t,e,n){const r=xr(),o=Sd(2);r.firstUpdatePass&&xF(r,null,o,n);const a=Ut();if(e!==fr&&zd(a,o,e)){const u=r.data[Os()];if(CF(u,n)&&!bF(r,o)){let f=n?u.classesWithoutHost:u.stylesWithoutHost;null!==f&&(e=So(f,e||"")),KD(r,u,a,e,n)}else!function j8(i,t,e,n,r,o,a,u){r===fr&&(r=Wr);let f=0,y=0,M=0<r.length?r[0]:null,A=0<o.length?o[0]:null;for(;null!==M||null!==A;){const I=f<r.length?r[f+1]:void 0,R=y<o.length?o[y+1]:void 0;let H,O=null;M===A?(f+=2,y+=2,I!==R&&(O=A,H=R)):null===A||null!==M&&M<A?(f+=2,O=M):(y+=2,O=A,H=R),null!==O&&MF(i,t,e,n,O,H,a,u),M=f<r.length?r[f]:null,A=y<o.length?o[y]:null}}(r,u,a,a[In],a[o+1],a[o+1]=function H8(i,t,e){if(null==e||""===e)return Wr;const n=[],r=Wa(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)i(n,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&i(n,o,r[o]);else"string"==typeof r&&t(n,r);return n}(i,t,e),n,o)}}(pa,sg,uw(Ut(),i,t,e),!0)}function vh(i,t,e){const n=Ut();return zd(n,zp(),t)&&Ie(xr(),cs(),n,i,t,n[In],e,!0),vh}function xS(i,t,e){const n=Ut();if(zd(n,zp(),t)){const o=xr(),a=cs();Ie(o,a,n,i,t,_s(ly(o.data),a,n),e,!0)}return xS}const n0=void 0;var hj=["en",[["a","p"],["AM","PM"],n0],[["AM","PM"],n0,n0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],n0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],n0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",n0,"{1} 'at' {0}",n0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function uj(i){const e=Math.floor(Math.abs(i)),n=i.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let ww={};function vu(i){const t=function pj(i){return i.toLowerCase().replace(/_/g,"-")}(i);let e=$F(t);if(e)return e;const n=t.split("-")[0];if(e=$F(n),e)return e;if("en"===n)return hj;throw new Ct(701,!1)}function $F(i){return i in ww||(ww[i]=Nr.ng&&Nr.ng.common&&Nr.ng.common.locales&&Nr.ng.common.locales[i]),ww[i]}var qi=(()=>((qi=qi||{})[qi.LocaleId=0]="LocaleId",qi[qi.DayPeriodsFormat=1]="DayPeriodsFormat",qi[qi.DayPeriodsStandalone=2]="DayPeriodsStandalone",qi[qi.DaysFormat=3]="DaysFormat",qi[qi.DaysStandalone=4]="DaysStandalone",qi[qi.MonthsFormat=5]="MonthsFormat",qi[qi.MonthsStandalone=6]="MonthsStandalone",qi[qi.Eras=7]="Eras",qi[qi.FirstDayOfWeek=8]="FirstDayOfWeek",qi[qi.WeekendRange=9]="WeekendRange",qi[qi.DateFormat=10]="DateFormat",qi[qi.TimeFormat=11]="TimeFormat",qi[qi.DateTimeFormat=12]="DateTimeFormat",qi[qi.NumberSymbols=13]="NumberSymbols",qi[qi.NumberFormats=14]="NumberFormats",qi[qi.CurrencyCode=15]="CurrencyCode",qi[qi.CurrencySymbol=16]="CurrencySymbol",qi[qi.CurrencyName=17]="CurrencyName",qi[qi.Currencies=18]="Currencies",qi[qi.Directionality=19]="Directionality",qi[qi.PluralCase=20]="PluralCase",qi[qi.ExtraData=21]="ExtraData",qi))();const Mw="en-US";let qF=Mw;function oI(i,t,e,n,r){if(i=_n(i),Array.isArray(i))for(let o=0;o<i.length;o++)oI(i[o],t,e,n,r);else{const o=xr(),a=Ut();let u=dd(i)?i:_n(i.provide),f=qf(i);const y=Ho(),M=1048575&y.providerIndexes,A=y.directiveStart,I=y.providerIndexes>>20;if(dd(i)||!i.multi){const R=new Im(f,r,oe),O=aI(u,t,r?M:M+I,A);-1===O?(Kh(Bg(y,a),o,u),sI(o,i,t.length),t.push(u),y.directiveStart++,y.directiveEnd++,r&&(y.providerIndexes+=1048576),e.push(R),a.push(R)):(e[O]=R,a[O]=R)}else{const R=aI(u,t,M+I,A),O=aI(u,t,M,M+I),U=O>=0&&e[O];if(r&&!U||!r&&!(R>=0&&e[R])){Kh(Bg(y,a),o,u);const B=function dW(i,t,e,n,r){const o=new Im(i,e,oe);return o.multi=[],o.index=t,o.componentProviders=0,yO(o,r,n&&!e),o}(r?cW:lW,e.length,r,n,f);!r&&U&&(e[O].providerFactory=B),sI(o,i,t.length,0),t.push(u),y.directiveStart++,y.directiveEnd++,r&&(y.providerIndexes+=1048576),e.push(B),a.push(B)}else sI(o,i,R>-1?R:O,yO(e[r?O:R],f,!r&&n));!r&&n&&U&&e[O].componentProviders++}}}function sI(i,t,e,n){const r=dd(t),o=function Zm(i){return!!i.useClass}(t);if(r||o){const f=(o?_n(t.useClass):t).prototype.ngOnDestroy;if(f){const y=i.destroyHooks||(i.destroyHooks=[]);if(!r&&t.multi){const M=y.indexOf(e);-1===M?y.push(e,[n,f]):y[M+1].push(n,f)}else y.push(e,f)}}}function yO(i,t,e){return e&&i.componentProviders++,i.multi.push(t)-1}function aI(i,t,e,n){for(let r=e;r<n;r++)if(t[r]===i)return r;return-1}function lW(i,t,e,n){return lI(this.multi,[])}function cW(i,t,e,n){const r=this.multi;let o;if(this.providerFactory){const a=this.providerFactory.componentProviders,u=au(e,e[Si],this.providerFactory.index,n);o=u.slice(0,a),lI(r,o);for(let f=a;f<u.length;f++)o.push(u[f])}else o=[],lI(r,o);return o}function lI(i,t){for(let e=0;e<i.length;e++)t.push((0,i[e])());return t}function Qn(i,t=[]){return e=>{e.providersResolver=(n,r)=>function aW(i,t,e){const n=xr();if(n.firstCreatePass){const r=ic(i);oI(e,n.data,n.blueprint,r,!0),oI(t,n.data,n.blueprint,r,!1)}}(n,r?r(i):i,t)}}class Ew{}class vO{}class cI extends Ew{constructor(t,e,n){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new HM(this);const r=Ws(t);this._bootstrapComponents=Ln(r.bootstrap),this._r3Injector=lw(t,e,[{provide:Ew,useValue:this},{provide:tg,useValue:this.componentFactoryResolver},...n],yo(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class dI extends vO{constructor(t){super(),this.moduleType=t}create(t){return new cI(this.moduleType,t,[])}}class bO extends Ew{constructor(t){super(),this.componentFactoryResolver=new HM(this),this.instance=null;const e=new Vb([...t.providers,{provide:Ew,useValue:this},{provide:tg,useValue:this.componentFactoryResolver}],t.parent||$f(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function uI(i,t,e=null){return new bO({providers:i,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}let pW=(()=>{class i{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const n=Zx(0,e.type),r=n.length>0?uI([n],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,r)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return i.\u0275prov=Qt({token:i,providedIn:"environment",factory:()=>new i(it(fh))}),i})();function tm(i){i.getStandaloneInjector=t=>t.get(pW).getOrCreateStandaloneInjector(i)}function TO(i,t,e,n,r,o){const a=t+e;return zd(i,a,r)?function rg(i,t,e){return i[t]=e}(i,a+1,o?n.call(o,r):n(r)):function rE(i,t){const e=i[t];return e===fr?void 0:e}(i,a+1)}function Ka(i,t){const e=xr();let n;const r=i+Er;e.firstCreatePass?(n=function RW(i,t){if(t)for(let e=t.length-1;e>=0;e--){const n=t[e];if(i===n.name)return n}}(t,e.pipeRegistry),e.data[r]=n,n.onDestroy&&(e.destroyHooks??=[]).push(r,n.onDestroy)):n=e.data[r];const o=n.factory||(n.factory=Sa(n.type)),a=Uo(oe);try{const u=Bs(!1),f=o();return Bs(u),function m8(i,t,e,n){e>=i.data.length&&(i.data[e]=null,i.blueprint[e]=null),t[e]=n}(e,Ut(),r,f),f}finally{Uo(a)}}function Ja(i,t,e){const n=i+Er,r=Ut(),o=Mt(r,n);return function oE(i,t){return i[Si].data[t].pure}(r,n)?TO(r,function dl(){const i=Di.lFrame;let t=i.bindingRootIndex;return-1===t&&(t=i.bindingRootIndex=i.tView.bindingStartIndex),t}(),t,o.transform,e,o):o.transform(e)}function pI(i){return t=>{setTimeout(i,void 0,t)}}const Mi=class NW extends Fi{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r=t,o=e||(()=>null),a=n;if(t&&"object"==typeof t){const f=t;r=f.next?.bind(f),o=f.error?.bind(f),a=f.complete?.bind(f)}this.__isAsync&&(o=pI(o),r&&(r=pI(r)),a&&(a=pI(a)));const u=super.subscribe({next:r,error:o,complete:a});return t instanceof gt&&t.add(u),u}};function BW(){return this._results[Symbol.iterator]()}class Jy{get changes(){return this._changes||(this._changes=new Mi)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Jy.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=BW)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const n=this;n.dirty=!1;const r=function zl(i){return i.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function qg(i,t,e){if(i.length!==t.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],o=t[n];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(n._results,r,e))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let sf=(()=>{class i{}return i.__NG_ELEMENT_ID__=VW,i})();const zW=sf,UW=class extends zW{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,e){return this.createEmbeddedViewImpl(t,e,null)}createEmbeddedViewImpl(t,e,n){const a=this._declarationTContainer.tView,u=Yb(this._declarationLView,a,t,4096&this._declarationLView[Sn]?4096:16,null,a.declTNode,null,null,null,e||null,n||null);u[la]=this._declarationLView[this._declarationTContainer.index];const y=this._declarationLView[Pl];return null!==y&&(u[Pl]=y.createEmbeddedView(a)),Ur(a,u,t),new m_(u)}};function VW(){return SS(Ho(),Ut())}function SS(i,t){return 4&i.type?new UW(t,i,ef(i,t)):null}let bu=(()=>{class i{}return i.__NG_ELEMENT_ID__=XW,i})();function XW(){return NO(Ho(),Ut())}const ZW=bu,FO=class extends ZW{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return ef(this._hostTNode,this._hostLView)}get injector(){return new oh(this._hostTNode,this._hostLView)}get parentInjector(){const t=uy(this._hostTNode,this._hostLView);if(Rm(t)){const e=Nl(t,this._hostLView),n=ih(t);return new oh(e[Si].data[n+8],e)}return new oh(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=OO(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-ms}createEmbeddedView(t,e,n){let r,o;"number"==typeof n?r=n:null!=n&&(r=n.index,o=n.injector);const u=t.createEmbeddedViewImpl(e||{},o,null);return this.insertImpl(u,r,false),u}createComponent(t,e,n,r,o){const a=t&&!function Ff(i){return"function"==typeof i}(t);let u;if(a)u=e;else{const H=e||{};u=H.index,n=H.injector,r=H.projectableNodes,o=H.environmentInjector||H.ngModuleRef}const f=a?t:new _h(vr(t)),y=n||this.parentInjector;if(!o&&null==f.ngModule){const U=(a?y:this.parentInjector).get(fh,null);U&&(o=U)}vr(f.componentType??{});const R=f.create(y,r,null,o);return this.insertImpl(R.hostView,u,false),R}insert(t,e){return this.insertImpl(t,e,!1)}insertImpl(t,e,n){const r=t._lView,o=r[Si];if(function $i(i){return ca(i[Yo])}(r)){const f=this.indexOf(t);if(-1!==f)this.detach(f);else{const y=r[Yo],M=new FO(y,y[aa],y[Yo]);M.detach(M.indexOf(t))}}const a=this._adjustIndex(e),u=this._lContainer;if(function yb(i,t,e,n){const r=ms+n,o=e.length;n>0&&(e[r-1][Ca]=t),n<o-ms?(t[Ca]=e[r],du(e,ms+n,t)):(e.push(t),t[Ca]=null),t[Yo]=e;const a=t[la];null!==a&&e!==a&&function vb(i,t){const e=i[Ba];t[ii]!==t[Yo][Yo][ii]&&(i[Op]=!0),null===e?i[Ba]=[t]:e.push(t)}(a,t);const u=t[Pl];null!==u&&u.insertView(i),t[Sn]|=128}(o,r,u,a),!n){const f=Ul(a,u),y=r[In],M=ky(y,u[Ll]);null!==M&&function kx(i,t,e,n,r,o){n[ls]=r,n[aa]=t,Pn(i,n,e,1,r,o)}(o,u[aa],y,r,M,f)}return t.attachToViewContainerRef(),du(mI(u),a,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=OO(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=Ay(this._lContainer,e);n&&(Nf(mI(this._lContainer),e),Px(n[Si],n))}detach(t){const e=this._adjustIndex(t,-1),n=Ay(this._lContainer,e);return n&&null!=Nf(mI(this._lContainer),e)?new m_(n):null}_adjustIndex(t,e=0){return t??this.length+e}};function OO(i){return i[8]}function mI(i){return i[8]||(i[8]=[])}function NO(i,t){let e;const n=t[i.index];return ca(n)?e=n:(e=Xn(n,t,null,i),t[i.index]=e,co(t,e)),BO(e,t,i,n),new FO(e,i,t)}let BO=function zO(i,t,e,n){if(i[Ll])return;let r;r=8&e.type?St(n):function YW(i,t){const e=i[In],n=e.createComment(""),r=et(t,i);return pu(e,ky(e,r),n,function Fx(i,t){return i.nextSibling(t)}(e,r),!1),n}(t,e),i[Ll]=r};class gI{constructor(t){this.queryList=t,this.matches=null}clone(){return new gI(this.queryList)}setDirty(){this.queryList.setDirty()}}class _I{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let o=0;o<n;o++){const a=e.getByIndex(o);r.push(this.queries[a.indexInDeclarationView].clone())}return new _I(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==jO(t,e).matches&&this.queries[e].setDirty()}}class UO{constructor(t,e,n=null){this.predicate=t,this.flags=e,this.read=n}}class yI{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,o=this.getByIndex(n).embeddedTView(t,r);o&&(o.indexInDeclarationView=n,null!==e?e.push(o):e=[o])}return null!==e?new yI(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class vI{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new vI(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const o=n[r];this.matchTNodeWithReadOption(t,e,QW(e,o)),this.matchTNodeWithReadOption(t,e,wn(e,t,o,!1,!1))}else n===sf?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,wn(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===tn||r===bu||r===sf&&4&e.type)this.addMatch(e.index,-2);else{const o=wn(e,t,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function QW(i,t){const e=i.localNames;if(null!==e)for(let n=0;n<e.length;n+=2)if(e[n]===t)return e[n+1];return null}function t$(i,t,e,n){return-1===e?function e$(i,t){return 11&i.type?ef(i,t):4&i.type?SS(i,t):null}(t,i):-2===e?function i$(i,t,e){return e===tn?ef(t,i):e===sf?SS(t,i):e===bu?NO(t,i):void 0}(i,t,n):au(i,i[Si],e,t)}function VO(i,t,e,n){const r=t[Pl].queries[n];if(null===r.matches){const o=i.data,a=e.matches,u=[];for(let f=0;f<a.length;f+=2){const y=a[f];u.push(y<0?null:t$(t,o[y],a[f+1],e.metadata.read))}r.matches=u}return r.matches}function bI(i,t,e,n){const r=i.queries.getByIndex(e),o=r.matches;if(null!==o){const a=VO(i,t,r,e);for(let u=0;u<o.length;u+=2){const f=o[u];if(f>0)n.push(a[u/2]);else{const y=o[u+1],M=t[-f];for(let A=ms;A<M.length;A++){const I=M[A];I[la]===I[Yo]&&bI(I[Si],I,y,n)}if(null!==M[Ba]){const A=M[Ba];for(let I=0;I<A.length;I++){const R=A[I];bI(R[Si],R,y,n)}}}}}return n}function zi(i){const t=Ut(),e=xr(),n=Rc();Td(n+1);const r=jO(e,n);if(i.dirty&&function Bt(i){return 4==(4&i[Sn])}(t)===(2==(2&r.metadata.flags))){if(null===r.matches)i.reset([]);else{const o=r.crossesNgTemplate?bI(e,t,n,[]):VO(e,t,r,n);i.reset(o,p_),i.notifyOnChanges()}return!0}return!1}function uo(i,t,e){const n=xr();n.firstCreatePass&&(GO(n,new UO(i,t,e),-1),2==(2&t)&&(n.staticViewQueries=!0)),HO(n,Ut(),t)}function Qr(i,t,e,n){const r=xr();if(r.firstCreatePass){const o=Ho();GO(r,new UO(t,e,n),o.index),function r$(i,t){const e=i.contentQueries||(i.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(i.queries.length-1,t)}(r,i),2==(2&e)&&(r.staticContentQueries=!0)}HO(r,Ut(),e)}function Ui(){return function n$(i,t){return i[Pl].queries[t].queryList}(Ut(),Rc())}function HO(i,t,e){const n=new Jy(4==(4&e));(function Q(i,t,e,n){const r=ko(t);r.push(e),i.firstCreatePass&&os(i).push(n,r.length-1)})(i,t,n,n.destroy),null===t[Pl]&&(t[Pl]=new _I),t[Pl].queries.push(new gI(n))}function GO(i,t,e){null===i.queries&&(i.queries=new yI),i.queries.track(new vI(t,e))}function jO(i,t){return i.queries.getByIndex(t)}function Cw(i,t){return SS(i,t)}const SI=new Ot("Application Initializer");let TI=(()=>{class i{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,n)=>{this.resolve=e,this.reject=n}),this.appInits=mi(SI,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const r of this.appInits){const o=r();if(KM(o))e.push(o);else if(eF(o)){const a=new Promise((u,f)=>{o.subscribe({complete:u,error:f})});e.push(a)}}const n=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{n()}).catch(r=>{this.reject(r)}),0===e.length&&n(),this.initialized=!0}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),aN=(()=>{class i{log(e){console.log(e)}warn(e){console.warn(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const ag=new Ot("LocaleId",{providedIn:"root",factory:()=>mi(ag,xi.Optional|xi.SkipSelf)||function C$(){return typeof $localize<"u"&&$localize.locale||Mw}()});let AS=(()=>{class i{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new ws(!1)}add(){this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class T${constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let lN=(()=>{class i{compileModuleSync(e){return new dI(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const n=this.compileModuleSync(e),o=Ln(Ws(e).declarations).reduce((a,u)=>{const f=vr(u);return f&&a.push(new _h(f)),a},[]);return new T$(n,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function uN(...i){}class Ji{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Mi(!1),this.onMicrotaskEmpty=new Mi(!1),this.onStable=new Mi(!1),this.onError=new Mi(!1),typeof Zone>"u")throw new Ct(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&e,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function I$(){let i=Nr.requestAnimationFrame,t=Nr.cancelAnimationFrame;if(typeof Zone<"u"&&i&&t){const e=i[Zone.__symbol__("OriginalDelegate")];e&&(i=e);const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function P$(i){const t=()=>{!function R$(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(Nr,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,DI(i),i.isCheckStableRunning=!0,AI(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),DI(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,n,r,o,a,u)=>{try{return hN(i),e.invokeTask(r,o,a,u)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||i.shouldCoalesceRunChangeDetection)&&t(),pN(i)}},onInvoke:(e,n,r,o,a,u,f)=>{try{return hN(i),e.invoke(r,o,a,u,f)}finally{i.shouldCoalesceRunChangeDetection&&t(),pN(i)}},onHasTask:(e,n,r,o)=>{e.hasTask(r,o),n===r&&("microTask"==o.change?(i._hasPendingMicrotasks=o.microTask,DI(i),AI(i)):"macroTask"==o.change&&(i.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,n,r,o)=>(e.handleError(r,o),i.runOutsideAngular(()=>i.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ji.isInAngularZone())throw new Ct(909,!1)}static assertNotInAngularZone(){if(Ji.isInAngularZone())throw new Ct(909,!1)}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const o=this._inner,a=o.scheduleEventTask("NgZoneEvent: "+r,t,k$,uN,uN);try{return o.runTask(a,e,n)}finally{o.cancelTask(a)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const k$={};function AI(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function DI(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function hN(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function pN(i){i._nesting--,AI(i)}class L${constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Mi,this.onMicrotaskEmpty=new Mi,this.onStable=new Mi,this.onError=new Mi}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}const fN=new Ot("",{providedIn:"root",factory:mN});function mN(){const i=mi(Ji);let t=!0;return oi(new Cn(r=>{t=i.isStable&&!i.hasPendingMacrotasks&&!i.hasPendingMicrotasks,i.runOutsideAngular(()=>{r.next(t),r.complete()})}),new Cn(r=>{let o;i.runOutsideAngular(()=>{o=i.onStable.subscribe(()=>{Ji.assertNotInAngularZone(),queueMicrotask(()=>{!t&&!i.hasPendingMacrotasks&&!i.hasPendingMicrotasks&&(t=!0,r.next(!0))})})});const a=i.onUnstable.subscribe(()=>{Ji.assertInAngularZone(),t&&(t=!1,i.runOutsideAngular(()=>{r.next(!1)}))});return()=>{o.unsubscribe(),a.unsubscribe()}}).pipe(Wn()))}const gN=new Ot(""),DS=new Ot("");let RI,II=(()=>{class i{constructor(e,n,r){this._ngZone=e,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,RI||(function F$(i){RI=i}(r),r.addToWindow(n)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ji.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(e)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,n,r){let o=-1;n&&n>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),e(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,n,r){return[]}}return i.\u0275fac=function(e){return new(e||i)(it(Ji),it(kI),it(DS))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})(),kI=(()=>{class i{constructor(){this._applications=new Map}registerApplication(e,n){this._applications.set(e,n)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,n=!0){return RI?.findTestabilityInTree(this,e,n)??null}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})(),Qy=null;const _N=new Ot("AllowMultipleToken"),PI=new Ot("PlatformDestroyListeners"),LI=new Ot("appBootstrapListener");class vN{constructor(t,e){this.name=t,this.token=e}}function xN(i,t,e=[]){const n=`Platform: ${t}`,r=new Ot(n);return(o=[])=>{let a=FI();if(!a||a.injector.get(_N,!1)){const u=[...e,...o,{provide:r,useValue:!0}];i?i(u):function B$(i){if(Qy&&!Qy.get(_N,!1))throw new Ct(400,!1);(function yN(){!function P(i){C=i}(()=>{throw new Ct(600,!1)})})(),Qy=i;const t=i.get(MN);(function bN(i){i.get(Jm,null)?.forEach(e=>e())})(i)}(function wN(i=[],t){return vl.create({name:t,providers:[{provide:Hy,useValue:"platform"},{provide:PI,useValue:new Set([()=>Qy=null])},...i]})}(u,n))}return function U$(i){const t=FI();if(!t)throw new Ct(401,!1);return t}()}}function FI(){return Qy?.get(MN)??null}let MN=(()=>{class i{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,n){const r=function V$(i="zone.js",t){return"noop"===i?new L$:"zone.js"===i?new Ji(t):i}(n?.ngZone,function EN(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}({eventCoalescing:n?.ngZoneEventCoalescing,runCoalescing:n?.ngZoneRunCoalescing}));return r.run(()=>{const o=function hW(i,t,e){return new cI(i,t,e)}(e.moduleType,this.injector,function DN(i){return[{provide:Ji,useFactory:i},{provide:Xm,multi:!0,useFactory:()=>{const t=mi(G$,{optional:!0});return()=>t.initialize()}},{provide:AN,useFactory:H$},{provide:fN,useFactory:mN}]}(()=>r)),a=o.injector.get(fe,null);return r.runOutsideAngular(()=>{const u=r.onError.subscribe({next:f=>{a.handleError(f)}});o.onDestroy(()=>{IS(this._modules,o),u.unsubscribe()})}),function CN(i,t,e){try{const n=e();return KM(n)?n.catch(r=>{throw t.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw t.runOutsideAngular(()=>i.handleError(n)),n}}(a,r,()=>{const u=o.injector.get(TI);return u.runInitializers(),u.donePromise.then(()=>(function XF(i){Cc(i,"Expected localeId to be defined"),"string"==typeof i&&(qF=i.toLowerCase().replace(/_/g,"-"))}(o.injector.get(ag,Mw)||Mw),this._moduleDoBootstrap(o),o))})})}bootstrapModule(e,n=[]){const r=SN({},n);return function O$(i,t,e){const n=new dI(e);return Promise.resolve(n)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const n=e.injector.get(ev);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new Ct(-403,!1);e.instance.ngDoBootstrap(n)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ct(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());const e=this._injector.get(PI,null);e&&(e.forEach(n=>n()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(e){return new(e||i)(it(vl))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function SN(i,t){return Array.isArray(t)?t.reduce(SN,i):{...i,...t}}let ev=(()=>{class i{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=mi(AN),this.zoneIsStable=mi(fN),this.componentTypes=[],this.components=[],this.isStable=mi(AS).hasPendingTasks.pipe(Co(e=>e?Jt(!1):this.zoneIsStable),Jn(),Wn()),this._injector=mi(fh)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,n){const r=e instanceof qy;if(!this._injector.get(TI).done)throw!r&&function Br(i){const t=vr(i)||vo(i)||Cs(i);return null!==t&&t.standalone}(e),new Ct(405,!1);let a;a=r?e:this._injector.get(tg).resolveComponentFactory(e),this.componentTypes.push(a.componentType);const u=function N$(i){return i.isBoundToModule}(a)?void 0:this._injector.get(Ew),y=a.create(vl.NULL,[],n||a.selector,u),M=y.location.nativeElement,A=y.injector.get(gN,null);return A?.registerApplication(M),y.onDestroy(()=>{this.detachView(y.hostView),IS(this.components,y),A?.unregisterApplication(M)}),this._loadComponent(y),y}tick(){if(this._runningTick)throw new Ct(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this.internalErrorHandler(e)}finally{this._runningTick=!1}}attachView(e){const n=e;this._views.push(n),n.attachToAppRef(this)}detachView(e){const n=e;IS(this._views,n),n.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const n=this._injector.get(LI,[]);n.push(...this._bootstrapListeners),n.forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>IS(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Ct(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function IS(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}const AN=new Ot("",{providedIn:"root",factory:()=>mi(fe).handleError.bind(void 0)});function H$(){const i=mi(Ji),t=mi(fe);return e=>i.runOutsideAngular(()=>t.handleError(e))}let G$=(()=>{class i{constructor(){this.zone=mi(Ji),this.applicationRef=mi(ev)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();let vs=(()=>{class i{}return i.__NG_ELEMENT_ID__=W$,i})();function W$(i){return function $$(i,t,e){if(tu(i)&&!e){const n=Nt(i.index,t);return new m_(n,n)}return 47&i.type?new m_(t[ii],t):null}(Ho(),Ut(),16==(16&i))}class PN{constructor(){}supports(t){return pS(t)}create(t){return new J$(t)}}const K$=(i,t)=>t;class J${constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||K$}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,o=null;for(;e||n;){const a=!n||e&&e.currentIndex<FN(n,r,o)?e:n,u=FN(a,r,o),f=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(e=e._next,null==a.previousIndex)r++;else{o||(o=[]);const y=u-r,M=f-r;if(y!=M){for(let I=0;I<y;I++){const R=I<o.length?o[I]:o[I]=0,O=R+I;M<=O&&O<y&&(o[I]=R+1)}o[a.previousIndex]=M-y}}u!==f&&t(a,u,f)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!pS(t))throw new Ct(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,o,a,e=this._itHead,n=!1;if(Array.isArray(t)){this.length=t.length;for(let u=0;u<this.length;u++)o=t[u],a=this._trackByFn(u,o),null!==e&&Object.is(e.trackById,a)?(n&&(e=this._verifyReinsertion(e,o,a,u)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,a,u),n=!0),e=e._next}else r=0,function XG(i,t){if(Array.isArray(i))for(let e=0;e<i.length;e++)t(i[e]);else{const e=i[Symbol.iterator]();let n;for(;!(n=e.next()).done;)t(n.value)}}(t,u=>{a=this._trackByFn(r,u),null!==e&&Object.is(e.trackById,a)?(n&&(e=this._verifyReinsertion(e,u,a,r)),Object.is(e.item,u)||this._addIdentityChange(e,u)):(e=this._mismatch(e,u,a,r),n=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let o;return null===t?o=this._itTail:(o=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,o,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,o,r)):t=this._addAfter(new Q$(e,n),o,r),t}_verifyReinsertion(t,e,n,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==o?t=this._reinsertAfter(o,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,o=t._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new LN),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new LN),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Q${constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class eq{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class LN{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new eq,this.map.set(e,n)),n.add(t)}get(t,e){const r=this.map.get(t);return r?r.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function FN(i,t,e){const n=i.previousIndex;if(null===n)return n;let r=0;return e&&n<e.length&&(r=e[n]),n+t+r}class ON{constructor(){}supports(t){return t instanceof Map||WD(t)}create(){return new tq}}class tq{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||WD(t)))throw new Ct(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(n,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,n),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,n);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let n=e;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,e);const o=r._prev,a=r._next;return o&&(o._next=a),a&&(a._prev=o),r._next=null,r._prev=null,r}const n=new iq(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class iq{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function NN(){return new PS([new PN])}let PS=(()=>{class i{constructor(e){this.factories=e}static create(e,n){if(null!=n){const r=n.factories.slice();e=e.concat(r)}return new i(e)}static extend(e){return{provide:i,useFactory:n=>i.create(e,n||NN()),deps:[[i,new Qh,new Id]]}}find(e){const n=this.factories.find(r=>r.supports(e));if(null!=n)return n;throw new Ct(901,!1)}}return i.\u0275prov=Qt({token:i,providedIn:"root",factory:NN}),i})();function BN(){return new aE([new ON])}let aE=(()=>{class i{constructor(e){this.factories=e}static create(e,n){if(n){const r=n.factories.slice();e=e.concat(r)}return new i(e)}static extend(e){return{provide:i,useFactory:n=>i.create(e,n||BN()),deps:[[i,new Qh,new Id]]}}find(e){const n=this.factories.find(r=>r.supports(e));if(n)return n;throw new Ct(901,!1)}}return i.\u0275prov=Qt({token:i,providedIn:"root",factory:BN}),i})();const oq=xN(null,"core",[]);let sq=(()=>{class i{constructor(e){}}return i.\u0275fac=function(e){return new(e||i)(it(ev))},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})(),HI=null;function tv(){return HI}class yq{}const lr=new Ot("DocumentToken");let GI=(()=>{class i{historyGo(e){throw new Error("Not implemented")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:function(){return mi(bq)},providedIn:"platform"}),i})();const vq=new Ot("Location Initialized");let bq=(()=>{class i extends GI{constructor(){super(),this._doc=mi(lr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return tv().getBaseHref(this._doc)}onPopState(e){const n=tv().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){const n=tv().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,n,r){this._history.pushState(e,n,r)}replaceState(e,n,r){this._history.replaceState(e,n,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:function(){return new i},providedIn:"platform"}),i})();function jI(i,t){if(0==i.length)return t;if(0==t.length)return i;let e=0;return i.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?i+t.substring(1):1==e?i+t:i+"/"+t}function WN(i){const t=i.match(/#|\?|$/),e=t&&t.index||i.length;return i.slice(0,e-("/"===i[e-1]?1:0))+i.slice(e)}function y_(i){return i&&"?"!==i[0]?"?"+i:i}let o0=(()=>{class i{historyGo(e){throw new Error("Not implemented")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:function(){return mi(qN)},providedIn:"root"}),i})();const $N=new Ot("appBaseHref");let qN=(()=>{class i extends o0{constructor(e,n){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??mi(lr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return jI(this._baseHref,e)}path(e=!1){const n=this._platformLocation.pathname+y_(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${n}${r}`:n}pushState(e,n,r,o){const a=this.prepareExternalUrl(r+y_(o));this._platformLocation.pushState(e,n,a)}replaceState(e,n,r,o){const a=this.prepareExternalUrl(r+y_(o));this._platformLocation.replaceState(e,n,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return i.\u0275fac=function(e){return new(e||i)(it(GI),it($N,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),xq=(()=>{class i extends o0{constructor(e,n){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(e){const n=jI(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,r,o){let a=this.prepareExternalUrl(r+y_(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(e,n,a)}replaceState(e,n,r,o){let a=this.prepareExternalUrl(r+y_(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(e,n,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return i.\u0275fac=function(e){return new(e||i)(it(GI),it($N,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})(),s0=(()=>{class i{constructor(e){this._subject=new Mi,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const n=this._locationStrategy.getBaseHref();this._basePath=function Eq(i){if(new RegExp("^(https?:)?//").test(i)){const[,e]=i.split(/\/\/[^\/]+/);return e}return i}(WN(XN(n))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+y_(n))}normalize(e){return i.stripTrailingSlash(function Mq(i,t){if(!i||!t.startsWith(i))return t;const e=t.substring(i.length);return""===e||["/",";","?","#"].includes(e[0])?e:t}(this._basePath,XN(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,n="",r=null){this._locationStrategy.pushState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+y_(n)),r)}replaceState(e,n="",r=null){this._locationStrategy.replaceState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+y_(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(r=>r(e,n))}subscribe(e,n,r){return this._subject.subscribe({next:e,error:n,complete:r})}}return i.normalizeQueryParams=y_,i.joinWithSlash=jI,i.stripTrailingSlash=WN,i.\u0275fac=function(e){return new(e||i)(it(o0))},i.\u0275prov=Qt({token:i,factory:function(){return function wq(){return new s0(it(o0))}()},providedIn:"root"}),i})();function XN(i){return i.replace(/\/index.html$/,"")}var xl=(()=>((xl=xl||{})[xl.Format=0]="Format",xl[xl.Standalone=1]="Standalone",xl))(),ho=(()=>((ho=ho||{})[ho.Narrow=0]="Narrow",ho[ho.Abbreviated=1]="Abbreviated",ho[ho.Wide=2]="Wide",ho[ho.Short=3]="Short",ho))(),Aa=(()=>((Aa=Aa||{})[Aa.Short=0]="Short",Aa[Aa.Medium=1]="Medium",Aa[Aa.Long=2]="Long",Aa[Aa.Full=3]="Full",Aa))(),nr=(()=>((nr=nr||{})[nr.Decimal=0]="Decimal",nr[nr.Group=1]="Group",nr[nr.List=2]="List",nr[nr.PercentSign=3]="PercentSign",nr[nr.PlusSign=4]="PlusSign",nr[nr.MinusSign=5]="MinusSign",nr[nr.Exponential=6]="Exponential",nr[nr.SuperscriptingExponent=7]="SuperscriptingExponent",nr[nr.PerMille=8]="PerMille",nr[nr.Infinity=9]="Infinity",nr[nr.NaN=10]="NaN",nr[nr.TimeSeparator=11]="TimeSeparator",nr[nr.CurrencyDecimal=12]="CurrencyDecimal",nr[nr.CurrencyGroup=13]="CurrencyGroup",nr))();function FS(i,t){return lf(vu(i)[qi.DateFormat],t)}function OS(i,t){return lf(vu(i)[qi.TimeFormat],t)}function NS(i,t){return lf(vu(i)[qi.DateTimeFormat],t)}function af(i,t){const e=vu(i),n=e[qi.NumberSymbols][t];if(typeof n>"u"){if(t===nr.CurrencyDecimal)return e[qi.NumberSymbols][nr.Decimal];if(t===nr.CurrencyGroup)return e[qi.NumberSymbols][nr.Group]}return n}function YN(i){if(!i[qi.ExtraData])throw new Error(`Missing extra locale data for the locale "${i[qi.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function lf(i,t){for(let e=t;e>-1;e--)if(typeof i[e]<"u")return i[e];throw new Error("Locale data API: locale data undefined")}function $I(i){const[t,e]=i.split(":");return{hours:+t,minutes:+e}}const Nq=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,lE={},Bq=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var pc=(()=>((pc=pc||{})[pc.Short=0]="Short",pc[pc.ShortGMT=1]="ShortGMT",pc[pc.Long=2]="Long",pc[pc.Extended=3]="Extended",pc))(),hr=(()=>((hr=hr||{})[hr.FullYear=0]="FullYear",hr[hr.Month=1]="Month",hr[hr.Date=2]="Date",hr[hr.Hours=3]="Hours",hr[hr.Minutes=4]="Minutes",hr[hr.Seconds=5]="Seconds",hr[hr.FractionalSeconds=6]="FractionalSeconds",hr[hr.Day=7]="Day",hr))(),Vr=(()=>((Vr=Vr||{})[Vr.DayPeriods=0]="DayPeriods",Vr[Vr.Days=1]="Days",Vr[Vr.Months=2]="Months",Vr[Vr.Eras=3]="Eras",Vr))();function zq(i,t,e,n){let r=function Xq(i){if(QN(i))return i;if("number"==typeof i&&!isNaN(i))return new Date(i);if("string"==typeof i){if(i=i.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(i)){const[r,o=1,a=1]=i.split("-").map(u=>+u);return BS(r,o-1,a)}const e=parseFloat(i);if(!isNaN(i-e))return new Date(e);let n;if(n=i.match(Nq))return function Zq(i){const t=new Date(0);let e=0,n=0;const r=i[8]?t.setUTCFullYear:t.setFullYear,o=i[8]?t.setUTCHours:t.setHours;i[9]&&(e=Number(i[9]+i[10]),n=Number(i[9]+i[11])),r.call(t,Number(i[1]),Number(i[2])-1,Number(i[3]));const a=Number(i[4]||0)-e,u=Number(i[5]||0)-n,f=Number(i[6]||0),y=Math.floor(1e3*parseFloat("0."+(i[7]||0)));return o.call(t,a,u,f,y),t}(n)}const t=new Date(i);if(!QN(t))throw new Error(`Unable to convert "${i}" into a date`);return t}(i);t=v_(e,t)||t;let u,a=[];for(;t;){if(u=Bq.exec(t),!u){a.push(t);break}{a=a.concat(u.slice(1));const M=a.pop();if(!M)break;t=M}}let f=r.getTimezoneOffset();n&&(f=JN(n,f),r=function qq(i,t,e){const n=e?-1:1,r=i.getTimezoneOffset();return function $q(i,t){return(i=new Date(i.getTime())).setMinutes(i.getMinutes()+t),i}(i,n*(JN(t,r)-r))}(r,n,!0));let y="";return a.forEach(M=>{const A=function Wq(i){if(XI[i])return XI[i];let t;switch(i){case"G":case"GG":case"GGG":t=Gs(Vr.Eras,ho.Abbreviated);break;case"GGGG":t=Gs(Vr.Eras,ho.Wide);break;case"GGGGG":t=Gs(Vr.Eras,ho.Narrow);break;case"y":t=Gl(hr.FullYear,1,0,!1,!0);break;case"yy":t=Gl(hr.FullYear,2,0,!0,!0);break;case"yyy":t=Gl(hr.FullYear,3,0,!1,!0);break;case"yyyy":t=Gl(hr.FullYear,4,0,!1,!0);break;case"Y":t=HS(1);break;case"YY":t=HS(2,!0);break;case"YYY":t=HS(3);break;case"YYYY":t=HS(4);break;case"M":case"L":t=Gl(hr.Month,1,1);break;case"MM":case"LL":t=Gl(hr.Month,2,1);break;case"MMM":t=Gs(Vr.Months,ho.Abbreviated);break;case"MMMM":t=Gs(Vr.Months,ho.Wide);break;case"MMMMM":t=Gs(Vr.Months,ho.Narrow);break;case"LLL":t=Gs(Vr.Months,ho.Abbreviated,xl.Standalone);break;case"LLLL":t=Gs(Vr.Months,ho.Wide,xl.Standalone);break;case"LLLLL":t=Gs(Vr.Months,ho.Narrow,xl.Standalone);break;case"w":t=qI(1);break;case"ww":t=qI(2);break;case"W":t=qI(1,!0);break;case"d":t=Gl(hr.Date,1);break;case"dd":t=Gl(hr.Date,2);break;case"c":case"cc":t=Gl(hr.Day,1);break;case"ccc":t=Gs(Vr.Days,ho.Abbreviated,xl.Standalone);break;case"cccc":t=Gs(Vr.Days,ho.Wide,xl.Standalone);break;case"ccccc":t=Gs(Vr.Days,ho.Narrow,xl.Standalone);break;case"cccccc":t=Gs(Vr.Days,ho.Short,xl.Standalone);break;case"E":case"EE":case"EEE":t=Gs(Vr.Days,ho.Abbreviated);break;case"EEEE":t=Gs(Vr.Days,ho.Wide);break;case"EEEEE":t=Gs(Vr.Days,ho.Narrow);break;case"EEEEEE":t=Gs(Vr.Days,ho.Short);break;case"a":case"aa":case"aaa":t=Gs(Vr.DayPeriods,ho.Abbreviated);break;case"aaaa":t=Gs(Vr.DayPeriods,ho.Wide);break;case"aaaaa":t=Gs(Vr.DayPeriods,ho.Narrow);break;case"b":case"bb":case"bbb":t=Gs(Vr.DayPeriods,ho.Abbreviated,xl.Standalone,!0);break;case"bbbb":t=Gs(Vr.DayPeriods,ho.Wide,xl.Standalone,!0);break;case"bbbbb":t=Gs(Vr.DayPeriods,ho.Narrow,xl.Standalone,!0);break;case"B":case"BB":case"BBB":t=Gs(Vr.DayPeriods,ho.Abbreviated,xl.Format,!0);break;case"BBBB":t=Gs(Vr.DayPeriods,ho.Wide,xl.Format,!0);break;case"BBBBB":t=Gs(Vr.DayPeriods,ho.Narrow,xl.Format,!0);break;case"h":t=Gl(hr.Hours,1,-12);break;case"hh":t=Gl(hr.Hours,2,-12);break;case"H":t=Gl(hr.Hours,1);break;case"HH":t=Gl(hr.Hours,2);break;case"m":t=Gl(hr.Minutes,1);break;case"mm":t=Gl(hr.Minutes,2);break;case"s":t=Gl(hr.Seconds,1);break;case"ss":t=Gl(hr.Seconds,2);break;case"S":t=Gl(hr.FractionalSeconds,1);break;case"SS":t=Gl(hr.FractionalSeconds,2);break;case"SSS":t=Gl(hr.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=US(pc.Short);break;case"ZZZZZ":t=US(pc.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=US(pc.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=US(pc.Long);break;default:return null}return XI[i]=t,t}(M);y+=A?A(r,e,f):"''"===M?"'":M.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),y}function BS(i,t,e){const n=new Date(0);return n.setFullYear(i,t,e),n.setHours(0,0,0),n}function v_(i,t){const e=function Cq(i){return vu(i)[qi.LocaleId]}(i);if(lE[e]=lE[e]||{},lE[e][t])return lE[e][t];let n="";switch(t){case"shortDate":n=FS(i,Aa.Short);break;case"mediumDate":n=FS(i,Aa.Medium);break;case"longDate":n=FS(i,Aa.Long);break;case"fullDate":n=FS(i,Aa.Full);break;case"shortTime":n=OS(i,Aa.Short);break;case"mediumTime":n=OS(i,Aa.Medium);break;case"longTime":n=OS(i,Aa.Long);break;case"fullTime":n=OS(i,Aa.Full);break;case"short":const r=v_(i,"shortTime"),o=v_(i,"shortDate");n=zS(NS(i,Aa.Short),[r,o]);break;case"medium":const a=v_(i,"mediumTime"),u=v_(i,"mediumDate");n=zS(NS(i,Aa.Medium),[a,u]);break;case"long":const f=v_(i,"longTime"),y=v_(i,"longDate");n=zS(NS(i,Aa.Long),[f,y]);break;case"full":const M=v_(i,"fullTime"),A=v_(i,"fullDate");n=zS(NS(i,Aa.Full),[M,A])}return n&&(lE[e][t]=n),n}function zS(i,t){return t&&(i=i.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),i}function nm(i,t,e="-",n,r){let o="";(i<0||r&&i<=0)&&(r?i=1-i:(i=-i,o=e));let a=String(i);for(;a.length<t;)a="0"+a;return n&&(a=a.slice(a.length-t)),o+a}function Gl(i,t,e=0,n=!1,r=!1){return function(o,a){let u=function Vq(i,t){switch(i){case hr.FullYear:return t.getFullYear();case hr.Month:return t.getMonth();case hr.Date:return t.getDate();case hr.Hours:return t.getHours();case hr.Minutes:return t.getMinutes();case hr.Seconds:return t.getSeconds();case hr.FractionalSeconds:return t.getMilliseconds();case hr.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${i}".`)}}(i,o);if((e>0||u>-e)&&(u+=e),i===hr.Hours)0===u&&-12===e&&(u=12);else if(i===hr.FractionalSeconds)return function Uq(i,t){return nm(i,3).substring(0,t)}(u,t);const f=af(a,nr.MinusSign);return nm(u,t,f,n,r)}}function Gs(i,t,e=xl.Format,n=!1){return function(r,o){return function Hq(i,t,e,n,r,o){switch(e){case Vr.Months:return function Aq(i,t,e){const n=vu(i),o=lf([n[qi.MonthsFormat],n[qi.MonthsStandalone]],t);return lf(o,e)}(t,r,n)[i.getMonth()];case Vr.Days:return function Tq(i,t,e){const n=vu(i),o=lf([n[qi.DaysFormat],n[qi.DaysStandalone]],t);return lf(o,e)}(t,r,n)[i.getDay()];case Vr.DayPeriods:const a=i.getHours(),u=i.getMinutes();if(o){const y=function Rq(i){const t=vu(i);return YN(t),(t[qi.ExtraData][2]||[]).map(n=>"string"==typeof n?$I(n):[$I(n[0]),$I(n[1])])}(t),M=function Pq(i,t,e){const n=vu(i);YN(n);const o=lf([n[qi.ExtraData][0],n[qi.ExtraData][1]],t)||[];return lf(o,e)||[]}(t,r,n),A=y.findIndex(I=>{if(Array.isArray(I)){const[R,O]=I,H=a>=R.hours&&u>=R.minutes,U=a<O.hours||a===O.hours&&u<O.minutes;if(R.hours<O.hours){if(H&&U)return!0}else if(H||U)return!0}else if(I.hours===a&&I.minutes===u)return!0;return!1});if(-1!==A)return M[A]}return function Sq(i,t,e){const n=vu(i),o=lf([n[qi.DayPeriodsFormat],n[qi.DayPeriodsStandalone]],t);return lf(o,e)}(t,r,n)[a<12?0:1];case Vr.Eras:return function Dq(i,t){return lf(vu(i)[qi.Eras],t)}(t,n)[i.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,i,t,e,n)}}function US(i){return function(t,e,n){const r=-1*n,o=af(e,nr.MinusSign),a=r>0?Math.floor(r/60):Math.ceil(r/60);switch(i){case pc.Short:return(r>=0?"+":"")+nm(a,2,o)+nm(Math.abs(r%60),2,o);case pc.ShortGMT:return"GMT"+(r>=0?"+":"")+nm(a,1,o);case pc.Long:return"GMT"+(r>=0?"+":"")+nm(a,2,o)+":"+nm(Math.abs(r%60),2,o);case pc.Extended:return 0===n?"Z":(r>=0?"+":"")+nm(a,2,o)+":"+nm(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${i}"`)}}}const Gq=0,VS=4;function KN(i){return BS(i.getFullYear(),i.getMonth(),i.getDate()+(VS-i.getDay()))}function qI(i,t=!1){return function(e,n){let r;if(t){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,a=e.getDate();r=1+Math.floor((a+o)/7)}else{const o=KN(e),a=function jq(i){const t=BS(i,Gq,1).getDay();return BS(i,0,1+(t<=VS?VS:VS+7)-t)}(o.getFullYear()),u=o.getTime()-a.getTime();r=1+Math.round(u/6048e5)}return nm(r,i,af(n,nr.MinusSign))}}function HS(i,t=!1){return function(e,n){return nm(KN(e).getFullYear(),i,af(n,nr.MinusSign),t)}}const XI={};function JN(i,t){i=i.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+i)/6e4;return isNaN(e)?t:e}function QN(i){return i instanceof Date&&!isNaN(i.valueOf())}function nB(i,t){t=encodeURIComponent(t);for(const e of i.split(";")){const n=e.indexOf("="),[r,o]=-1==n?[e,""]:[e.slice(0,n),e.slice(n+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}const ek=/\s+/,rB=[];let dE=(()=>{class i{constructor(e,n,r,o){this._iterableDiffers=e,this._keyValueDiffers=n,this._ngEl=r,this._renderer=o,this.initialClasses=rB,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(ek):rB}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(ek):e}ngDoCheck(){for(const n of this.initialClasses)this._updateState(n,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const n of e)this._updateState(n,!0);else if(null!=e)for(const n of Object.keys(e))this._updateState(n,!!e[n]);this._applyStateDiff()}_updateState(e,n){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==n&&(r.changed=!0,r.enabled=n),r.touched=!0):this.stateMap.set(e,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const n=e[0],r=e[1];r.changed?(this._toggleClass(n,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),r.touched=!1}}_toggleClass(e,n){(e=e.trim()).length>0&&e.split(ek).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return i.\u0275fac=function(e){return new(e||i)(oe(PS),oe(aE),oe(tn),oe(sp))},i.\u0275dir=si({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),i})();class l9{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let a0=(()=>{class i{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,n,r){this._viewContainer=e,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const n=this._viewContainer;e.forEachOperation((r,o,a)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new l9(r.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)n.remove(null===o?void 0:o);else if(null!==o){const u=n.get(o);n.move(u,a),sB(u,r)}});for(let r=0,o=n.length;r<o;r++){const u=n.get(r).context;u.index=r,u.count=o,u.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{sB(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,n){return!0}}return i.\u0275fac=function(e){return new(e||i)(oe(bu),oe(sf),oe(PS))},i.\u0275dir=si({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),i})();function sB(i,t){i.context.$implicit=t.item}let cp=(()=>{class i{constructor(e,n){this._viewContainer=e,this._context=new c9,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){aB("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){aB("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,n){return!0}}return i.\u0275fac=function(e){return new(e||i)(oe(bu),oe(sf))},i.\u0275dir=si({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),i})();class c9{constructor(){this.$implicit=null,this.ngIf=null}}function aB(i,t){if(t&&!t.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${yo(t)}'.`)}class tk{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let l0=(()=>{class i{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const n=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const n of this._defaultViews)n.enforceState(e)}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),i})(),uE=(()=>{class i{constructor(e,n,r){this.ngSwitch=r,r._addCase(),this._view=new tk(e,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(e){return new(e||i)(oe(bu),oe(sf),oe(l0,9))},i.\u0275dir=si({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),i})(),lB=(()=>{class i{constructor(e,n,r){r._addDefault(new tk(e,n))}}return i.\u0275fac=function(e){return new(e||i)(oe(bu),oe(sf),oe(l0,9))},i.\u0275dir=si({type:i,selectors:[["","ngSwitchDefault",""]],standalone:!0}),i})(),ik=(()=>{class i{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const n=this._viewContainerRef;if(this._viewRef&&n.remove(n.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:o,ngTemplateOutletInjector:a}=this;this._viewRef=n.createEmbeddedView(r,o,a?{injector:a}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return i.\u0275fac=function(e){return new(e||i)(oe(bu))},i.\u0275dir=si({type:i,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[le]}),i})();const w9=new Ot("DATE_PIPE_DEFAULT_TIMEZONE"),M9=new Ot("DATE_PIPE_DEFAULT_OPTIONS");let dB=(()=>{class i{constructor(e,n,r){this.locale=e,this.defaultTimezone=n,this.defaultOptions=r}transform(e,n,r,o){if(null==e||""===e||e!=e)return null;try{return zq(e,n??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(a){throw function rm(i,t){return new Ct(2100,!1)}()}}}return i.\u0275fac=function(e){return new(e||i)(oe(ag,16),oe(w9,24),oe(M9,24))},i.\u0275pipe=as({name:"date",type:i,pure:!0,standalone:!0}),i})(),wu=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})();const hB="browser";function pB(i){return"server"===i}let N9=(()=>{class i{}return i.\u0275prov=Qt({token:i,providedIn:"root",factory:()=>new B9(it(lr),window)}),i})();class B9{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function z9(i,t){const e=i.getElementById(t)||i.getElementsByName(t)[0];if(e)return e;if("function"==typeof i.createTreeWalker&&i.body&&"function"==typeof i.body.attachShadow){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const o=r.shadowRoot;if(o){const a=o.getElementById(t)||o.querySelector(`[name="${t}"]`);if(a)return a}r=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(n-o[0],r-o[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=fB(this.window.history)||fB(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function fB(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class mB{}class l7 extends yq{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ak extends l7{static makeCurrent(){!function _q(i){HI||(HI=i)}(new ak)}onAndCancel(t,e,n){return t.addEventListener(e,n),()=>{t.removeEventListener(e,n)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function c7(){return pE=pE||document.querySelector("base"),pE?pE.getAttribute("href"):null}();return null==e?null:function d7(i){$S=$S||document.createElement("a"),$S.setAttribute("href",i);const t=$S.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){pE=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return nB(document.cookie,t)}}let $S,pE=null,h7=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const lk=new Ot("EventManagerPlugins");let bB=(()=>{class i{constructor(e,n){this._zone=n,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,n,r){return this._findPluginFor(n).addEventListener(e,n,r)}getZone(){return this._zone}_findPluginFor(e){let n=this._eventNameToPlugin.get(e);if(n)return n;if(n=this._plugins.find(o=>o.supports(e)),!n)throw new Ct(5101,!1);return this._eventNameToPlugin.set(e,n),n}}return i.\u0275fac=function(e){return new(e||i)(it(lk),it(Ji))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();class xB{constructor(t){this._doc=t}}const ck="ng-app-id";let wB=(()=>{class i{constructor(e,n,r,o={}){this.doc=e,this.appId=n,this.nonce=r,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=pB(o),this.resetHostNodes()}addStyles(e){for(const n of e)1===this.changeUsageCount(n,1)&&this.onStyleAdded(n)}removeStyles(e){for(const n of e)this.changeUsageCount(n,-1)<=0&&this.onStyleRemoved(n)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(n=>n.remove()),e.clear());for(const n of this.getAllStyles())this.onStyleRemoved(n);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const n of this.getAllStyles())this.addStyleToHost(e,n)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const n of this.hostNodes)this.addStyleToHost(n,e)}onStyleRemoved(e){const n=this.styleRef;n.get(e)?.elements?.forEach(r=>r.remove()),n.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${ck}="${this.appId}"]`);if(e?.length){const n=new Map;return e.forEach(r=>{null!=r.textContent&&n.set(r.textContent,r)}),n}return null}changeUsageCount(e,n){const r=this.styleRef;if(r.has(e)){const o=r.get(e);return o.usage+=n,o.usage}return r.set(e,{usage:n,elements:[]}),n}getStyleElement(e,n){const r=this.styleNodesInDOM,o=r?.get(n);if(o?.parentNode===e)return r.delete(n),o.removeAttribute(ck),o;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=n,this.platformIsServer&&a.setAttribute(ck,this.appId),a}}addStyleToHost(e,n){const r=this.getStyleElement(e,n);e.appendChild(r);const o=this.styleRef,a=o.get(n)?.elements;a?a.push(r):o.set(n,{elements:[r],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return i.\u0275fac=function(e){return new(e||i)(it(lr),it(Km),it(Qm,8),it(cc))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const dk={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},uk=/%COMP%/g,g7=new Ot("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function EB(i,t){return t.map(e=>e.replace(uk,i))}let hk=(()=>{class i{constructor(e,n,r,o,a,u,f,y=null){this.eventManager=e,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=f,this.nonce=y,this.rendererByCompId=new Map,this.platformIsServer=pB(u),this.defaultRenderer=new pk(e,a,f,this.platformIsServer)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===sa.ShadowDom&&(n={...n,encapsulation:sa.Emulated});const r=this.getOrCreateRenderer(e,n);return r instanceof SB?r.applyToHost(e):r instanceof fk&&r.applyStyles(),r}getOrCreateRenderer(e,n){const r=this.rendererByCompId;let o=r.get(n.id);if(!o){const a=this.doc,u=this.ngZone,f=this.eventManager,y=this.sharedStylesHost,M=this.removeStylesOnCompDestroy,A=this.platformIsServer;switch(n.encapsulation){case sa.Emulated:o=new SB(f,y,n,this.appId,M,a,u,A);break;case sa.ShadowDom:return new b7(f,y,e,n,a,u,this.nonce,A);default:o=new fk(f,y,n,M,a,u,A)}o.onDestroy=()=>r.delete(n.id),r.set(n.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}}return i.\u0275fac=function(e){return new(e||i)(it(bB),it(wB),it(Km),it(g7),it(lr),it(cc),it(Ji),it(Qm))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();class pk{constructor(t,e,n,r){this.eventManager=t,this.doc=e,this.ngZone=n,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?this.doc.createElementNS(dk[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(CB(t)?t.content:t).appendChild(e)}insertBefore(t,e,n){t&&(CB(t)?t.content:t).insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?this.doc.querySelector(t):t;if(!n)throw new Ct(-5104,!1);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const o=dk[r];o?t.setAttributeNS(o,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=dk[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&(ja.DashCase|ja.Important)?t.style.setProperty(e,n,r&ja.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&ja.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){if("string"==typeof t&&!(t=tv().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${e}`);return this.eventManager.addEventListener(t,e,this.decoratePreventDefault(n))}decoratePreventDefault(t){return e=>{if("__ngUnwrap__"===e)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))&&e.preventDefault()}}}function CB(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class b7 extends pk{constructor(t,e,n,r,o,a,u,f){super(t,o,a,f),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const y=EB(r.id,r.styles);for(const M of y){const A=document.createElement("style");u&&A.setAttribute("nonce",u),A.textContent=M,this.shadowRoot.appendChild(A)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class fk extends pk{constructor(t,e,n,r,o,a,u,f){super(t,o,a,u),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r,this.rendererUsageCount=0,this.styles=f?EB(f,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestroy&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class SB extends fk{constructor(t,e,n,r,o,a,u,f){const y=r+"-"+n.id;super(t,e,n,o,a,u,f,y),this.contentAttr=function _7(i){return"_ngcontent-%COMP%".replace(uk,i)}(y),this.hostAttr=function y7(i){return"_nghost-%COMP%".replace(uk,i)}(y)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}let x7=(()=>{class i extends xB{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,r){return e.addEventListener(n,r,!1),()=>this.removeEventListener(e,n,r)}removeEventListener(e,n,r){return e.removeEventListener(n,r)}}return i.\u0275fac=function(e){return new(e||i)(it(lr))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const TB=["alt","control","meta","shift"],w7={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},M7={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let E7=(()=>{class i extends xB{constructor(e){super(e)}supports(e){return null!=i.parseEventName(e)}addEventListener(e,n,r){const o=i.parseEventName(n),a=i.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>tv().onAndCancel(e,o.domEventName,a))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const o=i._normalizeKey(n.pop());let a="",u=n.indexOf("code");if(u>-1&&(n.splice(u,1),a="code."),TB.forEach(y=>{const M=n.indexOf(y);M>-1&&(n.splice(M,1),a+=y+".")}),a+=o,0!=n.length||0===o.length)return null;const f={};return f.domEventName=r,f.fullKey=a,f}static matchEventFullKeyCode(e,n){let r=w7[e.key]||e.key,o="";return n.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),TB.forEach(a=>{a!==r&&(0,M7[a])(e)&&(o+=a+".")}),o+=r,o===n)}static eventCallback(e,n,r){return o=>{i.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>n(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return i.\u0275fac=function(e){return new(e||i)(it(lr))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const A7=xN(oq,"browser",[{provide:cc,useValue:hB},{provide:Jm,useValue:function C7(){ak.makeCurrent()},multi:!0},{provide:lr,useFactory:function T7(){return function ks(i){jm=i}(document),document},deps:[]}]),D7=new Ot(""),IB=[{provide:DS,useClass:class u7{addToWindow(t){Nr.getAngularTestability=(n,r=!0)=>{const o=t.findTestabilityInTree(n,r);if(null==o)throw new Ct(5103,!1);return o},Nr.getAllAngularTestabilities=()=>t.getAllTestabilities(),Nr.getAllAngularRootElements=()=>t.getAllRootElements(),Nr.frameworkStabilizers||(Nr.frameworkStabilizers=[]),Nr.frameworkStabilizers.push(n=>{const r=Nr.getAllAngularTestabilities();let o=r.length,a=!1;const u=function(f){a=a||f,o--,0==o&&n(a)};r.forEach(f=>{f.whenStable(u)})})}findTestabilityInTree(t,e,n){return null==e?null:t.getTestability(e)??(n?tv().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:gN,useClass:II,deps:[Ji,kI,DS]},{provide:II,useClass:II,deps:[Ji,kI,DS]}],kB=[{provide:Hy,useValue:"root"},{provide:fe,useFactory:function S7(){return new fe},deps:[]},{provide:lk,useClass:x7,multi:!0,deps:[lr,Ji,cc]},{provide:lk,useClass:E7,multi:!0,deps:[lr]},hk,wB,bB,{provide:f_,useExisting:hk},{provide:mB,useClass:h7,deps:[]},[]];let I7=(()=>{class i{constructor(e){}static withServerTransition(e){return{ngModule:i,providers:[{provide:Km,useValue:e.appId}]}}}return i.\u0275fac=function(e){return new(e||i)(it(D7,12))},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[...kB,...IB],imports:[wu,sq]}),i})(),RB=(()=>{class i{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return i.\u0275fac=function(e){return new(e||i)(it(lr))},i.\u0275prov=Qt({token:i,factory:function(e){let n=null;return n=e?new e:function R7(){return new RB(it(lr))}(),n},providedIn:"root"}),i})();typeof window<"u"&&window;let gk=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:function(e){let n=null;return n=e?new(e||i):it(FB),n},providedIn:"root"}),i})(),FB=(()=>{class i extends gk{constructor(e){super(),this._doc=e}sanitize(e,n){if(null==n)return null;switch(e){case wo.NONE:return n;case wo.HTML:return ld(n,"HTML")?Wa(n):$m(this._doc,String(n)).toString();case wo.STYLE:return ld(n,"Style")?Wa(n):n;case wo.SCRIPT:if(ld(n,"Script"))return Wa(n);throw new Ct(5200,!1);case wo.URL:return ld(n,"URL")?Wa(n):ac(String(n));case wo.RESOURCE_URL:if(ld(n,"ResourceURL"))return Wa(n);throw new Ct(5201,!1);default:throw new Ct(5202,!1)}}bypassSecurityTrustHtml(e){return function Hf(i){return new kb(i)}(e)}bypassSecurityTrustStyle(e){return function Ux(i){return new a_(i)}(e)}bypassSecurityTrustScript(e){return function Vx(i){return new uh(i)}(e)}bypassSecurityTrustUrl(e){return function Ao(i){return new Rb(i)}(e)}bypassSecurityTrustResourceUrl(e){return function Pb(i){return new pM(i)}(e)}}return i.\u0275fac=function(e){return new(e||i)(it(lr))},i.\u0275prov=Qt({token:i,factory:function(e){let n=null;return n=e?new e:function O7(i){return new FB(i.get(lr))}(it(vl)),n},providedIn:"root"}),i})();function nv(i){return!!i&&(i instanceof Cn||Sr(i.lift)&&Sr(i.subscribe))}const{isArray:N7}=Array,{getPrototypeOf:B7,prototype:z7,keys:U7}=Object;function NB(i){if(1===i.length){const t=i[0];if(N7(t))return{args:t,keys:null};if(function V7(i){return i&&"object"==typeof i&&B7(i)===z7}(t)){const e=U7(t);return{args:e.map(n=>t[n]),keys:e}}}return{args:i,keys:null}}const{isArray:H7}=Array;function _k(i){return vn(t=>function G7(i,t){return H7(t)?i(...t):i(t)}(i,t))}function BB(i,t){return i.reduce((e,n,r)=>(e[n]=t[r],e),{})}function qS(...i){const t=Xc(i),e=fm(i),{args:n,keys:r}=NB(i);if(0===n.length)return Zo([],t);const o=new Cn(function j7(i,t,e=yc){return n=>{zB(t,()=>{const{length:r}=i,o=new Array(r);let a=r,u=r;for(let f=0;f<r;f++)zB(t,()=>{const y=Zo(i[f],t);let M=!1;y.subscribe(go(n,A=>{o[f]=A,M||(M=!0,u--),u||n.next(e(o.slice()))},()=>{--a||n.complete()}))},n)},n)}}(n,t,r?a=>BB(r,a):yc));return e?o.pipe(_k(e)):o}function zB(i,t,e){i?_d(e,i,t):t()}const XS=Oe(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function c0(...i){return function W7(){return yd(1)}()(Zo(i,Xc(i)))}function d0(i){return new Cn(t=>{Tr(i()).subscribe(t)})}function Dw(i,t){const e=Sr(i)?i:()=>i,n=r=>r.error(e());return new Cn(t?r=>t.schedule(n,0,r):n)}function yk(){return to((i,t)=>{let e=null;i._refCount++;const n=go(t,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(e=null);const r=i._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),t.unsubscribe()});i.subscribe(n),n.closed||(e=i.connect())})}class UB extends Cn{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,fd(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new gt;const e=this.getSubject();t.add(this.source.subscribe(go(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),t.closed&&(this._connection=null,t=gt.EMPTY)}return t}refCount(){return yk()(this)}}function ss(i){return i<=0?()=>Ql:to((t,e)=>{let n=0;t.subscribe(go(e,r=>{++n<=i&&(e.next(r),i<=n&&e.complete())}))})}function Oc(...i){const t=Xc(i);return to((e,n)=>{(t?c0(i,e,t):c0(i,e)).subscribe(n)})}function Ko(i,t){return to((e,n)=>{let r=0;e.subscribe(go(n,o=>i.call(t,o,r++)&&n.next(o)))})}function ZS(i){return to((t,e)=>{let n=!1;t.subscribe(go(e,r=>{n=!0,e.next(r)},()=>{n||e.next(i),e.complete()}))})}function VB(i=$7){return to((t,e)=>{let n=!1;t.subscribe(go(e,r=>{n=!0,e.next(r)},()=>n?e.complete():e.error(i())))})}function $7(){return new XS}function u0(i,t){const e=arguments.length>=2;return n=>n.pipe(i?Ko((r,o)=>i(r,o,n)):yc,ss(1),e?ZS(t):VB(()=>new XS))}function h0(i,t){return Sr(t)?Ms(i,t,1):Ms(i,1)}function fc(i,t,e){const n=Sr(i)||t||e?{next:i,error:t,complete:e}:i;return n?to((r,o)=>{var a;null===(a=n.subscribe)||void 0===a||a.call(n);let u=!0;r.subscribe(go(o,f=>{var y;null===(y=n.next)||void 0===y||y.call(n,f),o.next(f)},()=>{var f;u=!1,null===(f=n.complete)||void 0===f||f.call(n),o.complete()},f=>{var y;u=!1,null===(y=n.error)||void 0===y||y.call(n,f),o.error(f)},()=>{var f,y;u&&(null===(f=n.unsubscribe)||void 0===f||f.call(n)),null===(y=n.finalize)||void 0===y||y.call(n)}))}):yc}function rv(i){return to((t,e)=>{let o,n=null,r=!1;n=t.subscribe(go(e,void 0,void 0,a=>{o=Tr(i(a,rv(i)(t))),n?(n.unsubscribe(),n=null,o.subscribe(e)):r=!0})),r&&(n.unsubscribe(),n=null,o.subscribe(e))})}function vk(i){return i<=0?()=>Ql:to((t,e)=>{let n=[];t.subscribe(go(e,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)e.next(r);e.complete()},void 0,()=>{n=null}))})}function YS(i){return vn(()=>i)}function Iw(i){return to((t,e)=>{try{t.subscribe(e)}finally{e.add(i)}})}const Lr="primary",fE=Symbol("RouteTitle");class Y7{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function kw(i){return new Y7(i)}function K7(i,t,e){const n=e.path.split("/");if(n.length>i.length||"full"===e.pathMatch&&(t.hasChildren()||n.length<i.length))return null;const r={};for(let o=0;o<n.length;o++){const a=n[o],u=i[o];if(a.startsWith(":"))r[a.substring(1)]=u;else if(a!==u.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function lg(i,t){const e=i?Object.keys(i):void 0,n=t?Object.keys(t):void 0;if(!e||!n||e.length!=n.length)return!1;let r;for(let o=0;o<e.length;o++)if(r=e[o],!HB(i[r],t[r]))return!1;return!0}function HB(i,t){if(Array.isArray(i)&&Array.isArray(t)){if(i.length!==t.length)return!1;const e=[...i].sort(),n=[...t].sort();return e.every((r,o)=>n[o]===r)}return i===t}function GB(i){return i.length>0?i[i.length-1]:null}function ov(i){return nv(i)?i:KM(i)?Zo(Promise.resolve(i)):Jt(i)}const Q7={exact:function $B(i,t,e){if(!p0(i.segments,t.segments)||!KS(i.segments,t.segments,e)||i.numberOfChildren!==t.numberOfChildren)return!1;for(const n in t.children)if(!i.children[n]||!$B(i.children[n],t.children[n],e))return!1;return!0},subset:qB},jB={exact:function eX(i,t){return lg(i,t)},subset:function tX(i,t){return Object.keys(t).length<=Object.keys(i).length&&Object.keys(t).every(e=>HB(i[e],t[e]))},ignored:()=>!0};function WB(i,t,e){return Q7[e.paths](i.root,t.root,e.matrixParams)&&jB[e.queryParams](i.queryParams,t.queryParams)&&!("exact"===e.fragment&&i.fragment!==t.fragment)}function qB(i,t,e){return XB(i,t,t.segments,e)}function XB(i,t,e,n){if(i.segments.length>e.length){const r=i.segments.slice(0,e.length);return!(!p0(r,e)||t.hasChildren()||!KS(r,e,n))}if(i.segments.length===e.length){if(!p0(i.segments,e)||!KS(i.segments,e,n))return!1;for(const r in t.children)if(!i.children[r]||!qB(i.children[r],t.children[r],n))return!1;return!0}{const r=e.slice(0,i.segments.length),o=e.slice(i.segments.length);return!!(p0(i.segments,r)&&KS(i.segments,r,n)&&i.children[Lr])&&XB(i.children[Lr],t,o,n)}}function KS(i,t,e){return t.every((n,r)=>jB[e](i[r].parameters,n.parameters))}class Rw{constructor(t=new us([],{}),e={},n=null){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=kw(this.queryParams)),this._queryParamMap}toString(){return rX.serialize(this)}}class us{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Object.values(e).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return JS(this)}}class mE{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=kw(this.parameters)),this._parameterMap}toString(){return KB(this)}}function p0(i,t){return i.length===t.length&&i.every((e,n)=>e.path===t[n].path)}let gE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:function(){return new bk},providedIn:"root"}),i})();class bk{parse(t){const e=new mX(t);return new Rw(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${_E(t.root,!0)}`,n=function aX(i){const t=Object.keys(i).map(e=>{const n=i[e];return Array.isArray(n)?n.map(r=>`${QS(e)}=${QS(r)}`).join("&"):`${QS(e)}=${QS(n)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${n}${"string"==typeof t.fragment?`#${function oX(i){return encodeURI(i)}(t.fragment)}`:""}`}}const rX=new bk;function JS(i){return i.segments.map(t=>KB(t)).join("/")}function _E(i,t){if(!i.hasChildren())return JS(i);if(t){const e=i.children[Lr]?_E(i.children[Lr],!1):"",n=[];return Object.entries(i.children).forEach(([r,o])=>{r!==Lr&&n.push(`${r}:${_E(o,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function nX(i,t){let e=[];return Object.entries(i.children).forEach(([n,r])=>{n===Lr&&(e=e.concat(t(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==Lr&&(e=e.concat(t(r,n)))}),e}(i,(n,r)=>r===Lr?[_E(i.children[Lr],!1)]:[`${r}:${_E(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[Lr]?`${JS(i)}/${e[0]}`:`${JS(i)}/(${e.join("//")})`}}function ZB(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function QS(i){return ZB(i).replace(/%3B/gi,";")}function xk(i){return ZB(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function eT(i){return decodeURIComponent(i)}function YB(i){return eT(i.replace(/\+/g,"%20"))}function KB(i){return`${xk(i.path)}${function sX(i){return Object.keys(i).map(t=>`;${xk(t)}=${xk(i[t])}`).join("")}(i.parameters)}`}const lX=/^[^\/()?;#]+/;function wk(i){const t=i.match(lX);return t?t[0]:""}const cX=/^[^\/()?;=#]+/,uX=/^[^=?&#]+/,pX=/^[^&#]+/;class mX{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new us([],{}):new us([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[Lr]=new us(t,e)),n}parseSegment(){const t=wk(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Ct(4009,!1);return this.capture(t),new mE(eT(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=function dX(i){const t=i.match(cX);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const r=wk(this.remaining);r&&(n=r,this.capture(n))}t[eT(e)]=eT(n)}parseQueryParam(t){const e=function hX(i){const t=i.match(uX);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const a=function fX(i){const t=i.match(pX);return t?t[0]:""}(this.remaining);a&&(n=a,this.capture(n))}const r=YB(e),o=YB(n);if(t.hasOwnProperty(r)){let a=t[r];Array.isArray(a)||(a=[a],t[r]=a),a.push(o)}else t[r]=o}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=wk(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Ct(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=Lr);const a=this.parseChildren();e[o]=1===Object.keys(a).length?a[Lr]:new us([],a),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Ct(4011,!1)}}function JB(i){return i.segments.length>0?new us([],{[Lr]:i}):i}function QB(i){const t={};for(const n of Object.keys(i.children)){const o=QB(i.children[n]);if(n===Lr&&0===o.segments.length&&o.hasChildren())for(const[a,u]of Object.entries(o.children))t[a]=u;else(o.segments.length>0||o.hasChildren())&&(t[n]=o)}return function gX(i){if(1===i.numberOfChildren&&i.children[Lr]){const t=i.children[Lr];return new us(i.segments.concat(t.segments),t.children)}return i}(new us(i.segments,t))}function f0(i){return i instanceof Rw}function e3(i){let t;const r=JB(function e(o){const a={};for(const f of o.children){const y=e(f);a[f.outlet]=y}const u=new us(o.url,a);return o===i&&(t=u),u}(i.root));return t??r}function t3(i,t,e,n){let r=i;for(;r.parent;)r=r.parent;if(0===t.length)return Mk(r,r,r,e,n);const o=function yX(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new n3(!0,0,i);let t=0,e=!1;const n=i.reduce((r,o,a)=>{if("object"==typeof o&&null!=o){if(o.outlets){const u={};return Object.entries(o.outlets).forEach(([f,y])=>{u[f]="string"==typeof y?y.split("/"):y}),[...r,{outlets:u}]}if(o.segmentPath)return[...r,o.segmentPath]}return"string"!=typeof o?[...r,o]:0===a?(o.split("/").forEach((u,f)=>{0==f&&"."===u||(0==f&&""===u?e=!0:".."===u?t++:""!=u&&r.push(u))}),r):[...r,o]},[]);return new n3(e,t,n)}(t);if(o.toRoot())return Mk(r,r,new us([],{}),e,n);const a=function vX(i,t,e){if(i.isAbsolute)return new iT(t,!0,0);if(!e)return new iT(t,!1,NaN);if(null===e.parent)return new iT(e,!0,0);const n=tT(i.commands[0])?0:1;return function bX(i,t,e){let n=i,r=t,o=e;for(;o>r;){if(o-=r,n=n.parent,!n)throw new Ct(4005,!1);r=n.segments.length}return new iT(n,!1,r-o)}(e,e.segments.length-1+n,i.numberOfDoubleDots)}(o,r,i),u=a.processChildren?vE(a.segmentGroup,a.index,o.commands):r3(a.segmentGroup,a.index,o.commands);return Mk(r,a.segmentGroup,u,e,n)}function tT(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function yE(i){return"object"==typeof i&&null!=i&&i.outlets}function Mk(i,t,e,n,r){let a,o={};n&&Object.entries(n).forEach(([f,y])=>{o[f]=Array.isArray(y)?y.map(M=>`${M}`):`${y}`}),a=i===t?e:i3(i,t,e);const u=JB(QB(a));return new Rw(u,o,r)}function i3(i,t,e){const n={};return Object.entries(i.children).forEach(([r,o])=>{n[r]=o===t?e:i3(o,t,e)}),new us(i.segments,n)}class n3{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&tT(n[0]))throw new Ct(4003,!1);const r=n.find(yE);if(r&&r!==GB(n))throw new Ct(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class iT{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function r3(i,t,e){if(i||(i=new us([],{})),0===i.segments.length&&i.hasChildren())return vE(i,t,e);const n=function wX(i,t,e){let n=0,r=t;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=e.length)return o;const a=i.segments[r],u=e[n];if(yE(u))break;const f=`${u}`,y=n<e.length-1?e[n+1]:null;if(r>0&&void 0===f)break;if(f&&y&&"object"==typeof y&&void 0===y.outlets){if(!s3(f,y,a))return o;n+=2}else{if(!s3(f,{},a))return o;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,t,e),r=e.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const o=new us(i.segments.slice(0,n.pathIndex),{});return o.children[Lr]=new us(i.segments.slice(n.pathIndex),i.children),vE(o,0,r)}return n.match&&0===r.length?new us(i.segments,{}):n.match&&!i.hasChildren()?Ek(i,t,e):n.match?vE(i,0,r):Ek(i,t,e)}function vE(i,t,e){if(0===e.length)return new us(i.segments,{});{const n=function xX(i){return yE(i[0])?i[0].outlets:{[Lr]:i}}(e),r={};if(!n[Lr]&&i.children[Lr]&&1===i.numberOfChildren&&0===i.children[Lr].segments.length){const o=vE(i.children[Lr],t,e);return new us(i.segments,o.children)}return Object.entries(n).forEach(([o,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(r[o]=r3(i.children[o],t,a))}),Object.entries(i.children).forEach(([o,a])=>{void 0===n[o]&&(r[o]=a)}),new us(i.segments,r)}}function Ek(i,t,e){const n=i.segments.slice(0,t);let r=0;for(;r<e.length;){const o=e[r];if(yE(o)){const f=MX(o.outlets);return new us(n,f)}if(0===r&&tT(e[0])){n.push(new mE(i.segments[t].path,o3(e[0]))),r++;continue}const a=yE(o)?o.outlets[Lr]:`${o}`,u=r<e.length-1?e[r+1]:null;a&&u&&tT(u)?(n.push(new mE(a,o3(u))),r+=2):(n.push(new mE(a,{})),r++)}return new us(n,{})}function MX(i){const t={};return Object.entries(i).forEach(([e,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(t[e]=Ek(new us([],{}),0,n))}),t}function o3(i){const t={};return Object.entries(i).forEach(([e,n])=>t[e]=`${n}`),t}function s3(i,t,e){return i==e.path&&lg(t,e.parameters)}const bE="imperative";class cg{constructor(t,e){this.id=t,this.url=e}}class Ck extends cg{constructor(t,e,n="imperative",r=null){super(t,e),this.type=0,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class m0 extends cg{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class nT extends cg{constructor(t,e,n,r){super(t,e),this.reason=n,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class xE extends cg{constructor(t,e,n,r){super(t,e),this.reason=n,this.code=r,this.type=16}}class Sk extends cg{constructor(t,e,n,r){super(t,e),this.error=n,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class EX extends cg{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class CX extends cg{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class SX extends cg{constructor(t,e,n,r,o){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class TX extends cg{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class AX extends cg{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class DX{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class IX{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class kX{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class RX{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class PX{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class LX{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class a3{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class FX{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new wE,this.attachRef=null}}let wE=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(e,n){const r=this.getOrCreateContext(e);r.outlet=n,this.contexts.set(e,r)}onChildOutletDestroyed(e){const n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new FX,this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class l3{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Tk(t,this._root);return e?e.children.map(n=>n.value):[]}firstChild(t){const e=Tk(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Ak(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return Ak(t,this._root).map(e=>e.value)}}function Tk(i,t){if(i===t.value)return t;for(const e of t.children){const n=Tk(i,e);if(n)return n}return null}function Ak(i,t){if(i===t.value)return[t];for(const e of t.children){const n=Ak(i,e);if(n.length)return n.unshift(t),n}return[]}class b_{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Pw(i){const t={};return i&&i.children.forEach(e=>t[e.value.outlet]=e),t}class c3 extends l3{constructor(t,e){super(t),this.snapshot=e,Dk(this,t)}toString(){return this.snapshot.toString()}}function d3(i,t){const e=function OX(i,t){const a=new rT([],{},{},"",{},Lr,t,null,{});return new h3("",new b_(a,[]))}(0,t),n=new ws([new mE("",{})]),r=new ws({}),o=new ws({}),a=new ws({}),u=new ws(""),f=new sv(n,r,a,u,o,Lr,t,e.root);return f.snapshot=e.root,new c3(new b_(f,[]),e)}class sv{constructor(t,e,n,r,o,a,u,f){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=o,this.outlet=a,this.component=u,this._futureSnapshot=f,this.title=this.dataSubject?.pipe(vn(y=>y[fE]))??Jt(void 0),this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(vn(t=>kw(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(vn(t=>kw(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function u3(i,t="emptyOnly"){const e=i.pathFromRoot;let n=0;if("always"!==t)for(n=e.length-1;n>=1;){const r=e[n],o=e[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(o.component)break;n--}}return function NX(i){return i.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(n))}class rT{get title(){return this.data?.[fE]}constructor(t,e,n,r,o,a,u,f,y){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=o,this.outlet=a,this.component=u,this.routeConfig=f,this._resolve=y}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=kw(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=kw(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class h3 extends l3{constructor(t,e){super(e),this.url=t,Dk(this,e)}toString(){return p3(this._root)}}function Dk(i,t){t.value._routerState=i,t.children.forEach(e=>Dk(i,e))}function p3(i){const t=i.children.length>0?` { ${i.children.map(p3).join(", ")} } `:"";return`${i.value}${t}`}function Ik(i){if(i.snapshot){const t=i.snapshot,e=i._futureSnapshot;i.snapshot=e,lg(t.queryParams,e.queryParams)||i.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&i.fragmentSubject.next(e.fragment),lg(t.params,e.params)||i.paramsSubject.next(e.params),function J7(i,t){if(i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(!lg(i[e],t[e]))return!1;return!0}(t.url,e.url)||i.urlSubject.next(e.url),lg(t.data,e.data)||i.dataSubject.next(e.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function kk(i,t){const e=lg(i.params,t.params)&&function iX(i,t){return p0(i,t)&&i.every((e,n)=>lg(e.parameters,t[n].parameters))}(i.url,t.url);return e&&!(!i.parent!=!t.parent)&&(!i.parent||kk(i.parent,t.parent))}let oT=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=Lr,this.activateEvents=new Mi,this.deactivateEvents=new Mi,this.attachEvents=new Mi,this.detachEvents=new Mi,this.parentContexts=mi(wE),this.location=mi(bu),this.changeDetector=mi(vs),this.environmentInjector=mi(fh),this.inputBinder=mi(sT,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){const{firstChange:n,previousValue:r}=e.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ct(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ct(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ct(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new Ct(4013,!1);this._activatedRoute=e;const r=this.location,a=e.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,f=new BX(e,u,r.injector);this.activated=r.createComponent(a,{index:r.length,injector:f,environmentInjector:n??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[le]}),i})();class BX{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===sv?this.route:t===wE?this.childContexts:this.parent.get(t,e)}}const sT=new Ot("");let f3=(()=>{class i{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:n}=e,r=qS([n.queryParams,n.params,n.data]).pipe(Co(([o,a,u],f)=>(u={...o,...a,...u},0===f?Jt(u):Promise.resolve(u)))).subscribe(o=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==n||null===n.component)return void this.unsubscribeFromRouteData(e);const a=function gq(i){const t=vr(i);if(!t)return null;const e=new _h(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(n.component);if(a)for(const{templateName:u}of a.inputs)e.activatedComponentRef.setInput(u,o[u]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,r)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();function ME(i,t,e){if(e&&i.shouldReuseRoute(t.value,e.value.snapshot)){const n=e.value;n._futureSnapshot=t.value;const r=function UX(i,t,e){return t.children.map(n=>{for(const r of e.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return ME(i,n,r);return ME(i,n)})}(i,t,e);return new b_(n,r)}{if(i.shouldAttach(t.value)){const o=i.retrieve(t.value);if(null!==o){const a=o.route;return a.value._futureSnapshot=t.value,a.children=t.children.map(u=>ME(i,u)),a}}const n=function VX(i){return new sv(new ws(i.url),new ws(i.params),new ws(i.queryParams),new ws(i.fragment),new ws(i.data),i.outlet,i.component,i)}(t.value),r=t.children.map(o=>ME(i,o));return new b_(n,r)}}const Rk="ngNavigationCancelingError";function m3(i,t){const{redirectTo:e,navigationBehaviorOptions:n}=f0(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=g3(!1,0,t);return r.url=e,r.navigationBehaviorOptions=n,r}function g3(i,t,e){const n=new Error("NavigationCancelingError: "+(i||""));return n[Rk]=!0,n.cancellationCode=t,e&&(n.url=e),n}function _3(i){return y3(i)&&f0(i.url)}function y3(i){return i&&i[Rk]}let v3=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ui({type:i,selectors:[["ng-component"]],standalone:!0,features:[tm],decls:1,vars:0,template:function(e,n){1&e&&En(0,"router-outlet")},dependencies:[oT],encapsulation:2}),i})();function Pk(i){const t=i.children&&i.children.map(Pk),e=t?{...i,children:t}:{...i};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Lr&&(e.component=v3),e}function om(i){return i.outlet||Lr}function EE(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let t=i.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class XX{constructor(t,e,n,r,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=o}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),Ik(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=Pw(e);t.children.forEach(o=>{const a=o.value.outlet;this.deactivateRoutes(o,r[a],n),delete r[a]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(t,e,n){const r=t.value,o=e?e.value:null;if(r===o)if(r.component){const a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(t,e,a.children)}else this.deactivateChildRoutes(t,e,n);else o&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet),r=n&&t.value.component?n.children:e,o=Pw(t);for(const a of Object.keys(o))this.deactivateRouteAndItsChildren(o[a],r);if(n&&n.outlet){const a=n.outlet.detach(),u=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:a,route:t,contexts:u})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),r=n&&t.value.component?n.children:e,o=Pw(t);for(const a of Object.keys(o))this.deactivateRouteAndItsChildren(o[a],r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(t,e,n){const r=Pw(e);t.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],n),this.forwardEvent(new LX(o.value.snapshot))}),t.children.length&&this.forwardEvent(new RX(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,o=e?e.value:null;if(Ik(r),r===o)if(r.component){const a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,a.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const a=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const u=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(u.contexts),a.attachRef=u.componentRef,a.route=u.route.value,a.outlet&&a.outlet.attach(u.componentRef,u.route.value),Ik(u.route.value),this.activateChildRoutes(t,null,a.children)}else{const u=EE(r.snapshot);a.attachRef=null,a.route=r,a.injector=u,a.outlet&&a.outlet.activateWith(r,a.injector),this.activateChildRoutes(t,null,a.children)}}else this.activateChildRoutes(t,null,n)}}class b3{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class aT{constructor(t,e){this.component=t,this.route=e}}function ZX(i,t,e){const n=i._root;return CE(n,t?t._root:null,e,[n.value])}function Lw(i,t){const e=Symbol(),n=t.get(i,e);return n===e?"function"!=typeof i||function yf(i){return null!==Oa(i)}(i)?t.get(i):i:n}function CE(i,t,e,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=Pw(t);return i.children.forEach(a=>{(function KX(i,t,e,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=i.value,a=t?t.value:null,u=e?e.getContext(i.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){const f=function JX(i,t,e){if("function"==typeof e)return e(i,t);switch(e){case"pathParamsChange":return!p0(i.url,t.url);case"pathParamsOrQueryParamsChange":return!p0(i.url,t.url)||!lg(i.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!kk(i,t)||!lg(i.queryParams,t.queryParams);default:return!kk(i,t)}}(a,o,o.routeConfig.runGuardsAndResolvers);f?r.canActivateChecks.push(new b3(n)):(o.data=a.data,o._resolvedData=a._resolvedData),CE(i,t,o.component?u?u.children:null:e,n,r),f&&u&&u.outlet&&u.outlet.isActivated&&r.canDeactivateChecks.push(new aT(u.outlet.component,a))}else a&&SE(t,u,r),r.canActivateChecks.push(new b3(n)),CE(i,null,o.component?u?u.children:null:e,n,r)})(a,o[a.value.outlet],e,n.concat([a.value]),r),delete o[a.value.outlet]}),Object.entries(o).forEach(([a,u])=>SE(u,e.getContext(a),r)),r}function SE(i,t,e){const n=Pw(i),r=i.value;Object.entries(n).forEach(([o,a])=>{SE(a,r.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new aT(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function TE(i){return"function"==typeof i}function x3(i){return i instanceof XS||"EmptyError"===i?.name}const lT=Symbol("INITIAL_VALUE");function Fw(){return Co(i=>qS(i.map(t=>t.pipe(ss(1),Oc(lT)))).pipe(vn(t=>{for(const e of t)if(!0!==e){if(e===lT)return lT;if(!1===e||e instanceof Rw)return e}return!0}),Ko(t=>t!==lT),ss(1)))}function w3(i){return function pr(...i){return Th(i)}(fc(t=>{if(f0(t))throw m3(0,t)}),vn(t=>!0===t))}class cT{constructor(t){this.segmentGroup=t||null}}class M3{constructor(t){this.urlTree=t}}function Ow(i){return Dw(new cT(i))}function E3(i){return Dw(new M3(i))}class yZ{constructor(t,e){this.urlSerializer=t,this.urlTree=e}noMatchError(t){return new Ct(4002,!1)}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Jt(n);if(r.numberOfChildren>1||!r.children[Lr])return Dw(new Ct(4e3,!1));r=r.children[Lr]}}applyRedirectCommands(t,e,n){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreateUrlTree(t,e,n,r){const o=this.createSegmentGroup(t,e.root,n,r);return new Rw(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Object.entries(t).forEach(([r,o])=>{if("string"==typeof o&&o.startsWith(":")){const u=o.substring(1);n[r]=e[u]}else n[r]=o}),n}createSegmentGroup(t,e,n,r){const o=this.createSegments(t,e.segments,n,r);let a={};return Object.entries(e.children).forEach(([u,f])=>{a[u]=this.createSegmentGroup(t,f,n,r)}),new us(o,a)}createSegments(t,e,n,r){return e.map(o=>o.path.startsWith(":")?this.findPosParam(t,o,r):this.findOrReturn(o,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Ct(4001,!1);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}const Lk={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function vZ(i,t,e,n,r){const o=Fk(i,t,e);return o.matched?(n=function HX(i,t){return i.providers&&!i._injector&&(i._injector=uI(i.providers,t,`Route: ${i.path}`)),i._injector??t}(t,n),function mZ(i,t,e,n){const r=t.canMatch;return r&&0!==r.length?Jt(r.map(a=>{const u=Lw(a,i);return ov(function rZ(i){return i&&TE(i.canMatch)}(u)?u.canMatch(t,e):i.runInContext(()=>u(t,e)))})).pipe(Fw(),w3()):Jt(!0)}(n,t,e).pipe(vn(a=>!0===a?o:{...Lk}))):Jt(o)}function Fk(i,t,e){if(""===t.path)return"full"===t.pathMatch&&(i.hasChildren()||e.length>0)?{...Lk}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(t.matcher||K7)(e,i,t);if(!r)return{...Lk};const o={};Object.entries(r.posParams??{}).forEach(([u,f])=>{o[u]=f.path});const a=r.consumed.length>0?{...o,...r.consumed[r.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:a,positionalParamSegments:r.posParams??{}}}function C3(i,t,e,n){return e.length>0&&function wZ(i,t,e){return e.some(n=>dT(i,t,n)&&om(n)!==Lr)}(i,e,n)?{segmentGroup:new us(t,xZ(n,new us(e,i.children))),slicedSegments:[]}:0===e.length&&function MZ(i,t,e){return e.some(n=>dT(i,t,n))}(i,e,n)?{segmentGroup:new us(i.segments,bZ(i,0,e,n,i.children)),slicedSegments:e}:{segmentGroup:new us(i.segments,i.children),slicedSegments:e}}function bZ(i,t,e,n,r){const o={};for(const a of n)if(dT(i,e,a)&&!r[om(a)]){const u=new us([],{});o[om(a)]=u}return{...r,...o}}function xZ(i,t){const e={};e[Lr]=t;for(const n of i)if(""===n.path&&om(n)!==Lr){const r=new us([],{});e[om(n)]=r}return e}function dT(i,t,e){return(!(i.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}class TZ{constructor(t,e,n,r,o,a,u){this.injector=t,this.configLoader=e,this.rootComponentType=n,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=a,this.urlSerializer=u,this.allowRedirects=!0,this.applyRedirects=new yZ(this.urlSerializer,this.urlTree)}noMatchError(t){return new Ct(4002,!1)}recognize(){const t=C3(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Lr).pipe(rv(e=>{if(e instanceof M3)return this.allowRedirects=!1,this.urlTree=e.urlTree,this.match(e.urlTree);throw e instanceof cT?this.noMatchError(e):e}),vn(e=>{const n=new rT([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Lr,this.rootComponentType,null,{}),r=new b_(n,e),o=new h3("",r),a=function _X(i,t,e=null,n=null){return t3(e3(i),t,e,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(o._root),{state:o,tree:a}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t.root,Lr).pipe(rv(n=>{throw n instanceof cT?this.noMatchError(n):n}))}inheritParamsAndData(t){const e=t.value,n=u3(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,e,n):this.processSegment(t,e,n,n.segments,r,!0)}processChildren(t,e,n){const r=[];for(const o of Object.keys(n.children))"primary"===o?r.unshift(o):r.push(o);return Zo(r).pipe(h0(o=>{const a=n.children[o],u=function $X(i,t){const e=i.filter(n=>om(n)===t);return e.push(...i.filter(n=>om(n)!==t)),e}(e,o);return this.processSegmentGroup(t,u,a,o)}),function X7(i,t){return to(function q7(i,t,e,n,r){return(o,a)=>{let u=e,f=t,y=0;o.subscribe(go(a,M=>{const A=y++;f=u?i(f,M,A):(u=!0,M),n&&a.next(f)},r&&(()=>{u&&a.next(f),a.complete()})))}}(i,t,arguments.length>=2,!0))}((o,a)=>(o.push(...a),o)),ZS(null),function Z7(i,t){const e=arguments.length>=2;return n=>n.pipe(i?Ko((r,o)=>i(r,o,n)):yc,vk(1),e?ZS(t):VB(()=>new XS))}(),Ms(o=>{if(null===o)return Ow(n);const a=S3(o);return function AZ(i){i.sort((t,e)=>t.value.outlet===Lr?-1:e.value.outlet===Lr?1:t.value.outlet.localeCompare(e.value.outlet))}(a),Jt(a)}))}processSegment(t,e,n,r,o,a){return Zo(e).pipe(h0(u=>this.processSegmentAgainstRoute(u._injector??t,e,u,n,r,o,a).pipe(rv(f=>{if(f instanceof cT)return Jt(null);throw f}))),u0(u=>!!u),rv(u=>{if(x3(u))return function CZ(i,t,e){return 0===t.length&&!i.children[e]}(n,r,o)?Jt([]):Ow(n);throw u}))}processSegmentAgainstRoute(t,e,n,r,o,a,u){return function EZ(i,t,e,n){return!!(om(i)===n||n!==Lr&&dT(t,e,i))&&("**"===i.path||Fk(t,i,e).matched)}(n,r,o,a)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(t,r,n,o,a,u):u&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,r,e,n,o,a):Ow(r):Ow(r)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,o,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,o,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const o=this.applyRedirects.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?E3(o):this.applyRedirects.lineralizeSegments(n,o).pipe(Ms(a=>{const u=new us(a,{});return this.processSegment(t,e,u,a,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,o,a){const{matched:u,consumedSegments:f,remainingSegments:y,positionalParamSegments:M}=Fk(e,r,o);if(!u)return Ow(e);const A=this.applyRedirects.applyRedirectCommands(f,r.redirectTo,M);return r.redirectTo.startsWith("/")?E3(A):this.applyRedirects.lineralizeSegments(r,A).pipe(Ms(I=>this.processSegment(t,n,e,I.concat(y),a,!1)))}matchSegmentAgainstRoute(t,e,n,r,o,a){let u;if("**"===n.path){const f=r.length>0?GB(r).parameters:{};u=Jt({snapshot:new rT(r,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,T3(n),om(n),n.component??n._loadedComponent??null,n,A3(n)),consumedSegments:[],remainingSegments:[]}),e.children={}}else u=vZ(e,n,r,t).pipe(vn(({matched:f,consumedSegments:y,remainingSegments:M,parameters:A})=>f?{snapshot:new rT(y,A,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,T3(n),om(n),n.component??n._loadedComponent??null,n,A3(n)),consumedSegments:y,remainingSegments:M}:null));return u.pipe(Co(f=>null===f?Ow(e):this.getChildConfig(t=n._injector??t,n,r).pipe(Co(({routes:y})=>{const M=n._loadedInjector??t,{snapshot:A,consumedSegments:I,remainingSegments:R}=f,{segmentGroup:O,slicedSegments:H}=C3(e,I,R,y);if(0===H.length&&O.hasChildren())return this.processChildren(M,y,O).pipe(vn(B=>null===B?null:[new b_(A,B)]));if(0===y.length&&0===H.length)return Jt([new b_(A,[])]);const U=om(n)===o;return this.processSegment(M,y,O,H,U?Lr:o,!0).pipe(vn(B=>[new b_(A,B)]))}))))}getChildConfig(t,e,n){return e.children?Jt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Jt({routes:e._loadedRoutes,injector:e._loadedInjector}):function fZ(i,t,e,n){const r=t.canLoad;return void 0===r||0===r.length?Jt(!0):Jt(r.map(a=>{const u=Lw(a,i);return ov(function eZ(i){return i&&TE(i.canLoad)}(u)?u.canLoad(t,e):i.runInContext(()=>u(t,e)))})).pipe(Fw(),w3())}(t,e,n).pipe(Ms(r=>r?this.configLoader.loadChildren(t,e).pipe(fc(o=>{e._loadedRoutes=o.routes,e._loadedInjector=o.injector})):function _Z(i){return Dw(g3(!1,3))}())):Jt({routes:[],injector:t})}}function DZ(i){const t=i.value.routeConfig;return t&&""===t.path}function S3(i){const t=[],e=new Set;for(const n of i){if(!DZ(n)){t.push(n);continue}const r=t.find(o=>n.value.routeConfig===o.value.routeConfig);void 0!==r?(r.children.push(...n.children),e.add(r)):t.push(n)}for(const n of e){const r=S3(n.children);t.push(new b_(n.value,r))}return t.filter(n=>!e.has(n))}function T3(i){return i.data||{}}function A3(i){return i.resolve||{}}function D3(i){return"string"==typeof i.title||null===i.title}function Ok(i){return Co(t=>{const e=i(t);return e?Zo(e).pipe(vn(()=>t)):Jt(t)})}const Nw=new Ot("ROUTES");let Nk=(()=>{class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=mi(lN)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Jt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const n=ov(e.loadComponent()).pipe(vn(I3),fc(o=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=o}),Iw(()=>{this.componentLoaders.delete(e)})),r=new UB(n,()=>new Fi).pipe(yk());return this.componentLoaders.set(e,r),r}loadChildren(e,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Jt({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const o=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe(vn(u=>{this.onLoadEndListener&&this.onLoadEndListener(n);let f,y;return Array.isArray(u)?y=u:(f=u.create(e).injector,y=f.get(Nw,[],xi.Self|xi.Optional).flat()),{routes:y.map(Pk),injector:f}}),Iw(()=>{this.childrenLoaders.delete(n)})),a=new UB(o,()=>new Fi).pipe(yk());return this.childrenLoaders.set(n,a),a}loadModuleFactoryOrRoutes(e){return ov(e()).pipe(vn(I3),Ms(n=>n instanceof vO||Array.isArray(n)?Jt(n):Zo(this.compiler.compileModuleAsync(n))))}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function I3(i){return function OZ(i){return i&&"object"==typeof i&&"default"in i}(i)?i.default:i}let uT=(()=>{class i{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Fi,this.configLoader=mi(Nk),this.environmentInjector=mi(fh),this.urlSerializer=mi(gE),this.rootContexts=mi(wE),this.inputBindingEnabled=null!==mi(sT,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Jt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new IX(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new DX(r))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:n})}setupNavigations(e){return this.transitions=new ws({id:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:bE,restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ko(n=>0!==n.id),vn(n=>({...n,extractedUrl:e.urlHandlingStrategy.extract(n.rawUrl)})),Co(n=>{let r=!1,o=!1;return Jt(n).pipe(fc(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Co(a=>{const u=e.browserUrlTree.toString(),f=!e.navigated||a.extractedUrl.toString()!==u||u!==e.currentUrlTree.toString();if(!f&&"reload"!==(a.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const M="";return this.events.next(new xE(a.id,e.serializeUrl(n.rawUrl),M,0)),e.rawUrlTree=a.rawUrl,a.resolve(null),Ql}if(e.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return k3(a.source)&&(e.browserUrlTree=a.extractedUrl),Jt(a).pipe(Co(M=>{const A=this.transitions?.getValue();return this.events.next(new Ck(M.id,this.urlSerializer.serialize(M.extractedUrl),M.source,M.restoredState)),A!==this.transitions?.getValue()?Ql:Promise.resolve(M)}),function IZ(i,t,e,n,r,o){return Ms(a=>function SZ(i,t,e,n,r,o,a="emptyOnly"){return new TZ(i,t,e,n,r,a,o).recognize()}(i,t,e,n,a.extractedUrl,r,o).pipe(vn(({state:u,tree:f})=>({...a,targetSnapshot:u,urlAfterRedirects:f}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),fc(M=>{if(n.targetSnapshot=M.targetSnapshot,n.urlAfterRedirects=M.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:M.urlAfterRedirects},"eager"===e.urlUpdateStrategy){if(!M.extras.skipLocationChange){const I=e.urlHandlingStrategy.merge(M.urlAfterRedirects,M.rawUrl);e.setBrowserUrl(I,M)}e.browserUrlTree=M.urlAfterRedirects}const A=new EX(M.id,this.urlSerializer.serialize(M.extractedUrl),this.urlSerializer.serialize(M.urlAfterRedirects),M.targetSnapshot);this.events.next(A)}));if(f&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:M,extractedUrl:A,source:I,restoredState:R,extras:O}=a,H=new Ck(M,this.urlSerializer.serialize(A),I,R);this.events.next(H);const U=d3(0,this.rootComponentType).snapshot;return Jt(n={...a,targetSnapshot:U,urlAfterRedirects:A,extras:{...O,skipLocationChange:!1,replaceUrl:!1}})}{const M="";return this.events.next(new xE(a.id,e.serializeUrl(n.extractedUrl),M,1)),e.rawUrlTree=a.rawUrl,a.resolve(null),Ql}}),fc(a=>{const u=new CX(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(u)}),vn(a=>n={...a,guards:ZX(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function sZ(i,t){return Ms(e=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:a}}=e;return 0===a.length&&0===o.length?Jt({...e,guardsResult:!0}):function aZ(i,t,e,n){return Zo(i).pipe(Ms(r=>function pZ(i,t,e,n,r){const o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?Jt(o.map(u=>{const f=EE(t)??r,y=Lw(u,f);return ov(function nZ(i){return i&&TE(i.canDeactivate)}(y)?y.canDeactivate(i,t,e,n):f.runInContext(()=>y(i,t,e,n))).pipe(u0())})).pipe(Fw()):Jt(!0)}(r.component,r.route,e,t,n)),u0(r=>!0!==r,!0))}(a,n,r,i).pipe(Ms(u=>u&&function QX(i){return"boolean"==typeof i}(u)?function lZ(i,t,e,n){return Zo(t).pipe(h0(r=>c0(function dZ(i,t){return null!==i&&t&&t(new kX(i)),Jt(!0)}(r.route.parent,n),function cZ(i,t){return null!==i&&t&&t(new PX(i)),Jt(!0)}(r.route,n),function hZ(i,t,e){const n=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(a=>function YX(i){const t=i.routeConfig?i.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:i,guards:t}:null}(a)).filter(a=>null!==a).map(a=>d0(()=>Jt(a.guards.map(f=>{const y=EE(a.node)??e,M=Lw(f,y);return ov(function iZ(i){return i&&TE(i.canActivateChild)}(M)?M.canActivateChild(n,i):y.runInContext(()=>M(n,i))).pipe(u0())})).pipe(Fw())));return Jt(o).pipe(Fw())}(i,r.path,e),function uZ(i,t,e){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return Jt(!0);const r=n.map(o=>d0(()=>{const a=EE(t)??e,u=Lw(o,a);return ov(function tZ(i){return i&&TE(i.canActivate)}(u)?u.canActivate(t,i):a.runInContext(()=>u(t,i))).pipe(u0())}));return Jt(r).pipe(Fw())}(i,r.route,e))),u0(r=>!0!==r,!0))}(n,o,i,t):Jt(u)),vn(u=>({...e,guardsResult:u})))})}(this.environmentInjector,a=>this.events.next(a)),fc(a=>{if(n.guardsResult=a.guardsResult,f0(a.guardsResult))throw m3(0,a.guardsResult);const u=new SX(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(u)}),Ko(a=>!!a.guardsResult||(e.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),Ok(a=>{if(a.guards.canActivateChecks.length)return Jt(a).pipe(fc(u=>{const f=new TX(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}),Co(u=>{let f=!1;return Jt(u).pipe(function kZ(i,t){return Ms(e=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=e;if(!r.length)return Jt(e);let o=0;return Zo(r).pipe(h0(a=>function RZ(i,t,e,n){const r=i.routeConfig,o=i._resolve;return void 0!==r?.title&&!D3(r)&&(o[fE]=r.title),function PZ(i,t,e,n){const r=function LZ(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===r.length)return Jt({});const o={};return Zo(r).pipe(Ms(a=>function FZ(i,t,e,n){const r=EE(t)??n,o=Lw(i,r);return ov(o.resolve?o.resolve(t,e):r.runInContext(()=>o(t,e)))}(i[a],t,e,n).pipe(u0(),fc(u=>{o[a]=u}))),vk(1),YS(o),rv(a=>x3(a)?Ql:Dw(a)))}(o,i,t,n).pipe(vn(a=>(i._resolvedData=a,i.data=u3(i,e).resolve,r&&D3(r)&&(i.data[fE]=r.title),null)))}(a.route,n,i,t)),fc(()=>o++),vk(1),Ms(a=>o===r.length?Jt(e):Ql))})}(e.paramsInheritanceStrategy,this.environmentInjector),fc({next:()=>f=!0,complete:()=>{f||(e.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),fc(u=>{const f=new AX(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}))}),Ok(a=>{const u=f=>{const y=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&y.push(this.configLoader.loadComponent(f.routeConfig).pipe(fc(M=>{f.component=M}),vn(()=>{})));for(const M of f.children)y.push(...u(M));return y};return qS(u(a.targetSnapshot.root)).pipe(ZS(),ss(1))}),Ok(()=>this.afterPreactivation()),vn(a=>{const u=function zX(i,t,e){const n=ME(i,t._root,e?e._root:void 0);return new c3(n,t)}(e.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return n={...a,targetRouterState:u}}),fc(a=>{e.currentUrlTree=a.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),e.routerState=a.targetRouterState,"deferred"===e.urlUpdateStrategy&&(a.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,a),e.browserUrlTree=a.urlAfterRedirects)}),((i,t,e,n)=>vn(r=>(new XX(t,r.targetRouterState,r.currentRouterState,e,n).activate(i),r)))(this.rootContexts,e.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),ss(1),fc({next:a=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new m0(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{r=!0}}),Iw(()=>{r||o||this.cancelNavigationTransition(n,"",1),this.currentNavigation?.id===n.id&&(this.currentNavigation=null)}),rv(a=>{if(o=!0,y3(a)){_3(a)||(e.navigated=!0,e.restoreHistory(n,!0));const u=new nT(n.id,this.urlSerializer.serialize(n.extractedUrl),a.message,a.cancellationCode);if(this.events.next(u),_3(a)){const f=e.urlHandlingStrategy.merge(a.url,e.rawUrlTree),y={skipLocationChange:n.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||k3(n.source)};e.scheduleNavigation(f,bE,null,y,{resolve:n.resolve,reject:n.reject,promise:n.promise})}else n.resolve(!1)}else{e.restoreHistory(n,!0);const u=new Sk(n.id,this.urlSerializer.serialize(n.extractedUrl),a,n.targetSnapshot??void 0);this.events.next(u);try{n.resolve(e.errorHandler(a))}catch(f){n.reject(f)}}return Ql}))}))}cancelNavigationTransition(e,n,r){const o=new nT(e.id,this.urlSerializer.serialize(e.extractedUrl),n,r);this.events.next(o),e.resolve(!1)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function k3(i){return i!==bE}let R3=(()=>{class i{buildTitle(e){let n,r=e.root;for(;void 0!==r;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(o=>o.outlet===Lr);return n}getResolvedTitleForRoute(e){return e.data[fE]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:function(){return mi(NZ)},providedIn:"root"}),i})(),NZ=(()=>{class i extends R3{constructor(e){super(),this.title=e}updateTitle(e){const n=this.buildTitle(e);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(e){return new(e||i)(it(RB))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),BZ=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:function(){return mi(UZ)},providedIn:"root"}),i})();class zZ{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let UZ=(()=>{class i extends zZ{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const hT=new Ot("",{providedIn:"root",factory:()=>({})});let VZ=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:function(){return mi(HZ)},providedIn:"root"}),i})(),HZ=(()=>{class i{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var dp=(()=>((dp=dp||{})[dp.COMPLETE=0]="COMPLETE",dp[dp.FAILED=1]="FAILED",dp[dp.REDIRECTING=2]="REDIRECTING",dp))();function P3(i,t){i.events.pipe(Ko(e=>e instanceof m0||e instanceof nT||e instanceof Sk||e instanceof xE),vn(e=>e instanceof m0||e instanceof xE?dp.COMPLETE:e instanceof nT&&(0===e.code||1===e.code)?dp.REDIRECTING:dp.FAILED),Ko(e=>e!==dp.REDIRECTING),ss(1)).subscribe(()=>{t()})}function GZ(i){throw i}function jZ(i,t,e){return t.parse("/")}const WZ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},$Z={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Mu=(()=>{class i{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=mi(aN),this.isNgZoneEnabled=!1,this.options=mi(hT,{optional:!0})||{},this.pendingTasks=mi(AS),this.errorHandler=this.options.errorHandler||GZ,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||jZ,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=mi(VZ),this.routeReuseStrategy=mi(BZ),this.titleStrategy=mi(R3),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=mi(Nw,{optional:!0})?.flat()??[],this.navigationTransitions=mi(uT),this.urlSerializer=mi(gE),this.location=mi(s0),this.componentInputBindingEnabled=!!mi(sT,{optional:!0}),this.isNgZoneEnabled=mi(Ji)instanceof Ji&&Ji.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Rw,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=d3(0,null),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId??0},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),bE,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const n="popstate"===e.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,n,e.state)},0)}))}navigateToSyncWithBrowser(e,n,r){const o={replaceUrl:!0},a=r?.navigationId?r:null;if(r){const f={...r};delete f.navigationId,delete f.\u0275routerPageId,0!==Object.keys(f).length&&(o.state=f)}const u=this.parseUrl(e);this.scheduleNavigation(u,n,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(Pk),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,n={}){const{relativeTo:r,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:f}=n,y=f?this.currentUrlTree.fragment:a;let A,M=null;switch(u){case"merge":M={...this.currentUrlTree.queryParams,...o};break;case"preserve":M=this.currentUrlTree.queryParams;break;default:M=o||null}null!==M&&(M=this.removeEmptyProps(M));try{A=e3(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||!e[0].startsWith("/"))&&(e=[]),A=this.currentUrlTree.root}return t3(A,e,M,y??null)}navigateByUrl(e,n={skipLocationChange:!1}){const r=f0(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,bE,null,n)}navigate(e,n={skipLocationChange:!1}){return function qZ(i){for(let t=0;t<i.length;t++)if(null==i[t])throw new Ct(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let n;try{n=this.urlSerializer.parse(e)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return n}isActive(e,n){let r;if(r=!0===n?{...WZ}:!1===n?{...$Z}:n,f0(e))return WB(this.currentUrlTree,e,r);const o=this.parseUrl(e);return WB(this.currentUrlTree,o,r)}removeEmptyProps(e){return Object.keys(e).reduce((n,r)=>{const o=e[r];return null!=o&&(n[r]=o),n},{})}scheduleNavigation(e,n,r,o,a){if(this.disposed)return Promise.resolve(!1);let u,f,y;a?(u=a.resolve,f=a.reject,y=a.promise):y=new Promise((A,I)=>{u=A,f=I});const M=this.pendingTasks.add();return P3(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(M))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:o,resolve:u,reject:f,promise:y,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),y.catch(A=>Promise.reject(A))}setBrowserUrl(e,n){const r=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl){const a={...n.extras.state,...this.generateNgRouterState(n.id,this.browserPageId)};this.location.replaceState(r,"",a)}else{const o={...n.extras.state,...this.generateNgRouterState(n.id,(this.browserPageId??0)+1)};this.location.go(r,"",o)}}restoreHistory(e,n=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-(this.browserPageId??this.currentPageId);0!==o?this.location.historyGo(o):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===o&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,n){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class L3{}let YZ=(()=>{class i{constructor(e,n,r,o,a){this.router=e,this.injector=r,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Ko(e=>e instanceof m0),h0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){const r=[];for(const o of n){o.providers&&!o._injector&&(o._injector=uI(o.providers,e,`Route: ${o.path}`));const a=o._injector??e,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&r.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&r.push(this.processRoutes(u,o.children??o._loadedRoutes))}return Zo(r).pipe(yd())}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>{let r;r=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(e,n):Jt(null);const o=r.pipe(Ms(a=>null===a?Jt(void 0):(n._loadedRoutes=a.routes,n._loadedInjector=a.injector,this.processRoutes(a.injector??e,a.routes))));return n.loadComponent&&!n._loadedComponent?Zo([o,this.loader.loadComponent(n)]).pipe(yd()):o})}}return i.\u0275fac=function(e){return new(e||i)(it(Mu),it(lN),it(fh),it(L3),it(Nk))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const zk=new Ot("");let F3=(()=>{class i{constructor(e,n,r,o,a={}){this.urlSerializer=e,this.transitions=n,this.viewportScroller=r,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Ck?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof m0?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof xE&&0===e.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof a3&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new a3(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return i.\u0275fac=function(e){lp()},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();function x_(i,t){return{\u0275kind:i,\u0275providers:t}}function N3(){const i=mi(vl);return t=>{const e=i.get(ev);if(t!==e.components[0])return;const n=i.get(Mu),r=i.get(B3);1===i.get(Uk)&&n.initialNavigation(),i.get(z3,null,xi.Optional)?.setUpPreloading(),i.get(zk,null,xi.Optional)?.init(),n.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const B3=new Ot("",{factory:()=>new Fi}),Uk=new Ot("",{providedIn:"root",factory:()=>1}),z3=new Ot("");function eY(i){return x_(0,[{provide:z3,useExisting:YZ},{provide:L3,useExisting:i}])}const U3=new Ot("ROUTER_FORROOT_GUARD"),iY=[s0,{provide:gE,useClass:bk},Mu,wE,{provide:sv,useFactory:function O3(i){return i.routerState.root},deps:[Mu]},Nk,[]];function nY(){return new vN("Router",Mu)}let Vk=(()=>{class i{constructor(e){}static forRoot(e,n){return{ngModule:i,providers:[iY,[],{provide:Nw,multi:!0,useValue:e},{provide:U3,useFactory:aY,deps:[[Mu,new Id,new Qh]]},{provide:hT,useValue:n||{}},n?.useHash?{provide:o0,useClass:xq}:{provide:o0,useClass:qN},{provide:zk,useFactory:()=>{const i=mi(N9),t=mi(Ji),e=mi(hT),n=mi(uT),r=mi(gE);return e.scrollOffset&&i.setOffset(e.scrollOffset),new F3(r,n,i,t,e)}},n?.preloadingStrategy?eY(n.preloadingStrategy).\u0275providers:[],{provide:vN,multi:!0,useFactory:nY},n?.initialNavigation?lY(n):[],n?.bindToComponentInputs?x_(8,[f3,{provide:sT,useExisting:f3}]).\u0275providers:[],[{provide:V3,useFactory:N3},{provide:LI,multi:!0,useExisting:V3}]]}}static forChild(e){return{ngModule:i,providers:[{provide:Nw,multi:!0,useValue:e}]}}}return i.\u0275fac=function(e){return new(e||i)(it(U3,8))},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})();function aY(i){return"guarded"}function lY(i){return["disabled"===i.initialNavigation?x_(3,[{provide:SI,multi:!0,useFactory:()=>{const t=mi(Mu);return()=>{t.setUpLocationChangeListener()}}},{provide:Uk,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?x_(2,[{provide:Uk,useValue:0},{provide:SI,multi:!0,deps:[vl],useFactory:t=>{const e=t.get(vq,Promise.resolve());return()=>e.then(()=>new Promise(n=>{const r=t.get(Mu),o=t.get(B3);P3(r,()=>{n(!0)}),t.get(uT).afterPreactivation=()=>(n(!0),o.closed?Jt(void 0):o),r.initialNavigation()}))}}]).\u0275providers:[]]}const V3=new Ot("");let Hk;try{Hk=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Hk=!1}let Bw,Js=(()=>{class i{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function O9(i){return i===hB}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!Hk)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(e){return new(e||i)(it(cc))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const H3=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function G3(){if(Bw)return Bw;if("object"!=typeof document||!document)return Bw=new Set(H3),Bw;let i=document.createElement("input");return Bw=new Set(H3.filter(t=>(i.setAttribute("type",t),i.type===t))),Bw}let AE,pT,g0,Gk;function w_(i){return function dY(){if(null==AE&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>AE=!0}))}finally{AE=AE||!1}return AE}()?i:!!i.capture}function j3(){if(null==g0){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return g0=!1,g0;if("scrollBehavior"in document.documentElement.style)g0=!0;else{const i=Element.prototype.scrollTo;g0=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return g0}function DE(){if("object"!=typeof document||!document)return 0;if(null==pT){const i=document.createElement("div"),t=i.style;i.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";const e=document.createElement("div"),n=e.style;n.width="2px",n.height="1px",i.appendChild(e),document.body.appendChild(i),pT=0,0===i.scrollLeft&&(i.scrollLeft=1,pT=0===i.scrollLeft?1:2),i.remove()}return pT}function zw(){let i=typeof document<"u"&&document?document.activeElement:null;for(;i&&i.shadowRoot;){const t=i.shadowRoot.activeElement;if(t===i)break;i=t}return i}function av(i){return i.composedPath?i.composedPath()[0]:i.target}function jk(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Nc(i,...t){return t.length?t.some(e=>i[e]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}class wY extends gt{constructor(t,e){super()}schedule(t,e=0){return this}}const gT={setInterval(i,t,...e){const{delegate:n}=gT;return n?.setInterval?n.setInterval(i,t,...e):setInterval(i,t,...e)},clearInterval(i){const{delegate:t}=gT;return(t?.clearInterval||clearInterval)(i)},delegate:void 0};class Xk extends wY{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var n;if(this.closed)return this;this.state=t;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,e),this}requestAsyncId(t,e,n=0){return gT.setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return e;null!=e&&gT.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,n=!1;try{this.work(t)}catch(o){n=!0,r=o||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,g(n,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const Zk={now:()=>(Zk.delegate||Date).now(),delegate:void 0};class RE{constructor(t,e=RE.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,n){return new this.schedulerActionCtor(this,t).schedule(n,e)}}RE.now=Zk.now;class Yk extends RE{constructor(t,e=RE.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let n;this._active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const _T=new Yk(Xk),MY=_T;function yT(i,t=_T){return to((e,n)=>{let r=null,o=null,a=null;const u=()=>{if(r){r.unsubscribe(),r=null;const y=o;o=null,n.next(y)}};function f(){const y=a+i,M=t.now();if(M<y)return r=this.schedule(void 0,y-M),void n.add(r);u()}e.subscribe(go(n,y=>{o=y,a=t.now(),r||(r=t.schedule(f,i),n.add(r))},()=>{u(),n.complete()},void 0,()=>{o=r=null}))})}function W3(i){return Ko((t,e)=>i<=e)}function oo(i){return to((t,e)=>{Tr(i).subscribe(go(e,()=>e.complete(),Yl)),!e.closed&&t.subscribe(e)})}function dn(i){return null!=i&&"false"!=`${i}`}function dv(i,t=0){return function EY(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):t}function vT(i){return Array.isArray(i)?i:[i]}function jl(i){return null==i?"":"string"==typeof i?i:`${i}px`}function C_(i){return i instanceof tn?i.nativeElement:i}let $3=(()=>{class i{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),SY=(()=>{class i{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,n)=>this._cleanupObserver(n))}observe(e){const n=C_(e);return new Cn(r=>{const a=this._observeElement(n).subscribe(r);return()=>{a.unsubscribe(),this._unobserveElement(n)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const n=new Fi,r=this._mutationObserverFactory.create(o=>n.next(o));r&&r.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:r,stream:n,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:n,stream:r}=this._observedElements.get(e);n&&n.disconnect(),r.complete(),this._observedElements.delete(e)}}}return i.\u0275fac=function(e){return new(e||i)(it($3))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),q3=(()=>{class i{get disabled(){return this._disabled}set disabled(e){this._disabled=dn(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=dv(e),this._subscribe()}constructor(e,n,r){this._contentObserver=e,this._elementRef=n,this._ngZone=r,this.event=new Mi,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(yT(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(oe(SY),oe(tn),oe(Ji))},i.\u0275dir=si({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),i})(),Kk=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[$3]}),i})();const X3=new Set;let y0,TY=(()=>{class i{constructor(e,n){this._platform=e,this._nonce=n,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):DY}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function AY(i,t){if(!X3.has(i))try{y0||(y0=document.createElement("style"),t&&(y0.nonce=t),y0.setAttribute("type","text/css"),document.head.appendChild(y0)),y0.sheet&&(y0.sheet.insertRule(`@media ${i} {body{ }}`,0),X3.add(i))}catch(e){console.error(e)}}(e,this._nonce),this._matchMedia(e)}}return i.\u0275fac=function(e){return new(e||i)(it(Js),it(Qm,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function DY(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let IY=(()=>{class i{constructor(e,n){this._mediaMatcher=e,this._zone=n,this._queries=new Map,this._destroySubject=new Fi}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return Z3(vT(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let o=qS(Z3(vT(e)).map(a=>this._registerQuery(a).observable));return o=c0(o.pipe(ss(1)),o.pipe(W3(1),yT(0))),o.pipe(vn(a=>{const u={matches:!1,breakpoints:{}};return a.forEach(({matches:f,query:y})=>{u.matches=u.matches||f,u.breakpoints[y]=f}),u}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const n=this._mediaMatcher.matchMedia(e),o={observable:new Cn(a=>{const u=f=>this._zone.run(()=>a.next(f));return n.addListener(u),()=>{n.removeListener(u)}}).pipe(Oc(n),vn(({matches:a})=>({query:e,matches:a})),oo(this._destroySubject)),mql:n};return this._queries.set(e,o),o}}return i.\u0275fac=function(e){return new(e||i)(it(TY),it(Ji))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Z3(i){return i.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}function K3(i,t,e){const r=J3(i,t).filter(o=>o!=e.trim());r.length?i.setAttribute(t,r.join(" ")):i.removeAttribute(t)}function J3(i,t){return(i.getAttribute(t)||"").match(/\S+/g)||[]}class Q3{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Fi,this._typeaheadSubscription=gt.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=e=>e.disabled,this._pressedLetters=[],this.tabOut=new Fi,this.change=new Fi,t instanceof Jy&&(this._itemChangesSubscription=t.changes.subscribe(e=>{if(this._activeItem){const r=e.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(fc(e=>this._pressedLetters.push(e)),yT(t),Ko(()=>this._pressedLetters.length>0),vn(()=>this._pressedLetters.join(""))).subscribe(e=>{const n=this._getItemsArray();for(let r=1;r<n.length+1;r++){const o=(this._activeItemIndex+r)%n.length,a=n[o];if(!this._skipPredicateFn(a)&&0===a.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(o);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}withPageUpDown(t=!0,e=10){return this._pageUpAndDown={enabled:t,delta:e},this}setActiveItem(t){const e=this._activeItem;this.updateActiveItem(t),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(o=>!t[o]||this._allowedModifierKeys.indexOf(o)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const o=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(o>0?o:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const o=this._activeItemIndex+this._pageUpAndDown.delta,a=this._getItemsArray().length;this._setActiveItemByIndex(o<a?o:a-1,-1);break}return;default:return void((r||Nc(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),n="number"==typeof t?t:e.indexOf(t);this._activeItem=e[n]??null,this._activeItemIndex=n}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let n=1;n<=e.length;n++){const r=(this._activeItemIndex+t*n+e.length)%e.length;if(!this._skipPredicateFn(e[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(!n[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof Jy?this._items.toArray():this._items}}class LY extends Q3{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}class Jk extends Q3{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}}let PE=(()=>{class i{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function OY(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const n=function FY(i){try{return i.frameElement}catch{return null}}(function jY(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(e));if(n&&(-1===tz(n)||!this.isVisible(n)))return!1;let r=e.nodeName.toLowerCase(),o=tz(e);return e.hasAttribute("contenteditable")?-1!==o:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function HY(i){let t=i.nodeName.toLowerCase(),e="input"===t&&i.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===r?!!e.hasAttribute("controls")&&-1!==o:"video"===r?-1!==o&&(null!==o||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,n){return function GY(i){return!function BY(i){return function UY(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function NY(i){let t=i.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(i)||function zY(i){return function VY(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||ez(i))}(e)&&!this.isDisabled(e)&&(n?.ignoreVisibility||this.isVisible(e))}}return i.\u0275fac=function(e){return new(e||i)(it(Js))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function ez(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let t=i.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function tz(i){if(!ez(i))return null;const t=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class WY{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,e,n,r,o=!1){this._element=t,this._checker=e,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,o||this.attachAnchors()}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const n=this._getFirstTabbableElement(e);return n?.focus(t),!!n}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=0;n<e.length;n++){const r=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(r)return r}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=e.length-1;n>=0;n--){const r=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(r)return r}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(ss(1)).subscribe(t)}}let LE=(()=>{class i{constructor(e,n,r){this._checker=e,this._ngZone=n,this._document=r}create(e,n=!1){return new WY(e,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(e){return new(e||i)(it(PE),it(Ji),it(lr))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),$Y=(()=>{class i{get enabled(){return this.focusTrap.enabled}set enabled(e){this.focusTrap.enabled=dn(e)}get autoCapture(){return this._autoCapture}set autoCapture(e){this._autoCapture=dn(e)}constructor(e,n,r){this._elementRef=e,this._focusTrapFactory=n,this._previouslyFocusedElement=null,this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0)}ngOnDestroy(){this.focusTrap.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap.hasAttached()||this.focusTrap.attachAnchors()}ngOnChanges(e){const n=e.autoCapture;n&&!n.firstChange&&this.autoCapture&&this.focusTrap.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=zw(),this.focusTrap.focusInitialElementWhenReady()}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(LE),oe(lr))},i.\u0275dir=si({type:i,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:["cdkTrapFocus","enabled"],autoCapture:["cdkTrapFocusAutoCapture","autoCapture"]},exportAs:["cdkTrapFocus"],features:[le]}),i})();function Qk(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function eR(i){const t=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const qY=new Ot("cdk-input-modality-detector-options"),XY={ignoreKeys:[18,17,224,91,16]},Uw=w_({passive:!0,capture:!0});let ZY=(()=>{class i{get mostRecentModality(){return this._modality.value}constructor(e,n,r,o){this._platform=e,this._mostRecentTarget=null,this._modality=new ws(null),this._lastTouchMs=0,this._onKeydown=a=>{this._options?.ignoreKeys?.some(u=>u===a.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=av(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<650||(this._modality.next(Qk(a)?"keyboard":"mouse"),this._mostRecentTarget=av(a))},this._onTouchstart=a=>{eR(a)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=av(a))},this._options={...XY,...o},this.modalityDetected=this._modality.pipe(W3(1)),this.modalityChanged=this.modalityDetected.pipe(Jn()),e.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Uw),r.addEventListener("mousedown",this._onMousedown,Uw),r.addEventListener("touchstart",this._onTouchstart,Uw)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Uw),document.removeEventListener("mousedown",this._onMousedown,Uw),document.removeEventListener("touchstart",this._onTouchstart,Uw))}}return i.\u0275fac=function(e){return new(e||i)(it(Js),it(Ji),it(lr),it(qY,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const YY=new Ot("liveAnnouncerElement",{providedIn:"root",factory:function KY(){return null}}),JY=new Ot("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let QY=0,eK=(()=>{class i{constructor(e,n,r,o){this._ngZone=n,this._defaultOptions=o,this._document=r,this._liveElement=e||this._createLiveElement()}announce(e,...n){const r=this._defaultOptions;let o,a;return 1===n.length&&"number"==typeof n[0]?a=n[0]:[o,a]=n,this.clear(),clearTimeout(this._previousTimeout),o||(o=r&&r.politeness?r.politeness:"polite"),null==a&&r&&(a=r.duration),this._liveElement.setAttribute("aria-live",o),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(u=>this._currentResolve=u)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,"number"==typeof a&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",n=this._document.getElementsByClassName(e),r=this._document.createElement("div");for(let o=0;o<n.length;o++)n[o].remove();return r.classList.add(e),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id="cdk-live-announcer-"+QY++,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(e){const n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<n.length;r++){const o=n[r],a=o.getAttribute("aria-owns");a?-1===a.indexOf(e)&&o.setAttribute("aria-owns",a+" "+e):o.setAttribute("aria-owns",e)}}}return i.\u0275fac=function(e){return new(e||i)(it(YY,8),it(Ji),it(lr),it(JY,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const tK=new Ot("cdk-focus-monitor-default-options"),bT=w_({passive:!0,capture:!0});let dg=(()=>{class i{constructor(e,n,r,o,a){this._ngZone=e,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Fi,this._rootNodeFocusAndBlurListener=u=>{for(let y=av(u);y;y=y.parentElement)"focus"===u.type?this._onFocus(u,y):this._onBlur(u,y)},this._document=o,this._detectionMode=a?.detectionMode||0}monitor(e,n=!1){const r=C_(e);if(!this._platform.isBrowser||1!==r.nodeType)return Jt();const o=function hY(i){if(function uY(){if(null==Gk){const i=typeof document<"u"?document.head:null;Gk=!(!i||!i.createShadowRoot&&!i.attachShadow)}return Gk}()){const t=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(r)||this._getDocument(),a=this._elementInfo.get(r);if(a)return n&&(a.checkChildren=!0),a.subject;const u={checkChildren:n,subject:new Fi,rootNode:o};return this._elementInfo.set(r,u),this._registerGlobalListeners(u),u.subject}stopMonitoring(e){const n=C_(e),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(e,n,r){const o=C_(e);o===this._getDocument().activeElement?this._getClosestElementsInfo(o).forEach(([u,f])=>this._originChanged(u,n,f)):(this._setOrigin(n),"function"==typeof o.focus&&o.focus(r))}ngOnDestroy(){this._elementInfo.forEach((e,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,n){e.classList.toggle("cdk-focused",!!n),e.classList.toggle("cdk-touch-focused","touch"===n),e.classList.toggle("cdk-keyboard-focused","keyboard"===n),e.classList.toggle("cdk-mouse-focused","mouse"===n),e.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(e,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,n){const r=this._elementInfo.get(n),o=av(e);!r||!r.checkChildren&&n!==o||this._originChanged(n,this._getFocusOrigin(o),r)}_onBlur(e,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&e.relatedTarget instanceof Node&&n.contains(e.relatedTarget)||(this._setClasses(n),this._emitOrigin(r,null))}_emitOrigin(e,n){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(n))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const n=e.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,bT),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,bT)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(oo(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(e){const n=e.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,bT),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,bT),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,n,r){this._setClasses(e,n),this._emitOrigin(r,n),this._lastFocusOrigin=n}_getClosestElementsInfo(e){const n=[];return this._elementInfo.forEach((r,o)=>{(o===e||r.checkChildren&&o.contains(e))&&n.push([o,r])}),n}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:n,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!n||n===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const o=e.labels;if(o)for(let a=0;a<o.length;a++)if(o[a].contains(n))return!0;return!1}}return i.\u0275fac=function(e){return new(e||i)(it(Ji),it(Js),it(ZY),it(lr,8),it(tK,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),iK=(()=>{class i{constructor(e,n){this._elementRef=e,this._focusMonitor=n,this._focusOrigin=null,this.cdkFocusChange=new Mi}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,1===e.nodeType&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>{this._focusOrigin=n,this.cdkFocusChange.emit(n)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(dg))},i.\u0275dir=si({type:i,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]}),i})();const nz="cdk-high-contrast-black-on-white",rz="cdk-high-contrast-white-on-black",tR="cdk-high-contrast-active";let oz=(()=>{class i{constructor(e,n){this._platform=e,this._document=n,this._breakpointSubscription=mi(IY).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(e):null,o=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(tR,nz,rz),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?e.add(tR,nz):2===n&&e.add(tR,rz)}}}return i.\u0275fac=function(e){return new(e||i)(it(Js),it(lr))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),sz=(()=>{class i{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(e){return new(e||i)(it(oz))},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[Kk]}),i})();const nK=new Ot("cdk-dir-doc",{providedIn:"root",factory:function rK(){return mi(lr)}}),oK=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Cu=(()=>{class i{constructor(e){this.value="ltr",this.change=new Mi,e&&(this.value=function sK(i){const t=i?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?oK.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(e){return new(e||i)(it(nK,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),FE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})();const aK=["text"];function lK(i,t){if(1&i&&En(0,"mat-pseudo-checkbox",6),2&i){const e=ln();Vt("disabled",e.disabled)("state",e.selected?"checked":"unchecked")}}function cK(i,t){1&i&&En(0,"mat-pseudo-checkbox",7),2&i&&Vt("disabled",ln().disabled)}function dK(i,t){if(1&i&&(rt(0,"span",8),sn(1),mt()),2&i){const e=ln();ft(1),__("(",e.group.label,")")}}const uK=[[["mat-icon"]],"*"],hK=["mat-icon","*"],fK=new Ot("mat-sanity-checks",{providedIn:"root",factory:function pK(){return!0}});let $o=(()=>{class i{constructor(e,n,r){this._sanityChecks=n,this._document=r,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!jk()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return i.\u0275fac=function(e){return new(e||i)(it(oz),it(fK,8),it(lr))},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[FE,FE]}),i})();function OE(i){return class extends i{get disabled(){return this._disabled}set disabled(t){this._disabled=dn(t)}constructor(...t){super(...t),this._disabled=!1}}}function Vw(i,t){return class extends i{get color(){return this._color}set color(e){const n=e||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...e){super(...e),this.defaultColor=t,this.color=t}}}function NE(i){return class extends i{get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=dn(t)}constructor(...t){super(...t),this._disableRipple=!1}}}function BE(i,t=0){return class extends i{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?dv(e):this.defaultTabIndex}constructor(...e){super(...e),this._tabIndex=t,this.defaultTabIndex=t}}}function iR(i){return class extends i{updateErrorState(){const t=this.errorState,o=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);o!==t&&(this.errorState=o,this.stateChanges.next())}constructor(...t){super(...t),this.errorState=!1}}}const mK=new Ot("MAT_DATE_LOCALE",{providedIn:"root",factory:function gK(){return mi(ag)}});class ud{constructor(){this._localeChanges=new Fi,this.localeChanges=this._localeChanges}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let n=this.isValid(t),r=this.isValid(e);return n&&r?!this.compareDate(t,e):n==r}return t==e}clampDate(t,e,n){return e&&this.compareDate(t,e)<0?e:n&&this.compareDate(t,n)>0?n:t}}const v0=new Ot("mat-date-formats"),_K=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function nR(i,t){const e=Array(i);for(let n=0;n<i;n++)e[n]=t(n);return e}let yK=(()=>{class i extends ud{constructor(e,n){super(),this.useUtcForDisplay=!1,super.setLocale(e)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){const n=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return nR(12,r=>this._format(n,new Date(2017,r,1)))}getDateNames(){const e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return nR(31,n=>this._format(e,new Date(2017,0,n+1)))}getDayOfWeekNames(e){const n=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return nR(7,r=>this._format(n,new Date(2017,0,r+1)))}getYearName(e){const n=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(n,e)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,n,r){let o=this._createDateWithOverflow(e,n,r);return o.getMonth(),o}today(){return new Date}parse(e,n){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}format(e,n){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");const r=new Intl.DateTimeFormat(this.locale,{...n,timeZone:"utc"});return this._format(r,e)}addCalendarYears(e,n){return this.addCalendarMonths(e,12*n)}addCalendarMonths(e,n){let r=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+n,this.getDate(e));return this.getMonth(r)!=((this.getMonth(e)+n)%12+12)%12&&(r=this._createDateWithOverflow(this.getYear(r),this.getMonth(r),0)),r}addCalendarDays(e,n){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+n)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if("string"==typeof e){if(!e)return null;if(_K.test(e)){let n=new Date(e);if(this.isValid(n))return n}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(e,n,r){const o=new Date;return o.setFullYear(e,n,r),o.setHours(0,0,0,0),o}_2digit(e){return("00"+e).slice(-2)}_format(e,n){const r=new Date;return r.setUTCFullYear(n.getFullYear(),n.getMonth(),n.getDate()),r.setUTCHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),e.format(r)}}return i.\u0275fac=function(e){return new(e||i)(it(mK,8),it(Js))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const vK={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let bK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[{provide:ud,useClass:yK}]}),i})(),xK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[{provide:v0,useValue:vK}],imports:[bK]}),i})(),xT=(()=>{class i{isErrorState(e,n){return!!(e&&e.invalid&&(e.touched||n&&n.submitted))}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class wK{constructor(t,e,n,r=!1){this._renderer=t,this.element=e,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const cz=w_({passive:!0,capture:!0});class MK{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const e=av(t);e&&this._events.get(t.type)?.forEach((n,r)=>{(r===e||r.contains(e))&&n.forEach(o=>o.handleEvent(t))})}}addHandler(t,e,n,r){const o=this._events.get(e);if(o){const a=o.get(n);a?a.add(r):o.set(n,new Set([r]))}else this._events.set(e,new Map([[n,new Set([r])]])),t.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,cz)})}removeHandler(t,e,n){const r=this._events.get(t);if(!r)return;const o=r.get(e);o&&(o.delete(n),0===o.size&&r.delete(e),0===r.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,cz)))}}const dz={enterDuration:225,exitDuration:150},uz=w_({passive:!0,capture:!0}),hz=["mousedown","touchstart"],pz=["mouseup","mouseleave","touchend","touchcancel"];class b0{constructor(t,e,n,r){this._target=t,this._ngZone=e,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=C_(n))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o={...dz,...n.animation};n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const a=n.radius||function CK(i,t,e){const n=Math.max(Math.abs(i-e.left),Math.abs(i-e.right)),r=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(n*n+r*r)}(t,e,r),u=t-r.left,f=e-r.top,y=o.enterDuration,M=document.createElement("div");M.classList.add("mat-ripple-element"),M.style.left=u-a+"px",M.style.top=f-a+"px",M.style.height=2*a+"px",M.style.width=2*a+"px",null!=n.color&&(M.style.backgroundColor=n.color),M.style.transitionDuration=`${y}ms`,this._containerElement.appendChild(M);const A=window.getComputedStyle(M),R=A.transitionDuration,O="none"===A.transitionProperty||"0s"===R||"0s, 0s"===R||0===r.width&&0===r.height,H=new wK(this,M,n,O);M.style.transform="scale3d(1, 1, 1)",H.state=0,n.persistent||(this._mostRecentTransientRipple=H);let U=null;return!O&&(y||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const B=()=>this._finishRippleTransition(H),Z=()=>this._destroyRipple(H);M.addEventListener("transitionend",B),M.addEventListener("transitioncancel",Z),U={onTransitionEnd:B,onTransitionCancel:Z}}),this._activeRipples.set(H,U),(O||!y)&&this._finishRippleTransition(H),H}fadeOutRipple(t){if(2===t.state||3===t.state)return;const e=t.element,n={...dz,...t.config.animation};e.style.transitionDuration=`${n.exitDuration}ms`,e.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=C_(t);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,hz.forEach(n=>{b0._eventManager.addHandler(this._ngZone,n,e,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{pz.forEach(e=>{this._triggerElement.addEventListener(e,this,uz)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:n}=t.config;t.state=1,!n&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=Qk(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!n&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!eR(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;if(e)for(let n=0;n<e.length;n++)this.fadeInRipple(e[n].clientX,e[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(hz.forEach(e=>b0._eventManager.removeHandler(e,t,this)),this._pointerUpEventsRegistered&&pz.forEach(e=>t.removeEventListener(e,this,uz)))}}b0._eventManager=new MK;const x0=new Ot("mat-ripple-global-options");let S_=(()=>{class i{get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}constructor(e,n,r,o,a){this._elementRef=e,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=o||{},this._rippleRenderer=new b0(this,n,e,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,n=0,r){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,n,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Ji),oe(Js),oe(x0,8),oe(ma,8))},i.\u0275dir=si({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,n){2&e&&Un("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),Hw=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,$o]}),i})(),SK=(()=>{class i{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1,this.appearance="full"}}return i.\u0275fac=function(e){return new(e||i)(oe(ma,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(e,n){2&e&&Un("mat-pseudo-checkbox-indeterminate","indeterminate"===n.state)("mat-pseudo-checkbox-checked","checked"===n.state)("mat-pseudo-checkbox-disabled",n.disabled)("mat-pseudo-checkbox-minimal","minimal"===n.appearance)("mat-pseudo-checkbox-full","full"===n.appearance)("_mat-animation-noopable","NoopAnimations"===n._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(e,n){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-full{border:2px solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0}),i})(),fz=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o]}),i})();const mz=new Ot("MAT_OPTION_PARENT_COMPONENT"),gz=new Ot("MatOptgroup");let TK=0;class AK{constructor(t,e=!1){this.source=t,this.isUserInput=e}}let DK=(()=>{class i{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=dn(e)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}constructor(e,n,r,o){this._element=e,this._changeDetectorRef=n,this._parent=r,this.group=o,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+TK++,this.onSelectionChange=new Mi,this._stateChanges=new Fi}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(e,n){const r=this._getHostElement();"function"==typeof r.focus&&r.focus(n)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!Nc(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=e)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new AK(this,e))}}return i.\u0275fac=function(e){lp()},i.\u0275dir=si({type:i,viewQuery:function(e,n){if(1&e&&uo(aK,7),2&e){let r;zi(r=Ui())&&(n._text=r.first)}},inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),i})(),_z=(()=>{class i extends DK{constructor(e,n,r,o){super(e,n,r,o)}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(vs),oe(mz,8),oe(gz,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(e,n){1&e&&ji("click",function(){return n._selectViaInteraction()})("keydown",function(o){return n._handleKeydown(o)}),2&e&&(vh("id",n.id),Mn("aria-selected",n.selected)("aria-disabled",n.disabled.toString()),Un("mdc-list-item--selected",n.selected)("mat-mdc-option-multiple",n.multiple)("mat-mdc-option-active",n.active)("mdc-list-item--disabled",n.disabled))},exportAs:["matOption"],features:[Zi],ngContentSelectors:hK,decls:8,vars:5,consts:[["class","mat-mdc-option-pseudo-checkbox","aria-hidden","true",3,"disabled","state",4,"ngIf"],[1,"mdc-list-item__primary-text"],["text",""],["class","mat-mdc-option-pseudo-checkbox","state","checked","aria-hidden","true","appearance","minimal",3,"disabled",4,"ngIf"],["class","cdk-visually-hidden",4,"ngIf"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"]],template:function(e,n){1&e&&(Lo(uK),Oi(0,lK,1,2,"mat-pseudo-checkbox",0),Hi(1),rt(2,"span",1,2),Hi(4,1),mt(),Oi(5,cK,1,1,"mat-pseudo-checkbox",3),Oi(6,dK,2,1,"span",4),En(7,"div",5)),2&e&&(Vt("ngIf",n.multiple),ft(5),Vt("ngIf",!n.multiple&&n.selected&&!n.hideSingleSelectionIndicator),ft(1),Vt("ngIf",n.group&&n.group._inert),ft(1),Vt("matRippleTrigger",n._getHostElement())("matRippleDisabled",n.disabled||n.disableRipple))},dependencies:[S_,cp,SK],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color);font-family:var(--mat-option-label-text-font);line-height:var(--mat-option-label-text-line-height);font-size:var(--mat-option-label-text-size);letter-spacing:var(--mat-option-label-text-tracking);font-weight:var(--mat-option-label-text-weight);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color)}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color)}.mat-mdc-option.mdc-list-item{align-items:center}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),i})(),yz=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[Hw,wu,$o,fz]}),i})();const RK=["*",[["mat-toolbar-row"]]],PK=["*","mat-toolbar-row"],LK=Vw(class{constructor(i){this._elementRef=i}});let FK=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),i})(),rR=(()=>{class i extends LK{constructor(e,n,r){super(e),this._platform=n,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Js),oe(lr))},i.\u0275cmp=ui({type:i,selectors:[["mat-toolbar"]],contentQueries:function(e,n,r){if(1&e&&Qr(r,FK,5),2&e){let o;zi(o=Ui())&&(n._toolbarRows=o)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,n){2&e&&Un("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",0===n._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Zi],ngContentSelectors:PK,decls:2,vars:0,template:function(e,n){1&e&&(Lo(RK),Hi(0),Hi(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),i})(),oR=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,$o]}),i})();const OK=["addListener","removeListener"],NK=["addEventListener","removeEventListener"],BK=["on","off"];function UE(i,t,e,n){if(Sr(e)&&(n=e,e=void 0),n)return UE(i,t,e).pipe(_k(n));const[r,o]=function VK(i){return Sr(i.addEventListener)&&Sr(i.removeEventListener)}(i)?NK.map(a=>u=>i[a](t,u,e)):function zK(i){return Sr(i.addListener)&&Sr(i.removeListener)}(i)?OK.map(vz(i,t)):function UK(i){return Sr(i.on)&&Sr(i.off)}(i)?BK.map(vz(i,t)):[];if(!r&&lt(i))return Ms(a=>UE(a,t,e))(Tr(i));if(!r)throw new TypeError("Invalid event target");return new Cn(a=>{const u=(...f)=>a.next(1<f.length?f:f[0]);return r(u),()=>o(u)})}function vz(i,t){return e=>n=>i[e](t,n)}const VE={schedule(i){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:n}=VE;n&&(t=n.requestAnimationFrame,e=n.cancelAnimationFrame);const r=t(o=>{e=void 0,i(o)});return new gt(()=>e?.(r))},requestAnimationFrame(...i){const{delegate:t}=VE;return(t?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:t}=VE;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0};new class GK extends Yk{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;t=t||n.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,r){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw r}}}(class HK extends Xk{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=VE.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(t,e,n);const{actions:o}=t;null!=e&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==e&&(VE.cancelAnimationFrame(e),t._scheduled=void 0)}});let sR,WK=1;const wT={};function bz(i){return i in wT&&(delete wT[i],!0)}const $K={setImmediate(i){const t=WK++;return wT[t]=!0,sR||(sR=Promise.resolve()),sR.then(()=>bz(t)&&i()),t},clearImmediate(i){bz(i)}},{setImmediate:qK,clearImmediate:XK}=$K,MT={setImmediate(...i){const{delegate:t}=MT;return(t?.setImmediate||qK)(...i)},clearImmediate(i){const{delegate:t}=MT;return(t?.clearImmediate||XK)(i)},delegate:void 0},aR=new class YK extends Yk{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;t=t||n.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,r){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw r}}}(class ZK extends Xk{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=MT.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(t,e,n);const{actions:o}=t;null!=e&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==e&&(MT.clearImmediate(e),t._scheduled===e&&(t._scheduled=void 0))}});function xz(i=0,t,e=MY){let n=-1;return null!=t&&(vd(t)?e=t:n=t),new Cn(r=>{let o=function JK(i){return i instanceof Date&&!isNaN(i)}(i)?+i-e.now():i;o<0&&(o=0);let a=0;return e.schedule(function(){r.closed||(r.next(a++),0<=n?this.schedule(void 0,n):r.complete())},o)})}function wz(i,t=_T){return function KK(i){return to((t,e)=>{let n=!1,r=null,o=null,a=!1;const u=()=>{if(o?.unsubscribe(),o=null,n){n=!1;const y=r;r=null,e.next(y)}a&&e.complete()},f=()=>{o=null,a&&e.complete()};t.subscribe(go(e,y=>{n=!0,r=y,o||Tr(i(y)).subscribe(o=go(e,u,f))},()=>{a=!0,(!n||!o||o.closed)&&e.complete()}))})}(()=>xz(i,t))}let ET=(()=>{class i{constructor(e,n,r){this._ngZone=e,this._platform=n,this._scrolled=new Fi,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Cn(n=>{this._globalSubscription||this._addGlobalListener();const r=e>0?this._scrolled.pipe(wz(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Jt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){const r=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe(Ko(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(e){const n=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,e)&&n.push(o)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,n){let r=C_(n),o=e.getElementRef().nativeElement;do{if(r==o)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>UE(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(e){return new(e||i)(it(Ji),it(Js),it(lr,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),HE=(()=>{class i{constructor(e,n,r,o){this.elementRef=e,this.scrollDispatcher=n,this.ngZone=r,this.dir=o,this._destroyed=new Fi,this._elementScrolled=new Cn(a=>this.ngZone.runOutsideAngular(()=>UE(this.elementRef.nativeElement,"scroll").pipe(oo(this._destroyed)).subscribe(a)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=r?e.end:e.start),null==e.right&&(e.right=r?e.start:e.end),null!=e.bottom&&(e.top=n.scrollHeight-n.clientHeight-e.bottom),r&&0!=DE()?(null!=e.left&&(e.right=n.scrollWidth-n.clientWidth-e.left),2==DE()?e.left=e.right:1==DE()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=n.scrollWidth-n.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const n=this.elementRef.nativeElement;j3()?n.scrollTo(e):(null!=e.top&&(n.scrollTop=e.top),null!=e.left&&(n.scrollLeft=e.left))}measureScrollOffset(e){const n="left",r="right",o=this.elementRef.nativeElement;if("top"==e)return o.scrollTop;if("bottom"==e)return o.scrollHeight-o.clientHeight-o.scrollTop;const a=this.dir&&"rtl"==this.dir.value;return"start"==e?e=a?r:n:"end"==e&&(e=a?n:r),a&&2==DE()?e==n?o.scrollWidth-o.clientWidth-o.scrollLeft:o.scrollLeft:a&&1==DE()?e==n?o.scrollLeft+o.scrollWidth-o.clientWidth:-o.scrollLeft:e==n?o.scrollLeft:o.scrollWidth-o.clientWidth-o.scrollLeft}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(ET),oe(Ji),oe(Cu,8))},i.\u0275dir=si({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),i})(),CT=(()=>{class i{constructor(e,n,r){this._platform=e,this._change=new Fi,this._changeListener=o=>{this._change.next(o)},this._document=r,n.runOutsideAngular(()=>{if(e.isBrowser){const o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,n=this._getWindow(),r=e.documentElement,o=r.getBoundingClientRect();return{top:-o.top||e.body.scrollTop||n.scrollY||r.scrollTop||0,left:-o.left||e.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(wz(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(e){return new(e||i)(it(Js),it(Ji),it(lr,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),w0=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})(),Mz=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[FE,w0,FE,w0]}),i})();class Ez{}class tJ{}const T_="*";function A_(i,t){return{type:7,name:i,definitions:t,options:{}}}function xh(i,t=null){return{type:4,styles:t,timings:i}}function Sz(i,t=null){return{type:2,steps:i,options:t}}function Qs(i){return{type:6,styles:i,offset:null}}function ug(i,t,e){return{type:0,name:i,styles:t,options:e}}function Tz(i){return{type:5,steps:i}}function Su(i,t,e=null){return{type:1,expr:i,animation:t,options:e}}function lR(i=null){return{type:9,options:i}}function cR(i,t,e=null){return{type:11,selector:i,animation:t,options:e}}class GE{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class Az{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(a=>{a.onDone(()=>{++e==o&&this._onFinish()}),a.onDestroy(()=>{++n==o&&this._onDestroy()}),a.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((a,u)=>Math.max(a,u.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(r)})}getPosition(){const t=this.players.reduce((e,n)=>null===e||n.totalTime>e.totalTime?n:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}const ST=["*"],iJ=["content"];function nJ(i,t){if(1&i){const e=yh();rt(0,"div",2),ji("click",function(){return $r(e),lo(ln()._onBackdropClicked())}),mt()}2&i&&Un("mat-drawer-shown",ln()._isShowingBackdrop())}function rJ(i,t){1&i&&(rt(0,"mat-drawer-content"),Hi(1,2),mt())}const oJ=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],sJ=["mat-drawer","mat-drawer-content","*"];function aJ(i,t){if(1&i){const e=yh();rt(0,"div",2),ji("click",function(){return $r(e),lo(ln()._onBackdropClicked())}),mt()}2&i&&Un("mat-drawer-shown",ln()._isShowingBackdrop())}function lJ(i,t){1&i&&(rt(0,"mat-sidenav-content"),Hi(1,2),mt())}const cJ=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],dJ=["mat-sidenav","mat-sidenav-content","*"],Dz={transformDrawer:A_("transform",[ug("open, open-instant",Qs({transform:"none",visibility:"visible"})),ug("void",Qs({"box-shadow":"none",visibility:"hidden"})),Su("void => open-instant",xh("0ms")),Su("void <=> open, open-instant => void",xh("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},hJ=new Ot("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function pJ(){return!1}}),uR=new Ot("MAT_DRAWER_CONTAINER");let TT=(()=>{class i extends HE{constructor(e,n,r,o,a){super(r,o,a),this._changeDetectorRef=e,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(e){return new(e||i)(oe(vs),oe(ir(()=>kz)),oe(tn),oe(ET),oe(Ji))},i.\u0275cmp=ui({type:i,selectors:[["mat-drawer-content"]],hostAttrs:["ngSkipHydration","",1,"mat-drawer-content"],hostVars:4,hostBindings:function(e,n){2&e&&Jf("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[Qn([{provide:HE,useExisting:i}]),Zi],ngContentSelectors:ST,decls:1,vars:0,template:function(e,n){1&e&&(Lo(),Hi(0))},encapsulation:2,changeDetection:0}),i})(),Iz=(()=>{class i{get position(){return this._position}set position(e){(e="end"===e?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(e),this._position=e,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(e){this._disableClose=dn(e)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(e){("true"===e||"false"===e||null==e)&&(e=dn(e)),this._autoFocus=e}get opened(){return this._opened}set opened(e){this.toggle(dn(e))}constructor(e,n,r,o,a,u,f,y){this._elementRef=e,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=o,this._ngZone=a,this._interactivityChecker=u,this._doc=f,this._container=y,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Fi,this._animationEnd=new Fi,this._animationState="void",this.openedChange=new Mi(!0),this._openedStream=this.openedChange.pipe(Ko(M=>M),vn(()=>{})),this.openedStart=this._animationStarted.pipe(Ko(M=>M.fromState!==M.toState&&0===M.toState.indexOf("open")),YS(void 0)),this._closedStream=this.openedChange.pipe(Ko(M=>!M),vn(()=>{})),this.closedStart=this._animationStarted.pipe(Ko(M=>M.fromState!==M.toState&&"void"===M.toState),YS(void 0)),this._destroyed=new Fi,this.onPositionChanged=new Mi,this._modeChanged=new Fi,this.openedChange.subscribe(M=>{M?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{UE(this._elementRef.nativeElement,"keydown").pipe(Ko(M=>27===M.keyCode&&!this.disableClose&&!Nc(M)),oo(this._destroyed)).subscribe(M=>this._ngZone.run(()=>{this.close(),M.stopPropagation(),M.preventDefault()}))}),this._animationEnd.pipe(Jn((M,A)=>M.fromState===A.fromState&&M.toState===A.toState)).subscribe(M=>{const{fromState:A,toState:I}=M;(0===I.indexOf("open")&&"void"===A||"void"===I&&0===A.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(n)}_focusByCssSelector(e,n){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;const e=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&e.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(e){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,e):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const e=this._doc.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(e){return this.toggle(!0,e)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(e=!this.opened,n){e&&n&&(this._openedVia=n);const r=this._setOpen(e,!e&&this._isFocusWithinDrawer(),this._openedVia||"program");return e||(this._openedVia=null),r}_setOpen(e,n,r){return this._opened=e,e?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(o=>{this.openedChange.pipe(ss(1)).subscribe(a=>o(a?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(e){const n=this._elementRef.nativeElement,r=n.parentNode;"end"===e?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,n)),r.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(LE),oe(dg),oe(Js),oe(Ji),oe(PE),oe(lr,8),oe(uR,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-drawer"]],viewQuery:function(e,n){if(1&e&&uo(iJ,5),2&e){let r;zi(r=Ui())&&(n._content=r.first)}},hostAttrs:["tabIndex","-1","ngSkipHydration","",1,"mat-drawer"],hostVars:12,hostBindings:function(e,n){1&e&&yS("@transform.start",function(o){return n._animationStarted.next(o)})("@transform.done",function(o){return n._animationEnd.next(o)}),2&e&&(Mn("align",null),xS("@transform",n._animationState),Un("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:ST,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(e,n){1&e&&(Lo(),rt(0,"div",0,1),Hi(2),mt())},dependencies:[HE],encapsulation:2,data:{animation:[Dz.transformDrawer]},changeDetection:0}),i})(),kz=(()=>{class i{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(e){this._autosize=dn(e)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(e){this._backdropOverride=null==e?null:dn(e)}get scrollable(){return this._userContent||this._content}constructor(e,n,r,o,a,u=!1,f){this._dir=e,this._element=n,this._ngZone=r,this._changeDetectorRef=o,this._animationMode=f,this._drawers=new Jy,this.backdropClick=new Mi,this._destroyed=new Fi,this._doCheckSubject=new Fi,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Fi,e&&e.change.pipe(oo(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),a.change().pipe(oo(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=u}ngAfterContentInit(){this._allDrawers.changes.pipe(Oc(this._allDrawers),oo(this._destroyed)).subscribe(e=>{this._drawers.reset(e.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Oc(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(e=>{this._watchDrawerToggle(e),this._watchDrawerPosition(e),this._watchDrawerMode(e)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(yT(10),oo(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(e=>e.open())}close(){this._drawers.forEach(e=>e.close())}updateContentMargins(){let e=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();e+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();n+=r,e-=r}e=e||null,n=n||null,(e!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:e,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(e){e._animationStarted.pipe(Ko(n=>n.fromState!==n.toState),oo(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==e.mode&&e.openedChange.pipe(oo(this._drawers.changes)).subscribe(()=>this._setContainerClass(e.opened))}_watchDrawerPosition(e){e&&e.onPositionChanged.pipe(oo(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(ss(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(e){e&&e._modeChanged.pipe(oo(oi(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(e){const n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";e?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(e=>{"end"==e.position?this._end=e:this._start=e}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(e=>e&&!e.disableClose&&this._canHaveBackdrop(e)).forEach(e=>e._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(e){return"side"!==e.mode||!!this._backdropOverride}_isDrawerOpen(e){return null!=e&&e.opened}}return i.\u0275fac=function(e){return new(e||i)(oe(Cu,8),oe(tn),oe(Ji),oe(vs),oe(CT),oe(hJ),oe(ma,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(e,n,r){if(1&e&&(Qr(r,TT,5),Qr(r,Iz,5)),2&e){let o;zi(o=Ui())&&(n._content=o.first),zi(o=Ui())&&(n._allDrawers=o)}},viewQuery:function(e,n){if(1&e&&uo(TT,5),2&e){let r;zi(r=Ui())&&(n._userContent=r.first)}},hostAttrs:["ngSkipHydration","",1,"mat-drawer-container"],hostVars:2,hostBindings:function(e,n){2&e&&Un("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Qn([{provide:uR,useExisting:i}])],ngContentSelectors:sJ,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,n){1&e&&(Lo(oJ),Oi(0,nJ,1,2,"div",0),Hi(1),Hi(2,1),Oi(3,rJ,2,0,"mat-drawer-content",1)),2&e&&(Vt("ngIf",n.hasBackdrop),ft(3),Vt("ngIf",!n._content))},dependencies:[cp,TT],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),hR=(()=>{class i extends TT{constructor(e,n,r,o,a){super(e,n,r,o,a)}}return i.\u0275fac=function(e){return new(e||i)(oe(vs),oe(ir(()=>Pz)),oe(tn),oe(ET),oe(Ji))},i.\u0275cmp=ui({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:["ngSkipHydration","",1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(e,n){2&e&&Jf("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[Qn([{provide:HE,useExisting:i}]),Zi],ngContentSelectors:ST,decls:1,vars:0,template:function(e,n){1&e&&(Lo(),Hi(0))},encapsulation:2,changeDetection:0}),i})(),Rz=(()=>{class i extends Iz{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(e){this._fixedInViewport=dn(e)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(e){this._fixedTopGap=dv(e)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(e){this._fixedBottomGap=dv(e)}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275cmp=ui({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1","ngSkipHydration","",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(e,n){2&e&&(Mn("align",null),Jf("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),Un("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Zi],ngContentSelectors:ST,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(e,n){1&e&&(Lo(),rt(0,"div",0,1),Hi(2),mt())},dependencies:[HE],encapsulation:2,data:{animation:[Dz.transformDrawer]},changeDetection:0}),i})(),Pz=(()=>{class i extends kz{constructor(){super(...arguments),this._allDrawers=void 0,this._content=void 0}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275cmp=ui({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(e,n,r){if(1&e&&(Qr(r,hR,5),Qr(r,Rz,5)),2&e){let o;zi(o=Ui())&&(n._content=o.first),zi(o=Ui())&&(n._allDrawers=o)}},hostAttrs:["ngSkipHydration","",1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(e,n){2&e&&Un("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[Qn([{provide:uR,useExisting:i}]),Zi],ngContentSelectors:dJ,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,n){1&e&&(Lo(cJ),Oi(0,aJ,1,2,"div",0),Hi(1),Hi(2,1),Oi(3,lJ,2,0,"mat-sidenav-content",1)),2&e&&(Vt("ngIf",n.hasBackdrop),ft(3),Vt("ngIf",!n._content))},dependencies:[cp,hR],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),fJ=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[wu,$o,w0,w0,$o]}),i})();const mJ=["mat-button",""],Lz=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Fz=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],_J=["mat-fab",""],yJ=["mat-icon-button",""],vJ=["*"],Oz={capture:!0},Nz=["focus","click","mouseenter","touchstart"],jE="mat-button-ripple-uninitialized";let bJ=(()=>{class i{constructor(){this._document=mi(lr,{optional:!0}),this._animationMode=mi(ma,{optional:!0}),this._globalRippleOptions=mi(x0,{optional:!0}),this._platform=mi(Js),this._ngZone=mi(Ji),this._onInteraction=e=>{if(e.target===this._document)return;const r=e.target.closest(`[${jE}]`);r&&(r.removeAttribute(jE),this._appendRipple(r))},this._ngZone.runOutsideAngular(()=>{for(const e of Nz)this._document?.addEventListener(e,this._onInteraction,Oz)})}ngOnDestroy(){for(const e of Nz)this._document?.removeEventListener(e,this._onInteraction,Oz)}_appendRipple(e){if(!this._document)return;const n=this._document.createElement("span");n.classList.add("mat-mdc-button-ripple");const r=new xJ(e,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);r.rippleConfig.centered=e.hasAttribute("mat-icon-button"),new b0(r,this._ngZone,n,this._platform).setupTriggerEvents(e),e.append(n)}_createMatRipple(e){if(!this._document)return;e.querySelector(".mat-mdc-button-ripple")?.remove(),e.removeAttribute(jE);const n=this._document.createElement("span");n.classList.add("mat-mdc-button-ripple");const r=new S_(new tn(n),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return r._isInitialized=!0,r.trigger=e,e.append(n),r}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class xJ{constructor(t,e,n){this._button=t,this._globalRippleOptions=e,this._setRippleConfig(e,n)}_setRippleConfig(t,e){this.rippleConfig=t||{},"NoopAnimations"===e&&(this.rippleConfig.animation={enterDuration:0,exitDuration:0})}get rippleDisabled(){return this._button.hasAttribute("disabled")||!!this._globalRippleOptions?.disabled}}const wJ=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],MJ=Vw(OE(NE(class{constructor(i){this._elementRef=i}})));let pR=(()=>{class i extends MJ{get ripple(){return!this._ripple&&this._rippleLoader&&(this._ripple=this._rippleLoader._createMatRipple(this._elementRef.nativeElement)),this._ripple}set ripple(e){this._ripple=e}constructor(e,n,r,o){super(e),this._platform=n,this._ngZone=r,this._animationMode=o,this._focusMonitor=mi(dg),this._rippleLoader=mi(bJ),this._isFab=!1;const a=e.nativeElement.classList;for(const u of wJ)this._hasHostAttributes(u.selector)&&u.mdcClasses.forEach(f=>{a.add(f)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnChanges(){this._ripple&&(this._ripple.disabled=this.disableRipple||this.disabled)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",n){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,n):this._elementRef.nativeElement.focus(n)}_hasHostAttributes(...e){return e.some(n=>this._elementRef.nativeElement.hasAttribute(n))}}return i.\u0275fac=function(e){lp()},i.\u0275dir=si({type:i,features:[Zi,le]}),i})(),WE=(()=>{class i extends pR{constructor(e,n,r,o){super(e,n,r,o)}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Js),oe(Ji),oe(ma,8))},i.\u0275cmp=ui({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostAttrs:["mat-button-ripple-uninitialized",""],hostVars:7,hostBindings:function(e,n){2&e&&(Mn("disabled",n.disabled||null),Un("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Zi],attrs:mJ,ngContentSelectors:Fz,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(e,n){1&e&&(Lo(Lz),En(0,"span",0),Hi(1),rt(2,"span",1),Hi(3,1),mt(),Hi(4,2),En(5,"span",2)(6,"span",3)),2&e&&Un("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})();const CJ=new Ot("mat-mdc-fab-default-options",{providedIn:"root",factory:Bz});function Bz(){return{color:"accent"}}const zz=Bz();let Uz=(()=>{class i extends pR{get extended(){return this._extended}set extended(e){this._extended=dn(e)}constructor(e,n,r,o,a){super(e,n,r,o),this._options=a,this._isFab=!0,this._options=this._options||zz,this.color=this.defaultColor=this._options.color||zz.color}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Js),oe(Ji),oe(ma,8),oe(CJ,8))},i.\u0275cmp=ui({type:i,selectors:[["button","mat-fab",""]],hostAttrs:["mat-button-ripple-uninitialized",""],hostVars:11,hostBindings:function(e,n){2&e&&(Mn("disabled",n.disabled||null),Un("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0)("mdc-fab--extended",n.extended)("mat-mdc-extended-fab",n.extended))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",extended:"extended"},exportAs:["matButton"],features:[Zi],attrs:_J,ngContentSelectors:Fz,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(e,n){1&e&&(Lo(Lz),En(0,"span",0),Hi(1),rt(2,"span",1),Hi(3,1),mt(),Hi(4,2),En(5,"span",2)(6,"span",3)),2&e&&Un("mdc-button__ripple",!n._isFab)("mdc-fab__ripple",n._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-fab{position:relative;display:inline-flex;position:relative;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;user-select:none;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-fab .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-fab[hidden]{display:none}.mdc-fab::-moz-focus-inner{padding:0;border:0}.mdc-fab .mdc-fab__focus-ring{position:absolute}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    )}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{border-color:CanvasText}}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{border-color:CanvasText}}.mdc-fab:active,.mdc-fab:focus{outline:none}.mdc-fab:hover{cursor:pointer}.mdc-fab>svg{width:100%}.mdc-fab--mini{width:40px;height:40px}.mdc-fab--extended{border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}.mdc-fab--extended .mdc-fab__ripple{border-radius:24px}.mdc-fab--extended .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mdc-fab--extended .mdc-fab__icon,.mdc-fab--extended .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon,.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}.mdc-fab--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-fab--touch .mdc-fab__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-fab::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-fab::before{border-color:CanvasText}}.mdc-fab__label{justify-content:flex-start;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:visible}.mdc-fab__icon{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mdc-fab .mdc-fab__icon{display:inline-flex;align-items:center;justify-content:center}.mdc-fab--exited{transform:scale(0);opacity:0;transition:opacity 15ms linear 150ms,transform 180ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-fab--exited .mdc-fab__icon{transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-fab .mdc-fab__icon{width:24px;height:24px;font-size:24px}.mdc-fab:not(.mdc-fab--extended){border-radius:50%}.mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:50%}.mat-mdc-fab,.mat-mdc-mini-fab{-webkit-tap-highlight-color:rgba(0,0,0,0);background-color:var(--mdc-fab-container-color, transparent);box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);color:var(--mat-mdc-fab-color, inherit);flex-shrink:0}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-fab .mat-ripple-element,.mat-mdc-mini-fab .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-fab .mdc-button__label,.mat-mdc-mini-fab .mdc-button__label{z-index:1}.mat-mdc-fab .mat-mdc-focus-indicator,.mat-mdc-mini-fab .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-fab:focus .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-fab .mat-mdc-button-touch-target,.mat-mdc-mini-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-fab._mat-animation-noopable,.mat-mdc-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-fab:not(:disabled) .mdc-fab__icon,.mat-mdc-mini-fab:not(:disabled) .mdc-fab__icon{color:var(--mdc-fab-icon-color, inherit)}.mat-mdc-fab:not(.mdc-fab--extended),.mat-mdc-mini-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-container-shape, 50%)}.mat-mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple,.mat-mdc-mini-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-container-shape, 50%)}.mat-mdc-fab:hover,.mat-mdc-fab:focus,.mat-mdc-mini-fab:hover,.mat-mdc-mini-fab:focus{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12)}.mat-mdc-fab:active,.mat-mdc-fab:focus:active,.mat-mdc-mini-fab:active,.mat-mdc-mini-fab:focus:active{box-shadow:0px 7px 8px -4px rgba(0, 0, 0, 0.2), 0px 12px 17px 2px rgba(0, 0, 0, 0.14), 0px 5px 22px 4px rgba(0, 0, 0, 0.12)}.mat-mdc-fab[disabled],.mat-mdc-mini-fab[disabled]{cursor:default;pointer-events:none;box-shadow:0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12)}.mat-mdc-fab:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-mini-fab:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}.mat-mdc-fab .mat-icon,.mat-mdc-fab .material-icons,.mat-mdc-mini-fab .mat-icon,.mat-mdc-mini-fab .material-icons{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mat-mdc-fab .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-extended-fab{border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}.mat-mdc-extended-fab .mdc-fab__ripple{border-radius:24px}.mat-mdc-extended-fab .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mat-mdc-extended-fab .mdc-fab__icon,.mat-mdc-extended-fab .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mat-mdc-extended-fab .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mat-mdc-extended-fab .mdc-fab__label+.mdc-fab__icon,.mat-mdc-extended-fab .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}.mat-mdc-extended-fab>.mat-icon,.mat-mdc-extended-fab>.material-icons{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mat-mdc-extended-fab>.mat-icon,[dir=rtl] .mat-mdc-extended-fab>.material-icons,.mat-mdc-extended-fab>.mat-icon[dir=rtl],.mat-mdc-extended-fab>.material-icons[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mat-mdc-extended-fab .mdc-button__label+.mat-icon,.mat-mdc-extended-fab .mdc-button__label+.material-icons{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.material-icons,.mat-mdc-extended-fab .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-extended-fab .mdc-button__label+.material-icons[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}.mat-mdc-extended-fab .mat-mdc-button-touch-target{width:100%}'],encapsulation:2,changeDetection:0}),i})(),M0=(()=>{class i extends pR{get ripple(){return!this._ripple&&this._rippleLoader&&(this._ripple=this._rippleLoader._createMatRipple(this._elementRef.nativeElement),this._ripple.centered=!0),this._ripple}constructor(e,n,r,o){super(e,n,r,o)}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Js),oe(Ji),oe(ma,8))},i.\u0275cmp=ui({type:i,selectors:[["button","mat-icon-button",""]],hostAttrs:["mat-button-ripple-uninitialized",""],hostVars:7,hostBindings:function(e,n){2&e&&(Mn("disabled",n.disabled||null),Un("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Zi],attrs:yJ,ngContentSelectors:vJ,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(e,n){1&e&&(Lo(),En(0,"span",0),Hi(1),En(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),uv=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,Hw,$o]}),i})();function fR(...i){const t=fm(i),{args:e,keys:n}=NB(i),r=new Cn(o=>{const{length:a}=e;if(!a)return void o.complete();const u=new Array(a);let f=a,y=a;for(let M=0;M<a;M++){let A=!1;Tr(e[M]).subscribe(go(o,I=>{A||(A=!0,y--),u[M]=I},()=>f--,void 0,()=>{(!f||!A)&&(y||o.next(n?BB(n,u):u),o.complete())}))}});return t?r.pipe(_k(t)):r}class AT{}class DT{}class hg{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(e=>{const n=e.indexOf(":");if(n>0){const r=e.slice(0,n),o=r.toLowerCase(),a=e.slice(n+1).trim();this.maybeSetNormalizedName(r,o),this.headers.has(o)?this.headers.get(o).push(a):this.headers.set(o,[a])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,n)=>{this.setHeaderEntries(n,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,n])=>{this.setHeaderEntries(e,n)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof hg?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new hg;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof hg?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const o=t.value;if(o){let a=this.headers.get(e);if(!a)return;a=a.filter(u=>-1===o.indexOf(u)),0===a.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,a)}else this.headers.delete(e),this.normalizedNames.delete(e)}}setHeaderEntries(t,e){const n=(Array.isArray(e)?e:[e]).map(o=>o.toString()),r=t.toLowerCase();this.headers.set(r,n),this.maybeSetNormalizedName(t,r)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class SJ{encodeKey(t){return Vz(t)}encodeValue(t){return Vz(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const AJ=/%(\d[a-f0-9])/gi,DJ={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Vz(i){return encodeURIComponent(i).replace(AJ,(t,e)=>DJ[e]??t)}function IT(i){return`${i}`}class hv{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new SJ,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function TJ(i,t){const e=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const o=r.indexOf("="),[a,u]=-1==o?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,o)),t.decodeValue(r.slice(o+1))],f=e.get(a)||[];f.push(u),e.set(a,f)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e],r=Array.isArray(n)?n.map(IT):[IT(n)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const r=t[n];Array.isArray(r)?r.forEach(o=>{e.push({param:n,value:o,op:"a"})}):e.push({param:n,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new hv({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(IT(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let n=this.map.get(t.param)||[];const r=n.indexOf(IT(t.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(t.param,n):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class IJ{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function Hz(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function Gz(i){return typeof Blob<"u"&&i instanceof Blob}function jz(i){return typeof FormData<"u"&&i instanceof FormData}class $E{constructor(t,e,n,r){let o;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function kJ(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,o=r):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new hg),this.context||(this.context=new IJ),this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=e;else{const u=e.indexOf("?");this.urlWithParams=e+(-1===u?"?":u<e.length-1?"&":"")+a}}else this.params=new hv,this.urlWithParams=e}serializeBody(){return null===this.body?null:Hz(this.body)||Gz(this.body)||jz(this.body)||function RJ(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof hv?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||jz(this.body)?null:Gz(this.body)?this.body.type||null:Hz(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof hv?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,r=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,u=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let f=t.headers||this.headers,y=t.params||this.params;const M=t.context??this.context;return void 0!==t.setHeaders&&(f=Object.keys(t.setHeaders).reduce((A,I)=>A.set(I,t.setHeaders[I]),f)),t.setParams&&(y=Object.keys(t.setParams).reduce((A,I)=>A.set(I,t.setParams[I]),y)),new $E(e,n,o,{params:y,headers:f,context:M,reportProgress:u,responseType:r,withCredentials:a})}}var Wl=(()=>((Wl=Wl||{})[Wl.Sent=0]="Sent",Wl[Wl.UploadProgress=1]="UploadProgress",Wl[Wl.ResponseHeader=2]="ResponseHeader",Wl[Wl.DownloadProgress=3]="DownloadProgress",Wl[Wl.Response=4]="Response",Wl[Wl.User=5]="User",Wl))();class mR{constructor(t,e=200,n="OK"){this.headers=t.headers||new hg,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class gR extends mR{constructor(t={}){super(t),this.type=Wl.ResponseHeader}clone(t={}){return new gR({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Gw extends mR{constructor(t={}){super(t),this.type=Wl.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Gw({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Wz extends mR{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function _R(i,t){return{body:t,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let kT=(()=>{class i{constructor(e){this.handler=e}request(e,n,r={}){let o;if(e instanceof $E)o=e;else{let f,y;f=r.headers instanceof hg?r.headers:new hg(r.headers),r.params&&(y=r.params instanceof hv?r.params:new hv({fromObject:r.params})),o=new $E(e,n,void 0!==r.body?r.body:null,{headers:f,context:r.context,params:y,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const a=Jt(o).pipe(h0(f=>this.handler.handle(f)));if(e instanceof $E||"events"===r.observe)return a;const u=a.pipe(Ko(f=>f instanceof Gw));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return u.pipe(vn(f=>{if(null!==f.body&&!(f.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return f.body}));case"blob":return u.pipe(vn(f=>{if(null!==f.body&&!(f.body instanceof Blob))throw new Error("Response is not a Blob.");return f.body}));case"text":return u.pipe(vn(f=>{if(null!==f.body&&"string"!=typeof f.body)throw new Error("Response is not a string.");return f.body}));default:return u.pipe(vn(f=>f.body))}case"response":return u;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:(new hv).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,r={}){return this.request("PATCH",e,_R(r,n))}post(e,n,r={}){return this.request("POST",e,_R(r,n))}put(e,n,r={}){return this.request("PUT",e,_R(r,n))}}return i.\u0275fac=function(e){return new(e||i)(it(AT))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();function Xz(i,t){return t(i)}function LJ(i,t){return(e,n)=>t.intercept(e,{handle:r=>i(r,n)})}const OJ=new Ot(""),qE=new Ot(""),Zz=new Ot("");function NJ(){let i=null;return(t,e)=>{null===i&&(i=(mi(OJ,{optional:!0})??[]).reduceRight(LJ,Xz));const n=mi(AS),r=n.add();return i(t,e).pipe(Iw(()=>n.remove(r)))}}let Yz=(()=>{class i extends AT{constructor(e,n){super(),this.backend=e,this.injector=n,this.chain=null,this.pendingTasks=mi(AS)}handle(e){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(qE),...this.injector.get(Zz,[])]));this.chain=r.reduceRight((o,a)=>function FJ(i,t,e){return(n,r)=>e.runInContext(()=>t(n,o=>i(o,r)))}(o,a,this.injector),Xz)}const n=this.pendingTasks.add();return this.chain(e,r=>this.backend.handle(r)).pipe(Iw(()=>this.pendingTasks.remove(n)))}}return i.\u0275fac=function(e){return new(e||i)(it(DT),it(fh))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const VJ=/^\)\]\}',?\n/;let Jz=(()=>{class i{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Ct(-2800,!1);const n=this.xhrFactory;return(n.\u0275loadImpl?Zo(n.\u0275loadImpl()):Jt(null)).pipe(Co(()=>new Cn(o=>{const a=n.build();if(a.open(e.method,e.urlWithParams),e.withCredentials&&(a.withCredentials=!0),e.headers.forEach((H,U)=>a.setRequestHeader(H,U.join(","))),e.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const H=e.detectContentTypeHeader();null!==H&&a.setRequestHeader("Content-Type",H)}if(e.responseType){const H=e.responseType.toLowerCase();a.responseType="json"!==H?H:"text"}const u=e.serializeBody();let f=null;const y=()=>{if(null!==f)return f;const H=a.statusText||"OK",U=new hg(a.getAllResponseHeaders()),B=function HJ(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(a)||e.url;return f=new gR({headers:U,status:a.status,statusText:H,url:B}),f},M=()=>{let{headers:H,status:U,statusText:B,url:Z}=y(),X=null;204!==U&&(X=typeof a.response>"u"?a.responseText:a.response),0===U&&(U=X?200:0);let ee=U>=200&&U<300;if("json"===e.responseType&&"string"==typeof X){const se=X;X=X.replace(VJ,"");try{X=""!==X?JSON.parse(X):null}catch(ve){X=se,ee&&(ee=!1,X={error:ve,text:X})}}ee?(o.next(new Gw({body:X,headers:H,status:U,statusText:B,url:Z||void 0})),o.complete()):o.error(new Wz({error:X,headers:H,status:U,statusText:B,url:Z||void 0}))},A=H=>{const{url:U}=y(),B=new Wz({error:H,status:a.status||0,statusText:a.statusText||"Unknown Error",url:U||void 0});o.error(B)};let I=!1;const R=H=>{I||(o.next(y()),I=!0);let U={type:Wl.DownloadProgress,loaded:H.loaded};H.lengthComputable&&(U.total=H.total),"text"===e.responseType&&a.responseText&&(U.partialText=a.responseText),o.next(U)},O=H=>{let U={type:Wl.UploadProgress,loaded:H.loaded};H.lengthComputable&&(U.total=H.total),o.next(U)};return a.addEventListener("load",M),a.addEventListener("error",A),a.addEventListener("timeout",A),a.addEventListener("abort",A),e.reportProgress&&(a.addEventListener("progress",R),null!==u&&a.upload&&a.upload.addEventListener("progress",O)),a.send(u),o.next({type:Wl.Sent}),()=>{a.removeEventListener("error",A),a.removeEventListener("abort",A),a.removeEventListener("load",M),a.removeEventListener("timeout",A),e.reportProgress&&(a.removeEventListener("progress",R),null!==u&&a.upload&&a.upload.removeEventListener("progress",O)),a.readyState!==a.DONE&&a.abort()}})))}}return i.\u0275fac=function(e){return new(e||i)(it(mB))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const yR=new Ot("XSRF_ENABLED"),Qz=new Ot("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),eU=new Ot("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class tU{}let WJ=(()=>{class i{constructor(e,n,r){this.doc=e,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=nB(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return i.\u0275fac=function(e){return new(e||i)(it(lr),it(cc),it(Qz))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();function $J(i,t){const e=i.url.toLowerCase();if(!mi(yR)||"GET"===i.method||"HEAD"===i.method||e.startsWith("http://")||e.startsWith("https://"))return t(i);const n=mi(tU).getToken(),r=mi(eU);return null!=n&&!i.headers.has(r)&&(i=i.clone({headers:i.headers.set(r,n)})),t(i)}var va=(()=>((va=va||{})[va.Interceptors=0]="Interceptors",va[va.LegacyInterceptors=1]="LegacyInterceptors",va[va.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",va[va.NoXsrfProtection=3]="NoXsrfProtection",va[va.JsonpSupport=4]="JsonpSupport",va[va.RequestsMadeViaParent=5]="RequestsMadeViaParent",va[va.Fetch=6]="Fetch",va))();function E0(i,t){return{\u0275kind:i,\u0275providers:t}}function qJ(...i){const t=[kT,Jz,Yz,{provide:AT,useExisting:Yz},{provide:DT,useExisting:Jz},{provide:qE,useValue:$J,multi:!0},{provide:yR,useValue:!0},{provide:tU,useClass:WJ}];for(const e of i)t.push(...e.\u0275providers);return function Uy(i){return{\u0275providers:i}}(t)}const iU=new Ot("LEGACY_INTERCEPTOR_FN");let ZJ=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[qJ(E0(va.LegacyInterceptors,[{provide:iU,useFactory:NJ},{provide:qE,useExisting:iU,multi:!0}]))]}),i})();const tQ=["*"];let PT;function XE(i){return function iQ(){if(void 0===PT&&(PT=null,typeof window<"u")){const i=window;void 0!==i.trustedTypes&&(PT=i.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return PT}()?.createHTML(i)||i}function nU(i){return Error(`Unable to find icon with the name "${i}"`)}function rU(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function oU(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class C0{constructor(t,e,n){this.url=t,this.svgText=e,this.options=n}}let LT=(()=>{class i{constructor(e,n,r,o){this._httpClient=e,this._sanitizer=n,this._errorHandler=o,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(e,n,r){return this.addSvgIconInNamespace("",e,n,r)}addSvgIconLiteral(e,n,r){return this.addSvgIconLiteralInNamespace("",e,n,r)}addSvgIconInNamespace(e,n,r,o){return this._addSvgIconConfig(e,n,new C0(r,null,o))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,n,r,o){const a=this._sanitizer.sanitize(wo.HTML,r);if(!a)throw oU(r);const u=XE(a);return this._addSvgIconConfig(e,n,new C0("",u,o))}addSvgIconSet(e,n){return this.addSvgIconSetInNamespace("",e,n)}addSvgIconSetLiteral(e,n){return this.addSvgIconSetLiteralInNamespace("",e,n)}addSvgIconSetInNamespace(e,n,r){return this._addSvgIconSetConfig(e,new C0(n,null,r))}addSvgIconSetLiteralInNamespace(e,n,r){const o=this._sanitizer.sanitize(wo.HTML,n);if(!o)throw oU(n);const a=XE(o);return this._addSvgIconSetConfig(e,new C0("",a,r))}registerFontClassAlias(e,n=e){return this._fontCssClassesByAlias.set(e,n),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const n=this._sanitizer.sanitize(wo.RESOURCE_URL,e);if(!n)throw rU(e);const r=this._cachedIconsByUrl.get(n);return r?Jt(FT(r)):this._loadSvgIconFromConfig(new C0(e,null)).pipe(fc(o=>this._cachedIconsByUrl.set(n,o)),vn(o=>FT(o)))}getNamedSvgIcon(e,n=""){const r=sU(n,e);let o=this._svgIconConfigs.get(r);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(n,e),o)return this._svgIconConfigs.set(r,o),this._getSvgFromConfig(o);const a=this._iconSetConfigs.get(n);return a?this._getSvgFromIconSetConfigs(e,a):Dw(nU(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Jt(FT(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(vn(n=>FT(n)))}_getSvgFromIconSetConfigs(e,n){const r=this._extractIconWithNameFromAnySet(e,n);return r?Jt(r):fR(n.filter(a=>!a.svgText).map(a=>this._loadSvgIconSetFromConfig(a).pipe(rv(u=>{const y=`Loading icon set URL: ${this._sanitizer.sanitize(wo.RESOURCE_URL,a.url)} failed: ${u.message}`;return this._errorHandler.handleError(new Error(y)),Jt(null)})))).pipe(vn(()=>{const a=this._extractIconWithNameFromAnySet(e,n);if(!a)throw nU(e);return a}))}_extractIconWithNameFromAnySet(e,n){for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.svgText&&o.svgText.toString().indexOf(e)>-1){const a=this._svgElementFromConfig(o),u=this._extractSvgIconFromSet(a,e,o.options);if(u)return u}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(fc(n=>e.svgText=n),vn(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Jt(null):this._fetchIcon(e).pipe(fc(n=>e.svgText=n))}_extractSvgIconFromSet(e,n,r){const o=e.querySelector(`[id="${n}"]`);if(!o)return null;const a=o.cloneNode(!0);if(a.removeAttribute("id"),"svg"===a.nodeName.toLowerCase())return this._setSvgAttributes(a,r);if("symbol"===a.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(a),r);const u=this._svgElementFromString(XE("<svg></svg>"));return u.appendChild(a),this._setSvgAttributes(u,r)}_svgElementFromString(e){const n=this._document.createElement("DIV");n.innerHTML=e;const r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(e){const n=this._svgElementFromString(XE("<svg></svg>")),r=e.attributes;for(let o=0;o<r.length;o++){const{name:a,value:u}=r[o];"id"!==a&&n.setAttribute(a,u)}for(let o=0;o<e.childNodes.length;o++)e.childNodes[o].nodeType===this._document.ELEMENT_NODE&&n.appendChild(e.childNodes[o].cloneNode(!0));return n}_setSvgAttributes(e,n){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),n&&n.viewBox&&e.setAttribute("viewBox",n.viewBox),e}_fetchIcon(e){const{url:n,options:r}=e,o=r?.withCredentials??!1;if(!this._httpClient)throw function nQ(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const a=this._sanitizer.sanitize(wo.RESOURCE_URL,n);if(!a)throw rU(n);const u=this._inProgressUrlFetches.get(a);if(u)return u;const f=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(vn(y=>XE(y)),Iw(()=>this._inProgressUrlFetches.delete(a)),Wn());return this._inProgressUrlFetches.set(a,f),f}_addSvgIconConfig(e,n,r){return this._svgIconConfigs.set(sU(e,n),r),this}_addSvgIconSetConfig(e,n){const r=this._iconSetConfigs.get(e);return r?r.push(n):this._iconSetConfigs.set(e,[n]),this}_svgElementFromConfig(e){if(!e.svgElement){const n=this._svgElementFromString(e.svgText);this._setSvgAttributes(n,e.options),e.svgElement=n}return e.svgElement}_getIconConfigFromResolvers(e,n){for(let r=0;r<this._resolvers.length;r++){const o=this._resolvers[r](n,e);if(o)return oQ(o)?new C0(o.url,null,o.options):new C0(o,null)}}}return i.\u0275fac=function(e){return new(e||i)(it(kT,8),it(gk),it(lr,8),it(fe))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function FT(i){return i.cloneNode(!0)}function sU(i,t){return i+":"+t}function oQ(i){return!(!i.url||!i.options)}const sQ=Vw(class{constructor(i){this._elementRef=i}}),aQ=new Ot("MAT_ICON_DEFAULT_OPTIONS"),lQ=new Ot("mat-icon-location",{providedIn:"root",factory:function cQ(){const i=mi(lr),t=i?i.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),aU=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],dQ=aU.map(i=>`[${i}]`).join(", "),uQ=/^url\(['"]?#(.*?)['"]?\)$/;let S0=(()=>{class i extends sQ{get inline(){return this._inline}set inline(e){this._inline=dn(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const n=this._cleanupFontValue(e);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const n=this._cleanupFontValue(e);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}constructor(e,n,r,o,a,u){super(e),this._iconRegistry=n,this._location=o,this._errorHandler=a,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=gt.EMPTY,u&&(u.color&&(this.color=this.defaultColor=u.color),u.fontSet&&(this.fontSet=u.fontSet)),r||e.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];const n=e.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let n=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const r=e.childNodes[n];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>e.classList.remove(r)),n.forEach(r=>e.classList.add(r)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const n=this._elementsWithExternalReferences;n&&n.forEach((r,o)=>{r.forEach(a=>{o.setAttribute(a.name,`url('${e}#${a.value}')`)})})}_cacheChildrenWithExternalReferences(e){const n=e.querySelectorAll(dQ),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<n.length;o++)aU.forEach(a=>{const u=n[o],f=u.getAttribute(a),y=f?f.match(uQ):null;if(y){let M=r.get(u);M||(M=[],r.set(u,M)),M.push({name:a,value:y[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[n,r]=this._splitIconName(e);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(ss(1)).subscribe(o=>this._setSvgElement(o),o=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${r}! ${o.message}`))})}}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(LT),Bl("aria-hidden"),oe(lQ),oe(fe),oe(aQ,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(e,n){2&e&&(Mn("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),Un("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Zi],ngContentSelectors:tQ,decls:1,vars:0,template:function(e,n){1&e&&(Lo(),Hi(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),i})(),T0=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,$o]}),i})(),lU=(()=>{class i{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(e){this._vertical=dn(e)}get inset(){return this._inset}set inset(e){this._inset=dn(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ui({type:i,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(e,n){2&e&&(Mn("aria-orientation",n.vertical?"vertical":"horizontal"),Un("mat-divider-vertical",n.vertical)("mat-divider-horizontal",!n.vertical)("mat-divider-inset",n.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(e,n){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0}),i})(),vR=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,$o]}),i})();class bR{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(t=!1,e,n=!0,r){this._multiple=t,this._emitChanges=n,this.compareWith=r,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new Fi,e&&e.length&&(t?e.forEach(o=>this._markSelected(o)):this._markSelected(e[0]),this._selectedToEmit.length=0)}select(...t){this._verifyValueAssignment(t),t.forEach(n=>this._markSelected(n));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...t){this._verifyValueAssignment(t),t.forEach(n=>this._unmarkSelected(n));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...t){this._verifyValueAssignment(t);const e=this.selected,n=new Set(t);t.forEach(o=>this._markSelected(o)),e.filter(o=>!n.has(o)).forEach(o=>this._unmarkSelected(o));const r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();const e=this._hasQueuedChanges();return t&&this._emitChangeEvent(),e}isSelected(t){return this._selection.has(this._getConcreteValue(t))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){t=this._getConcreteValue(t),this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){t=this._getConcreteValue(t),this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(t){if(this.compareWith){for(let e of this._selection)if(this.compareWith(t,e))return e;return t}return t}}let cU=(()=>{class i{constructor(e,n){this._renderer=e,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return i.\u0275fac=function(e){return new(e||i)(oe(sp),oe(tn))},i.\u0275dir=si({type:i}),i})(),A0=(()=>{class i extends cU{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275dir=si({type:i,features:[Zi]}),i})();const wh=new Ot("NgValueAccessor"),pQ={provide:wh,useExisting:ir(()=>ZE),multi:!0},mQ=new Ot("CompositionEventMode");let ZE=(()=>{class i extends cU{constructor(e,n,r){super(e,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function fQ(){const i=tv()?tv().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return i.\u0275fac=function(e){return new(e||i)(oe(sp),oe(tn),oe(mQ,8))},i.\u0275dir=si({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,n){1&e&&ji("input",function(o){return n._handleInput(o.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(o){return n._compositionEnd(o.target.value)})},features:[Qn([pQ]),Zi]}),i})();function pv(i){return null==i||("string"==typeof i||Array.isArray(i))&&0===i.length}function uU(i){return null!=i&&"number"==typeof i.length}const Bc=new Ot("NgValidators"),fv=new Ot("NgAsyncValidators"),gQ=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class OT{static min(t){return function hU(i){return t=>{if(pv(t.value)||pv(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}(t)}static max(t){return function pU(i){return t=>{if(pv(t.value)||pv(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}(t)}static required(t){return function fU(i){return pv(i.value)?{required:!0}:null}(t)}static requiredTrue(t){return function mU(i){return!0===i.value?null:{required:!0}}(t)}static email(t){return function gU(i){return pv(i.value)||gQ.test(i.value)?null:{email:!0}}(t)}static minLength(t){return function _U(i){return t=>pv(t.value)||!uU(t.value)?null:t.value.length<i?{minlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function yU(i){return t=>uU(t.value)&&t.value.length>i?{maxlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static pattern(t){return function vU(i){if(!i)return NT;let t,e;return"string"==typeof i?(e="","^"!==i.charAt(0)&&(e+="^"),e+=i,"$"!==i.charAt(i.length-1)&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),n=>{if(pv(n.value))return null;const r=n.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(t)}static nullValidator(t){return null}static compose(t){return CU(t)}static composeAsync(t){return SU(t)}}function NT(i){return null}function bU(i){return null!=i}function xU(i){return KM(i)?Zo(i):i}function wU(i){let t={};return i.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function MU(i,t){return t.map(e=>e(i))}function EU(i){return i.map(t=>function _Q(i){return!i.validate}(t)?t:e=>t.validate(e))}function CU(i){if(!i)return null;const t=i.filter(bU);return 0==t.length?null:function(e){return wU(MU(e,t))}}function xR(i){return null!=i?CU(EU(i)):null}function SU(i){if(!i)return null;const t=i.filter(bU);return 0==t.length?null:function(e){return fR(MU(e,t).map(xU)).pipe(vn(wU))}}function wR(i){return null!=i?SU(EU(i)):null}function TU(i,t){return null===i?[t]:Array.isArray(i)?[...i,t]:[i,t]}function AU(i){return i._rawValidators}function DU(i){return i._rawAsyncValidators}function MR(i){return i?Array.isArray(i)?i:[i]:[]}function BT(i,t){return Array.isArray(i)?i.includes(t):i===t}function IU(i,t){const e=MR(t);return MR(i).forEach(r=>{BT(e,r)||e.push(r)}),e}function kU(i,t){return MR(t).filter(e=>!BT(i,e))}class RU{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=xR(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=wR(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Tu extends RU{get formDirective(){return null}get path(){return null}}class sm extends RU{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class PU{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let ER=(()=>{class i extends PU{constructor(e){super(e)}}return i.\u0275fac=function(e){return new(e||i)(oe(sm,2))},i.\u0275dir=si({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,n){2&e&&Un("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[Zi]}),i})();const YE="VALID",UT="INVALID",jw="PENDING",KE="DISABLED";function TR(i){return(VT(i)?i.validators:i)||null}function AR(i,t){return(VT(t)?t.asyncValidators:i)||null}function VT(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}class NU{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===YE}get invalid(){return this.status===UT}get pending(){return this.status==jw}get disabled(){return this.status===KE}get enabled(){return this.status!==KE}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(IU(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(IU(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(kU(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(kU(t,this._rawAsyncValidators))}hasValidator(t){return BT(this._rawValidators,t)}hasAsyncValidator(t){return BT(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=jw,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=KE,this.errors=null,this._forEachChild(n=>{n.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(n=>n(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=YE,this._forEachChild(n=>{n.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===YE||this.status===jw)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?KE:YE}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=jw,this._hasOwnPendingAsyncValidator=!0;const e=xU(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((n,r)=>n&&n._find(r),this)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Mi,this.statusChanges=new Mi}_calculateStatus(){return this._allControlsDisabled()?KE:this.errors?UT:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(jw)?jw:this._anyControlsHaveStatus(UT)?UT:YE}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){VT(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function wQ(i){return Array.isArray(i)?xR(i):i||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function MQ(i){return Array.isArray(i)?wR(i):i||null}(this._rawAsyncValidators)}}class DR extends NU{constructor(t,e,n){super(TR(e),AR(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){(function OU(i,t,e){i._forEachChild((n,r)=>{if(void 0===e[r])throw new Ct(1002,"")})})(this,0,t),Object.keys(t).forEach(n=>{(function FU(i,t,e){const n=i.controls;if(!(t?Object.keys(n):n).length)throw new Ct(1e3,"");if(!n[e])throw new Ct(1001,"")})(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{const r=this.controls[n];r&&r.patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,n)=>!!n._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,n]of Object.entries(this.controls))if(this.contains(e)&&t(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,n,r)=>((n.enabled||this.disabled)&&(e[r]=n.value),e))}_reduceChildren(t,e){let n=t;return this._forEachChild((r,o)=>{n=e(n,r,o)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}const Ww=new Ot("CallSetDisabledState",{providedIn:"root",factory:()=>HT}),HT="always";function JE(i,t,e=HT){IR(i,t),t.valueAccessor.writeValue(i.value),(i.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(i.disabled),function SQ(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&BU(i,t)})}(i,t),function AQ(i,t){const e=(n,r)=>{t.valueAccessor.writeValue(n),r&&t.viewToModelUpdate(n)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}(i,t),function TQ(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&BU(i,t),"submit"!==i.updateOn&&i.markAsTouched()})}(i,t),function CQ(i,t){if(t.valueAccessor.setDisabledState){const e=n=>{t.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}(i,t)}function jT(i,t,e=!0){const n=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),$T(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function WT(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function IR(i,t){const e=AU(i);null!==t.validator?i.setValidators(TU(e,t.validator)):"function"==typeof e&&i.setValidators([e]);const n=DU(i);null!==t.asyncValidator?i.setAsyncValidators(TU(n,t.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();WT(t._rawValidators,r),WT(t._rawAsyncValidators,r)}function $T(i,t){let e=!1;if(null!==i){if(null!==t.validator){const r=AU(i);if(Array.isArray(r)&&r.length>0){const o=r.filter(a=>a!==t.validator);o.length!==r.length&&(e=!0,i.setValidators(o))}}if(null!==t.asyncValidator){const r=DU(i);if(Array.isArray(r)&&r.length>0){const o=r.filter(a=>a!==t.asyncValidator);o.length!==r.length&&(e=!0,i.setAsyncValidators(o))}}}const n=()=>{};return WT(t._rawValidators,n),WT(t._rawAsyncValidators,n),e}function BU(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function zU(i,t){IR(i,t)}function UU(i,t){i._syncPendingControls(),t.forEach(e=>{const n=e.control;"submit"===n.updateOn&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}const PQ={provide:Tu,useExisting:ir(()=>$w)},QE=(()=>Promise.resolve())();let $w=(()=>{class i extends Tu{constructor(e,n,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Mi,this.form=new DR({},xR(e),wR(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){QE.then(()=>{const n=this._findContainer(e.path);e.control=n.registerControl(e.name,e.control),JE(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){QE.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){QE.then(()=>{const n=this._findContainer(e.path),r=new DR({});zU(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){QE.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,n){QE.then(()=>{this.form.get(e.path).setValue(n)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,UU(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return i.\u0275fac=function(e){return new(e||i)(oe(Bc,10),oe(fv,10),oe(Ww,8))},i.\u0275dir=si({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,n){1&e&&ji("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Qn([PQ]),Zi]}),i})();function VU(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}function HU(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const D_=class extends NU{constructor(t=null,e,n){super(TR(e),AR(n,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),VT(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=HU(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){VU(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){VU(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){HU(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};let XU=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})();const LR=new Ot("NgModelWithFormControlWarning"),HQ={provide:sm,useExisting:ir(()=>qT)};let qT=(()=>{class i extends sm{set isDisabled(e){}constructor(e,n,r,o,a){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=a,this.update=new Mi,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=function PR(i,t){if(!t)return null;let e,n,r;return Array.isArray(t),t.forEach(o=>{o.constructor===ZE?e=o:function kQ(i){return Object.getPrototypeOf(i.constructor)===A0}(o)?n=o:r=o}),r||n||e||null}(0,r)}ngOnChanges(e){if(this._isControlChanged(e)){const n=e.form.previousValue;n&&jT(n,this,!1),JE(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}(function RR(i,t){if(!i.hasOwnProperty("model"))return!1;const e=i.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)})(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&jT(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return i._ngModelWarningSentOnce=!1,i.\u0275fac=function(e){return new(e||i)(oe(Bc,10),oe(fv,10),oe(wh,10),oe(LR,8),oe(Ww,8))},i.\u0275dir=si({type:i,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Qn([HQ]),Zi,le]}),i})();const GQ={provide:Tu,useExisting:ir(()=>qw)};let qw=(()=>{class i extends Tu{constructor(e,n,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Mi,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&($T(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const n=this.form.get(e.path);return JE(n,e,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){jT(e.control||null,e,!1),function RQ(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this.submitted=!0,UU(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const n=e.control,r=this.form.get(e.path);n!==r&&(jT(n||null,e),(i=>i instanceof D_)(r)&&(JE(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const n=this.form.get(e.path);zU(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const n=this.form.get(e.path);n&&function DQ(i,t){return $T(i,t)}(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){IR(this.form,this),this._oldForm&&$T(this._oldForm,this)}_checkFormPresent(){}}return i.\u0275fac=function(e){return new(e||i)(oe(Bc,10),oe(fv,10),oe(Ww,8))},i.\u0275dir=si({type:i,selectors:[["","formGroup",""]],hostBindings:function(e,n){1&e&&ji("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Qn([GQ]),Zi,le]}),i})(),aee=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[XU]}),i})(),cV=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:LR,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:Ww,useValue:e.callSetDisabledState??HT}]}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[aee]}),i})();const dV=["*"],hV=["unscopedContent"],cee=["text"],dee=[[["","matListItemAvatar",""],["","matListItemIcon",""]],[["","matListItemTitle",""]],[["","matListItemLine",""]],"*",[["","matListItemMeta",""]],[["mat-divider"]]],uee=["[matListItemAvatar],[matListItemIcon]","[matListItemTitle]","[matListItemLine]","*","[matListItemMeta]","mat-divider"],pV=new Ot("ListOption");let VR=(()=>{class i{constructor(e){this._elementRef=e}}return i.\u0275fac=function(e){return new(e||i)(oe(tn))},i.\u0275dir=si({type:i,selectors:[["","matListItemTitle",""]],hostAttrs:[1,"mat-mdc-list-item-title","mdc-list-item__primary-text"]}),i})(),HR=(()=>{class i{constructor(e){this._elementRef=e}}return i.\u0275fac=function(e){return new(e||i)(oe(tn))},i.\u0275dir=si({type:i,selectors:[["","matListItemLine",""]],hostAttrs:[1,"mat-mdc-list-item-line","mdc-list-item__secondary-text"]}),i})(),Dee=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["","matListItemMeta",""]],hostAttrs:[1,"mat-mdc-list-item-meta","mdc-list-item__end"]}),i})(),fV=(()=>{class i{constructor(e){this._listOption=e}_isAlignedAtStart(){return!this._listOption||"after"===this._listOption?._getTogglePosition()}}return i.\u0275fac=function(e){return new(e||i)(oe(pV,8))},i.\u0275dir=si({type:i,hostVars:4,hostBindings:function(e,n){2&e&&Un("mdc-list-item__start",n._isAlignedAtStart())("mdc-list-item__end",!n._isAlignedAtStart())}}),i})(),Iee=(()=>{class i extends fV{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275dir=si({type:i,selectors:[["","matListItemAvatar",""]],hostAttrs:[1,"mat-mdc-list-item-avatar"],features:[Zi]}),i})(),kee=(()=>{class i extends fV{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275dir=si({type:i,selectors:[["","matListItemIcon",""]],hostAttrs:[1,"mat-mdc-list-item-icon"],features:[Zi]}),i})();const Ree=new Ot("MAT_LIST_CONFIG");let Xw=(()=>{class i{constructor(){this._isNonInteractive=!0,this._disableRipple=!1,this._disabled=!1,this._defaultOptions=mi(Ree,{optional:!0})}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=dn(e)}get disabled(){return this._disabled}set disabled(e){this._disabled=dn(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,hostVars:1,hostBindings:function(e,n){2&e&&Mn("aria-disabled",n.disabled)},inputs:{disableRipple:"disableRipple",disabled:"disabled"}}),i})(),GR=(()=>{class i{set lines(e){this._explicitLines=dv(e,null),this._updateItemLines(!1)}get disableRipple(){return this.disabled||this._disableRipple||this._noopAnimations||!!this._listBase?.disableRipple}set disableRipple(e){this._disableRipple=dn(e)}get disabled(){return this._disabled||!!this._listBase?.disabled}set disabled(e){this._disabled=dn(e)}get rippleDisabled(){return this.disableRipple||!!this.rippleConfig.disabled}constructor(e,n,r,o,a,u){this._elementRef=e,this._ngZone=n,this._listBase=r,this._platform=o,this._explicitLines=null,this._disableRipple=!1,this._disabled=!1,this._subscriptions=new gt,this._rippleRenderer=null,this._hasUnscopedTextContent=!1,this.rippleConfig=a||{},this._hostElement=this._elementRef.nativeElement,this._isButtonElement="button"===this._hostElement.nodeName.toLowerCase(),this._noopAnimations="NoopAnimations"===u,r&&!r._isNonInteractive&&this._initInteractiveListItem(),this._isButtonElement&&!this._hostElement.hasAttribute("type")&&this._hostElement.setAttribute("type","button")}ngAfterViewInit(){this._monitorProjectedLinesAndTitle(),this._updateItemLines(!0)}ngOnDestroy(){this._subscriptions.unsubscribe(),null!==this._rippleRenderer&&this._rippleRenderer._removeTriggerEvents()}_hasIconOrAvatar(){return!(!this._avatars.length&&!this._icons.length)}_initInteractiveListItem(){this._hostElement.classList.add("mat-mdc-list-item-interactive"),this._rippleRenderer=new b0(this,this._ngZone,this._hostElement,this._platform),this._rippleRenderer.setupTriggerEvents(this._hostElement)}_monitorProjectedLinesAndTitle(){this._ngZone.runOutsideAngular(()=>{this._subscriptions.add(oi(this._lines.changes,this._titles.changes).subscribe(()=>this._updateItemLines(!1)))})}_updateItemLines(e){if(!this._lines||!this._titles||!this._unscopedContent)return;e&&this._checkDomForUnscopedTextContent();const n=this._explicitLines??this._inferLinesFromContent(),r=this._unscopedContent.nativeElement;if(this._hostElement.classList.toggle("mat-mdc-list-item-single-line",n<=1),this._hostElement.classList.toggle("mdc-list-item--with-one-line",n<=1),this._hostElement.classList.toggle("mdc-list-item--with-two-lines",2===n),this._hostElement.classList.toggle("mdc-list-item--with-three-lines",3===n),this._hasUnscopedTextContent){const o=0===this._titles.length&&1===n;r.classList.toggle("mdc-list-item__primary-text",o),r.classList.toggle("mdc-list-item__secondary-text",!o)}else r.classList.remove("mdc-list-item__primary-text"),r.classList.remove("mdc-list-item__secondary-text")}_inferLinesFromContent(){let e=this._titles.length+this._lines.length;return this._hasUnscopedTextContent&&(e+=1),e}_checkDomForUnscopedTextContent(){this._hasUnscopedTextContent=Array.from(this._unscopedContent.nativeElement.childNodes).filter(e=>e.nodeType!==e.COMMENT_NODE).some(e=>!(!e.textContent||!e.textContent.trim()))}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Ji),oe(Xw,8),oe(Js),oe(x0,8),oe(ma,8))},i.\u0275dir=si({type:i,contentQueries:function(e,n,r){if(1&e&&(Qr(r,Iee,4),Qr(r,kee,4)),2&e){let o;zi(o=Ui())&&(n._avatars=o),zi(o=Ui())&&(n._icons=o)}},hostVars:4,hostBindings:function(e,n){2&e&&(Mn("aria-disabled",n.disabled)("disabled",n._isButtonElement&&n.disabled||null),Un("mdc-list-item--disabled",n.disabled))},inputs:{lines:"lines",disableRipple:"disableRipple",disabled:"disabled"}}),i})(),eC=(()=>{class i extends Xw{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275cmp=ui({type:i,selectors:[["mat-list"]],hostAttrs:[1,"mat-mdc-list","mat-mdc-list-base","mdc-list"],exportAs:["matList"],features:[Qn([{provide:Xw,useExisting:i}]),Zi],ngContentSelectors:dV,decls:1,vars:0,template:function(e,n){1&e&&(Lo(),Hi(0))},styles:['@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-list-divider::after{content:"";display:block;border-bottom-width:1px;border-bottom-style:solid}}.mdc-list{margin:0;padding:8px 0;list-style-type:none}.mdc-list:focus{outline:none}.mdc-list-item__wrapper{display:block}.mdc-list-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;align-items:stretch;cursor:pointer}.mdc-list-item:focus{outline:none}.mdc-list-item.mdc-list-item--with-one-line{height:48px}.mdc-list-item.mdc-list-item--with-two-lines{height:64px}.mdc-list-item.mdc-list-item--with-three-lines{height:88px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__start{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--disabled,.mdc-list-item.mdc-list-item--non-interactive{cursor:auto}.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item:not(.mdc-list-item--selected):focus::before,.mdc-list-item.mdc-ripple-upgraded--background-focused::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px double rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected::before{border-color:CanvasText}}.mdc-list-item.mdc-list-item--selected:focus::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:3px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-list-item.mdc-list-item--selected:focus::before{border-color:CanvasText}}a.mdc-list-item{color:inherit;text-decoration:none}.mdc-list-item__start{fill:currentColor;flex-shrink:0;pointer-events:none}.mdc-list-item__end{flex-shrink:0;pointer-events:none}.mdc-list-item__content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;align-self:center;flex:1;pointer-events:none}.mdc-list-item--with-two-lines .mdc-list-item__content,.mdc-list-item--with-three-lines .mdc-list-item__content{align-self:stretch}.mdc-list-item__content[for]{pointer-events:none}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item__secondary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__secondary-text{white-space:normal;line-height:20px}.mdc-list-item--with-overline .mdc-list-item__secondary-text{white-space:nowrap;line-height:auto}.mdc-list-item__overline-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-avatar.mdc-list-item,.mdc-list-item--with-leading-avatar.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-avatar .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-avatar .mdc-list-item__start,.mdc-list-item--with-leading-avatar .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-avatar.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-avatar .mdc-list-item__start{border-radius:50%}.mdc-list-item--with-leading-icon.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-icon.mdc-list-item,.mdc-list-item--with-leading-icon.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-icon .mdc-list-item__start{margin-left:16px;margin-right:32px}[dir=rtl] .mdc-list-item--with-leading-icon .mdc-list-item__start,.mdc-list-item--with-leading-icon .mdc-list-item__start[dir=rtl]{margin-left:32px;margin-right:16px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-icon.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-thumbnail.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-thumbnail.mdc-list-item,.mdc-list-item--with-leading-thumbnail.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-thumbnail .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-thumbnail .mdc-list-item__start,.mdc-list-item--with-leading-thumbnail .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-thumbnail.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-image.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-image.mdc-list-item,.mdc-list-item--with-leading-image.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-image .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-image .mdc-list-item__start,.mdc-list-item--with-leading-image .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-image.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-image.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-video.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-video.mdc-list-item,.mdc-list-item--with-leading-video.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-video .mdc-list-item__start{margin-left:0;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-video .mdc-list-item__start,.mdc-list-item--with-leading-video .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-video.mdc-list-item--with-one-line{height:72px}.mdc-list-item--with-leading-video.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-checkbox.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-checkbox.mdc-list-item,.mdc-list-item--with-leading-checkbox.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-checkbox .mdc-list-item__start,.mdc-list-item--with-leading-checkbox .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-radio.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-radio.mdc-list-item,.mdc-list-item--with-leading-radio.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-radio .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-radio .mdc-list-item__start,.mdc-list-item--with-leading-radio .mdc-list-item__start[dir=rtl]{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-leading-switch.mdc-list-item{padding-left:0;padding-right:auto}[dir=rtl] .mdc-list-item--with-leading-switch.mdc-list-item,.mdc-list-item--with-leading-switch.mdc-list-item[dir=rtl]{padding-left:auto;padding-right:0}.mdc-list-item--with-leading-switch .mdc-list-item__start{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-leading-switch .mdc-list-item__start,.mdc-list-item--with-leading-switch .mdc-list-item__start[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines .mdc-list-item__overline-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-switch.mdc-list-item--with-one-line{height:56px}.mdc-list-item--with-leading-switch.mdc-list-item--with-two-lines{height:72px}.mdc-list-item--with-trailing-icon.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-icon.mdc-list-item,.mdc-list-item--with-trailing-icon.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-icon .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-icon .mdc-list-item__end,.mdc-list-item--with-trailing-icon .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-meta.mdc-list-item,.mdc-list-item--with-trailing-meta.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-meta .mdc-list-item__end{margin-left:28px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-trailing-meta .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:28px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-trailing-meta .mdc-list-item__end{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mdc-typography-caption-font-family);font-size:var(--mdc-typography-caption-font-size);line-height:var(--mdc-typography-caption-line-height);font-weight:var(--mdc-typography-caption-font-weight);letter-spacing:var(--mdc-typography-caption-letter-spacing);text-decoration:var(--mdc-typography-caption-text-decoration);text-transform:var(--mdc-typography-caption-text-transform)}.mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item,.mdc-list-item--with-trailing-checkbox.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-checkbox .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-radio.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item,.mdc-list-item--with-trailing-radio.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-radio .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-radio .mdc-list-item__end,.mdc-list-item--with-trailing-radio .mdc-list-item__end[dir=rtl]{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-switch.mdc-list-item{padding-left:auto;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-switch.mdc-list-item,.mdc-list-item--with-trailing-switch.mdc-list-item[dir=rtl]{padding-left:0;padding-right:auto}.mdc-list-item--with-trailing-switch .mdc-list-item__end{margin-left:16px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-switch .mdc-list-item__end,.mdc-list-item--with-trailing-switch .mdc-list-item__end[dir=rtl]{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-switch.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-overline.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item{padding-left:16px;padding-right:16px}[dir=rtl] .mdc-list-item,.mdc-list-item[dir=rtl]{padding-left:16px;padding-right:16px}.mdc-list-group .mdc-deprecated-list{padding:0}.mdc-list-group__subheader{margin:calc((3rem - 1.5rem)/2) 16px}.mdc-list-divider{padding:0;background-clip:content-box}.mdc-list-divider.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset{padding-left:16px;padding-right:auto}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset,.mdc-list-divider.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-leading-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:16px}.mdc-list-divider.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset{padding-left:auto;padding-right:16px}[dir=rtl] .mdc-list-divider.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset,[dir=rtl] .mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset,.mdc-list-divider.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-text.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-icon.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-image.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-thumbnail.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-avatar.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-checkbox.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-switch.mdc-list-divider--with-trailing-inset[dir=rtl],.mdc-list-divider--with-leading-radio.mdc-list-divider--with-trailing-inset[dir=rtl]{padding-left:16px;padding-right:auto}.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset{padding-left:0px;padding-right:auto}[dir=rtl] .mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset,.mdc-list-divider--with-leading-video.mdc-list-divider--with-leading-inset[dir=rtl]{padding-left:auto;padding-right:0px}[dir=rtl] .mdc-list-divider,.mdc-list-divider[dir=rtl]{padding:0}.mdc-list-item{background-color:var(--mdc-list-list-item-container-color)}.mdc-list-item.mdc-list-item--selected{background-color:var(--mdc-list-list-item-selected-container-color)}.mdc-list-item--with-one-line{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-one-line.mdc-list-item--with-leading-avatar,.mdc-list-item--with-one-line.mdc-list-item--with-leading-icon,.mdc-list-item--with-one-line.mdc-list-item--with-leading-thumbnail,.mdc-list-item--with-one-line.mdc-list-item--with-leading-checkbox,.mdc-list-item--with-one-line.mdc-list-item--with-leading-radio,.mdc-list-item--with-one-line.mdc-list-item--with-leading-switch{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-one-line.mdc-list-item--with-leading-image,.mdc-list-item--with-one-line.mdc-list-item--with-leading-video{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-two-lines{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-two-lines.mdc-list-item--with-leading-avatar,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-icon,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-thumbnail,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-checkbox,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-radio,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-switch,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-image,.mdc-list-item--with-two-lines.mdc-list-item--with-leading-video{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item--with-three-lines{border-radius:var(--mdc-list-list-item-container-shape)}.mdc-list-item.mdc-list-item--with-one-line{height:var(--mdc-list-list-item-one-line-container-height)}.mdc-list-item.mdc-list-item--with-two-lines{height:var(--mdc-list-list-item-two-line-container-height)}.mdc-list-item.mdc-list-item--with-three-lines{height:var(--mdc-list-list-item-three-line-container-height)}.mdc-list-item__primary-text{color:var(--mdc-list-list-item-label-text-color)}.mdc-list-item__primary-text{font-family:var(--mdc-list-list-item-label-text-font);line-height:var(--mdc-list-list-item-label-text-line-height);font-size:var(--mdc-list-list-item-label-text-size);font-weight:var(--mdc-list-list-item-label-text-weight);letter-spacing:var(--mdc-list-list-item-label-text-tracking)}.mdc-list-item__secondary-text{color:var(--mdc-list-list-item-supporting-text-color)}.mdc-list-item__secondary-text{font-family:var(--mdc-list-list-item-supporting-text-font);line-height:var(--mdc-list-list-item-supporting-text-line-height);font-size:var(--mdc-list-list-item-supporting-text-size);font-weight:var(--mdc-list-list-item-supporting-text-weight);letter-spacing:var(--mdc-list-list-item-supporting-text-tracking)}.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mdc-list-list-item-leading-icon-color)}.mdc-list-item--with-leading-icon .mdc-list-item__start{width:var(--mdc-list-list-item-leading-icon-size);height:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-icon .mdc-list-item__start>i{font-size:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-icon .mdc-list-item__start .mdc-list-item__icon{font-size:var(--mdc-list-list-item-leading-icon-size);width:var(--mdc-list-list-item-leading-icon-size);height:var(--mdc-list-list-item-leading-icon-size)}.mdc-list-item--with-leading-icon .mdc-list-item__start .mdc-list-item__icon,.mdc-list-item--with-leading-icon .mdc-list-item__start .mdc-list-item__icon>.materialdesignWizIconSvgsSvgIcon{display:block}.mdc-list-item--with-leading-avatar .mdc-list-item__start{width:var(--mdc-list-list-item-leading-avatar-size);height:var(--mdc-list-list-item-leading-avatar-size)}.mdc-list-item.mdc-list-item--with-trailing-meta .mdc-list-item__end{color:var(--mdc-list-list-item-trailing-supporting-text-color)}.mdc-list-item--with-trailing-meta .mdc-list-item__end{font-family:var(--mdc-list-list-item-trailing-supporting-text-font);line-height:var(--mdc-list-list-item-trailing-supporting-text-line-height);font-size:var(--mdc-list-list-item-trailing-supporting-text-size);font-weight:var(--mdc-list-list-item-trailing-supporting-text-weight);letter-spacing:var(--mdc-list-list-item-trailing-supporting-text-tracking)}.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-trailing-icon-color)}.mdc-list-item--with-trailing-icon .mdc-list-item__end{width:var(--mdc-list-list-item-trailing-icon-size);height:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--with-trailing-icon .mdc-list-item__end>i{font-size:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--with-trailing-icon .mdc-list-item__end .mdc-list-item__icon{font-size:var(--mdc-list-list-item-trailing-icon-size);width:var(--mdc-list-list-item-trailing-icon-size);height:var(--mdc-list-list-item-trailing-icon-size)}.mdc-list-item--with-trailing-icon .mdc-list-item__end .mdc-list-item__icon,.mdc-list-item--with-trailing-icon .mdc-list-item__end .mdc-list-item__icon>.materialdesignWizIconSvgsSvgIcon{display:block}.mdc-list-item--selected.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-selected-trailing-icon-color)}.mdc-list-item--disabled .mdc-list-item__start,.mdc-list-item--disabled .mdc-list-item__content,.mdc-list-item--disabled .mdc-list-item__end{opacity:1}.mdc-list-item--disabled .mdc-list-item__primary-text,.mdc-list-item--disabled .mdc-list-item__secondary-text,.mdc-list-item--disabled .mdc-list-item__overline-text{opacity:var(--mdc-list-list-item-disabled-label-text-opacity)}.mdc-list-item--disabled.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mdc-list-list-item-disabled-leading-icon-color)}.mdc-list-item--disabled.mdc-list-item--with-leading-icon .mdc-list-item__start{opacity:var(--mdc-list-list-item-disabled-leading-icon-opacity)}.mdc-list-item--disabled.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-disabled-trailing-icon-color)}.mdc-list-item--disabled.mdc-list-item--with-trailing-icon .mdc-list-item__end{opacity:var(--mdc-list-list-item-disabled-trailing-icon-opacity)}.mdc-list-item:hover .mdc-list-item__primary-text{color:var(--mdc-list-list-item-hover-label-text-color)}.mdc-list-item--with-leading-icon:hover .mdc-list-item__start{color:var(--mdc-list-list-item-hover-leading-icon-color)}.mdc-list-item--with-trailing-icon:hover .mdc-list-item__end{color:var(--mdc-list-list-item-hover-trailing-icon-color)}.mdc-list-item:focus .mdc-list-item__primary-text{color:var(--mdc-list-list-item-focus-label-text-color)}.mdc-list-item.mdc-list-item--disabled .mdc-list-item__primary-text{color:var(--mdc-list-list-item-disabled-label-text-color)}.mdc-list-item:hover::before{background-color:var(--mdc-list-list-item-hover-state-layer-color);opacity:var(--mdc-list-list-item-hover-state-layer-opacity)}.mdc-list-item.mdc-list-item--disabled::before{background-color:var(--mdc-list-list-item-disabled-state-layer-color);opacity:var(--mdc-list-list-item-disabled-state-layer-opacity)}.mdc-list-item:focus::before{background-color:var(--mdc-list-list-item-focus-state-layer-color);opacity:var(--mdc-list-list-item-focus-state-layer-opacity)}.mdc-list-item--disabled .mdc-radio,.mdc-list-item--disabled .mdc-checkbox{opacity:var(--mdc-list-list-item-disabled-label-text-opacity)}.mdc-list-item--with-leading-avatar .mat-mdc-list-item-avatar{border-radius:var(--mdc-list-list-item-leading-avatar-shape);background-color:var(--mdc-list-list-item-leading-avatar-color)}.mat-mdc-list-base{--mdc-list-list-item-container-shape:0;--mdc-list-list-item-leading-avatar-shape:50%;--mdc-list-list-item-container-color:transparent;--mdc-list-list-item-selected-container-color:transparent;--mdc-list-list-item-leading-avatar-color:transparent;--mdc-list-list-item-leading-icon-size:24px;--mdc-list-list-item-leading-avatar-size:40px;--mdc-list-list-item-trailing-icon-size:24px;--mdc-list-list-item-disabled-state-layer-color:transparent;--mdc-list-list-item-disabled-state-layer-opacity:0;--mdc-list-list-item-disabled-label-text-opacity:0.38;--mdc-list-list-item-disabled-leading-icon-opacity:0.38;--mdc-list-list-item-disabled-trailing-icon-opacity:0.38}.cdk-high-contrast-active a.mdc-list-item--activated::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active a.mdc-list-item--activated [dir=rtl]::after{right:auto;left:16px}.mat-mdc-list-base{display:block}.mat-mdc-list-base .mdc-list-item__start,.mat-mdc-list-base .mdc-list-item__end,.mat-mdc-list-base .mdc-list-item__content{pointer-events:auto}.mat-mdc-list-item,.mat-mdc-list-option{width:100%;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-list-item:not(.mat-mdc-list-item-interactive),.mat-mdc-list-option:not(.mat-mdc-list-item-interactive){cursor:default}.mat-mdc-list-item .mat-divider-inset,.mat-mdc-list-option .mat-divider-inset{position:absolute;left:0;right:0;bottom:0}.mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,.mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-left:72px}[dir=rtl] .mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,[dir=rtl] .mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-right:72px}.mat-mdc-list-item-interactive::before{top:0;left:0;right:0;bottom:0;position:absolute;content:"";opacity:0;pointer-events:none}.mat-mdc-list-item>.mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-list-item:focus>.mat-mdc-focus-indicator::before{content:""}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-line.mdc-list-item__secondary-text{white-space:nowrap;line-height:normal}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-unscoped-content.mdc-list-item__secondary-text{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}'],encapsulation:2,changeDetection:0}),i})(),jR=(()=>{class i extends GR{get activated(){return this._activated}set activated(e){this._activated=dn(e)}constructor(e,n,r,o,a,u){super(e,n,r,o,a,u),this._activated=!1}_getAriaCurrent(){return"A"===this._hostElement.nodeName&&this._activated?"page":null}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Ji),oe(Xw,8),oe(Js),oe(x0,8),oe(ma,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(e,n,r){if(1&e&&(Qr(r,HR,5),Qr(r,VR,5),Qr(r,Dee,5)),2&e){let o;zi(o=Ui())&&(n._lines=o),zi(o=Ui())&&(n._titles=o),zi(o=Ui())&&(n._meta=o)}},viewQuery:function(e,n){if(1&e&&(uo(hV,5),uo(cee,5)),2&e){let r;zi(r=Ui())&&(n._unscopedContent=r.first),zi(r=Ui())&&(n._itemText=r.first)}},hostAttrs:[1,"mat-mdc-list-item","mdc-list-item"],hostVars:11,hostBindings:function(e,n){2&e&&(Mn("aria-current",n._getAriaCurrent()),Un("mdc-list-item--activated",n.activated)("mdc-list-item--with-leading-avatar",0!==n._avatars.length)("mdc-list-item--with-leading-icon",0!==n._icons.length)("mdc-list-item--with-trailing-meta",0!==n._meta.length)("_mat-animation-noopable",n._noopAnimations))},inputs:{activated:"activated"},exportAs:["matListItem"],features:[Zi],ngContentSelectors:uee,decls:10,vars:0,consts:[[1,"mdc-list-item__content"],[1,"mat-mdc-list-item-unscoped-content",3,"cdkObserveContent"],["unscopedContent",""],[1,"mat-mdc-focus-indicator"]],template:function(e,n){1&e&&(Lo(dee),Hi(0),rt(1,"span",0),Hi(2,1),Hi(3,2),rt(4,"span",1,2),ji("cdkObserveContent",function(){return n._updateItemLines(!0)}),Hi(6,3),mt()(),Hi(7,4),Hi(8,5),En(9,"div",3))},dependencies:[q3],encapsulation:2,changeDetection:0}),i})(),tC=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[Kk,wu,$o,Hw,fz,vR]}),i})();function iC(i){return(iC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(i)}function Yn(i,t,e){return(t=function Bee(i){var t=function Nee(i,t){if("object"!==iC(i)||null===i)return i;var e=i[Symbol.toPrimitive];if(void 0!==e){var n=e.call(i,t||"default");if("object"!==iC(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(i)}(i,"string");return"symbol"===iC(t)?t:String(t)}(t))in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}class zee extends Fi{constructor(t=1/0,e=1/0,n=Zk){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:o,_windowTime:a}=this;e||(n.push(t),!r&&n.push(o.now()+a)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:n,_buffer:r}=this,o=r.slice();for(let a=0;a<o.length&&!t.closed;a+=n?1:2)t.next(o[a]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:n,_infiniteTimeWindow:r}=this,o=(r?1:2)*t;if(t<1/0&&o<n.length&&n.splice(0,n.length-o),!r){const a=e.now();let u=0;for(let f=1;f<n.length&&n[f]<=a;f+=2)u=f;u&&n.splice(0,u+1)}}}function WR(i,t,e){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:t=1/0,refCount:r=!1,scheduler:e}=i):n=i??1/0,Wn({connector:()=>new zee(n,t,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}class nC{}let gV=(()=>{class i extends nC{getTranslation(e){return Jt({})}}return Yn(i,"\u0275fac",function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}()),Yn(i,"\u0275prov",Qt({token:i,factory:i.\u0275fac})),i})();class $R{}let _V=(()=>{class i{handle(e){return e.key}}return Yn(i,"\u0275fac",function(e){return new(e||i)}),Yn(i,"\u0275prov",Qt({token:i,factory:i.\u0275fac})),i})();function XT(i,t){if(i===t)return!0;if(null===i||null===t)return!1;if(i!=i&&t!=t)return!0;let r,o,a,e=typeof i;if(e==typeof t&&"object"==e){if(!Array.isArray(i)){if(Array.isArray(t))return!1;for(o in a=Object.create(null),i){if(!XT(i[o],t[o]))return!1;a[o]=!0}for(o in t)if(!(o in a)&&typeof t[o]<"u")return!1;return!0}if(!Array.isArray(t))return!1;if((r=i.length)==t.length){for(o=0;o<r;o++)if(!XT(i[o],t[o]))return!1;return!0}}return!1}function mv(i){return typeof i<"u"&&null!==i}function qR(i){return i&&"object"==typeof i&&!Array.isArray(i)}function yV(i,t){let e=Object.assign({},i);return qR(i)&&qR(t)&&Object.keys(t).forEach(n=>{qR(t[n])?n in i?e[n]=yV(i[n],t[n]):Object.assign(e,{[n]:t[n]}):Object.assign(e,{[n]:t[n]})}),e}class ZT{}let vV=(()=>{class i extends ZT{constructor(...e){super(...e),Yn(this,"templateMatcher",/{{\s?([^{}\s]*)\s?}}/g)}interpolate(e,n){let r;return r="string"==typeof e?this.interpolateString(e,n):"function"==typeof e?this.interpolateFunction(e,n):e,r}getValue(e,n){let r="string"==typeof n?n.split("."):[n];n="";do{n+=r.shift(),!mv(e)||!mv(e[n])||"object"!=typeof e[n]&&r.length?r.length?n+=".":e=void 0:(e=e[n],n="")}while(r.length);return e}interpolateFunction(e,n){return e(n)}interpolateString(e,n){return n?e.replace(this.templateMatcher,(r,o)=>{let a=this.getValue(n,o);return mv(a)?a:r}):e}}return Yn(i,"\u0275fac",function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}()),Yn(i,"\u0275prov",Qt({token:i,factory:i.\u0275fac})),i})();class YT{}let bV=(()=>{class i extends YT{compile(e,n){return e}compileTranslations(e,n){return e}}return Yn(i,"\u0275fac",function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}()),Yn(i,"\u0275prov",Qt({token:i,factory:i.\u0275fac})),i})();class xV{constructor(){Yn(this,"defaultLang",void 0),Yn(this,"currentLang",this.defaultLang),Yn(this,"translations",{}),Yn(this,"langs",[]),Yn(this,"onTranslationChange",new Mi),Yn(this,"onLangChange",new Mi),Yn(this,"onDefaultLangChange",new Mi)}}const XR=new Ot("USE_STORE"),ZR=new Ot("USE_DEFAULT_LANG"),YR=new Ot("DEFAULT_LANGUAGE"),KR=new Ot("USE_EXTEND");let KT=(()=>{class i{get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(e){this.isolate?this._defaultLang=e:this.store.defaultLang=e}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(e){this.isolate?this._currentLang=e:this.store.currentLang=e}get langs(){return this.isolate?this._langs:this.store.langs}set langs(e){this.isolate?this._langs=e:this.store.langs=e}get translations(){return this.isolate?this._translations:this.store.translations}set translations(e){this.isolate?this._translations=e:this.store.translations=e}constructor(e,n,r,o,a,u=!0,f=!1,y=!1,M){Yn(this,"store",void 0),Yn(this,"currentLoader",void 0),Yn(this,"compiler",void 0),Yn(this,"parser",void 0),Yn(this,"missingTranslationHandler",void 0),Yn(this,"useDefaultLang",void 0),Yn(this,"isolate",void 0),Yn(this,"extend",void 0),Yn(this,"loadingTranslations",void 0),Yn(this,"pending",!1),Yn(this,"_onTranslationChange",new Mi),Yn(this,"_onLangChange",new Mi),Yn(this,"_onDefaultLangChange",new Mi),Yn(this,"_defaultLang",void 0),Yn(this,"_currentLang",void 0),Yn(this,"_langs",[]),Yn(this,"_translations",{}),Yn(this,"_translationRequests",{}),this.store=e,this.currentLoader=n,this.compiler=r,this.parser=o,this.missingTranslationHandler=a,this.useDefaultLang=u,this.isolate=f,this.extend=y,M&&this.setDefaultLang(M)}setDefaultLang(e){if(e===this.defaultLang)return;let n=this.retrieveTranslations(e);typeof n<"u"?(null==this.defaultLang&&(this.defaultLang=e),n.pipe(ss(1)).subscribe(r=>{this.changeDefaultLang(e)})):this.changeDefaultLang(e)}getDefaultLang(){return this.defaultLang}use(e){if(e===this.currentLang)return Jt(this.translations[e]);let n=this.retrieveTranslations(e);return typeof n<"u"?(this.currentLang||(this.currentLang=e),n.pipe(ss(1)).subscribe(r=>{this.changeLang(e)}),n):(this.changeLang(e),Jt(this.translations[e]))}retrieveTranslations(e){let n;return(typeof this.translations[e]>"u"||this.extend)&&(this._translationRequests[e]=this._translationRequests[e]||this.getTranslation(e),n=this._translationRequests[e]),n}getTranslation(e){this.pending=!0;const n=this.currentLoader.getTranslation(e).pipe(WR(1),ss(1));return this.loadingTranslations=n.pipe(vn(r=>this.compiler.compileTranslations(r,e)),WR(1),ss(1)),this.loadingTranslations.subscribe({next:r=>{this.translations[e]=this.extend&&this.translations[e]?{...r,...this.translations[e]}:r,this.updateLangs(),this.pending=!1},error:r=>{this.pending=!1}}),n}setTranslation(e,n,r=!1){n=this.compiler.compileTranslations(n,e),this.translations[e]=(r||this.extend)&&this.translations[e]?yV(this.translations[e],n):n,this.updateLangs(),this.onTranslationChange.emit({lang:e,translations:this.translations[e]})}getLangs(){return this.langs}addLangs(e){e.forEach(n=>{-1===this.langs.indexOf(n)&&this.langs.push(n)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(e,n,r){let o;if(n instanceof Array){let a={},u=!1;for(let f of n)a[f]=this.getParsedResult(e,f,r),nv(a[f])&&(u=!0);return u?fR(n.map(y=>nv(a[y])?a[y]:Jt(a[y]))).pipe(vn(y=>{let M={};return y.forEach((A,I)=>{M[n[I]]=A}),M})):a}if(e&&(o=this.parser.interpolate(this.parser.getValue(e,n),r)),typeof o>"u"&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(o=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],n),r)),typeof o>"u"){let a={key:n,translateService:this};typeof r<"u"&&(a.interpolateParams=r),o=this.missingTranslationHandler.handle(a)}return typeof o<"u"?o:n}get(e,n){if(!mv(e)||!e.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe(h0(r=>nv(r=this.getParsedResult(r,e,n))?r:Jt(r)));{let r=this.getParsedResult(this.translations[this.currentLang],e,n);return nv(r)?r:Jt(r)}}getStreamOnTranslationChange(e,n){if(!mv(e)||!e.length)throw new Error('Parameter "key" required');return c0(d0(()=>this.get(e,n)),this.onTranslationChange.pipe(Co(r=>{const o=this.getParsedResult(r.translations,e,n);return"function"==typeof o.subscribe?o:Jt(o)})))}stream(e,n){if(!mv(e)||!e.length)throw new Error('Parameter "key" required');return c0(d0(()=>this.get(e,n)),this.onLangChange.pipe(Co(r=>{const o=this.getParsedResult(r.translations,e,n);return nv(o)?o:Jt(o)})))}instant(e,n){if(!mv(e)||!e.length)throw new Error('Parameter "key" required');let r=this.getParsedResult(this.translations[this.currentLang],e,n);if(nv(r)){if(e instanceof Array){let o={};return e.forEach((a,u)=>{o[e[u]]=e[u]}),o}return e}return r}set(e,n,r=this.currentLang){this.translations[r][e]=this.compiler.compile(n,r),this.updateLangs(),this.onTranslationChange.emit({lang:r,translations:this.translations[r]})}changeLang(e){this.currentLang=e,this.onLangChange.emit({lang:e,translations:this.translations[e]}),null==this.defaultLang&&this.changeDefaultLang(e)}changeDefaultLang(e){this.defaultLang=e,this.onDefaultLangChange.emit({lang:e,translations:this.translations[e]})}reloadLang(e){return this.resetLang(e),this.getTranslation(e)}resetLang(e){this._translationRequests[e]=void 0,this.translations[e]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let e=window.navigator.languages?window.navigator.languages[0]:null;return e=e||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,typeof e>"u"?void 0:(-1!==e.indexOf("-")&&(e=e.split("-")[0]),-1!==e.indexOf("_")&&(e=e.split("_")[0]),e)}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let e=window.navigator.languages?window.navigator.languages[0]:null;return e=e||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,e}}return Yn(i,"\u0275fac",function(e){return new(e||i)(it(xV),it(nC),it(YT),it(ZT),it($R),it(ZR),it(XR),it(KR),it(YR))}),Yn(i,"\u0275prov",Qt({token:i,factory:i.\u0275fac})),i})(),rC=(()=>{class i{constructor(e,n){Yn(this,"translate",void 0),Yn(this,"_ref",void 0),Yn(this,"value",""),Yn(this,"lastKey",null),Yn(this,"lastParams",[]),Yn(this,"onTranslationChange",void 0),Yn(this,"onLangChange",void 0),Yn(this,"onDefaultLangChange",void 0),this.translate=e,this._ref=n}updateValue(e,n,r){let o=a=>{this.value=void 0!==a?a:e,this.lastKey=e,this._ref.markForCheck()};if(r){let a=this.translate.getParsedResult(r,e,n);nv(a.subscribe)?a.subscribe(o):o(a)}this.translate.get(e,n).subscribe(o)}transform(e,...n){if(!e||!e.length)return e;if(XT(e,this.lastKey)&&XT(n,this.lastParams))return this.value;let r;if(mv(n[0])&&n.length)if("string"==typeof n[0]&&n[0].length){let o=n[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{r=JSON.parse(o)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${n[0]}`)}}else"object"==typeof n[0]&&!Array.isArray(n[0])&&(r=n[0]);return this.lastKey=e,this.lastParams=n,this.updateValue(e,r),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(o=>{this.lastKey&&o.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(e,r,o.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(o=>{this.lastKey&&(this.lastKey=null,this.updateValue(e,r,o.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(e,r))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return Yn(i,"\u0275fac",function(e){return new(e||i)(oe(KT,16),oe(vs,16))}),Yn(i,"\u0275pipe",as({name:"translate",type:i,pure:!1})),Yn(i,"\u0275prov",Qt({token:i,factory:i.\u0275fac})),i})(),Zw=(()=>{class i{static forRoot(e={}){return{ngModule:i,providers:[e.loader||{provide:nC,useClass:gV},e.compiler||{provide:YT,useClass:bV},e.parser||{provide:ZT,useClass:vV},e.missingTranslationHandler||{provide:$R,useClass:_V},xV,{provide:XR,useValue:e.isolate},{provide:ZR,useValue:e.useDefaultLang},{provide:KR,useValue:e.extend},{provide:YR,useValue:e.defaultLanguage},KT]}}static forChild(e={}){return{ngModule:i,providers:[e.loader||{provide:nC,useClass:gV},e.compiler||{provide:YT,useClass:bV},e.parser||{provide:ZT,useClass:vV},e.missingTranslationHandler||{provide:$R,useClass:_V},{provide:XR,useValue:e.isolate},{provide:ZR,useValue:e.useDefaultLang},{provide:KR,useValue:e.extend},{provide:YR,useValue:e.defaultLanguage},KT]}}}return Yn(i,"\u0275fac",function(e){return new(e||i)}),Yn(i,"\u0275mod",Nn({type:i})),Yn(i,"\u0275inj",Rn({})),i})();var Uee=Mp(990);const Vee=["toolbar"],Hee=["content"];function Gee(i,t){if(1&i){const e=yh();rt(0,"mat-list-item")(1,"div",8),ji("click",function(){const o=$r(e).$implicit;return lo(ln().onListItemClick(o.path))}),rt(2,"mat-icon"),sn(3),mt(),rt(4,"span",9),sn(5),Ka(6,"translate"),mt()()()}if(2&i){const e=t.$implicit,n=ln();ft(1),Jf("color",n.router.url===e.path?"var(--mat-select-focused-arrow-color)":""),ft(2),Pr(e.icon),ft(2),Pr(Ja(6,4,e.i18n))}}let jee=(()=>{class i{constructor(e){this.router=e,this.resize=()=>{this.content.nativeElement.style.height=`calc(100vh - ${this.toolbar._elementRef.nativeElement.clientHeight}px)`},this.resizeCallback=(0,Uee.debounce)(this.resize,100),this.sidenavOpened=!1,this.navigations=[{path:"/index/home",i18n:"index.home",icon:"home"},{path:"/index/daily",i18n:"index.daily",icon:"format_list_numbered_icon"},{path:"/index/three",i18n:"index.three",icon:"view_in_ar_icon"},{path:"/index/map",i18n:"index.map",icon:"map"},{path:"/index/setting",i18n:"index.setting",icon:"settings"}],this.onToolbarIconClick=()=>this.sidenavOpened=!0,this.onListItemClick=n=>this.router.navigateByUrl(n,{replaceUrl:!0})}ngAfterViewInit(){this.resize(),window.addEventListener("resize",this.resizeCallback)}ngOnDestroy(){window.removeEventListener("resize",this.resizeCallback)}}return i.\u0275fac=function(e){return new(e||i)(oe(Mu))},i.\u0275cmp=ui({type:i,selectors:[["page-index"]],viewQuery:function(e,n){if(1&e&&(uo(Vee,5),uo(Hee,5)),2&e){let r;zi(r=Ui())&&(n.toolbar=r.first),zi(r=Ui())&&(n.content=r.first)}},standalone:!0,features:[tm],decls:19,vars:5,consts:[[1,"page-index"],["mode","over",3,"opened","openedChange"],["role","list"],[4,"ngFor","ngForOf"],["color","primary"],["toolbar",""],["mat-icon-button","",3,"click"],["content",""],[2,"display","flex","align-items","center",3,"click"],[2,"margin-left","0.5em"]],template:function(e,n){1&e&&(rt(0,"mat-sidenav-container",0)(1,"mat-sidenav",1),ji("openedChange",function(o){return n.sidenavOpened=o}),rt(2,"mat-list",2)(3,"mat-list-item"),sn(4),Ka(5,"translate"),mt(),En(6,"mat-divider"),Oi(7,Gee,7,6,"mat-list-item",3),mt()(),rt(8,"mat-sidenav-content")(9,"mat-toolbar",4,5)(11,"button",6),ji("click",function(){return n.onToolbarIconClick()}),rt(12,"mat-icon"),sn(13,"menu"),mt()(),rt(14,"span"),sn(15,"Todo Application"),mt()(),rt(16,"div",null,7),En(18,"router-outlet"),mt()()()),2&e&&(ft(1),Vt("opened",n.sidenavOpened),ft(3),Pr(Ja(5,3,"index.navigation")),ft(3),Vt("ngForOf",n.navigations))},dependencies:[Zw,rC,wu,a0,Vk,oT,oR,rR,fJ,Rz,Pz,hR,uv,M0,T0,S0,tC,eC,jR,lU,vR],styles:[".page-index[_ngcontent-%COMP%]{width:100vw;height:100vh}"]}),i})();const Wee=["*"],Xee=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],Zee=["[mat-card-avatar], [matCardAvatar]","mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","*"],Yee=new Ot("MAT_CARD_CONFIG");let JR=(()=>{class i{constructor(e){this.appearance=e?.appearance||"raised"}}return i.\u0275fac=function(e){return new(e||i)(oe(Yee,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(e,n){2&e&&Un("mat-mdc-card-outlined","outlined"===n.appearance)("mdc-card--outlined","outlined"===n.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:Wee,decls:1,vars:0,template:function(e,n){1&e&&(Lo(),Hi(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{color:rgba(0, 0, 0, 0.6);flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mdc-card__action--icon:not(:disabled){color:rgba(0, 0, 0, 0.6)}.mat-mdc-card{border-radius:var(--mdc-elevated-card-container-shape);background-color:var(--mdc-elevated-card-container-color);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color);box-shadow:var(--mdc-elevated-card-container-elevation);--mdc-elevated-card-container-shape:4px;--mdc-outlined-card-container-shape:4px;--mdc-outlined-card-outline-width:1px}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape)}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width);border-style:solid;border-color:var(--mdc-outlined-card-outline-color);border-radius:var(--mdc-outlined-card-container-shape);background-color:var(--mdc-outlined-card-container-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.mat-mdc-card-outlined .mdc-card::after{border-radius:var(--mdc-outlined-card-container-shape)}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font);line-height:var(--mat-card-title-text-line-height);font-size:var(--mat-card-title-text-size);letter-spacing:var(--mat-card-title-text-tracking);font-weight:var(--mat-card-title-text-weight)}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color);font-family:var(--mat-card-subtitle-text-font);line-height:var(--mat-card-subtitle-text-line-height);font-size:var(--mat-card-subtitle-text-size);letter-spacing:var(--mat-card-subtitle-text-tracking);font-weight:var(--mat-card-subtitle-text-weight)}.mat-mdc-card{position:relative}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0}),i})(),wV=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]}),i})(),QR=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]}),i})(),MV=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ui({type:i,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:Zee,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(e,n){1&e&&(Lo(Xee),Hi(0),rt(1,"div",0),Hi(2,1),mt(),Hi(3,2))},encapsulation:2,changeDetection:0}),i})(),EV=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,wu,$o]}),i})();var Au=(()=>((Au=Au||{})[Au.GREEN=0]="GREEN",Au[Au.ORANGE=1]="ORANGE",Au[Au.RED=2]="RED",Au))();class e2{constructor(t,e,n,r,o){this.id=t,this.title=e,this.type=n,this.startTime=r,this.content=o}get color(){switch(this.type){case Au.GREEN:default:return"green";case Au.ORANGE:return"orange";case Au.RED:return"red"}}}let Yw=(()=>{class i{constructor(){this.id=1,this.todos=[]}static getInstance(){return null===i.instance&&(i.instance=new i),i.instance}getTodos(){try{return this.todos.map(e=>new e2(e.id,e.title,e.type,e.startTime,e.content))}catch{return[]}}insertTodo(e){try{return this.todos.push(new e2(this.id++,e.title,e.type,e.startTime,e.content)),!0}catch{return!1}}findTodoById(e){try{const n=this.todos.find(r=>r.id===e);if(void 0!==n)return new e2(n.id,n.title,n.type,n.startTime,n.content);throw new Error}catch{return null}}modifyTodoById(e,n){try{const r=this.todos.find(o=>o.id===e);if(void 0===r)throw new Error;return void 0!==n.title&&(r.title=n.title),void 0!==n.type&&(r.type=n.type),void 0!==n.startTime&&(r.startTime=n.startTime),void 0!==n.content&&(r.content=n.content),!0}catch{return!1}}deleteTodoById(e){try{const n=this.todos.findIndex(r=>r.id===e);return-1!==n&&this.todos.splice(n,1),!0}catch{return!1}}}return i.instance=null,i})(),CV=(()=>{class i{fetchData(){return Yw.getInstance().getTodos()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();function ete(i,t){if(1&i){const e=yh();rt(0,"mat-card",3),ji("click",function(){const o=$r(e).$implicit;return lo(ln().onListItemClick(o.id))}),rt(1,"mat-card-header")(2,"mat-card-title"),sn(3),mt()(),rt(4,"mat-card-content"),sn(5),Ka(6,"date"),mt(),rt(7,"mat-card-content"),sn(8),mt()()}if(2&i){const e=t.$implicit;ft(3),Pr(e.title),ft(1),Jf("color",e.color),ft(1),Pr(Ja(6,5,e.startTime)),ft(3),Pr(e.content)}}let tte=(()=>{class i{constructor(e,n){this.router=e,this.homeService=n,this.list=[],this.onListItemClick=r=>{this.router.navigateByUrl(`/detail?id=${r}`)},this.onAddButtonClick=()=>{this.router.navigateByUrl("/edit")},this.list=this.homeService.fetchData()}}return i.\u0275fac=function(e){return new(e||i)(oe(Mu),oe(CV))},i.\u0275cmp=ui({type:i,selectors:[["view-home"]],standalone:!0,features:[Qn([CV]),tm],decls:6,vars:1,consts:[[2,"padding","1em"],["mat-fab","","color","primary",2,"position","fixed","bottom","1em","right","1em",3,"click"],["class","list-item-card",3,"click",4,"ngFor","ngForOf"],[1,"list-item-card",3,"click"]],template:function(e,n){1&e&&(rt(0,"div",0)(1,"button",1),ji("click",function(){return n.onAddButtonClick()}),rt(2,"mat-icon"),sn(3,"add"),mt()(),rt(4,"mat-list"),Oi(5,ete,9,7,"mat-card",2),mt()()),2&e&&(ft(5),Vt("ngForOf",n.list))},dependencies:[wu,a0,dB,tC,eC,EV,JR,QR,MV,wV,uv,Uz,T0,S0],styles:[".list-item-card[_ngcontent-%COMP%]:not(:first-child){margin-top:1em}"]}),i})();class ite{constructor(t){this._box=t,this._destroyed=new Fi,this._resizeSubject=new Fi,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(e=>this._resizeSubject.next(e)))}observe(t){return this._elementObservables.has(t)||this._elementObservables.set(t,new Cn(e=>{const n=this._resizeSubject.subscribe(e);return this._resizeObserver?.observe(t,{box:this._box}),()=>{this._resizeObserver?.unobserve(t),n.unsubscribe(),this._elementObservables.delete(t)}}).pipe(Ko(e=>e.some(n=>n.target===t)),WR({bufferSize:1,refCount:!0}),oo(this._destroyed))),this._elementObservables.get(t)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}}let nte=(()=>{class i{constructor(){this._observers=new Map,this._ngZone=mi(Ji)}ngOnDestroy(){for(const[,e]of this._observers)e.destroy();this._observers.clear()}observe(e,n){const r=n?.box||"content-box";return this._observers.has(r)||this._observers.set(r,new ite(r)),this._observers.get(r).observe(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const rte=["notch"],ote=["matFormFieldNotchedOutline",""],ste=["*"],ate=["textField"],lte=["iconPrefixContainer"],cte=["textPrefixContainer"];function dte(i,t){1&i&&En(0,"span",19)}function ute(i,t){if(1&i&&(rt(0,"label",17),Hi(1,1),Oi(2,dte,1,0,"span",18),mt()),2&i){const e=ln(2);Vt("floating",e._shouldLabelFloat())("monitorResize",e._hasOutline())("id",e._labelId),Mn("for",e._control.id)("aria-owns",e._control.id),ft(2),Vt("ngIf",!e.hideRequiredMarker&&e._control.required)}}function hte(i,t){1&i&&Oi(0,ute,3,6,"label",16),2&i&&Vt("ngIf",ln()._hasFloatingLabel())}function pte(i,t){1&i&&En(0,"div",20)}function fte(i,t){}function mte(i,t){1&i&&Oi(0,fte,0,0,"ng-template",22),2&i&&(ln(2),Vt("ngTemplateOutlet",yu(1)))}function gte(i,t){if(1&i&&(rt(0,"div",21),Oi(1,mte,1,1,"ng-template",9),mt()),2&i){const e=ln();Vt("matFormFieldNotchedOutlineOpen",e._shouldLabelFloat()),ft(1),Vt("ngIf",!e._forceDisplayInfixLabel())}}function _te(i,t){1&i&&(rt(0,"div",23,24),Hi(2,2),mt())}function yte(i,t){1&i&&(rt(0,"div",25,26),Hi(2,3),mt())}function vte(i,t){}function bte(i,t){1&i&&Oi(0,vte,0,0,"ng-template",22),2&i&&(ln(),Vt("ngTemplateOutlet",yu(1)))}function xte(i,t){1&i&&(rt(0,"div",27),Hi(1,4),mt())}function wte(i,t){1&i&&(rt(0,"div",28),Hi(1,5),mt())}function Mte(i,t){1&i&&En(0,"div",29)}function Ete(i,t){1&i&&(rt(0,"div",30),Hi(1,6),mt()),2&i&&Vt("@transitionMessages",ln()._subscriptAnimationState)}function Cte(i,t){if(1&i&&(rt(0,"mat-hint",34),sn(1),mt()),2&i){const e=ln(2);Vt("id",e._hintLabelId),ft(1),Pr(e.hintLabel)}}function Ste(i,t){if(1&i&&(rt(0,"div",31),Oi(1,Cte,2,2,"mat-hint",32),Hi(2,7),En(3,"div",33),Hi(4,8),mt()),2&i){const e=ln();Vt("@transitionMessages",e._subscriptAnimationState),ft(1),Vt("ngIf",e.hintLabel)}}const Tte=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Ate=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];let JT=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["mat-label"]]}),i})();const Dte=new Ot("MatError");let Ite=0,SV=(()=>{class i{constructor(){this.align="start",this.id="mat-mdc-hint-"+Ite++}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(e,n){2&e&&(vh("id",n.id),Mn("align",null),Un("mat-mdc-form-field-hint-end","end"===n.align))},inputs:{align:"align",id:"id"}}),i})();const kte=new Ot("MatPrefix"),TV=new Ot("MatSuffix");let AV=(()=>{class i{constructor(){this._isText=!1}set _isTextSelector(e){this._isText=!0}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:["matTextSuffix","_isTextSelector"]},features:[Qn([{provide:TV,useExisting:i}])]}),i})();const DV=new Ot("FloatingLabelParent");let IV=(()=>{class i{get floating(){return this._floating}set floating(e){this._floating=e,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(e){this._monitorResize=e,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(e){this._elementRef=e,this._floating=!1,this._monitorResize=!1,this._resizeObserver=mi(nte),this._ngZone=mi(Ji),this._parent=mi(DV),this._resizeSubscription=new gt}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return function Rte(i){if(null!==i.offsetParent)return i.scrollWidth;const e=i.cloneNode(!0);e.style.setProperty("position","absolute"),e.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(e);const n=e.scrollWidth;return e.remove(),n}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}}return i.\u0275fac=function(e){return new(e||i)(oe(tn))},i.\u0275dir=si({type:i,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(e,n){2&e&&Un("mdc-floating-label--float-above",n.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}}),i})();const kV="mdc-line-ripple--active",QT="mdc-line-ripple--deactivating";let RV=(()=>{class i{constructor(e,n){this._elementRef=e,this._handleTransitionEnd=r=>{const o=this._elementRef.nativeElement.classList,a=o.contains(QT);"opacity"===r.propertyName&&a&&o.remove(kV,QT)},n.runOutsideAngular(()=>{e.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const e=this._elementRef.nativeElement.classList;e.remove(QT),e.add(kV)}deactivate(){this._elementRef.nativeElement.classList.add(QT)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Ji))},i.\u0275dir=si({type:i,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]}),i})(),PV=(()=>{class i{constructor(e,n){this._elementRef=e,this._ngZone=n,this.open=!1}ngAfterViewInit(){const e=this._elementRef.nativeElement.querySelector(".mdc-floating-label");e?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(e.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>e.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(e){this._notch.nativeElement.style.width=this.open&&e?`calc(${e}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:""}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Ji))},i.\u0275cmp=ui({type:i,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(e,n){if(1&e&&uo(rte,5),2&e){let r;zi(r=Ui())&&(n._notch=r.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(e,n){2&e&&Un("mdc-notched-outline--notched",n.open)},inputs:{open:["matFormFieldNotchedOutlineOpen","open"]},attrs:ote,ngContentSelectors:ste,decls:5,vars:0,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],["notch",""],[1,"mdc-notched-outline__trailing"]],template:function(e,n){1&e&&(Lo(),En(0,"div",0),rt(1,"div",1,2),Hi(3),mt(),En(4,"div",3))},encapsulation:2,changeDetection:0}),i})();const Pte={transitionMessages:A_("transitionMessages",[ug("enter",Qs({opacity:1,transform:"translateY(0%)"})),Su("void => enter",[Qs({opacity:0,transform:"translateY(-5px)"}),xh("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let eA=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i}),i})();const oC=new Ot("MatFormField"),Lte=new Ot("MAT_FORM_FIELD_DEFAULT_OPTIONS");let LV=0,NV=(()=>{class i{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=dn(e)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(e){const n=this._appearance;this._appearance=e||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==n&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(e){this._subscriptSizing=e||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(e){this._explicitFormFieldControl=e}constructor(e,n,r,o,a,u,f,y){this._elementRef=e,this._changeDetectorRef=n,this._ngZone=r,this._dir=o,this._platform=a,this._defaults=u,this._animationMode=f,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+LV++,this._hintLabelId="mat-mdc-hint-"+LV++,this._subscriptAnimationState="",this._destroyed=new Fi,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,u&&(u.appearance&&(this.appearance=u.appearance),this._hideRequiredMarker=!!u?.hideRequiredMarker,u.color&&(this.color=u.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${e.controlType}`),e.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(oo(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(e=>!e._isText),this._hasTextPrefix=!!this._prefixChildren.find(e=>e._isText),this._hasIconSuffix=!!this._suffixChildren.find(e=>!e._isText),this._hasTextSuffix=!!this._suffixChildren.find(e=>e._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),oi(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(oo(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(oo(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(e){const n=this._control?this._control.ngControl:null;return n&&n[e]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){this._hasOutline()&&this._floatingLabel&&this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth()):this._notchedOutline?._setNotchWidth(0)}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const n=this._hintChildren?this._hintChildren.find(o=>"start"===o.align):null,r=this._hintChildren?this._hintChildren.find(o=>"end"===o.align):null;n?e.push(n.id):this._hintLabel&&e.push(this._hintLabelId),r&&e.push(r.id)}else this._errorChildren&&e.push(...this._errorChildren.map(n=>n.id));this._control.setDescribedByIds(e)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const e=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(e.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const n=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,o=n?.getBoundingClientRect().width??0,a=r?.getBoundingClientRect().width??0;e.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${o+a}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const e=this._elementRef.nativeElement;if(e.getRootNode){const n=e.getRootNode();return n&&n!==e}return document.documentElement.contains(e)}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(vs),oe(Ji),oe(Cu),oe(Js),oe(Lte,8),oe(ma,8),oe(lr))},i.\u0275cmp=ui({type:i,selectors:[["mat-form-field"]],contentQueries:function(e,n,r){if(1&e&&(Qr(r,JT,5),Qr(r,JT,7),Qr(r,eA,5),Qr(r,kte,5),Qr(r,TV,5),Qr(r,Dte,5),Qr(r,SV,5)),2&e){let o;zi(o=Ui())&&(n._labelChildNonStatic=o.first),zi(o=Ui())&&(n._labelChildStatic=o.first),zi(o=Ui())&&(n._formFieldControl=o.first),zi(o=Ui())&&(n._prefixChildren=o),zi(o=Ui())&&(n._suffixChildren=o),zi(o=Ui())&&(n._errorChildren=o),zi(o=Ui())&&(n._hintChildren=o)}},viewQuery:function(e,n){if(1&e&&(uo(ate,5),uo(lte,5),uo(cte,5),uo(IV,5),uo(PV,5),uo(RV,5)),2&e){let r;zi(r=Ui())&&(n._textField=r.first),zi(r=Ui())&&(n._iconPrefixContainer=r.first),zi(r=Ui())&&(n._textPrefixContainer=r.first),zi(r=Ui())&&(n._floatingLabel=r.first),zi(r=Ui())&&(n._notchedOutline=r.first),zi(r=Ui())&&(n._lineRipple=r.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(e,n){2&e&&Un("mat-mdc-form-field-label-always-float",n._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",n._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",n._hasIconSuffix)("mat-form-field-invalid",n._control.errorState)("mat-form-field-disabled",n._control.disabled)("mat-form-field-autofilled",n._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===n._animationMode)("mat-form-field-appearance-fill","fill"==n.appearance)("mat-form-field-appearance-outline","outline"==n.appearance)("mat-form-field-hide-placeholder",n._hasFloatingLabel()&&!n._shouldLabelFloat())("mat-focused",n._control.focused)("mat-primary","accent"!==n.color&&"warn"!==n.color)("mat-accent","accent"===n.color)("mat-warn","warn"===n.color)("ng-untouched",n._shouldForward("untouched"))("ng-touched",n._shouldForward("touched"))("ng-pristine",n._shouldForward("pristine"))("ng-dirty",n._shouldForward("dirty"))("ng-valid",n._shouldForward("valid"))("ng-invalid",n._shouldForward("invalid"))("ng-pending",n._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Qn([{provide:oC,useExisting:i},{provide:DV,useExisting:i}])],ngContentSelectors:Ate,decls:18,vars:23,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay",4,"ngIf"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen",4,"ngIf"],["class","mat-mdc-form-field-icon-prefix",4,"ngIf"],["class","mat-mdc-form-field-text-prefix",4,"ngIf"],[1,"mat-mdc-form-field-infix"],[3,"ngIf"],["class","mat-mdc-form-field-text-suffix",4,"ngIf"],["class","mat-mdc-form-field-icon-suffix",4,"ngIf"],["matFormFieldLineRipple","",4,"ngIf"],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align",3,"ngSwitch"],["class","mat-mdc-form-field-error-wrapper",4,"ngSwitchCase"],["class","mat-mdc-form-field-hint-wrapper",4,"ngSwitchCase"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id",4,"ngIf"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required",4,"ngIf"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id",4,"ngIf"],[1,"mat-mdc-form-field-hint-spacer"],[3,"id"]],template:function(e,n){1&e&&(Lo(Tte),Oi(0,hte,1,1,"ng-template",null,0,Cw),rt(2,"div",1,2),ji("click",function(o){return n._control.onContainerClick(o)}),Oi(4,pte,1,0,"div",3),rt(5,"div",4),Oi(6,gte,2,2,"div",5),Oi(7,_te,3,0,"div",6),Oi(8,yte,3,0,"div",7),rt(9,"div",8),Oi(10,bte,1,1,"ng-template",9),Hi(11),mt(),Oi(12,xte,2,0,"div",10),Oi(13,wte,2,0,"div",11),mt(),Oi(14,Mte,1,0,"div",12),mt(),rt(15,"div",13),Oi(16,Ete,2,1,"div",14),Oi(17,Ste,5,2,"div",15),mt()),2&e&&(ft(2),Un("mdc-text-field--filled",!n._hasOutline())("mdc-text-field--outlined",n._hasOutline())("mdc-text-field--no-label",!n._hasFloatingLabel())("mdc-text-field--disabled",n._control.disabled)("mdc-text-field--invalid",n._control.errorState),ft(2),Vt("ngIf",!n._hasOutline()&&!n._control.disabled),ft(2),Vt("ngIf",n._hasOutline()),ft(1),Vt("ngIf",n._hasIconPrefix),ft(1),Vt("ngIf",n._hasTextPrefix),ft(2),Vt("ngIf",!n._hasOutline()||n._forceDisplayInfixLabel()),ft(2),Vt("ngIf",n._hasTextSuffix),ft(1),Vt("ngIf",n._hasIconSuffix),ft(1),Vt("ngIf",!n._hasOutline()),ft(1),Un("mat-mdc-form-field-subscript-dynamic-size","dynamic"===n.subscriptSizing),Vt("ngSwitch",n._getDisplayedMessages()),ft(1),Vt("ngSwitchCase","error"),ft(1),Vt("ngSwitchCase","hint"))},dependencies:[cp,ik,l0,uE,SV,IV,PV,RV],styles:['.mdc-text-field{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px * 2)}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{line-height:normal;pointer-events:all}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[Pte.transitionMessages]},changeDetection:0}),i})(),sC=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,wu,Kk,$o]}),i})();function Nte(i,t){1&i&&(rt(0,"span",8),Hi(1,1),mt())}function Bte(i,t){1&i&&(rt(0,"span",9),Hi(1,2),mt())}const BV=["*",[["mat-chip-avatar"],["","matChipAvatar",""]],[["mat-chip-trailing-icon"],["","matChipRemove",""],["","matChipTrailingIcon",""]]],zV=["*","mat-chip-avatar, [matChipAvatar]","mat-chip-trailing-icon,[matChipRemove],[matChipTrailingIcon]"],tA=new Ot("mat-chips-default-options"),n2=new Ot("MatChipAvatar"),r2=new Ot("MatChipTrailingIcon"),o2=new Ot("MatChipRemove"),iA=new Ot("MatChip");class Yte{}const Kte=BE(Yte,-1);let Kw=(()=>{class i extends Kte{get disabled(){return this._disabled||this._parentChip.disabled}set disabled(e){this._disabled=dn(e)}_getDisabledAttribute(){return this.disabled&&!this._allowFocusWhenDisabled?"":null}_getTabindex(){return this.disabled&&!this._allowFocusWhenDisabled||!this.isInteractive?null:this.tabIndex.toString()}constructor(e,n){super(),this._elementRef=e,this._parentChip=n,this.isInteractive=!0,this._isPrimary=!0,this._disabled=!1,this._allowFocusWhenDisabled=!1,"BUTTON"===e.nativeElement.nodeName&&e.nativeElement.setAttribute("type","button")}focus(){this._elementRef.nativeElement.focus()}_handleClick(e){!this.disabled&&this.isInteractive&&this._isPrimary&&(e.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!this.disabled&&this.isInteractive&&this._isPrimary&&!this._parentChip._isEditing&&(e.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(iA))},i.\u0275dir=si({type:i,selectors:[["","matChipAction",""]],hostAttrs:[1,"mdc-evolution-chip__action","mat-mdc-chip-action"],hostVars:9,hostBindings:function(e,n){1&e&&ji("click",function(o){return n._handleClick(o)})("keydown",function(o){return n._handleKeydown(o)}),2&e&&(Mn("tabindex",n._getTabindex())("disabled",n._getDisabledAttribute())("aria-disabled",n.disabled),Un("mdc-evolution-chip__action--primary",n._isPrimary)("mdc-evolution-chip__action--presentational",!n.isInteractive)("mdc-evolution-chip__action--trailing",!n._isPrimary))},inputs:{disabled:"disabled",tabIndex:"tabIndex",isInteractive:"isInteractive",_allowFocusWhenDisabled:"_allowFocusWhenDisabled"},features:[Zi]}),i})(),tie=0;const iie=BE(Vw(NE(OE(class{constructor(i){this._elementRef=i}})),"primary"),-1);let I0=(()=>{class i extends iie{_hasFocus(){return this._hasFocusInternal}get value(){return void 0!==this._value?this._value:this._textElement.textContent.trim()}set value(e){this._value=e}get removable(){return this._removable}set removable(e){this._removable=dn(e)}get highlighted(){return this._highlighted}set highlighted(e){this._highlighted=dn(e)}constructor(e,n,r,o,a,u,f,y){super(n),this._changeDetectorRef=e,this._ngZone=r,this._focusMonitor=o,this._globalRippleOptions=f,this._isRippleCentered=!1,this._onFocus=new Fi,this._onBlur=new Fi,this.role=null,this._hasFocusInternal=!1,this.id="mat-mdc-chip-"+tie++,this.ariaLabel=null,this.ariaDescription=null,this._ariaDescriptionId=`${this.id}-aria-description`,this._removable=!0,this._highlighted=!1,this.removed=new Mi,this.destroyed=new Mi,this.basicChipAttrName="mat-basic-chip",this._document=a,this._animationsDisabled="NoopAnimations"===u,null!=y&&(this.tabIndex=parseInt(y)??this.defaultTabIndex),this._monitorFocus()}ngOnInit(){const e=this._elementRef.nativeElement;this._isBasicChip=e.hasAttribute(this.basicChipAttrName)||e.tagName.toLowerCase()===this.basicChipAttrName}ngAfterViewInit(){this._textElement=this._elementRef.nativeElement.querySelector(".mat-mdc-chip-action-label"),this._pendingFocus&&(this._pendingFocus=!1,this.focus())}ngAfterContentInit(){this._actionChanges=oi(this._allLeadingIcons.changes,this._allTrailingIcons.changes,this._allRemoveIcons.changes).subscribe(()=>this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._actionChanges?.unsubscribe(),this.destroyed.emit({chip:this}),this.destroyed.complete()}remove(){this.removable&&this.removed.emit({chip:this})}_isRippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||this._isBasicChip||!!this._globalRippleOptions?.disabled}_hasTrailingIcon(){return!(!this.trailingIcon&&!this.removeIcon)}_handleKeydown(e){(8===e.keyCode||46===e.keyCode)&&(e.preventDefault(),this.remove())}focus(){this.disabled||(this.primaryAction?this.primaryAction.focus():this._pendingFocus=!0)}_getSourceAction(e){return this._getActions().find(n=>{const r=n._elementRef.nativeElement;return r===e||r.contains(e)})}_getActions(){const e=[];return this.primaryAction&&e.push(this.primaryAction),this.removeIcon&&e.push(this.removeIcon),this.trailingIcon&&e.push(this.trailingIcon),e}_handlePrimaryActionInteraction(){}_monitorFocus(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{const n=null!==e;n!==this._hasFocusInternal&&(this._hasFocusInternal=n,n?this._onFocus.next({chip:this}):this._ngZone.onStable.pipe(ss(1)).subscribe(()=>this._ngZone.run(()=>this._onBlur.next({chip:this}))))})}}return i.\u0275fac=function(e){return new(e||i)(oe(vs),oe(tn),oe(Ji),oe(dg),oe(lr),oe(ma,8),oe(x0,8),Bl("tabindex"))},i.\u0275cmp=ui({type:i,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(e,n,r){if(1&e&&(Qr(r,n2,5),Qr(r,r2,5),Qr(r,o2,5),Qr(r,n2,5),Qr(r,r2,5),Qr(r,o2,5)),2&e){let o;zi(o=Ui())&&(n.leadingIcon=o.first),zi(o=Ui())&&(n.trailingIcon=o.first),zi(o=Ui())&&(n.removeIcon=o.first),zi(o=Ui())&&(n._allLeadingIcons=o),zi(o=Ui())&&(n._allTrailingIcons=o),zi(o=Ui())&&(n._allRemoveIcons=o)}},viewQuery:function(e,n){if(1&e&&(uo(S_,5),uo(Kw,5)),2&e){let r;zi(r=Ui())&&(n.ripple=r.first),zi(r=Ui())&&(n.primaryAction=r.first)}},hostAttrs:[1,"mat-mdc-chip"],hostVars:30,hostBindings:function(e,n){1&e&&ji("keydown",function(o){return n._handleKeydown(o)}),2&e&&(vh("id",n.id),Mn("role",n.role)("tabindex",n.role?n.tabIndex:null)("aria-label",n.ariaLabel),Un("mdc-evolution-chip",!n._isBasicChip)("mdc-evolution-chip--disabled",n.disabled)("mdc-evolution-chip--with-trailing-action",n._hasTrailingIcon())("mdc-evolution-chip--with-primary-graphic",n.leadingIcon)("mdc-evolution-chip--with-primary-icon",n.leadingIcon)("mdc-evolution-chip--with-avatar",n.leadingIcon)("mat-mdc-chip-with-avatar",n.leadingIcon)("mat-mdc-chip-highlighted",n.highlighted)("mat-mdc-chip-disabled",n.disabled)("mat-mdc-basic-chip",n._isBasicChip)("mat-mdc-standard-chip",!n._isBasicChip)("mat-mdc-chip-with-trailing-icon",n._hasTrailingIcon())("_mat-animation-noopable",n._animationsDisabled))},inputs:{color:"color",disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",role:"role",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaDescription:["aria-description","ariaDescription"],value:"value",removable:"removable",highlighted:"highlighted"},outputs:{removed:"removed",destroyed:"destroyed"},exportAs:["matChip"],features:[Qn([{provide:iA,useExisting:i}]),Zi],ngContentSelectors:zV,decls:9,vars:6,consts:[["matRipple","",1,"mat-mdc-chip-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","",3,"isInteractive"],["class","mdc-evolution-chip__graphic mat-mdc-chip-graphic",4,"ngIf"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-mdc-focus-indicator"],["class","mdc-evolution-chip__cell mdc-evolution-chip__cell--trailing",4,"ngIf"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(e,n){1&e&&(Lo(BV),En(0,"span",0)(1,"span",1),rt(2,"span",2)(3,"span",3),Oi(4,Nte,2,0,"span",4),rt(5,"span",5),Hi(6),En(7,"span",6),mt()()(),Oi(8,Bte,2,0,"span",7)),2&e&&(Vt("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n._isRippleCentered)("matRippleTrigger",n._elementRef.nativeElement),ft(3),Vt("isInteractive",!1),ft(1),Vt("ngIf",n.leadingIcon),ft(4),Vt("ngIf",n._hasTrailingIcon()))},dependencies:[cp,S_,Kw],styles:['.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}.mdc-evolution-chip__action--primary{overflow-x:hidden}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mdc-evolution-chip__action--primary:before{box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1}.mdc-evolution-chip--touch{margin-top:8px;margin-bottom:8px}.mdc-evolution-chip__action-touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-evolution-chip__text-label{white-space:nowrap;user-select:none;text-overflow:ellipsis;overflow:hidden}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mdc-evolution-chip__checkmark-background{opacity:0}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__graphic{transition:width 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark{transition:opacity 50ms 0ms linear,transform 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-50%, -50%)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@keyframes mdc-evolution-chip-enter{from{transform:scale(0.8);opacity:.4}to{transform:scale(1);opacity:1}}.mdc-evolution-chip--enter{animation:mdc-evolution-chip-enter 100ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-evolution-chip-exit{from{opacity:1}to{opacity:0}}.mdc-evolution-chip--exit{animation:mdc-evolution-chip-exit 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-evolution-chip--hidden{opacity:0;pointer-events:none;transition:width 150ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius);height:var(--mdc-chip-container-height);--mdc-chip-container-shape-family:rounded;--mdc-chip-container-shape-radius:16px 16px 16px 16px;--mdc-chip-with-avatar-avatar-shape-family:rounded;--mdc-chip-with-avatar-avatar-shape-radius:14px 14px 14px 14px;--mdc-chip-with-avatar-avatar-size:28px;--mdc-chip-with-icon-icon-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__ripple{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius)}.mat-mdc-standard-chip.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{height:var(--mdc-chip-with-avatar-avatar-size);width:var(--mdc-chip-with-avatar-avatar-size);font-size:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font);line-height:var(--mdc-chip-label-text-line-height);font-size:var(--mdc-chip-label-text-size);font-weight:var(--mdc-chip-label-text-weight);letter-spacing:var(--mdc-chip-label-text-tracking)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{height:var(--mdc-chip-with-icon-icon-size);width:var(--mdc-chip-with-icon-icon-size);font-size:var(--mdc-chip-with-icon-icon-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary.mdc-ripple-upgraded--background-focused .mdc-evolution-chip__ripple::before,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:not(.mdc-ripple-upgraded):focus .mdc-evolution-chip__ripple::before{transition-duration:75ms;opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color);opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-standard-chip .mdc-evolution-chip__checkmark{height:20px;width:20px}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-mdc-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-mdc-standard-chip .mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:.4}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary{flex-basis:100%}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{opacity:.04}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{opacity:.12}.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-chip-remove{opacity:.54}.mat-mdc-chip-remove:focus{opacity:1}.mat-mdc-chip-remove::before{margin:calc(var(--mat-mdc-focus-indicator-border-width, 3px) * -1);left:8px;right:8px}.mat-mdc-chip-remove .mat-icon{width:inherit;height:inherit;font-size:inherit;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}.cdk-high-contrast-active .mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}.mat-mdc-chip-action:focus .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),i})(),hie=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[xT,{provide:tA,useValue:{separatorKeyCodes:[13]}}],imports:[$o,wu,Hw,$o]}),i})();const pie=["input"],fie=["label"],mie=["*"],gie=new Ot("mat-checkbox-default-options",{providedIn:"root",factory:WV});function WV(){return{color:"accent",clickAction:"check-indeterminate"}}const _ie={provide:wh,useExisting:ir(()=>qV),multi:!0};class yie{}let vie=0;const $V=WV(),bie=BE(Vw(NE(OE(class{constructor(i){this._elementRef=i}}))));let xie=(()=>{class i extends bie{get inputId(){return`${this.id||this._uniqueId}-input`}get required(){return this._required}set required(e){this._required=dn(e)}constructor(e,n,r,o,a,u,f){super(n),this._changeDetectorRef=r,this._ngZone=o,this._animationMode=u,this._options=f,this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new Mi,this.indeterminateChange=new Mi,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=0,this._controlValueAccessorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||$V,this.color=this.defaultColor=this._options.color||$V.color,this.tabIndex=parseInt(a)||0,this.id=this._uniqueId=`${e}${++vie}`}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(e){const n=dn(e);n!=this.checked&&(this._checked=n,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(e){const n=dn(e);n!==this.disabled&&(this._disabled=n,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(e){const n=e!=this._indeterminate;this._indeterminate=dn(e),n&&(this._transitionCheckState(this._indeterminate?3:this.checked?1:2),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(e){this.checked=!!e}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_transitionCheckState(e){let n=this._currentCheckState,r=this._getAnimationTargetElement();if(n!==e&&r&&(this._currentAnimationClass&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(n,e),this._currentCheckState=e,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);const o=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(o)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const e=this._options?.clickAction;this.disabled||"noop"===e?!this.disabled&&"noop"===e&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==e&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?1:2),this._emitChangeEvent())}_onInteractionEvent(e){e.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(e,n){if("NoopAnimations"===this._animationMode)return"";switch(e){case 0:if(1===n)return this._animationClasses.uncheckedToChecked;if(3==n)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case 2:return 1===n?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case 1:return 2===n?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case 3:return 1===n?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(e){const n=this._inputElement;n&&(n.nativeElement.indeterminate=e)}}return i.\u0275fac=function(e){lp()},i.\u0275dir=si({type:i,viewQuery:function(e,n){if(1&e&&(uo(pie,5),uo(fie,5),uo(S_,5)),2&e){let r;zi(r=Ui())&&(n._inputElement=r.first),zi(r=Ui())&&(n._labelElement=r.first),zi(r=Ui())&&(n.ripple=r.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],id:"id",required:"required",labelPosition:"labelPosition",name:"name",value:"value",checked:"checked",disabled:"disabled",indeterminate:"indeterminate"},outputs:{change:"change",indeterminateChange:"indeterminateChange"},features:[Zi]}),i})(),qV=(()=>{class i extends xie{constructor(e,n,r,o,a,u){super("mat-mdc-checkbox-",e,n,r,o,a,u),this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"}}focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(e){const n=new yie;return n.source=this,n.checked=e,n}_getAnimationTargetElement(){return this._inputElement?.nativeElement}_onInputClick(){super._handleInputClick()}_onTouchTargetClick(){super._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(e){e.target&&this._labelElement.nativeElement.contains(e.target)&&e.stopPropagation()}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(vs),oe(Ji),Bl("tabindex"),oe(ma,8),oe(gie,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-checkbox"]],hostAttrs:[1,"mat-mdc-checkbox"],hostVars:12,hostBindings:function(e,n){2&e&&(vh("id",n.id),Mn("tabindex",null)("aria-label",null)("aria-labelledby",null),Un("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mdc-checkbox--disabled",n.disabled)("mat-mdc-checkbox-disabled",n.disabled)("mat-mdc-checkbox-checked",n.checked))},inputs:{disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matCheckbox"],features:[Qn([_ie]),Zi],ngContentSelectors:mie,decls:15,vars:19,consts:[[1,"mdc-form-field",3,"click"],[1,"mdc-checkbox"],["checkbox",""],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"checked","indeterminate","disabled","id","required","tabIndex","blur","click","change"],["input",""],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"],["label",""]],template:function(e,n){if(1&e&&(Lo(),rt(0,"div",0),ji("click",function(o){return n._preventBubblingFromLabel(o)}),rt(1,"div",1,2)(3,"div",3),ji("click",function(){return n._onTouchTargetClick()}),mt(),rt(4,"input",4,5),ji("blur",function(){return n._onBlur()})("click",function(){return n._onInputClick()})("change",function(o){return n._onInteractionEvent(o)}),mt(),En(6,"div",6),rt(7,"div",7),qs(),rt(8,"svg",8),En(9,"path",9),mt(),Og(),En(10,"div",10),mt(),En(11,"div",11),mt(),rt(12,"label",12,13),Hi(14),mt()()),2&e){const r=yu(2);Un("mdc-form-field--align-end","before"==n.labelPosition),ft(4),Un("mdc-checkbox--selected",n.checked),Vt("checked",n.checked)("indeterminate",n.indeterminate)("disabled",n.disabled)("id",n.inputId)("required",n.required)("tabIndex",n.tabIndex),Mn("aria-label",n.ariaLabel||null)("aria-labelledby",n.ariaLabelledby)("aria-describedby",n.ariaDescribedby)("name",n.name)("value",n.value),ft(7),Vt("matRippleTrigger",r)("matRippleDisabled",n.disableRipple||n.disabled)("matRippleCentered",!0),ft(1),Vt("for",n.inputId)}},dependencies:[S_],styles:['.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox[hidden]{display:none}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}.mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mdc-checkbox{padding:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-selected-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}@keyframes mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}}@keyframes mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}}.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:hover.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox .mdc-checkbox__background{top:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2)}.mdc-checkbox .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:focus:not(:checked):not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color);background-color:var(--mdc-checkbox-selected-focus-icon-color)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}html{--mdc-checkbox-disabled-selected-checkmark-color:#fff;--mdc-checkbox-selected-focus-state-layer-opacity:0.16;--mdc-checkbox-selected-hover-state-layer-opacity:0.04;--mdc-checkbox-selected-pressed-state-layer-opacity:0.16;--mdc-checkbox-unselected-focus-state-layer-opacity:0.16;--mdc-checkbox-unselected-hover-state-layer-opacity:0.04;--mdc-checkbox-unselected-pressed-state-layer-opacity:0.16}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox._mat-animation-noopable *,.mat-mdc-checkbox._mat-animation-noopable *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default}.mat-mdc-checkbox label:empty{display:none}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),i})(),XV=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})(),Eie=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,Hw,XV,$o,XV]}),i})();class aC{constructor(t,e,n){this.id=t,this.title=e,this.isDone=n}}class a2{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class lC extends a2{constructor(t,e,n,r,o){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r,this.projectableNodes=o}}class rA extends a2{constructor(t,e,n,r){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Sie extends a2{constructor(t){super(),this.element=t instanceof tn?t.nativeElement:t}}class l2{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof lC?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof rA?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Sie?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Tie extends l2{constructor(t,e,n,r,o){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=a=>{const u=a.element,f=this._document.createComment("dom-portal");u.parentNode.insertBefore(f,u),this.outletElement.appendChild(u),this._attachedPortal=a,super.setDisposeFn(()=>{f.parentNode&&f.parentNode.replaceChild(u,f)})},this._document=o}attachComponentPortal(t){const n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let r;return t.viewContainerRef?(r=t.viewContainerRef.createComponent(n,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=n.create(t.injector||this._defaultInjector||vl.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=t,r}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=e.indexOf(n);-1!==r&&e.remove(r)}),this._attachedPortal=t,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let cC=(()=>{class i extends l2{constructor(e,n,r){super(),this._componentFactoryResolver=e,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new Mi,this.attachDomPortal=o=>{const a=o.element,u=this._document.createComment("dom-portal");o.setAttachedHost(this),a.parentNode.insertBefore(u,a),this._getRootNode().appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{u.parentNode&&u.parentNode.replaceChild(a,u)})},this._document=r}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);const n=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,o=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),a=n.createComponent(o,n.length,e.injector||n.injector,e.projectableNodes||void 0);return n!==this._viewContainerRef&&this._getRootNode().appendChild(a.hostView.rootNodes[0]),super.setDisposeFn(()=>a.destroy()),this._attachedPortal=e,this._attachedRef=a,this.attached.emit(a),a}attachTemplatePortal(e){e.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return i.\u0275fac=function(e){return new(e||i)(oe(tg),oe(bu),oe(lr))},i.\u0275dir=si({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Zi]}),i})(),dC=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})();const ZV=j3();class Aie{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=jl(-this._previousScrollPosition.left),t.style.top=jl(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,n=t.style,r=this._document.body.style,o=n.scrollBehavior||"",a=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),ZV&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),ZV&&(n.scrollBehavior=o,r.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,n=this._viewportRuler.getViewportSize();return e.scrollHeight>n.height||e.scrollWidth>n.width}}class Die{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0).pipe(Ko(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class YV{enable(){}disable(){}attach(){}}function c2(i,t){return t.some(e=>i.bottom<e.top||i.top>e.bottom||i.right<e.left||i.left>e.right)}function KV(i,t){return t.some(e=>i.top<e.top||i.bottom>e.bottom||i.left<e.left||i.right>e.right)}class Iie{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();c2(e,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let kie=(()=>{class i{constructor(e,n,r,o){this._scrollDispatcher=e,this._viewportRuler=n,this._ngZone=r,this.noop=()=>new YV,this.close=a=>new Die(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new Aie(this._viewportRuler,this._document),this.reposition=a=>new Iie(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=o}}return i.\u0275fac=function(e){return new(e||i)(it(ET),it(CT),it(Ji),it(lr))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class uC{constructor(t){if(this.scrollStrategy=new YV,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class Rie{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let JV=(()=>{class i{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const n=this._attachedOverlays.indexOf(e);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(e){return new(e||i)(it(lr))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Pie=(()=>{class i extends JV{constructor(e,n){super(e),this._ngZone=n,this._keydownListener=r=>{const o=this._attachedOverlays;for(let a=o.length-1;a>-1;a--)if(o[a]._keydownEvents.observers.length>0){const u=o[a]._keydownEvents;this._ngZone?this._ngZone.run(()=>u.next(r)):u.next(r);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(e){return new(e||i)(it(lr),it(Ji,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Lie=(()=>{class i extends JV{constructor(e,n,r){super(e),this._platform=n,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=o=>{this._pointerDownEventTarget=av(o)},this._clickListener=o=>{const a=av(o),u="click"===o.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:a;this._pointerDownEventTarget=null;const f=this._attachedOverlays.slice();for(let y=f.length-1;y>-1;y--){const M=f[y];if(M._outsidePointerEvents.observers.length<1||!M.hasAttached())continue;if(M.overlayElement.contains(a)||M.overlayElement.contains(u))break;const A=M._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>A.next(o)):A.next(o)}}}add(e){if(super.add(e),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(e){return new(e||i)(it(lr),it(Js),it(Ji,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),oA=(()=>{class i{constructor(e,n){this._platform=n,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||jk()){const r=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let o=0;o<r.length;o++)r[o].remove()}const n=this._document.createElement("div");n.classList.add(e),jk()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(e){return new(e||i)(it(lr),it(Js))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class hC{constructor(t,e,n,r,o,a,u,f,y,M=!1){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=o,this._keyboardDispatcher=a,this._document=u,this._location=f,this._outsideClickDispatcher=y,this._animationsDisabled=M,this._backdropElement=null,this._backdropClick=new Fi,this._attachments=new Fi,this._detachments=new Fi,this._locationChanges=gt.EMPTY,this._backdropClickHandler=A=>this._backdropClick.next(A),this._backdropTransitionendHandler=A=>{this._disposeBackdrop(A.target)},this._keydownEvents=new Fi,this._outsidePointerEvents=new Fi,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(ss(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=jl(this._config.width),t.height=jl(this._config.height),t.minWidth=jl(this._config.minWidth),t.minHeight=jl(this._config.minHeight),t.maxWidth=jl(this._config.maxWidth),t.maxHeight=jl(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,e,n){const r=vT(e||[]).filter(o=>!!o);r.length&&(n?t.classList.add(...r):t.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(oo(oi(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const QV="cdk-overlay-connected-position-bounding-box",Fie=/([A-Za-z%]+)$/;class e4{get positions(){return this._preferredPositions}constructor(t,e,n,r,o){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Fi,this._resizeSubscription=gt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._validatePositions(),t.hostElement.classList.add(QV),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=this._containerRect,o=[];let a;for(let u of this._preferredPositions){let f=this._getOriginPoint(t,r,u),y=this._getOverlayPoint(f,e,u),M=this._getOverlayFit(y,e,n,u);if(M.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(u,f);this._canFitWithFlexibleDimensions(M,y,n)?o.push({position:u,origin:f,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(f,u)}):(!a||a.overlayFit.visibleArea<M.visibleArea)&&(a={overlayFit:M,overlayPoint:y,originPoint:f,position:u,overlayRect:e})}if(o.length){let u=null,f=-1;for(const y of o){const M=y.boundingBoxRect.width*y.boundingBoxRect.height*(y.position.weight||1);M>f&&(f=M,u=y)}return this._isPushed=!1,void this._applyPosition(u.position,u.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(a.position,a.originPoint);this._applyPosition(a.position,a.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&k0(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(QV),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,n){let r,o;if("center"==n.originX)r=t.left+t.width/2;else{const a=this._isRtl()?t.right:t.left,u=this._isRtl()?t.left:t.right;r="start"==n.originX?a:u}return e.left<0&&(r-=e.left),o="center"==n.originY?t.top+t.height/2:"top"==n.originY?t.top:t.bottom,e.top<0&&(o-=e.top),{x:r,y:o}}_getOverlayPoint(t,e,n){let r,o;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,o="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+r,y:t.y+o}}_getOverlayFit(t,e,n,r){const o=i4(e);let{x:a,y:u}=t,f=this._getOffset(r,"x"),y=this._getOffset(r,"y");f&&(a+=f),y&&(u+=y);let I=0-u,R=u+o.height-n.height,O=this._subtractOverflows(o.width,0-a,a+o.width-n.width),H=this._subtractOverflows(o.height,I,R),U=O*H;return{visibleArea:U,isCompletelyWithinViewport:o.width*o.height===U,fitsInViewportVertically:H===o.height,fitsInViewportHorizontally:O==o.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,o=n.right-e.x,a=t4(this._overlayRef.getConfig().minHeight),u=t4(this._overlayRef.getConfig().minWidth);return(t.fitsInViewportVertically||null!=a&&a<=r)&&(t.fitsInViewportHorizontally||null!=u&&u<=o)}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=i4(e),o=this._viewportRect,a=Math.max(t.x+r.width-o.width,0),u=Math.max(t.y+r.height-o.height,0),f=Math.max(o.top-n.top-t.y,0),y=Math.max(o.left-n.left-t.x,0);let M=0,A=0;return M=r.width<=o.width?y||-a:t.x<this._viewportMargin?o.left-n.left-t.x:0,A=r.height<=o.height?f||-u:t.y<this._viewportMargin?o.top-n.top-t.y:0,this._previousPushAmount={x:M,y:A},{x:t.x+M,y:t.y+A}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const n=this._getScrollVisibility(),r=new Rie(t,n);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let o=0;o<e.length;o++)e[o].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let o,a,u,M,A,I;if("top"===e.overlayY)a=t.y,o=n.height-a+this._viewportMargin;else if("bottom"===e.overlayY)u=n.height-t.y+2*this._viewportMargin,o=n.height-u+this._viewportMargin;else{const R=Math.min(n.bottom-t.y+n.top,t.y),O=this._lastBoundingBoxSize.height;o=2*R,a=t.y-R,o>O&&!this._isInitialRender&&!this._growAfterOpen&&(a=t.y-O/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)I=n.width-t.x+this._viewportMargin,M=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)A=t.x,M=n.right-t.x;else{const R=Math.min(n.right-t.x+n.left,t.x),O=this._lastBoundingBoxSize.width;M=2*R,A=t.x-R,M>O&&!this._isInitialRender&&!this._growAfterOpen&&(A=t.x-O/2)}return{top:a,left:A,bottom:u,right:I,width:M,height:o}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const o=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;r.height=jl(n.height),r.top=jl(n.top),r.bottom=jl(n.bottom),r.width=jl(n.width),r.left=jl(n.left),r.right=jl(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",o&&(r.maxHeight=jl(o)),a&&(r.maxWidth=jl(a))}this._lastBoundingBoxSize=n,k0(this._boundingBox.style,r)}_resetBoundingBoxStyles(){k0(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){k0(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},r=this._hasExactPosition(),o=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(r){const M=this._viewportRuler.getViewportScrollPosition();k0(n,this._getExactOverlayY(e,t,M)),k0(n,this._getExactOverlayX(e,t,M))}else n.position="static";let u="",f=this._getOffset(e,"x"),y=this._getOffset(e,"y");f&&(u+=`translateX(${f}px) `),y&&(u+=`translateY(${y}px)`),n.transform=u.trim(),a.maxHeight&&(r?n.maxHeight=jl(a.maxHeight):o&&(n.maxHeight="")),a.maxWidth&&(r?n.maxWidth=jl(a.maxWidth):o&&(n.maxWidth="")),k0(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:"",bottom:""},o=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,n)),"bottom"===t.overlayY?r.bottom=this._document.documentElement.clientHeight-(o.y+this._overlayRect.height)+"px":r.top=jl(o.y),r}_getExactOverlayX(t,e,n){let a,r={left:"",right:""},o=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,n)),a=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===a?r.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":r.left=jl(o.x),r}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:KV(t,n),isOriginOutsideView:c2(t,n),isOverlayClipped:KV(e,n),isOverlayOutsideView:c2(e,n)}}_subtractOverflows(t,...e){return e.reduce((n,r)=>n-Math.max(r,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&vT(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof tn)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function k0(i,t){for(let e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function t4(i){if("number"!=typeof i&&null!=i){const[t,e]=i.split(Fie);return e&&"px"!==e?null:parseFloat(t)}return i||null}function i4(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const n4="cdk-global-overlay-wrapper";class Oie{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(n4),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:o,maxWidth:a,maxHeight:u}=n,f=!("100%"!==r&&"100vw"!==r||a&&"100%"!==a&&"100vw"!==a),y=!("100%"!==o&&"100vh"!==o||u&&"100%"!==u&&"100vh"!==u),M=this._xPosition,A=this._xOffset,I="rtl"===this._overlayRef.getConfig().direction;let R="",O="",H="";f?H="flex-start":"center"===M?(H="center",I?O=A:R=A):I?"left"===M||"end"===M?(H="flex-end",R=A):("right"===M||"start"===M)&&(H="flex-start",O=A):"left"===M||"start"===M?(H="flex-start",R=A):("right"===M||"end"===M)&&(H="flex-end",O=A),t.position=this._cssPosition,t.marginLeft=f?"0":R,t.marginTop=y?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=f?"0":O,e.justifyContent=H,e.alignItems=y?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(n4),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let Nie=(()=>{class i{constructor(e,n,r,o){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=o}global(){return new Oie}flexibleConnectedTo(e){return new e4(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(e){return new(e||i)(it(CT),it(lr),it(Js),it(oA))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Bie=0,cf=(()=>{class i{constructor(e,n,r,o,a,u,f,y,M,A,I,R){this.scrollStrategies=e,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=o,this._keyboardDispatcher=a,this._injector=u,this._ngZone=f,this._document=y,this._directionality=M,this._location=A,this._outsideClickDispatcher=I,this._animationsModuleType=R}create(e){const n=this._createHostElement(),r=this._createPaneElement(n),o=this._createPortalOutlet(r),a=new uC(e);return a.direction=a.direction||this._directionality.value,new hC(o,n,r,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(e){const n=this._document.createElement("div");return n.id="cdk-overlay-"+Bie++,n.classList.add("cdk-overlay-pane"),e.appendChild(n),n}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(ev)),new Tie(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(e){return new(e||i)(it(kie),it(oA),it(tg),it(Nie),it(Pie),it(vl),it(Ji),it(lr),it(Cu),it(s0),it(Lie),it(ma,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const zie=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],r4=new Ot("cdk-connected-overlay-scroll-strategy");let d2=(()=>{class i{constructor(e){this.elementRef=e}}return i.\u0275fac=function(e){return new(e||i)(oe(tn))},i.\u0275dir=si({type:i,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0}),i})(),o4=(()=>{class i{get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=dn(e)}get lockPosition(){return this._lockPosition}set lockPosition(e){this._lockPosition=dn(e)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(e){this._flexibleDimensions=dn(e)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(e){this._growAfterOpen=dn(e)}get push(){return this._push}set push(e){this._push=dn(e)}constructor(e,n,r,o,a){this._overlay=e,this._dir=a,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=gt.EMPTY,this._attachSubscription=gt.EMPTY,this._detachSubscription=gt.EMPTY,this._positionSubscription=gt.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new Mi,this.positionChange=new Mi,this.attach=new Mi,this.detach=new Mi,this.overlayKeydown=new Mi,this.overlayOutsideClick=new Mi,this._templatePortal=new rA(n,r),this._scrollStrategyFactory=o,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=zie);const e=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=e.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=e.detachments().subscribe(()=>this.detach.emit()),e.keydownEvents().subscribe(n=>{this.overlayKeydown.next(n),27===n.keyCode&&!this.disableClose&&!Nc(n)&&(n.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(n=>{this.overlayOutsideClick.next(n)})}_buildConfig(){const e=this._position=this.positionStrategy||this._createPositionStrategy(),n=new uC({direction:this._dir,positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(n.width=this.width),(this.height||0===this.height)&&(n.height=this.height),(this.minWidth||0===this.minWidth)&&(n.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(n.minHeight=this.minHeight),this.backdropClass&&(n.backdropClass=this.backdropClass),this.panelClass&&(n.panelClass=this.panelClass),n}_updatePositionStrategy(e){const n=this.positions.map(r=>({originX:r.originX,originY:r.originY,overlayX:r.overlayX,overlayY:r.overlayY,offsetX:r.offsetX||this.offsetX,offsetY:r.offsetY||this.offsetY,panelClass:r.panelClass||void 0}));return e.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const e=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(e),e}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof d2?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(function Cie(i,t=!1){return to((e,n)=>{let r=0;e.subscribe(go(n,o=>{const a=i(o,r++);(a||t)&&n.next(o),!a&&n.complete()}))})}(()=>this.positionChange.observers.length>0)).subscribe(e=>{this.positionChange.emit(e),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(oe(cf),oe(sf),oe(bu),oe(r4),oe(Cu,8))},i.\u0275dir=si({type:i,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[le]}),i})();const Vie={provide:r4,deps:[cf],useFactory:function Uie(i){return()=>i.scrollStrategies.reposition()}};let pC=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[cf,Vie],imports:[FE,dC,Mz,Mz]}),i})();function Hie(i,t){}class sA{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let s4=(()=>{class i extends l2{constructor(e,n,r,o,a,u,f,y){super(),this._elementRef=e,this._focusTrapFactory=n,this._config=o,this._interactivityChecker=a,this._ngZone=u,this._overlayRef=f,this._focusMonitor=y,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=M=>{this._portalOutlet.hasAttached();const A=this._portalOutlet.attachDomPortal(M);return this._contentAttached(),A},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=r}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();const n=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),n}attachTemplatePortal(e){this._portalOutlet.hasAttached();const n=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),n}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(n)}_focusByCssSelector(e,n){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,n)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{n||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const e=this._config.restoreFocus;let n=null;if("string"==typeof e?n=this._document.querySelector(e):"boolean"==typeof e?n=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(n=e),this._config.restoreFocus&&n&&"function"==typeof n.focus){const r=zw(),o=this._elementRef.nativeElement;(!r||r===this._document.body||r===o||o.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(n,this._closeInteractionType),this._closeInteractionType=null):n.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const e=this._elementRef.nativeElement,n=zw();return e===n||e.contains(n)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=zw())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(LE),oe(lr,8),oe(sA),oe(PE),oe(Ji),oe(hC),oe(dg))},i.\u0275cmp=ui({type:i,selectors:[["cdk-dialog-container"]],viewQuery:function(e,n){if(1&e&&uo(cC,7),2&e){let r;zi(r=Ui())&&(n._portalOutlet=r.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(e,n){2&e&&Mn("id",n._config.id||null)("role",n._config.role)("aria-modal",n._config.ariaModal)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null)},features:[Zi],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,n){1&e&&Oi(0,Hie,0,0,"ng-template",0)},dependencies:[cC],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),i})();class u2{constructor(t,e){this.overlayRef=t,this.config=e,this.closed=new Fi,this.disableClose=e.disableClose,this.backdropClick=t.backdropClick(),this.keydownEvents=t.keydownEvents(),this.outsidePointerEvents=t.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(n=>{27===n.keyCode&&!this.disableClose&&!Nc(n)&&(n.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=t.detachments().subscribe(()=>{!1!==e.closeOnOverlayDetachments&&this.close()})}close(t,e){if(this.containerInstance){const n=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),n.next(t),n.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(t="",e=""){return this.overlayRef.updateSize({width:t,height:e}),this}addPanelClass(t){return this.overlayRef.addPanelClass(t),this}removePanelClass(t){return this.overlayRef.removePanelClass(t),this}}const a4=new Ot("DialogScrollStrategy"),Gie=new Ot("DialogData"),jie=new Ot("DefaultDialogConfig"),$ie={provide:a4,deps:[cf],useFactory:function Wie(i){return()=>i.scrollStrategies.block()}};let qie=0,l4=(()=>{class i{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(e,n,r,o,a,u){this._overlay=e,this._injector=n,this._defaultOptions=r,this._parentDialog=o,this._overlayContainer=a,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Fi,this._afterOpenedAtThisLevel=new Fi,this._ariaHiddenElements=new Map,this.afterAllClosed=d0(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Oc(void 0))),this._scrollStrategy=u}open(e,n){(n={...this._defaultOptions||new sA,...n}).id=n.id||"cdk-dialog-"+qie++,n.id&&this.getDialogById(n.id);const o=this._getOverlayConfig(n),a=this._overlay.create(o),u=new u2(a,n),f=this._attachContainer(a,u,n);return u.containerInstance=f,this._attachDialogContent(e,u,f,n),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(u),u.closed.subscribe(()=>this._removeOpenDialog(u,!0)),this.afterOpened.next(u),u}closeAll(){h2(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){h2(this._openDialogsAtThisLevel,e=>{!1===e.config.closeOnDestroy&&this._removeOpenDialog(e,!1)}),h2(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){const n=new uC({positionStrategy:e.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(n.backdropClass=e.backdropClass),n}_attachContainer(e,n,r){const o=r.injector||r.viewContainerRef?.injector,a=[{provide:sA,useValue:r},{provide:u2,useValue:n},{provide:hC,useValue:e}];let u;r.container?"function"==typeof r.container?u=r.container:(u=r.container.type,a.push(...r.container.providers(r))):u=s4;const f=new lC(u,r.viewContainerRef,vl.create({parent:o||this._injector,providers:a}),r.componentFactoryResolver);return e.attach(f).instance}_attachDialogContent(e,n,r,o){if(e instanceof sf){const a=this._createInjector(o,n,r,void 0);let u={$implicit:o.data,dialogRef:n};o.templateContext&&(u={...u,..."function"==typeof o.templateContext?o.templateContext():o.templateContext}),r.attachTemplatePortal(new rA(e,null,u,a))}else{const a=this._createInjector(o,n,r,this._injector),u=r.attachComponentPortal(new lC(e,o.viewContainerRef,a,o.componentFactoryResolver));n.componentInstance=u.instance}}_createInjector(e,n,r,o){const a=e.injector||e.viewContainerRef?.injector,u=[{provide:Gie,useValue:e.data},{provide:u2,useValue:n}];return e.providers&&("function"==typeof e.providers?u.push(...e.providers(n,e,r)):u.push(...e.providers)),e.direction&&(!a||!a.get(Cu,null,{optional:!0}))&&u.push({provide:Cu,useValue:{value:e.direction,change:Jt()}}),vl.create({parent:a||o,providers:u})}_removeOpenDialog(e,n){const r=this.openDialogs.indexOf(e);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((o,a)=>{o?a.setAttribute("aria-hidden",o):a.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),n&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const n=e.parentElement.children;for(let r=n.length-1;r>-1;r--){const o=n[r];o!==e&&"SCRIPT"!==o.nodeName&&"STYLE"!==o.nodeName&&!o.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(o,o.getAttribute("aria-hidden")),o.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return i.\u0275fac=function(e){return new(e||i)(it(cf),it(vl),it(jie,8),it(i,12),it(oA),it(a4))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();function h2(i,t){let e=i.length;for(;e--;)t(i[e])}let Xie=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[l4,$ie],imports:[pC,dC,sz,dC]}),i})();function Zie(i,t){}class aA{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const p2="mdc-dialog--open",c4="mdc-dialog--opening",d4="mdc-dialog--closing";let Jie=(()=>{class i extends s4{constructor(e,n,r,o,a,u,f,y){super(e,n,r,o,a,u,f,y),this._animationStateChanged=new Mi}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(LE),oe(lr,8),oe(aA),oe(PE),oe(Ji),oe(hC),oe(dg))},i.\u0275cmp=ui({type:i,selectors:[["ng-component"]],features:[Zi],decls:0,vars:0,template:function(e,n){},encapsulation:2}),i})();const u4="--mat-dialog-transition-duration";function h4(i){return null==i?null:"number"==typeof i?i:i.endsWith("ms")?dv(i.substring(0,i.length-2)):i.endsWith("s")?1e3*dv(i.substring(0,i.length-1)):"0"===i?0:null}let Qie=(()=>{class i extends Jie{constructor(e,n,r,o,a,u,f,y,M){super(e,n,r,o,a,u,f,M),this._animationMode=y,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?h4(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?h4(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(u4,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(c4,p2)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(p2),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(p2),this._animationsEnabled?(this._hostElement.style.setProperty(u4,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(d4)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_clearAnimationClasses(){this._hostElement.classList.remove(c4,d4)}_waitForAnimationToComplete(e,n){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(n,e)}_requestAnimationFrame(e){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(e):e()})}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(LE),oe(lr,8),oe(aA),oe(PE),oe(Ji),oe(hC),oe(ma,8),oe(dg))},i.\u0275cmp=ui({type:i,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:8,hostBindings:function(e,n){2&e&&(vh("id",n._config.id),Mn("aria-modal",n._config.ariaModal)("role",n._config.role)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null),Un("_mat-animation-noopable",!n._animationsEnabled))},features:[Zi],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(e,n){1&e&&(rt(0,"div",0)(1,"div",1),Oi(2,Zie,0,0,"ng-template",2),mt()())},dependencies:[cC],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(0.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{display:block;width:100%;height:100%}.mat-mdc-dialog-container{--mdc-dialog-container-elevation-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);--mdc-dialog-container-shadow-color:#000;--mdc-dialog-container-shape:4px;--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition-duration:var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container{transition:none}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-actions{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2}),i})();class p4{constructor(t,e,n){this._ref=t,this._containerInstance=n,this._afterOpened=new Fi,this._beforeClosed=new Fi,this._state=0,this.disableClose=e.disableClose,this.id=t.id,n._animationStateChanged.pipe(Ko(r=>"opened"===r.state),ss(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),n._animationStateChanged.pipe(Ko(r=>"closed"===r.state),ss(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),oi(this.backdropClick(),this.keydownEvents().pipe(Ko(r=>27===r.keyCode&&!this.disableClose&&!Nc(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function ene(i,t,e){i._closeInteractionType=t,i.close(e)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(Ko(e=>"closing"===e.state),ss(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(t){let e=this._ref.config.positionStrategy;return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(t="",e=""){return this._ref.updateSize(t,e),this}addPanelClass(t){return this._ref.addPanelClass(t),this}removePanelClass(t){return this._ref.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const f4=new Ot("MatMdcDialogData"),tne=new Ot("mat-mdc-dialog-default-options"),m4=new Ot("mat-mdc-dialog-scroll-strategy"),nne={provide:m4,deps:[cf],useFactory:function ine(i){return()=>i.scrollStrategies.block()}};let rne=0,one=(()=>{class i{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(e,n,r,o,a,u,f,y,M,A){this._overlay=e,this._defaultOptions=r,this._parentDialog=o,this._dialogRefConstructor=f,this._dialogContainerType=y,this._dialogDataToken=M,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Fi,this._afterOpenedAtThisLevel=new Fi,this._idPrefix="mat-dialog-",this.dialogConfigClass=aA,this.afterAllClosed=d0(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Oc(void 0))),this._scrollStrategy=u,this._dialog=n.get(l4)}open(e,n){let r;(n={...this._defaultOptions||new aA,...n}).id=n.id||`${this._idPrefix}${rne++}`,n.scrollStrategy=n.scrollStrategy||this._scrollStrategy();const o=this._dialog.open(e,{...n,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:n},{provide:sA,useValue:n}]},templateContext:()=>({dialogRef:r}),providers:(a,u,f)=>(r=new this._dialogRefConstructor(a,n,f),r.updatePosition(n?.position),[{provide:this._dialogContainerType,useValue:f},{provide:this._dialogDataToken,useValue:u.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentInstance=o.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const a=this.openDialogs.indexOf(r);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let n=e.length;for(;n--;)e[n].close()}}return i.\u0275fac=function(e){lp()},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})(),g4=(()=>{class i extends one{constructor(e,n,r,o,a,u,f,y){super(e,n,o,u,f,a,p4,Qie,f4,y),this._idPrefix="mat-mdc-dialog-"}}return i.\u0275fac=function(e){return new(e||i)(it(cf),it(vl),it(s0,8),it(tne,8),it(m4),it(i,12),it(oA),it(ma,8))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})(),sne=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"]}),i})(),_4=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[g4,nne],imports:[Xie,pC,dC,$o,$o]}),i})();const v4=w_({passive:!0});let ane=(()=>{class i{constructor(e,n){this._platform=e,this._ngZone=n,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return Ql;const n=C_(e),r=this._monitoredElements.get(n);if(r)return r.subject;const o=new Fi,a="cdk-text-field-autofilled",u=f=>{"cdk-text-field-autofill-start"!==f.animationName||n.classList.contains(a)?"cdk-text-field-autofill-end"===f.animationName&&n.classList.contains(a)&&(n.classList.remove(a),this._ngZone.run(()=>o.next({target:f.target,isAutofilled:!1}))):(n.classList.add(a),this._ngZone.run(()=>o.next({target:f.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{n.addEventListener("animationstart",u,v4),n.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(n,{subject:o,unlisten:()=>{n.removeEventListener("animationstart",u,v4)}}),o}stopMonitoring(e){const n=C_(e),r=this._monitoredElements.get(n);r&&(r.unlisten(),r.subject.complete(),n.classList.remove("cdk-text-field-autofill-monitored"),n.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(n))}ngOnDestroy(){this._monitoredElements.forEach((e,n)=>this.stopMonitoring(n))}}return i.\u0275fac=function(e){return new(e||i)(it(Js),it(Ji))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),lne=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({}),i})();const b4=new Ot("MAT_INPUT_VALUE_ACCESSOR"),cne=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let dne=0;const une=iR(class{constructor(i,t,e,n){this._defaultErrorStateMatcher=i,this._parentForm=t,this._parentFormGroup=e,this.ngControl=n,this.stateChanges=new Fi}});let x4=(()=>{class i extends une{get disabled(){return this._disabled}set disabled(e){this._disabled=dn(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(OT.required)??!1}set required(e){this._required=dn(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&G3().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=dn(e)}constructor(e,n,r,o,a,u,f,y,M,A){super(u,o,a,r),this._elementRef=e,this._platform=n,this._autofillMonitor=y,this._formField=A,this._uid="mat-input-"+dne++,this.focused=!1,this.stateChanges=new Fi,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(O=>G3().has(O)),this._iOSKeyupListener=O=>{const H=O.target;!H.value&&0===H.selectionStart&&0===H.selectionEnd&&(H.setSelectionRange(1,1),H.setSelectionRange(0,0))};const I=this._elementRef.nativeElement,R=I.nodeName.toLowerCase();this._inputValueAccessor=f||I,this._previousNativeValue=this.value,this.id=this.id,n.IOS&&M.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===R,this._isTextarea="textarea"===R,this._isInFormField=!!A,this._isNativeSelect&&(this.controlType=I.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_dirtyCheckPlaceholder(){const e=this._getPlaceholder();if(e!==this._previousPlaceholder){const n=this._elementRef.nativeElement;this._previousPlaceholder=e,e?n.setAttribute("placeholder",e):n.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){cne.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,n=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&n&&n.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Js),oe(sm,10),oe($w,8),oe(qw,8),oe(xT),oe(b4,10),oe(ane),oe(Ji),oe(oC,8))},i.\u0275dir=si({type:i,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(e,n){1&e&&ji("focus",function(){return n._focusChanged(!0)})("blur",function(){return n._focusChanged(!1)})("input",function(){return n._onInput()}),2&e&&(vh("id",n.id)("disabled",n.disabled)("required",n.required),Mn("name",n.name||null)("readonly",n.readonly&&!n._isNativeSelect||null)("aria-invalid",n.empty&&n.required?null:n.errorState)("aria-required",n.required)("id",n.id),Un("mat-input-server",n._isServer)("mat-mdc-form-field-textarea-control",n._isInFormField&&n._isTextarea)("mat-mdc-form-field-input-control",n._isInFormField)("mdc-text-field__input",n._isInFormField)("mat-mdc-native-select-inline",n._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[Qn([{provide:eA,useExisting:i}]),Zi,le]}),i})(),w4=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[$o,sC,sC,lne,$o]}),i})();function hne(i,t){if(1&i){const e=yh();rt(0,"mat-form-field",1)(1,"mat-label"),sn(2),Ka(3,"translate"),mt(),En(4,"input",2),rt(5,"button",3),ji("click",function(){const o=$r(e).index;return lo(ln().onRemoveButtonClick(o))}),rt(6,"mat-icon"),sn(7,"remove_circle_outline_icon"),mt()()()}if(2&i){const e=t.$implicit;ft(2),Pr(Ja(3,2,"index._view.daily._component.editGroupDialog.title")),ft(2),Vt("formControl",e)}}let M4=(()=>{class i{constructor(e,n){this.dialogRef=e,this.data=n,this.nameControl=new D_(""),this.items=[new D_("")],this.onAddButtonClick=()=>{this.items.push(new D_(""))},this.onRemoveButtonClick=r=>{this.items.splice(r,1)},this.onSaveButtonClick=()=>{const r={name:this.nameControl.getRawValue()||"",items:this.items.map(o=>o.getRawValue()||"")};this.dialogRef.close(r)}}}return i.\u0275fac=function(e){return new(e||i)(oe(p4),oe(f4))},i.\u0275cmp=ui({type:i,selectors:[["add-group-dialog"]],standalone:!0,features:[tm],decls:14,vars:8,consts:[["mat-dialog-content","",2,"padding-top","2em"],["appearance","outline",2,"width","100%"],["matInput","",3,"formControl"],["matSuffix","","mat-icon-button","",3,"click"],["appearance","outline","style","width: 100%",4,"ngFor","ngForOf"],[2,"display","flex","justify-content","flex-end"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,n){1&e&&(rt(0,"div",0)(1,"mat-form-field",1)(2,"mat-label"),sn(3),Ka(4,"translate"),mt(),En(5,"input",2),rt(6,"button",3),ji("click",function(){return n.onAddButtonClick()}),rt(7,"mat-icon"),sn(8,"add_circle_outline_icon"),mt()()(),Oi(9,hne,8,4,"mat-form-field",4),rt(10,"div",5)(11,"button",6),ji("click",function(){return n.onSaveButtonClick()}),sn(12),Ka(13,"translate"),mt()()()),2&e&&(ft(3),Pr(Ja(4,4,"index._view.daily._component.editGroupDialog.name")),ft(2),Vt("formControl",n.nameControl),ft(4),Vt("ngForOf",n.items),ft(3),Pr(Ja(13,6,"index._view.daily._component.editGroupDialog.save")))},dependencies:[Zw,rC,wu,a0,cV,ZE,ER,qT,_4,sne,sC,NV,JT,AV,w4,x4,uv,WE,M0,T0,S0],encapsulation:2}),i})();function pne(i,t){if(1&i&&(rt(0,"mat-checkbox",5),sn(1),mt()),2&i){const e=t.$implicit;Vt("checked",e.isDone),ft(1),Pr(e.title)}}function fne(i,t){if(1&i){const e=yh();rt(0,"mat-card")(1,"mat-chip",3),ji("click",function(){const o=$r(e).$implicit;return lo(ln().onGroupChipClick(o))}),sn(2),mt(),rt(3,"mat-card-content"),Oi(4,pne,2,2,"mat-checkbox",4),mt()()}if(2&i){const e=t.$implicit;ft(1),Jf("background",e.color),ft(1),Pr(e.name),ft(2),Vt("ngForOf",e.items)}}let mne=(()=>{class i{constructor(e){this.dialog=e,this.data=[{id:10,name:"Group-1",color:"aliceblue",items:[new aC(1,"somgf",!1),new aC(2,"soczxczxcmgf",!1)]},{id:11,name:"Group-2",color:"orange",items:[new aC(3,"advdsvs",!0),new aC(4,"bdbgbfb",!1)]}],this.onGroupChipClick=n=>{this.dialog.open(M4,{data:n})},this.onAddButtonClick=()=>{this.dialog.open(M4).afterClosed().subscribe(n=>{n&&this.data.push({id:(new Date).getTime(),name:n.name,color:"aliceblue",items:n.items.map(r=>new aC(1,r,!1))})})}}}return i.\u0275fac=function(e){return new(e||i)(oe(g4))},i.\u0275cmp=ui({type:i,selectors:[["view-daily"]],standalone:!0,features:[tm],decls:6,vars:1,consts:[[2,"padding","1em"],[4,"ngFor","ngForOf"],["mat-fab","","color","primary",2,"position","fixed","bottom","1em","right","1em",3,"click"],[3,"click"],[3,"checked",4,"ngFor","ngForOf"],[3,"checked"]],template:function(e,n){1&e&&(rt(0,"div",0)(1,"mat-list"),Oi(2,fne,5,4,"mat-card",1),mt(),rt(3,"button",2),ji("click",function(){return n.onAddButtonClick()}),rt(4,"mat-icon"),sn(5,"add"),mt()()()),2&e&&(ft(2),Vt("ngForOf",n.data))},dependencies:[wu,a0,tC,eC,hie,I0,EV,JR,QR,Eie,qV,uv,Uz,T0,S0,_4],styles:["[_nghost-%COMP%]   mat-card[_ngcontent-%COMP%]:not(:first-of-type){margin-top:2em}[_nghost-%COMP%]   mat-chip[_ngcontent-%COMP%]{position:relative;top:-16px;left:1em;width:-moz-fit-content;width:fit-content}[_nghost-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:block}"]}),i})();function E4(i,t,e,n,r,o,a){try{var u=i[o](a),f=u.value}catch(y){return void e(y)}u.done?t(f):Promise.resolve(f).then(n,r)}const S4=1,vne=2,I_=3,lA=0,zne=1,Une=2,R_=0,Vne=1,Hne=2,Gne=3,jne=4,Wne=5,R0=301,P0=302,fC=306,Du=1001,$l=1003,ql=1006,L0=1008,yv=1009,vv=1014,P_=1015,mC=1016,F0=1020,df=1023,O0=1026,n1=1027,N0=3001,Hr="srgb",pg="srgb-linear",p5="display-p3",f5="300 es",L_=2e3;class U0{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const r=this._listeners[t];if(void 0!==r){const o=r.indexOf(e);-1!==o&&r.splice(o,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const n=this._listeners[t.type];if(void 0!==n){t.target=this;const r=n.slice(0);for(let o=0,a=r.length;o<a;o++)r[o].call(this,t);t.target=null}}}const Ud=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],V0=Math.PI/180,s1=180/Math.PI;function hp(){const i=4294967295*Math.random()|0,t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Ud[255&i]+Ud[i>>8&255]+Ud[i>>16&255]+Ud[i>>24&255]+"-"+Ud[255&t]+Ud[t>>8&255]+"-"+Ud[t>>16&15|64]+Ud[t>>24&255]+"-"+Ud[63&e|128]+Ud[e>>8&255]+"-"+Ud[e>>16&255]+Ud[e>>24&255]+Ud[255&n]+Ud[n>>8&255]+Ud[n>>16&255]+Ud[n>>24&255]).toLowerCase()}function Qa(i,t,e){return Math.max(t,Math.min(e,i))}function gC(i,t,e){return(1-e)*i+e*t}function D2(i){return 0==(i&i-1)&&0!==i}function vA(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function pp(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Xr(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return Math.round(4294967295*i);case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int32Array:return Math.round(2147483647*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}}class ei{constructor(t=0,e=0){ei.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Qa(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),o=this.x-t.x,a=this.y-t.y;return this.x=o*n-a*r+t.x,this.y=o*r+a*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class eo{constructor(t,e,n,r,o,a,u,f,y){eo.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,n,r,o,a,u,f,y)}set(t,e,n,r,o,a,u,f,y){const M=this.elements;return M[0]=t,M[1]=r,M[2]=u,M[3]=e,M[4]=o,M[5]=f,M[6]=n,M[7]=a,M[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,o=this.elements,a=n[0],u=n[3],f=n[6],y=n[1],M=n[4],A=n[7],I=n[2],R=n[5],O=n[8],H=r[0],U=r[3],B=r[6],Z=r[1],X=r[4],ee=r[7],se=r[2],ve=r[5],Ce=r[8];return o[0]=a*H+u*Z+f*se,o[3]=a*U+u*X+f*ve,o[6]=a*B+u*ee+f*Ce,o[1]=y*H+M*Z+A*se,o[4]=y*U+M*X+A*ve,o[7]=y*B+M*ee+A*Ce,o[2]=I*H+R*Z+O*se,o[5]=I*U+R*X+O*ve,o[8]=I*B+R*ee+O*Ce,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],a=t[4],u=t[5],f=t[6],y=t[7],M=t[8];return e*a*M-e*u*y-n*o*M+n*u*f+r*o*y-r*a*f}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],a=t[4],u=t[5],f=t[6],y=t[7],M=t[8],A=M*a-u*y,I=u*f-M*o,R=y*o-a*f,O=e*A+n*I+r*R;if(0===O)return this.set(0,0,0,0,0,0,0,0,0);const H=1/O;return t[0]=A*H,t[1]=(r*y-M*n)*H,t[2]=(u*n-r*a)*H,t[3]=I*H,t[4]=(M*e-r*f)*H,t[5]=(r*o-u*e)*H,t[6]=R*H,t[7]=(n*f-y*e)*H,t[8]=(a*e-n*o)*H,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,o,a,u){const f=Math.cos(o),y=Math.sin(o);return this.set(n*f,n*y,-n*(f*a+y*u)+a+t,-r*y,r*f,-r*(-y*a+f*u)+u+e,0,0,1),this}scale(t,e){return this.premultiply(I2.makeScale(t,e)),this}rotate(t){return this.premultiply(I2.makeRotation(-t)),this}translate(t,e){return this.premultiply(I2.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const I2=new eo;function _5(i){for(let t=i.length-1;t>=0;--t)if(i[t]>=65535)return!0;return!1}function _C(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const y5={};function yC(i){i in y5||(y5[i]=!0,console.warn(i))}function l1(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function k2(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}const Ire=(new eo).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),kre=(new eo).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Lre={[pg]:i=>i,[Hr]:i=>i.convertSRGBToLinear(),[p5]:function Rre(i){return i.convertSRGBToLinear().applyMatrix3(kre)}},Fre={[pg]:i=>i,[Hr]:i=>i.convertLinearToSRGB(),[p5]:function Pre(i){return i.applyMatrix3(Ire).convertLinearToSRGB()}},am={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return pg},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,t,e){if(!1===this.enabled||t===e||!t||!e)return i;const n=Lre[t],r=Fre[e];if(void 0===n||void 0===r)throw new Error(`Unsupported color space conversion, "${t}" to "${e}".`);return r(n(i))},fromWorkingColorSpace:function(i,t){return this.convert(i,this.workingColorSpace,t)},toWorkingColorSpace:function(i,t){return this.convert(i,t,this.workingColorSpace)}};let c1;class v5{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===c1&&(c1=_C("canvas")),c1.width=t.width,c1.height=t.height;const n=c1.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=c1}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const e=_C("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),o=r.data;for(let a=0;a<o.length;a++)o[a]=255*l1(o[a]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let n=0;n<e.length;n++)e[n]=e instanceof Uint8Array||e instanceof Uint8ClampedArray?Math.floor(255*l1(e[n]/255)):l1(e[n]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Ore=0;class d1{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Ore++}),this.uuid=hp(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let o;if(Array.isArray(r)){o=[];for(let a=0,u=r.length;a<u;a++)o.push(R2(r[a].isDataTexture?r[a].image:r[a]))}else o=R2(r);n.url=o}return e||(t.images[this.uuid]=n),n}}function R2(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?v5.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Nre=0,bv=(()=>{class i extends U0{constructor(e=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=Du,o=Du,a=ql,u=L0,f=df,y=yv,M=i.DEFAULT_ANISOTROPY,A=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Nre++}),this.uuid=hp(),this.name="",this.source=new d1(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=o,this.magFilter=a,this.minFilter=u,this.anisotropy=M,this.format=f,this.internalFormat=null,this.type=y,this.offset=new ei(0,0),this.repeat=new ei(1,1),this.center=new ei(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new eo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof A?this.colorSpace=A:(yC("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=A===N0?Hr:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=void 0===e||"string"==typeof e;if(!n&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case Du:e.x=e.x<0?0:1;break;case 1002:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case Du:e.y=e.y<0?0:1;break;case 1002:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return yC("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Hr?N0:3e3}set encoding(e){yC("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===N0?Hr:""}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=300,i.DEFAULT_ANISOTROPY=1,i})();class bs{constructor(t=0,e=0,n=0,r=1){bs.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,o=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*r+a[12]*o,this.y=a[1]*e+a[5]*n+a[9]*r+a[13]*o,this.z=a[2]*e+a[6]*n+a[10]*r+a[14]*o,this.w=a[3]*e+a[7]*n+a[11]*r+a[15]*o,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,o;const f=t.elements,y=f[0],M=f[4],A=f[8],I=f[1],R=f[5],O=f[9],H=f[2],U=f[6],B=f[10];if(Math.abs(M-I)<.01&&Math.abs(A-H)<.01&&Math.abs(O-U)<.01){if(Math.abs(M+I)<.1&&Math.abs(A+H)<.1&&Math.abs(O+U)<.1&&Math.abs(y+R+B-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const X=(y+1)/2,ee=(R+1)/2,se=(B+1)/2,ve=(M+I)/4,Ce=(A+H)/4,Ve=(O+U)/4;return X>ee&&X>se?X<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(X),r=ve/n,o=Ce/n):ee>se?ee<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(ee),n=ve/r,o=Ve/r):se<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(se),n=Ce/o,r=Ve/o),this.set(n,r,o,e),this}let Z=Math.sqrt((U-O)*(U-O)+(A-H)*(A-H)+(I-M)*(I-M));return Math.abs(Z)<.001&&(Z=1),this.x=(U-O)/Z,this.y=(A-H)/Z,this.z=(I-M)/Z,this.w=Math.acos((y+R+B-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class H0 extends U0{constructor(t=1,e=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new bs(0,0,t,e),this.scissorTest=!1,this.viewport=new bs(0,0,t,e);const r={width:t,height:e,depth:1};void 0!==n.encoding&&(yC("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===N0?Hr:""),this.texture=new bv(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:ql,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(t,e,n=1){(this.width!==t||this.height!==e||this.depth!==n)&&(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new d1(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class P2 extends bv{constructor(t=null,e=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=$l,this.minFilter=$l,this.wrapR=Du,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class b5 extends bv{constructor(t=null,e=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=$l,this.minFilter=$l,this.wrapR=Du,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Iu{constructor(t=0,e=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,o,a,u){let f=n[r+0],y=n[r+1],M=n[r+2],A=n[r+3];const I=o[a+0],R=o[a+1],O=o[a+2],H=o[a+3];if(0===u)return t[e+0]=f,t[e+1]=y,t[e+2]=M,void(t[e+3]=A);if(1===u)return t[e+0]=I,t[e+1]=R,t[e+2]=O,void(t[e+3]=H);if(A!==H||f!==I||y!==R||M!==O){let U=1-u;const B=f*I+y*R+M*O+A*H,Z=B>=0?1:-1,X=1-B*B;if(X>Number.EPSILON){const se=Math.sqrt(X),ve=Math.atan2(se,B*Z);U=Math.sin(U*ve)/se,u=Math.sin(u*ve)/se}const ee=u*Z;if(f=f*U+I*ee,y=y*U+R*ee,M=M*U+O*ee,A=A*U+H*ee,U===1-u){const se=1/Math.sqrt(f*f+y*y+M*M+A*A);f*=se,y*=se,M*=se,A*=se}}t[e]=f,t[e+1]=y,t[e+2]=M,t[e+3]=A}static multiplyQuaternionsFlat(t,e,n,r,o,a){const u=n[r],f=n[r+1],y=n[r+2],M=n[r+3],A=o[a],I=o[a+1],R=o[a+2],O=o[a+3];return t[e]=u*O+M*A+f*R-y*I,t[e+1]=f*O+M*I+y*A-u*R,t[e+2]=y*O+M*R+u*I-f*A,t[e+3]=M*O-u*A-f*I-y*R,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const n=t._x,r=t._y,o=t._z,a=t._order,u=Math.cos,f=Math.sin,y=u(n/2),M=u(r/2),A=u(o/2),I=f(n/2),R=f(r/2),O=f(o/2);switch(a){case"XYZ":this._x=I*M*A+y*R*O,this._y=y*R*A-I*M*O,this._z=y*M*O+I*R*A,this._w=y*M*A-I*R*O;break;case"YXZ":this._x=I*M*A+y*R*O,this._y=y*R*A-I*M*O,this._z=y*M*O-I*R*A,this._w=y*M*A+I*R*O;break;case"ZXY":this._x=I*M*A-y*R*O,this._y=y*R*A+I*M*O,this._z=y*M*O+I*R*A,this._w=y*M*A-I*R*O;break;case"ZYX":this._x=I*M*A-y*R*O,this._y=y*R*A+I*M*O,this._z=y*M*O-I*R*A,this._w=y*M*A+I*R*O;break;case"YZX":this._x=I*M*A+y*R*O,this._y=y*R*A+I*M*O,this._z=y*M*O-I*R*A,this._w=y*M*A-I*R*O;break;case"XZY":this._x=I*M*A-y*R*O,this._y=y*R*A-I*M*O,this._z=y*M*O+I*R*A,this._w=y*M*A+I*R*O;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],o=e[8],a=e[1],u=e[5],f=e[9],y=e[2],M=e[6],A=e[10],I=n+u+A;if(I>0){const R=.5/Math.sqrt(I+1);this._w=.25/R,this._x=(M-f)*R,this._y=(o-y)*R,this._z=(a-r)*R}else if(n>u&&n>A){const R=2*Math.sqrt(1+n-u-A);this._w=(M-f)/R,this._x=.25*R,this._y=(r+a)/R,this._z=(o+y)/R}else if(u>A){const R=2*Math.sqrt(1+u-n-A);this._w=(o-y)/R,this._x=(r+a)/R,this._y=.25*R,this._z=(f+M)/R}else{const R=2*Math.sqrt(1+A-n-u);this._w=(a-r)/R,this._x=(o+y)/R,this._y=(f+M)/R,this._z=.25*R}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Qa(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,o=t._z,a=t._w,u=e._x,f=e._y,y=e._z,M=e._w;return this._x=n*M+a*u+r*y-o*f,this._y=r*M+a*f+o*u-n*y,this._z=o*M+a*y+n*f-r*u,this._w=a*M-n*u-r*f-o*y,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,o=this._z,a=this._w;let u=a*t._w+n*t._x+r*t._y+o*t._z;if(u<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,u=-u):this.copy(t),u>=1)return this._w=a,this._x=n,this._y=r,this._z=o,this;const f=1-u*u;if(f<=Number.EPSILON){const R=1-e;return this._w=R*a+e*this._w,this._x=R*n+e*this._x,this._y=R*r+e*this._y,this._z=R*o+e*this._z,this.normalize(),this._onChangeCallback(),this}const y=Math.sqrt(f),M=Math.atan2(y,u),A=Math.sin((1-e)*M)/y,I=Math.sin(e*M)/y;return this._w=a*A+this._w*I,this._x=n*A+this._x*I,this._y=r*A+this._y*I,this._z=o*A+this._z*I,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(o),n*Math.cos(o),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ee{constructor(t=0,e=0,n=0){Ee.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(x5.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(x5.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[3]*n+o[6]*r,this.y=o[1]*e+o[4]*n+o[7]*r,this.z=o[2]*e+o[5]*n+o[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,o=t.elements,a=1/(o[3]*e+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*e+o[4]*n+o[8]*r+o[12])*a,this.y=(o[1]*e+o[5]*n+o[9]*r+o[13])*a,this.z=(o[2]*e+o[6]*n+o[10]*r+o[14])*a,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,o=t.x,a=t.y,u=t.z,f=t.w,y=f*e+a*r-u*n,M=f*n+u*e-o*r,A=f*r+o*n-a*e,I=-o*e-a*n-u*r;return this.x=y*f+I*-o+M*-u-A*-a,this.y=M*f+I*-a+A*-o-y*-u,this.z=A*f+I*-u+y*-a-M*-o,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r,this.y=o[1]*e+o[5]*n+o[9]*r,this.z=o[2]*e+o[6]*n+o[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,o=t.z,a=e.x,u=e.y,f=e.z;return this.x=r*f-o*u,this.y=o*a-n*f,this.z=n*u-r*a,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return L2.copy(this).projectOnVector(t),this.sub(L2)}reflect(t){return this.sub(L2.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Qa(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const L2=new Ee,x5=new Iu;class F_{constructor(t=new Ee(1/0,1/0,1/0),e=new Ee(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(N_.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(N_.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=N_.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){if(t.updateWorldMatrix(!1,!1),void 0!==t.boundingBox)null===t.boundingBox&&t.computeBoundingBox(),u1.copy(t.boundingBox),u1.applyMatrix4(t.matrixWorld),this.union(u1);else{const r=t.geometry;if(void 0!==r)if(e&&void 0!==r.attributes&&void 0!==r.attributes.position){const o=r.attributes.position;for(let a=0,u=o.count;a<u;a++)N_.fromBufferAttribute(o,a).applyMatrix4(t.matrixWorld),this.expandByPoint(N_)}else null===r.boundingBox&&r.computeBoundingBox(),u1.copy(r.boundingBox),u1.applyMatrix4(t.matrixWorld),this.union(u1)}const n=t.children;for(let r=0,o=n.length;r<o;r++)this.expandByObject(n[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,N_),N_.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(vC),bA.subVectors(this.max,vC),h1.subVectors(t.a,vC),p1.subVectors(t.b,vC),f1.subVectors(t.c,vC),xv.subVectors(p1,h1),wv.subVectors(f1,p1),G0.subVectors(h1,f1);let e=[0,-xv.z,xv.y,0,-wv.z,wv.y,0,-G0.z,G0.y,xv.z,0,-xv.x,wv.z,0,-wv.x,G0.z,0,-G0.x,-xv.y,xv.x,0,-wv.y,wv.x,0,-G0.y,G0.x,0];return!(!F2(e,h1,p1,f1,bA)||(e=[1,0,0,0,1,0,0,0,1],!F2(e,h1,p1,f1,bA)))&&(xA.crossVectors(xv,wv),e=[xA.x,xA.y,xA.z],F2(e,h1,p1,f1,bA))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,N_).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(N_).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(O_[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),O_[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),O_[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),O_[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),O_[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),O_[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),O_[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),O_[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(O_)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const O_=[new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee],N_=new Ee,u1=new F_,h1=new Ee,p1=new Ee,f1=new Ee,xv=new Ee,wv=new Ee,G0=new Ee,vC=new Ee,bA=new Ee,xA=new Ee,j0=new Ee;function F2(i,t,e,n,r){for(let o=0,a=i.length-3;o<=a;o+=3){j0.fromArray(i,o);const u=r.x*Math.abs(j0.x)+r.y*Math.abs(j0.y)+r.z*Math.abs(j0.z),f=t.dot(j0),y=e.dot(j0),M=n.dot(j0);if(Math.max(-Math.max(f,y,M),Math.min(f,y,M))>u)return!1}return!0}const Bre=new F_,bC=new Ee,O2=new Ee;class fg{constructor(t=new Ee,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):Bre.setFromPoints(t).getCenter(n);let r=0;for(let o=0,a=t.length;o<a;o++)r=Math.max(r,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;bC.subVectors(t,this.center);const e=bC.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),r=.5*(n-this.radius);this.center.addScaledVector(bC,r/n),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(O2.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(bC.copy(t.center).add(O2)),this.expandByPoint(bC.copy(t.center).sub(O2))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const B_=new Ee,N2=new Ee,wA=new Ee,Mv=new Ee,B2=new Ee,MA=new Ee,z2=new Ee;class xC{constructor(t=new Ee,e=new Ee(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,B_)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=B_.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(B_.copy(this.origin).addScaledVector(this.direction,e),B_.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){N2.copy(t).add(e).multiplyScalar(.5),wA.copy(e).sub(t).normalize(),Mv.copy(this.origin).sub(N2);const o=.5*t.distanceTo(e),a=-this.direction.dot(wA),u=Mv.dot(this.direction),f=-Mv.dot(wA),y=Mv.lengthSq(),M=Math.abs(1-a*a);let A,I,R,O;if(M>0)if(A=a*f-u,I=a*u-f,O=o*M,A>=0)if(I>=-O)if(I<=O){const H=1/M;A*=H,I*=H,R=A*(A+a*I+2*u)+I*(a*A+I+2*f)+y}else I=o,A=Math.max(0,-(a*I+u)),R=-A*A+I*(I+2*f)+y;else I=-o,A=Math.max(0,-(a*I+u)),R=-A*A+I*(I+2*f)+y;else I<=-O?(A=Math.max(0,-(-a*o+u)),I=A>0?-o:Math.min(Math.max(-o,-f),o),R=-A*A+I*(I+2*f)+y):I<=O?(A=0,I=Math.min(Math.max(-o,-f),o),R=I*(I+2*f)+y):(A=Math.max(0,-(a*o+u)),I=A>0?o:Math.min(Math.max(-o,-f),o),R=-A*A+I*(I+2*f)+y);else I=a>0?-o:o,A=Math.max(0,-(a*I+u)),R=-A*A+I*(I+2*f)+y;return n&&n.copy(this.origin).addScaledVector(this.direction,A),r&&r.copy(N2).addScaledVector(wA,I),R}intersectSphere(t,e){B_.subVectors(t.center,this.origin);const n=B_.dot(this.direction),r=B_.dot(B_)-n*n,o=t.radius*t.radius;if(r>o)return null;const a=Math.sqrt(o-r),u=n-a,f=n+a;return f<0?null:this.at(u<0?f:u,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,o,a,u,f;const y=1/this.direction.x,M=1/this.direction.y,A=1/this.direction.z,I=this.origin;return y>=0?(n=(t.min.x-I.x)*y,r=(t.max.x-I.x)*y):(n=(t.max.x-I.x)*y,r=(t.min.x-I.x)*y),M>=0?(o=(t.min.y-I.y)*M,a=(t.max.y-I.y)*M):(o=(t.max.y-I.y)*M,a=(t.min.y-I.y)*M),n>a||o>r||((o>n||isNaN(n))&&(n=o),(a<r||isNaN(r))&&(r=a),A>=0?(u=(t.min.z-I.z)*A,f=(t.max.z-I.z)*A):(u=(t.max.z-I.z)*A,f=(t.min.z-I.z)*A),n>f||u>r)||((u>n||n!=n)&&(n=u),(f<r||r!=r)&&(r=f),r<0)?null:this.at(n>=0?n:r,e)}intersectsBox(t){return null!==this.intersectBox(t,B_)}intersectTriangle(t,e,n,r,o){B2.subVectors(e,t),MA.subVectors(n,t),z2.crossVectors(B2,MA);let u,a=this.direction.dot(z2);if(a>0){if(r)return null;u=1}else{if(!(a<0))return null;u=-1,a=-a}Mv.subVectors(this.origin,t);const f=u*this.direction.dot(MA.crossVectors(Mv,MA));if(f<0)return null;const y=u*this.direction.dot(B2.cross(Mv));if(y<0||f+y>a)return null;const M=-u*Mv.dot(z2);return M<0?null:this.at(M/a,o)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Fr{constructor(t,e,n,r,o,a,u,f,y,M,A,I,R,O,H,U){Fr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,n,r,o,a,u,f,y,M,A,I,R,O,H,U)}set(t,e,n,r,o,a,u,f,y,M,A,I,R,O,H,U){const B=this.elements;return B[0]=t,B[4]=e,B[8]=n,B[12]=r,B[1]=o,B[5]=a,B[9]=u,B[13]=f,B[2]=y,B[6]=M,B[10]=A,B[14]=I,B[3]=R,B[7]=O,B[11]=H,B[15]=U,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Fr).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/m1.setFromMatrixColumn(t,0).length(),o=1/m1.setFromMatrixColumn(t,1).length(),a=1/m1.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*o,e[5]=n[5]*o,e[6]=n[6]*o,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,o=t.z,a=Math.cos(n),u=Math.sin(n),f=Math.cos(r),y=Math.sin(r),M=Math.cos(o),A=Math.sin(o);if("XYZ"===t.order){const I=a*M,R=a*A,O=u*M,H=u*A;e[0]=f*M,e[4]=-f*A,e[8]=y,e[1]=R+O*y,e[5]=I-H*y,e[9]=-u*f,e[2]=H-I*y,e[6]=O+R*y,e[10]=a*f}else if("YXZ"===t.order){const I=f*M,R=f*A,O=y*M,H=y*A;e[0]=I+H*u,e[4]=O*u-R,e[8]=a*y,e[1]=a*A,e[5]=a*M,e[9]=-u,e[2]=R*u-O,e[6]=H+I*u,e[10]=a*f}else if("ZXY"===t.order){const I=f*M,R=f*A,O=y*M,H=y*A;e[0]=I-H*u,e[4]=-a*A,e[8]=O+R*u,e[1]=R+O*u,e[5]=a*M,e[9]=H-I*u,e[2]=-a*y,e[6]=u,e[10]=a*f}else if("ZYX"===t.order){const I=a*M,R=a*A,O=u*M,H=u*A;e[0]=f*M,e[4]=O*y-R,e[8]=I*y+H,e[1]=f*A,e[5]=H*y+I,e[9]=R*y-O,e[2]=-y,e[6]=u*f,e[10]=a*f}else if("YZX"===t.order){const I=a*f,R=a*y,O=u*f,H=u*y;e[0]=f*M,e[4]=H-I*A,e[8]=O*A+R,e[1]=A,e[5]=a*M,e[9]=-u*M,e[2]=-y*M,e[6]=R*A+O,e[10]=I-H*A}else if("XZY"===t.order){const I=a*f,R=a*y,O=u*f,H=u*y;e[0]=f*M,e[4]=-A,e[8]=y*M,e[1]=I*A+H,e[5]=a*M,e[9]=R*A-O,e[2]=O*A-R,e[6]=u*M,e[10]=H*A+I}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(zre,t,Ure)}lookAt(t,e,n){const r=this.elements;return fp.subVectors(t,e),0===fp.lengthSq()&&(fp.z=1),fp.normalize(),Ev.crossVectors(n,fp),0===Ev.lengthSq()&&(1===Math.abs(n.z)?fp.x+=1e-4:fp.z+=1e-4,fp.normalize(),Ev.crossVectors(n,fp)),Ev.normalize(),EA.crossVectors(fp,Ev),r[0]=Ev.x,r[4]=EA.x,r[8]=fp.x,r[1]=Ev.y,r[5]=EA.y,r[9]=fp.y,r[2]=Ev.z,r[6]=EA.z,r[10]=fp.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,o=this.elements,a=n[0],u=n[4],f=n[8],y=n[12],M=n[1],A=n[5],I=n[9],R=n[13],O=n[2],H=n[6],U=n[10],B=n[14],Z=n[3],X=n[7],ee=n[11],se=n[15],ve=r[0],Ce=r[4],Ve=r[8],ce=r[12],we=r[1],At=r[5],ni=r[9],ht=r[13],_t=r[2],Tt=r[6],at=r[10],ot=r[14],dt=r[3],It=r[7],Xt=r[11],ut=r[15];return o[0]=a*ve+u*we+f*_t+y*dt,o[4]=a*Ce+u*At+f*Tt+y*It,o[8]=a*Ve+u*ni+f*at+y*Xt,o[12]=a*ce+u*ht+f*ot+y*ut,o[1]=M*ve+A*we+I*_t+R*dt,o[5]=M*Ce+A*At+I*Tt+R*It,o[9]=M*Ve+A*ni+I*at+R*Xt,o[13]=M*ce+A*ht+I*ot+R*ut,o[2]=O*ve+H*we+U*_t+B*dt,o[6]=O*Ce+H*At+U*Tt+B*It,o[10]=O*Ve+H*ni+U*at+B*Xt,o[14]=O*ce+H*ht+U*ot+B*ut,o[3]=Z*ve+X*we+ee*_t+se*dt,o[7]=Z*Ce+X*At+ee*Tt+se*It,o[11]=Z*Ve+X*ni+ee*at+se*Xt,o[15]=Z*ce+X*ht+ee*ot+se*ut,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],o=t[12],a=t[1],u=t[5],f=t[9],y=t[13],M=t[2],A=t[6],I=t[10],R=t[14];return t[3]*(+o*f*A-r*y*A-o*u*I+n*y*I+r*u*R-n*f*R)+t[7]*(+e*f*R-e*y*I+o*a*I-r*a*R+r*y*M-o*f*M)+t[11]*(+e*y*A-e*u*R-o*a*A+n*a*R+o*u*M-n*y*M)+t[15]*(-r*u*M-e*f*A+e*u*I+r*a*A-n*a*I+n*f*M)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],a=t[4],u=t[5],f=t[6],y=t[7],M=t[8],A=t[9],I=t[10],R=t[11],O=t[12],H=t[13],U=t[14],B=t[15],Z=A*U*y-H*I*y+H*f*R-u*U*R-A*f*B+u*I*B,X=O*I*y-M*U*y-O*f*R+a*U*R+M*f*B-a*I*B,ee=M*H*y-O*A*y+O*u*R-a*H*R-M*u*B+a*A*B,se=O*A*f-M*H*f-O*u*I+a*H*I+M*u*U-a*A*U,ve=e*Z+n*X+r*ee+o*se;if(0===ve)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Ce=1/ve;return t[0]=Z*Ce,t[1]=(H*I*o-A*U*o-H*r*R+n*U*R+A*r*B-n*I*B)*Ce,t[2]=(u*U*o-H*f*o+H*r*y-n*U*y-u*r*B+n*f*B)*Ce,t[3]=(A*f*o-u*I*o-A*r*y+n*I*y+u*r*R-n*f*R)*Ce,t[4]=X*Ce,t[5]=(M*U*o-O*I*o+O*r*R-e*U*R-M*r*B+e*I*B)*Ce,t[6]=(O*f*o-a*U*o-O*r*y+e*U*y+a*r*B-e*f*B)*Ce,t[7]=(a*I*o-M*f*o+M*r*y-e*I*y-a*r*R+e*f*R)*Ce,t[8]=ee*Ce,t[9]=(O*A*o-M*H*o-O*n*R+e*H*R+M*n*B-e*A*B)*Ce,t[10]=(a*H*o-O*u*o+O*n*y-e*H*y-a*n*B+e*u*B)*Ce,t[11]=(M*u*o-a*A*o-M*n*y+e*A*y+a*n*R-e*u*R)*Ce,t[12]=se*Ce,t[13]=(M*H*r-O*A*r+O*n*I-e*H*I-M*n*U+e*A*U)*Ce,t[14]=(O*u*r-a*H*r-O*n*f+e*H*f+a*n*U-e*u*U)*Ce,t[15]=(a*A*r-M*u*r+M*n*f-e*A*f-a*n*I+e*u*I)*Ce,this}scale(t){const e=this.elements,n=t.x,r=t.y,o=t.z;return e[0]*=n,e[4]*=r,e[8]*=o,e[1]*=n,e[5]*=r,e[9]*=o,e[2]*=n,e[6]*=r,e[10]*=o,e[3]*=n,e[7]*=r,e[11]*=o,this}getMaxScaleOnAxis(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),o=1-n,a=t.x,u=t.y,f=t.z,y=o*a,M=o*u;return this.set(y*a+n,y*u-r*f,y*f+r*u,0,y*u+r*f,M*u+n,M*f-r*a,0,y*f-r*u,M*f+r*a,o*f*f+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,o,a){return this.set(1,n,o,0,t,1,a,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,o=e._x,a=e._y,u=e._z,f=e._w,y=o+o,M=a+a,A=u+u,I=o*y,R=o*M,O=o*A,H=a*M,U=a*A,B=u*A,Z=f*y,X=f*M,ee=f*A,se=n.x,ve=n.y,Ce=n.z;return r[0]=(1-(H+B))*se,r[1]=(R+ee)*se,r[2]=(O-X)*se,r[3]=0,r[4]=(R-ee)*ve,r[5]=(1-(I+B))*ve,r[6]=(U+Z)*ve,r[7]=0,r[8]=(O+X)*Ce,r[9]=(U-Z)*Ce,r[10]=(1-(I+H))*Ce,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let o=m1.set(r[0],r[1],r[2]).length();const a=m1.set(r[4],r[5],r[6]).length(),u=m1.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),t.x=r[12],t.y=r[13],t.z=r[14],lm.copy(this);const y=1/o,M=1/a,A=1/u;return lm.elements[0]*=y,lm.elements[1]*=y,lm.elements[2]*=y,lm.elements[4]*=M,lm.elements[5]*=M,lm.elements[6]*=M,lm.elements[8]*=A,lm.elements[9]*=A,lm.elements[10]*=A,e.setFromRotationMatrix(lm),n.x=o,n.y=a,n.z=u,this}makePerspective(t,e,n,r,o,a,u=L_){const f=this.elements,y=2*o/(e-t),M=2*o/(n-r),A=(e+t)/(e-t),I=(n+r)/(n-r);let R,O;if(u===L_)R=-(a+o)/(a-o),O=-2*a*o/(a-o);else{if(2001!==u)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);R=-a/(a-o),O=-a*o/(a-o)}return f[0]=y,f[4]=0,f[8]=A,f[12]=0,f[1]=0,f[5]=M,f[9]=I,f[13]=0,f[2]=0,f[6]=0,f[10]=R,f[14]=O,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(t,e,n,r,o,a,u=L_){const f=this.elements,y=1/(e-t),M=1/(n-r),A=1/(a-o),I=(e+t)*y,R=(n+r)*M;let O,H;if(u===L_)O=(a+o)*A,H=-2*A;else{if(2001!==u)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);O=o*A,H=-1*A}return f[0]=2*y,f[4]=0,f[8]=0,f[12]=-I,f[1]=0,f[5]=2*M,f[9]=0,f[13]=-R,f[2]=0,f[6]=0,f[10]=H,f[14]=-O,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const m1=new Ee,lm=new Fr,zre=new Ee(0,0,0),Ure=new Ee(1,1,1),Ev=new Ee,EA=new Ee,fp=new Ee,w5=new Fr,M5=new Iu;let Vre=(()=>{class i{constructor(e=0,n=0,r=0,o=i.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,o=this._order){return this._x=e,this._y=n,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const o=e.elements,a=o[0],u=o[4],f=o[8],y=o[1],M=o[5],A=o[9],I=o[2],R=o[6],O=o[10];switch(n){case"XYZ":this._y=Math.asin(Qa(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-A,O),this._z=Math.atan2(-u,a)):(this._x=Math.atan2(R,M),this._z=0);break;case"YXZ":this._x=Math.asin(-Qa(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(f,O),this._z=Math.atan2(y,M)):(this._y=Math.atan2(-I,a),this._z=0);break;case"ZXY":this._x=Math.asin(Qa(R,-1,1)),Math.abs(R)<.9999999?(this._y=Math.atan2(-I,O),this._z=Math.atan2(-u,M)):(this._y=0,this._z=Math.atan2(y,a));break;case"ZYX":this._y=Math.asin(-Qa(I,-1,1)),Math.abs(I)<.9999999?(this._x=Math.atan2(R,O),this._z=Math.atan2(y,a)):(this._x=0,this._z=Math.atan2(-u,M));break;case"YZX":this._z=Math.asin(Qa(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(-A,M),this._y=Math.atan2(-I,a)):(this._x=0,this._y=Math.atan2(f,O));break;case"XZY":this._z=Math.asin(-Qa(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(R,M),this._y=Math.atan2(f,a)):(this._x=Math.atan2(-A,O),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return w5.makeRotationFromQuaternion(e),this.setFromRotationMatrix(w5,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return M5.setFromEuler(this),this.setFromQuaternion(M5,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})();class U2{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let Hre=0;const E5=new Ee,g1=new Iu,z_=new Fr,CA=new Ee,wC=new Ee,Gre=new Ee,jre=new Iu,C5=new Ee(1,0,0),S5=new Ee(0,1,0),T5=new Ee(0,0,1),Wre={type:"added"},A5={type:"removed"};let mp=(()=>{class i extends U0{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Hre++}),this.uuid=hp(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();const e=new Ee,n=new Vre,r=new Iu,o=new Ee(1,1,1);n._onChange(function a(){r.setFromEuler(n,!1)}),r._onChange(function u(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Fr},normalMatrix:{value:new eo}}),this.matrix=new Fr,this.matrixWorld=new Fr,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new U2,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return g1.setFromAxisAngle(e,n),this.quaternion.multiply(g1),this}rotateOnWorldAxis(e,n){return g1.setFromAxisAngle(e,n),this.quaternion.premultiply(g1),this}rotateX(e){return this.rotateOnAxis(C5,e)}rotateY(e){return this.rotateOnAxis(S5,e)}rotateZ(e){return this.rotateOnAxis(T5,e)}translateOnAxis(e,n){return E5.copy(e).applyQuaternion(this.quaternion),this.position.add(E5.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(C5,e)}translateY(e){return this.translateOnAxis(S5,e)}translateZ(e){return this.translateOnAxis(T5,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(z_.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?CA.copy(e):CA.set(e,n,r);const o=this.parent;this.updateWorldMatrix(!0,!1),wC.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?z_.lookAt(wC,CA,this.up):z_.lookAt(CA,wC,this.up),this.quaternion.setFromRotationMatrix(z_),o&&(z_.extractRotation(o.matrixWorld),g1.setFromRotationMatrix(z_),this.quaternion.premultiply(g1.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Wre)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(A5)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const n=this.children[e];n.parent=null,n.dispatchEvent(A5)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),z_.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),z_.multiply(e.parent.matrixWorld)),e.applyMatrix4(z_),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,o=this.children.length;r<o;r++){const u=this.children[r].getObjectByProperty(e,n);if(void 0!==u)return u}}getObjectsByProperty(e,n){let r=[];this[e]===n&&r.push(this);for(let o=0,a=this.children.length;o<a;o++){const u=this.children[o].getObjectsByProperty(e,n);u.length>0&&(r=r.concat(u))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wC,e,Gre),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wC,jre,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;null!==n&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,o=n.length;r<o;r++){const a=n[r];(!0===a.matrixWorldAutoUpdate||!0===e)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const r=this.parent;if(!0===e&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const o=this.children;for(let a=0,u=o.length;a<u;a++){const f=o[a];!0===f.matrixWorldAutoUpdate&&f.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=void 0===e||"string"==typeof e,r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const o={};function a(f,y){return void 0===f[y.uuid]&&(f[y.uuid]=y.toJSON(e)),y.uuid}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(o.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=a(e.geometries,this.geometry);const f=this.geometry.parameters;if(void 0!==f&&void 0!==f.shapes){const y=f.shapes;if(Array.isArray(y))for(let M=0,A=y.length;M<A;M++)a(e.shapes,y[M]);else a(e.shapes,y)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(a(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const f=[];for(let y=0,M=this.material.length;y<M;y++)f.push(a(e.materials,this.material[y]));o.material=f}else o.material=a(e.materials,this.material);if(this.children.length>0){o.children=[];for(let f=0;f<this.children.length;f++)o.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let f=0;f<this.animations.length;f++)o.animations.push(a(e.animations,this.animations[f]))}if(n){const f=u(e.geometries),y=u(e.materials),M=u(e.textures),A=u(e.images),I=u(e.shapes),R=u(e.skeletons),O=u(e.animations),H=u(e.nodes);f.length>0&&(r.geometries=f),y.length>0&&(r.materials=y),M.length>0&&(r.textures=M),A.length>0&&(r.images=A),I.length>0&&(r.shapes=I),R.length>0&&(r.skeletons=R),O.length>0&&(r.animations=O),H.length>0&&(r.nodes=H)}return r.object=o,r;function u(f){const y=[];for(const M in f){const A=f[M];delete A.metadata,y.push(A)}return y}}clone(e){return(new this.constructor).copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===n)for(let r=0;r<e.children.length;r++)this.add(e.children[r].clone());return this}}return i.DEFAULT_UP=new Ee(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})();const cm=new Ee,U_=new Ee,V2=new Ee,V_=new Ee,_1=new Ee,y1=new Ee,D5=new Ee,H2=new Ee,G2=new Ee,j2=new Ee;let SA=!1;class gp{constructor(t=new Ee,e=new Ee,n=new Ee){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),cm.subVectors(t,e),r.cross(cm);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(t,e,n,r,o){cm.subVectors(r,e),U_.subVectors(n,e),V2.subVectors(t,e);const a=cm.dot(cm),u=cm.dot(U_),f=cm.dot(V2),y=U_.dot(U_),M=U_.dot(V2),A=a*y-u*u;if(0===A)return o.set(-2,-1,-1);const I=1/A,R=(y*f-u*M)*I,O=(a*M-u*f)*I;return o.set(1-R-O,O,R)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,V_),V_.x>=0&&V_.y>=0&&V_.x+V_.y<=1}static getUV(t,e,n,r,o,a,u,f){return!1===SA&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),SA=!0),this.getInterpolation(t,e,n,r,o,a,u,f)}static getInterpolation(t,e,n,r,o,a,u,f){return this.getBarycoord(t,e,n,r,V_),f.setScalar(0),f.addScaledVector(o,V_.x),f.addScaledVector(a,V_.y),f.addScaledVector(u,V_.z),f}static isFrontFacing(t,e,n,r){return cm.subVectors(n,e),U_.subVectors(t,e),cm.cross(U_).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return cm.subVectors(this.c,this.b),U_.subVectors(this.a,this.b),.5*cm.cross(U_).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return gp.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return gp.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,o){return!1===SA&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),SA=!0),gp.getInterpolation(t,this.a,this.b,this.c,e,n,r,o)}getInterpolation(t,e,n,r,o){return gp.getInterpolation(t,this.a,this.b,this.c,e,n,r,o)}containsPoint(t){return gp.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return gp.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,o=this.c;let a,u;_1.subVectors(r,n),y1.subVectors(o,n),H2.subVectors(t,n);const f=_1.dot(H2),y=y1.dot(H2);if(f<=0&&y<=0)return e.copy(n);G2.subVectors(t,r);const M=_1.dot(G2),A=y1.dot(G2);if(M>=0&&A<=M)return e.copy(r);const I=f*A-M*y;if(I<=0&&f>=0&&M<=0)return a=f/(f-M),e.copy(n).addScaledVector(_1,a);j2.subVectors(t,o);const R=_1.dot(j2),O=y1.dot(j2);if(O>=0&&R<=O)return e.copy(o);const H=R*y-f*O;if(H<=0&&y>=0&&O<=0)return u=y/(y-O),e.copy(n).addScaledVector(y1,u);const U=M*O-R*A;if(U<=0&&A-M>=0&&R-O>=0)return D5.subVectors(o,r),u=(A-M)/(A-M+(R-O)),e.copy(r).addScaledVector(D5,u);const B=1/(U+H+I);return a=H*B,u=I*B,e.copy(n).addScaledVector(_1,a).addScaledVector(y1,u)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let $re=0;class v1 extends U0{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:$re++}),this.uuid=hp(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(o){const a=[];for(const u in o){const f=o[u];delete f.metadata,a.push(f)}return a}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const o=r(t.textures),a=r(t.images);o.length>0&&(n.textures=o),a.length>0&&(n.images=a)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const r=e.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=e[o].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}const I5={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dm={h:0,s:0,l:0},TA={h:0,s:0,l:0};function W2(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+6*(t-i)*e:e<.5?t:e<2/3?i+6*(t-i)*(2/3-e):i}class rn{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(void 0===e&&void 0===n){const r=t;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Hr){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,am.toWorkingColorSpace(this,e),this}setRGB(t,e,n,r=am.workingColorSpace){return this.r=t,this.g=e,this.b=n,am.toWorkingColorSpace(this,r),this}setHSL(t,e,n,r=am.workingColorSpace){if(t=function A2(i,t){return(i%t+t)%t}(t,1),e=Qa(e,0,1),n=Qa(n,0,1),0===e)this.r=this.g=this.b=n;else{const o=n<=.5?n*(1+e):n+e-n*e,a=2*n-o;this.r=W2(a,o,t+1/3),this.g=W2(a,o,t),this.b=W2(a,o,t-1/3)}return am.toWorkingColorSpace(this,r),this}setStyle(t,e=Hr){function n(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let o;const u=r[2];switch(r[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,e);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,e);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=r[1],a=o.length;if(3===a)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,e);if(6===a)return this.setHex(parseInt(o,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=Hr){const n=I5[t.toLowerCase()];return void 0!==n?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=l1(t.r),this.g=l1(t.g),this.b=l1(t.b),this}copyLinearToSRGB(t){return this.r=k2(t.r),this.g=k2(t.g),this.b=k2(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Hr){return am.fromWorkingColorSpace(Vd.copy(this),t),65536*Math.round(Qa(255*Vd.r,0,255))+256*Math.round(Qa(255*Vd.g,0,255))+Math.round(Qa(255*Vd.b,0,255))}getHexString(t=Hr){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=am.workingColorSpace){am.fromWorkingColorSpace(Vd.copy(this),e);const n=Vd.r,r=Vd.g,o=Vd.b,a=Math.max(n,r,o),u=Math.min(n,r,o);let f,y;const M=(u+a)/2;if(u===a)f=0,y=0;else{const A=a-u;switch(y=M<=.5?A/(a+u):A/(2-a-u),a){case n:f=(r-o)/A+(r<o?6:0);break;case r:f=(o-n)/A+2;break;case o:f=(n-r)/A+4}f/=6}return t.h=f,t.s=y,t.l=M,t}getRGB(t,e=am.workingColorSpace){return am.fromWorkingColorSpace(Vd.copy(this),e),t.r=Vd.r,t.g=Vd.g,t.b=Vd.b,t}getStyle(t=Hr){am.fromWorkingColorSpace(Vd.copy(this),t);const e=Vd.r,n=Vd.g,r=Vd.b;return t!==Hr?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*e)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(t,e,n){return this.getHSL(dm),dm.h+=t,dm.s+=e,dm.l+=n,this.setHSL(dm.h,dm.s,dm.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(dm),t.getHSL(TA);const n=gC(dm.h,TA.h,e),r=gC(dm.s,TA.s,e),o=gC(dm.l,TA.l,e);return this.setHSL(n,r,o),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,r=this.b,o=t.elements;return this.r=o[0]*e+o[3]*n+o[6]*r,this.g=o[1]*e+o[4]*n+o[7]*r,this.b=o[2]*e+o[5]*n+o[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Vd=new rn;rn.NAMES=I5;class W0 extends v1{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new rn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=lA,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Xl=new Ee,AA=new ei;class zc{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=P_,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)AA.fromBufferAttribute(this,e),AA.applyMatrix3(t),this.setXY(e,AA.x,AA.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Xl.fromBufferAttribute(this,e),Xl.applyMatrix3(t),this.setXYZ(e,Xl.x,Xl.y,Xl.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Xl.fromBufferAttribute(this,e),Xl.applyMatrix4(t),this.setXYZ(e,Xl.x,Xl.y,Xl.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Xl.fromBufferAttribute(this,e),Xl.applyNormalMatrix(t),this.setXYZ(e,Xl.x,Xl.y,Xl.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Xl.fromBufferAttribute(this,e),Xl.transformDirection(t),this.setXYZ(e,Xl.x,Xl.y,Xl.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=pp(e,this.array)),e}setX(t,e){return this.normalized&&(e=Xr(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=pp(e,this.array)),e}setY(t,e){return this.normalized&&(e=Xr(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=pp(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Xr(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=pp(e,this.array)),e}setW(t,e){return this.normalized&&(e=Xr(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=Xr(e,this.array),n=Xr(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=Xr(e,this.array),n=Xr(n,this.array),r=Xr(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t*=this.itemSize,this.normalized&&(e=Xr(e,this.array),n=Xr(n,this.array),r=Xr(r,this.array),o=Xr(o,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=o,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),35044!==this.usage&&(t.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(t.updateRange=this.updateRange),t}}class k5 extends zc{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class R5 extends zc{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class xn extends zc{constructor(t,e,n){super(new Float32Array(t),e,n)}}let Xre=0;const uf=new Fr,$2=new mp,b1=new Ee,_p=new F_,EC=new F_,Uc=new Ee;class po extends U0{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Xre++}),this.uuid=hp(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return this.index=Array.isArray(t)?new(_5(t)?R5:k5)(t,1):t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const o=(new eo).getNormalMatrix(t);n.applyNormalMatrix(o),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return uf.makeRotationFromQuaternion(t),this.applyMatrix4(uf),this}rotateX(t){return uf.makeRotationX(t),this.applyMatrix4(uf),this}rotateY(t){return uf.makeRotationY(t),this.applyMatrix4(uf),this}rotateZ(t){return uf.makeRotationZ(t),this.applyMatrix4(uf),this}translate(t,e,n){return uf.makeTranslation(t,e,n),this.applyMatrix4(uf),this}scale(t,e,n){return uf.makeScale(t,e,n),this.applyMatrix4(uf),this}lookAt(t){return $2.lookAt(t),$2.updateMatrix(),this.applyMatrix4($2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(b1).negate(),this.translate(b1.x,b1.y,b1.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const o=t[n];e.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new xn(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new F_);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Ee(-1/0,-1/0,-1/0),new Ee(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++)_p.setFromBufferAttribute(e[n]),this.morphTargetsRelative?(Uc.addVectors(this.boundingBox.min,_p.min),this.boundingBox.expandByPoint(Uc),Uc.addVectors(this.boundingBox.max,_p.max),this.boundingBox.expandByPoint(Uc)):(this.boundingBox.expandByPoint(_p.min),this.boundingBox.expandByPoint(_p.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new fg);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Ee,1/0);if(t){const n=this.boundingSphere.center;if(_p.setFromBufferAttribute(t),e)for(let o=0,a=e.length;o<a;o++)EC.setFromBufferAttribute(e[o]),this.morphTargetsRelative?(Uc.addVectors(_p.min,EC.min),_p.expandByPoint(Uc),Uc.addVectors(_p.max,EC.max),_p.expandByPoint(Uc)):(_p.expandByPoint(EC.min),_p.expandByPoint(EC.max));_p.getCenter(n);let r=0;for(let o=0,a=t.count;o<a;o++)Uc.fromBufferAttribute(t,o),r=Math.max(r,n.distanceToSquared(Uc));if(e)for(let o=0,a=e.length;o<a;o++){const u=e[o],f=this.morphTargetsRelative;for(let y=0,M=u.count;y<M;y++)Uc.fromBufferAttribute(u,y),f&&(b1.fromBufferAttribute(t,y),Uc.add(b1)),r=Math.max(r,n.distanceToSquared(Uc))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,o=e.normal.array,a=e.uv.array,u=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new zc(new Float32Array(4*u),4));const f=this.getAttribute("tangent").array,y=[],M=[];for(let we=0;we<u;we++)y[we]=new Ee,M[we]=new Ee;const A=new Ee,I=new Ee,R=new Ee,O=new ei,H=new ei,U=new ei,B=new Ee,Z=new Ee;function X(we,At,ni){A.fromArray(r,3*we),I.fromArray(r,3*At),R.fromArray(r,3*ni),O.fromArray(a,2*we),H.fromArray(a,2*At),U.fromArray(a,2*ni),I.sub(A),R.sub(A),H.sub(O),U.sub(O);const ht=1/(H.x*U.y-U.x*H.y);isFinite(ht)&&(B.copy(I).multiplyScalar(U.y).addScaledVector(R,-H.y).multiplyScalar(ht),Z.copy(R).multiplyScalar(H.x).addScaledVector(I,-U.x).multiplyScalar(ht),y[we].add(B),y[At].add(B),y[ni].add(B),M[we].add(Z),M[At].add(Z),M[ni].add(Z))}let ee=this.groups;0===ee.length&&(ee=[{start:0,count:n.length}]);for(let we=0,At=ee.length;we<At;++we){const ni=ee[we],ht=ni.start;for(let Tt=ht,at=ht+ni.count;Tt<at;Tt+=3)X(n[Tt+0],n[Tt+1],n[Tt+2])}const se=new Ee,ve=new Ee,Ce=new Ee,Ve=new Ee;function ce(we){Ce.fromArray(o,3*we),Ve.copy(Ce);const At=y[we];se.copy(At),se.sub(Ce.multiplyScalar(Ce.dot(At))).normalize(),ve.crossVectors(Ve,At);const ht=ve.dot(M[we])<0?-1:1;f[4*we]=se.x,f[4*we+1]=se.y,f[4*we+2]=se.z,f[4*we+3]=ht}for(let we=0,At=ee.length;we<At;++we){const ni=ee[we],ht=ni.start;for(let Tt=ht,at=ht+ni.count;Tt<at;Tt+=3)ce(n[Tt+0]),ce(n[Tt+1]),ce(n[Tt+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new zc(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let I=0,R=n.count;I<R;I++)n.setXYZ(I,0,0,0);const r=new Ee,o=new Ee,a=new Ee,u=new Ee,f=new Ee,y=new Ee,M=new Ee,A=new Ee;if(t)for(let I=0,R=t.count;I<R;I+=3){const O=t.getX(I+0),H=t.getX(I+1),U=t.getX(I+2);r.fromBufferAttribute(e,O),o.fromBufferAttribute(e,H),a.fromBufferAttribute(e,U),M.subVectors(a,o),A.subVectors(r,o),M.cross(A),u.fromBufferAttribute(n,O),f.fromBufferAttribute(n,H),y.fromBufferAttribute(n,U),u.add(M),f.add(M),y.add(M),n.setXYZ(O,u.x,u.y,u.z),n.setXYZ(H,f.x,f.y,f.z),n.setXYZ(U,y.x,y.y,y.z)}else for(let I=0,R=e.count;I<R;I+=3)r.fromBufferAttribute(e,I+0),o.fromBufferAttribute(e,I+1),a.fromBufferAttribute(e,I+2),M.subVectors(a,o),A.subVectors(r,o),M.cross(A),n.setXYZ(I+0,M.x,M.y,M.z),n.setXYZ(I+1,M.x,M.y,M.z),n.setXYZ(I+2,M.x,M.y,M.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Uc.fromBufferAttribute(t,e),Uc.normalize(),t.setXYZ(e,Uc.x,Uc.y,Uc.z)}toNonIndexed(){function t(u,f){const y=u.array,M=u.itemSize,A=u.normalized,I=new y.constructor(f.length*M);let R=0,O=0;for(let H=0,U=f.length;H<U;H++){R=u.isInterleavedBufferAttribute?f[H]*u.data.stride+u.offset:f[H]*M;for(let B=0;B<M;B++)I[O++]=y[R++]}return new zc(I,M,A)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new po,n=this.index.array,r=this.attributes;for(const u in r){const y=t(r[u],n);e.setAttribute(u,y)}const o=this.morphAttributes;for(const u in o){const f=[],y=o[u];for(let M=0,A=y.length;M<A;M++){const R=t(y[M],n);f.push(R)}e.morphAttributes[u]=f}e.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let u=0,f=a.length;u<f;u++){const y=a[u];e.addGroup(y.start,y.count,y.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const f=this.parameters;for(const y in f)void 0!==f[y]&&(t[y]=f[y]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const f in n)t.data.attributes[f]=n[f].toJSON(t.data);const r={};let o=!1;for(const f in this.morphAttributes){const y=this.morphAttributes[f],M=[];for(let A=0,I=y.length;A<I;A++)M.push(y[A].toJSON(t.data));M.length>0&&(r[f]=M,o=!0)}o&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));const u=this.boundingSphere;return null!==u&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const y in r)this.setAttribute(y,r[y].clone(e));const o=t.morphAttributes;for(const y in o){const M=[],A=o[y];for(let I=0,R=A.length;I<R;I++)M.push(A[I].clone(e));this.morphAttributes[y]=M}this.morphTargetsRelative=t.morphTargetsRelative;const a=t.groups;for(let y=0,M=a.length;y<M;y++){const A=a[y];this.addGroup(A.start,A.count,A.materialIndex)}const u=t.boundingBox;null!==u&&(this.boundingBox=u.clone());const f=t.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const P5=new Fr,$0=new xC,DA=new fg,L5=new Ee,x1=new Ee,w1=new Ee,M1=new Ee,q2=new Ee,IA=new Ee,kA=new ei,RA=new ei,PA=new ei,F5=new Ee,O5=new Ee,N5=new Ee,LA=new Ee,FA=new Ee;class Hd extends mp{constructor(t=new po,e=new W0){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=r.length;o<a;o++){const u=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=o}}}}getVertexPosition(t,e){const n=this.geometry,o=n.morphAttributes.position,a=n.morphTargetsRelative;e.fromBufferAttribute(n.attributes.position,t);const u=this.morphTargetInfluences;if(o&&u){IA.set(0,0,0);for(let f=0,y=o.length;f<y;f++){const M=u[f];0!==M&&(q2.fromBufferAttribute(o[f],t),IA.addScaledVector(a?q2:q2.sub(e),M))}e.add(IA)}return e}raycast(t,e){const n=this.geometry,o=this.matrixWorld;void 0!==this.material&&(null===n.boundingSphere&&n.computeBoundingSphere(),DA.copy(n.boundingSphere),DA.applyMatrix4(o),$0.copy(t.ray).recast(t.near),(!1!==DA.containsPoint($0.origin)||!(null===$0.intersectSphere(DA,L5)||$0.origin.distanceToSquared(L5)>(t.far-t.near)**2))&&(P5.copy(o).invert(),$0.copy(t.ray).applyMatrix4(P5),(null===n.boundingBox||!1!==$0.intersectsBox(n.boundingBox))&&this._computeIntersections(t,e,$0)))}_computeIntersections(t,e,n){let r;const o=this.geometry,a=this.material,u=o.index,f=o.attributes.position,y=o.attributes.uv,M=o.attributes.uv1,A=o.attributes.normal,I=o.groups,R=o.drawRange;if(null!==u)if(Array.isArray(a))for(let O=0,H=I.length;O<H;O++){const U=I[O],B=a[U.materialIndex];for(let ee=Math.max(U.start,R.start),se=Math.min(u.count,Math.min(U.start+U.count,R.start+R.count));ee<se;ee+=3)r=OA(this,B,t,n,y,M,A,u.getX(ee),u.getX(ee+1),u.getX(ee+2)),r&&(r.faceIndex=Math.floor(ee/3),r.face.materialIndex=U.materialIndex,e.push(r))}else for(let U=Math.max(0,R.start),B=Math.min(u.count,R.start+R.count);U<B;U+=3)r=OA(this,a,t,n,y,M,A,u.getX(U),u.getX(U+1),u.getX(U+2)),r&&(r.faceIndex=Math.floor(U/3),e.push(r));else if(void 0!==f)if(Array.isArray(a))for(let O=0,H=I.length;O<H;O++){const U=I[O],B=a[U.materialIndex];for(let ee=Math.max(U.start,R.start),se=Math.min(f.count,Math.min(U.start+U.count,R.start+R.count));ee<se;ee+=3)r=OA(this,B,t,n,y,M,A,ee,ee+1,ee+2),r&&(r.faceIndex=Math.floor(ee/3),r.face.materialIndex=U.materialIndex,e.push(r))}else for(let U=Math.max(0,R.start),B=Math.min(f.count,R.start+R.count);U<B;U+=3)r=OA(this,a,t,n,y,M,A,U,U+1,U+2),r&&(r.faceIndex=Math.floor(U/3),e.push(r))}}function OA(i,t,e,n,r,o,a,u,f,y){i.getVertexPosition(u,x1),i.getVertexPosition(f,w1),i.getVertexPosition(y,M1);const M=function Zre(i,t,e,n,r,o,a,u){let f;if(f=1===t.side?n.intersectTriangle(a,o,r,!0,u):n.intersectTriangle(r,o,a,0===t.side,u),null===f)return null;FA.copy(u),FA.applyMatrix4(i.matrixWorld);const y=e.ray.origin.distanceTo(FA);return y<e.near||y>e.far?null:{distance:y,point:FA.clone(),object:i}}(i,t,e,n,x1,w1,M1,LA);if(M){r&&(kA.fromBufferAttribute(r,u),RA.fromBufferAttribute(r,f),PA.fromBufferAttribute(r,y),M.uv=gp.getInterpolation(LA,x1,w1,M1,kA,RA,PA,new ei)),o&&(kA.fromBufferAttribute(o,u),RA.fromBufferAttribute(o,f),PA.fromBufferAttribute(o,y),M.uv1=gp.getInterpolation(LA,x1,w1,M1,kA,RA,PA,new ei),M.uv2=M.uv1),a&&(F5.fromBufferAttribute(a,u),O5.fromBufferAttribute(a,f),N5.fromBufferAttribute(a,y),M.normal=gp.getInterpolation(LA,x1,w1,M1,F5,O5,N5,new Ee),M.normal.dot(n.direction)>0&&M.normal.multiplyScalar(-1));const A={a:u,b:f,c:y,normal:new Ee,materialIndex:0};gp.getNormal(x1,w1,M1,A.normal),M.face=A}return M}class E1 extends po{constructor(t=1,e=1,n=1,r=1,o=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:o,depthSegments:a};const u=this;r=Math.floor(r),o=Math.floor(o),a=Math.floor(a);const f=[],y=[],M=[],A=[];let I=0,R=0;function O(H,U,B,Z,X,ee,se,ve,Ce,Ve,ce){const we=ee/Ce,At=se/Ve,ni=ee/2,ht=se/2,_t=ve/2,Tt=Ce+1,at=Ve+1;let ot=0,dt=0;const It=new Ee;for(let Xt=0;Xt<at;Xt++){const ut=Xt*At-ht;for(let zt=0;zt<Tt;zt++)It[H]=(zt*we-ni)*Z,It[U]=ut*X,It[B]=_t,y.push(It.x,It.y,It.z),It[H]=0,It[U]=0,It[B]=ve>0?1:-1,M.push(It.x,It.y,It.z),A.push(zt/Ce),A.push(1-Xt/Ve),ot+=1}for(let Xt=0;Xt<Ve;Xt++)for(let ut=0;ut<Ce;ut++){const Ti=I+ut+Tt*(Xt+1),gi=I+(ut+1)+Tt*(Xt+1),Vi=I+(ut+1)+Tt*Xt;f.push(I+ut+Tt*Xt,Ti,Vi),f.push(Ti,gi,Vi),dt+=6}u.addGroup(R,dt,ce),R+=dt,I+=ot}O("z","y","x",-1,-1,n,e,t,a,o,0),O("z","y","x",1,-1,n,e,-t,a,o,1),O("x","z","y",1,1,t,n,e,r,a,2),O("x","z","y",1,-1,t,n,-e,r,a,3),O("x","y","z",1,-1,t,e,n,r,o,4),O("x","y","z",-1,-1,t,e,-n,r,o,5),this.setIndex(f),this.setAttribute("position",new xn(y,3)),this.setAttribute("normal",new xn(M,3)),this.setAttribute("uv",new xn(A,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new E1(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function C1(i){const t={};for(const e in i){t[e]={};for(const n in i[e]){const r=i[e][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[e][n]=null):t[e][n]=r.clone():t[e][n]=Array.isArray(r)?r.slice():r}}return t}function ku(i){const t={};for(let e=0;e<i.length;e++){const n=C1(i[e]);for(const r in n)t[r]=n[r]}return t}function B5(i){return null===i.getRenderTarget()?i.outputColorSpace:pg}const Kre={clone:C1,merge:ku};class Cv extends v1{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=C1(t.uniforms),this.uniformsGroups=function Yre(i){const t=[];for(let e=0;e<i.length;e++)t.push(i[e].clone());return t}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;e.uniforms[r]=a&&a.isTexture?{type:"t",value:a.toJSON(t).uuid}:a&&a.isColor?{type:"c",value:a.getHex()}:a&&a.isVector2?{type:"v2",value:a.toArray()}:a&&a.isVector3?{type:"v3",value:a.toArray()}:a&&a.isVector4?{type:"v4",value:a.toArray()}:a&&a.isMatrix3?{type:"m3",value:a.toArray()}:a&&a.isMatrix4?{type:"m4",value:a.toArray()}:{value:a}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class X2 extends mp{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Fr,this.projectionMatrix=new Fr,this.projectionMatrixInverse=new Fr,this.coordinateSystem=L_}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class hd extends X2{constructor(t=50,e=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*s1*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*V0*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*s1*Math.atan(Math.tan(.5*V0*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,o,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*V0*this.fov)/this.zoom,n=2*e,r=this.aspect*n,o=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const f=a.fullWidth,y=a.fullHeight;o+=a.offsetX*r/f,e-=a.offsetY*n/y,r*=a.width/f,n*=a.height/y}const u=this.filmOffset;0!==u&&(o+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,e,e-n,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}class eoe extends mp{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null;const r=new hd(-90,1,t,e);r.layers=this.layers,this.add(r);const o=new hd(-90,1,t,e);o.layers=this.layers,this.add(o);const a=new hd(-90,1,t,e);a.layers=this.layers,this.add(a);const u=new hd(-90,1,t,e);u.layers=this.layers,this.add(u);const f=new hd(-90,1,t,e);f.layers=this.layers,this.add(f);const y=new hd(-90,1,t,e);y.layers=this.layers,this.add(y)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[n,r,o,a,u,f]=e;for(const y of e)this.remove(y);if(t===L_)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else{if(2001!==t)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1)}for(const y of e)this.add(y),y.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[r,o,a,u,f,y]=this.children,M=t.getRenderTarget(),A=t.toneMapping,I=t.xr.enabled;t.toneMapping=R_,t.xr.enabled=!1;const R=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,o),t.setRenderTarget(n,2),t.render(e,a),t.setRenderTarget(n,3),t.render(e,u),t.setRenderTarget(n,4),t.render(e,f),n.texture.generateMipmaps=R,t.setRenderTarget(n,5),t.render(e,y),t.setRenderTarget(M),t.toneMapping=A,t.xr.enabled=I,n.texture.needsPMREMUpdate=!0}}class NA extends bv{constructor(t,e,n,r,o,a,u,f,y,M){super(t=void 0!==t?t:[],e=void 0!==e?e:R0,n,r,o,a,u,f,y,M),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class toe extends H0{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},r=[n,n,n,n,n,n];void 0!==e.encoding&&(yC("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),e.colorSpace=e.encoding===N0?Hr:""),this.texture=new NA(r,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:ql}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new E1(5,5,5),o=new Cv({name:"CubemapFromEquirect",uniforms:C1(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});o.uniforms.tEquirect.value=e;const a=new Hd(r,o),u=e.minFilter;return e.minFilter===L0&&(e.minFilter=ql),new eoe(1,10,this).update(t,a),e.minFilter=u,a.geometry.dispose(),a.material.dispose(),this}clear(t,e,n,r){const o=t.getRenderTarget();for(let a=0;a<6;a++)t.setRenderTarget(this,a),t.clear(e,n,r);t.setRenderTarget(o)}}const Z2=new Ee,ioe=new Ee,noe=new eo;class q0{constructor(t=new Ee(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=Z2.subVectors(n,e).cross(ioe.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const n=t.delta(Z2),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const o=-(t.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:e.copy(t.start).addScaledVector(n,o)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||noe.getNormalMatrix(t),r=this.coplanarPoint(Z2).applyMatrix4(t),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const X0=new fg,BA=new Ee;class Y2{constructor(t=new q0,e=new q0,n=new q0,r=new q0,o=new q0,a=new q0){this.planes=[t,e,n,r,o,a]}set(t,e,n,r,o,a){const u=this.planes;return u[0].copy(t),u[1].copy(e),u[2].copy(n),u[3].copy(r),u[4].copy(o),u[5].copy(a),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t,e=L_){const n=this.planes,r=t.elements,o=r[0],a=r[1],u=r[2],f=r[3],y=r[4],M=r[5],A=r[6],I=r[7],R=r[8],O=r[9],H=r[10],U=r[11],B=r[12],Z=r[13],X=r[14],ee=r[15];if(n[0].setComponents(f-o,I-y,U-R,ee-B).normalize(),n[1].setComponents(f+o,I+y,U+R,ee+B).normalize(),n[2].setComponents(f+a,I+M,U+O,ee+Z).normalize(),n[3].setComponents(f-a,I-M,U-O,ee-Z).normalize(),n[4].setComponents(f-u,I-A,U-H,ee-X).normalize(),e===L_)n[5].setComponents(f+u,I+A,U+H,ee+X).normalize();else{if(2001!==e)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);n[5].setComponents(u,A,H,X).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),X0.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),X0.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(X0)}intersectsSprite(t){return X0.center.set(0,0,0),X0.radius=.7071067811865476,X0.applyMatrix4(t.matrixWorld),this.intersectsSphere(X0)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let o=0;o<6;o++)if(e[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(BA.x=r.normal.x>0?t.max.x:t.min.x,BA.y=r.normal.y>0?t.max.y:t.min.y,BA.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(BA)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function z5(){let i=null,t=!1,e=null,n=null;function r(o,a){e(o,a),n=i.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==e&&(n=i.requestAnimationFrame(r),t=!0)},stop:function(){i.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(o){e=o},setContext:function(o){i=o}}}function roe(i,t){const e=t.isWebGL2,n=new WeakMap;return{get:function a(y){return y.isInterleavedBufferAttribute&&(y=y.data),n.get(y)},remove:function u(y){y.isInterleavedBufferAttribute&&(y=y.data);const M=n.get(y);M&&(i.deleteBuffer(M.buffer),n.delete(y))},update:function f(y,M){if(y.isGLBufferAttribute){const I=n.get(y);return void((!I||I.version<y.version)&&n.set(y,{buffer:y.buffer,type:y.type,bytesPerElement:y.elementSize,version:y.version}))}y.isInterleavedBufferAttribute&&(y=y.data);const A=n.get(y);void 0===A?n.set(y,function r(y,M){const A=y.array,I=y.usage,R=i.createBuffer();let O;if(i.bindBuffer(M,R),i.bufferData(M,A,I),y.onUploadCallback(),A instanceof Float32Array)O=i.FLOAT;else if(A instanceof Uint16Array)if(y.isFloat16BufferAttribute){if(!e)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");O=i.HALF_FLOAT}else O=i.UNSIGNED_SHORT;else if(A instanceof Int16Array)O=i.SHORT;else if(A instanceof Uint32Array)O=i.UNSIGNED_INT;else if(A instanceof Int32Array)O=i.INT;else if(A instanceof Int8Array)O=i.BYTE;else if(A instanceof Uint8Array)O=i.UNSIGNED_BYTE;else{if(!(A instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+A);O=i.UNSIGNED_BYTE}return{buffer:R,type:O,bytesPerElement:A.BYTES_PER_ELEMENT,version:y.version}}(y,M)):A.version<y.version&&(function o(y,M,A){const I=M.array,R=M.updateRange;i.bindBuffer(A,y),-1===R.count?i.bufferSubData(A,0,I):(e?i.bufferSubData(A,R.offset*I.BYTES_PER_ELEMENT,I,R.offset,R.count):i.bufferSubData(A,R.offset*I.BYTES_PER_ELEMENT,I.subarray(R.offset,R.offset+R.count)),R.count=-1),M.onUploadCallback()}(A.buffer,y,M),A.version=y.version)}}}class zA extends po{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const o=t/2,a=e/2,u=Math.floor(n),f=Math.floor(r),y=u+1,M=f+1,A=t/u,I=e/f,R=[],O=[],H=[],U=[];for(let B=0;B<M;B++){const Z=B*I-a;for(let X=0;X<y;X++)O.push(X*A-o,-Z,0),H.push(0,0,1),U.push(X/u),U.push(1-B/f)}for(let B=0;B<f;B++)for(let Z=0;Z<u;Z++){const ee=Z+y*(B+1),se=Z+1+y*(B+1),ve=Z+1+y*B;R.push(Z+y*B,ee,ve),R.push(ee,se,ve)}this.setIndex(R),this.setAttribute("position",new xn(O,3)),this.setAttribute("normal",new xn(H,3)),this.setAttribute("uv",new xn(U,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new zA(t.width,t.height,t.widthSegments,t.heightSegments)}}const Zr={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Ni={common:{diffuse:{value:new rn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new eo},alphaMap:{value:null},alphaMapTransform:{value:new eo},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new eo}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new eo}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new eo}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new eo},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new eo},normalScale:{value:new ei(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new eo},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new eo}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new eo}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new eo}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new rn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new rn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new eo},alphaTest:{value:0},uvTransform:{value:new eo}},sprite:{diffuse:{value:new rn(16777215)},opacity:{value:1},center:{value:new ei(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new eo},alphaMap:{value:null},alphaMapTransform:{value:new eo},alphaTest:{value:0}}},mg={basic:{uniforms:ku([Ni.common,Ni.specularmap,Ni.envmap,Ni.aomap,Ni.lightmap,Ni.fog]),vertexShader:Zr.meshbasic_vert,fragmentShader:Zr.meshbasic_frag},lambert:{uniforms:ku([Ni.common,Ni.specularmap,Ni.envmap,Ni.aomap,Ni.lightmap,Ni.emissivemap,Ni.bumpmap,Ni.normalmap,Ni.displacementmap,Ni.fog,Ni.lights,{emissive:{value:new rn(0)}}]),vertexShader:Zr.meshlambert_vert,fragmentShader:Zr.meshlambert_frag},phong:{uniforms:ku([Ni.common,Ni.specularmap,Ni.envmap,Ni.aomap,Ni.lightmap,Ni.emissivemap,Ni.bumpmap,Ni.normalmap,Ni.displacementmap,Ni.fog,Ni.lights,{emissive:{value:new rn(0)},specular:{value:new rn(1118481)},shininess:{value:30}}]),vertexShader:Zr.meshphong_vert,fragmentShader:Zr.meshphong_frag},standard:{uniforms:ku([Ni.common,Ni.envmap,Ni.aomap,Ni.lightmap,Ni.emissivemap,Ni.bumpmap,Ni.normalmap,Ni.displacementmap,Ni.roughnessmap,Ni.metalnessmap,Ni.fog,Ni.lights,{emissive:{value:new rn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Zr.meshphysical_vert,fragmentShader:Zr.meshphysical_frag},toon:{uniforms:ku([Ni.common,Ni.aomap,Ni.lightmap,Ni.emissivemap,Ni.bumpmap,Ni.normalmap,Ni.displacementmap,Ni.gradientmap,Ni.fog,Ni.lights,{emissive:{value:new rn(0)}}]),vertexShader:Zr.meshtoon_vert,fragmentShader:Zr.meshtoon_frag},matcap:{uniforms:ku([Ni.common,Ni.bumpmap,Ni.normalmap,Ni.displacementmap,Ni.fog,{matcap:{value:null}}]),vertexShader:Zr.meshmatcap_vert,fragmentShader:Zr.meshmatcap_frag},points:{uniforms:ku([Ni.points,Ni.fog]),vertexShader:Zr.points_vert,fragmentShader:Zr.points_frag},dashed:{uniforms:ku([Ni.common,Ni.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Zr.linedashed_vert,fragmentShader:Zr.linedashed_frag},depth:{uniforms:ku([Ni.common,Ni.displacementmap]),vertexShader:Zr.depth_vert,fragmentShader:Zr.depth_frag},normal:{uniforms:ku([Ni.common,Ni.bumpmap,Ni.normalmap,Ni.displacementmap,{opacity:{value:1}}]),vertexShader:Zr.meshnormal_vert,fragmentShader:Zr.meshnormal_frag},sprite:{uniforms:ku([Ni.sprite,Ni.fog]),vertexShader:Zr.sprite_vert,fragmentShader:Zr.sprite_frag},background:{uniforms:{uvTransform:{value:new eo},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Zr.background_vert,fragmentShader:Zr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Zr.backgroundCube_vert,fragmentShader:Zr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Zr.cube_vert,fragmentShader:Zr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Zr.equirect_vert,fragmentShader:Zr.equirect_frag},distanceRGBA:{uniforms:ku([Ni.common,Ni.displacementmap,{referencePosition:{value:new Ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Zr.distanceRGBA_vert,fragmentShader:Zr.distanceRGBA_frag},shadow:{uniforms:ku([Ni.lights,Ni.fog,{color:{value:new rn(0)},opacity:{value:1}}]),vertexShader:Zr.shadow_vert,fragmentShader:Zr.shadow_frag}};mg.physical={uniforms:ku([mg.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new eo},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new eo},clearcoatNormalScale:{value:new ei(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new eo},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new eo},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new eo},sheen:{value:0},sheenColor:{value:new rn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new eo},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new eo},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new eo},transmissionSamplerSize:{value:new ei},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new eo},attenuationDistance:{value:0},attenuationColor:{value:new rn(0)},specularColor:{value:new rn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new eo},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new eo},anisotropyVector:{value:new ei},anisotropyMap:{value:null},anisotropyMapTransform:{value:new eo}}]),vertexShader:Zr.meshphysical_vert,fragmentShader:Zr.meshphysical_frag};const UA={r:0,b:0,g:0};function iae(i,t,e,n,r,o,a){const u=new rn(0);let y,M,f=!0===o?0:1,A=null,I=0,R=null;function H(U,B){U.getRGB(UA,B5(i)),n.buffers.color.setClear(UA.r,UA.g,UA.b,B,a)}return{getClearColor:function(){return u},setClearColor:function(U,B=1){u.set(U),f=B,H(u,f)},getClearAlpha:function(){return f},setClearAlpha:function(U){f=U,H(u,f)},render:function O(U,B){let Z=!1,X=!0===B.isScene?B.background:null;switch(X&&X.isTexture&&(X=(B.backgroundBlurriness>0?e:t).get(X)),null===X?H(u,f):X&&X.isColor&&(H(X,1),Z=!0),i.xr.getEnvironmentBlendMode()){case"opaque":Z=!0;break;case"additive":n.buffers.color.setClear(0,0,0,1,a),Z=!0;break;case"alpha-blend":n.buffers.color.setClear(0,0,0,0,a),Z=!0}(i.autoClear||Z)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),X&&(X.isCubeTexture||X.mapping===fC)?(void 0===M&&(M=new Hd(new E1(1,1,1),new Cv({name:"BackgroundCubeMaterial",uniforms:C1(mg.backgroundCube.uniforms),vertexShader:mg.backgroundCube.vertexShader,fragmentShader:mg.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),M.geometry.deleteAttribute("normal"),M.geometry.deleteAttribute("uv"),M.onBeforeRender=function(ve,Ce,Ve){this.matrixWorld.copyPosition(Ve.matrixWorld)},Object.defineProperty(M.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(M)),M.material.uniforms.envMap.value=X,M.material.uniforms.flipEnvMap.value=X.isCubeTexture&&!1===X.isRenderTargetTexture?-1:1,M.material.uniforms.backgroundBlurriness.value=B.backgroundBlurriness,M.material.uniforms.backgroundIntensity.value=B.backgroundIntensity,M.material.toneMapped=X.colorSpace!==Hr,(A!==X||I!==X.version||R!==i.toneMapping)&&(M.material.needsUpdate=!0,A=X,I=X.version,R=i.toneMapping),M.layers.enableAll(),U.unshift(M,M.geometry,M.material,0,0,null)):X&&X.isTexture&&(void 0===y&&(y=new Hd(new zA(2,2),new Cv({name:"BackgroundMaterial",uniforms:C1(mg.background.uniforms),vertexShader:mg.background.vertexShader,fragmentShader:mg.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),y.geometry.deleteAttribute("normal"),Object.defineProperty(y.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(y)),y.material.uniforms.t2D.value=X,y.material.uniforms.backgroundIntensity.value=B.backgroundIntensity,y.material.toneMapped=X.colorSpace!==Hr,!0===X.matrixAutoUpdate&&X.updateMatrix(),y.material.uniforms.uvTransform.value.copy(X.matrix),(A!==X||I!==X.version||R!==i.toneMapping)&&(y.material.needsUpdate=!0,A=X,I=X.version,R=i.toneMapping),y.layers.enableAll(),U.unshift(y,y.geometry,y.material,0,0,null))}}}function nae(i,t,e,n){const r=i.getParameter(i.MAX_VERTEX_ATTRIBS),o=n.isWebGL2?null:t.get("OES_vertex_array_object"),a=n.isWebGL2||null!==o,u={},f=U(null);let y=f,M=!1;function R(_t){return n.isWebGL2?i.bindVertexArray(_t):o.bindVertexArrayOES(_t)}function O(_t){return n.isWebGL2?i.deleteVertexArray(_t):o.deleteVertexArrayOES(_t)}function U(_t){const Tt=[],at=[],ot=[];for(let dt=0;dt<r;dt++)Tt[dt]=0,at[dt]=0,ot[dt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Tt,enabledAttributes:at,attributeDivisors:ot,object:_t,attributes:{},index:null}}function X(){const _t=y.newAttributes;for(let Tt=0,at=_t.length;Tt<at;Tt++)_t[Tt]=0}function ee(_t){se(_t,0)}function se(_t,Tt){const ot=y.enabledAttributes,dt=y.attributeDivisors;y.newAttributes[_t]=1,0===ot[_t]&&(i.enableVertexAttribArray(_t),ot[_t]=1),dt[_t]!==Tt&&((n.isWebGL2?i:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](_t,Tt),dt[_t]=Tt)}function ve(){const _t=y.newAttributes,Tt=y.enabledAttributes;for(let at=0,ot=Tt.length;at<ot;at++)Tt[at]!==_t[at]&&(i.disableVertexAttribArray(at),Tt[at]=0)}function Ce(_t,Tt,at,ot,dt,It,Xt){!0===Xt?i.vertexAttribIPointer(_t,Tt,at,dt,It):i.vertexAttribPointer(_t,Tt,at,ot,dt,It)}function ni(){ht(),M=!0,y!==f&&(y=f,R(y.object))}function ht(){f.geometry=null,f.program=null,f.wireframe=!1}return{setup:function A(_t,Tt,at,ot,dt){let It=!1;if(a){const Xt=function H(_t,Tt,at){const ot=!0===at.wireframe;let dt=u[_t.id];void 0===dt&&(dt={},u[_t.id]=dt);let It=dt[Tt.id];void 0===It&&(It={},dt[Tt.id]=It);let Xt=It[ot];return void 0===Xt&&(Xt=U(function I(){return n.isWebGL2?i.createVertexArray():o.createVertexArrayOES()}()),It[ot]=Xt),Xt}(ot,at,Tt);y!==Xt&&(y=Xt,R(y.object)),It=function B(_t,Tt,at,ot){const dt=y.attributes,It=Tt.attributes;let Xt=0;const ut=at.getAttributes();for(const zt in ut)if(ut[zt].location>=0){const gi=dt[zt];let Vi=It[zt];if(void 0===Vi&&("instanceMatrix"===zt&&_t.instanceMatrix&&(Vi=_t.instanceMatrix),"instanceColor"===zt&&_t.instanceColor&&(Vi=_t.instanceColor)),void 0===gi||gi.attribute!==Vi||Vi&&gi.data!==Vi.data)return!0;Xt++}return y.attributesNum!==Xt||y.index!==ot}(_t,ot,at,dt),It&&function Z(_t,Tt,at,ot){const dt={},It=Tt.attributes;let Xt=0;const ut=at.getAttributes();for(const zt in ut)if(ut[zt].location>=0){let gi=It[zt];void 0===gi&&("instanceMatrix"===zt&&_t.instanceMatrix&&(gi=_t.instanceMatrix),"instanceColor"===zt&&_t.instanceColor&&(gi=_t.instanceColor));const Vi={};Vi.attribute=gi,gi&&gi.data&&(Vi.data=gi.data),dt[zt]=Vi,Xt++}y.attributes=dt,y.attributesNum=Xt,y.index=ot}(_t,ot,at,dt)}else{const Xt=!0===Tt.wireframe;(y.geometry!==ot.id||y.program!==at.id||y.wireframe!==Xt)&&(y.geometry=ot.id,y.program=at.id,y.wireframe=Xt,It=!0)}null!==dt&&e.update(dt,i.ELEMENT_ARRAY_BUFFER),(It||M)&&(M=!1,function Ve(_t,Tt,at,ot){if(!1===n.isWebGL2&&(_t.isInstancedMesh||ot.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;X();const dt=ot.attributes,It=at.getAttributes(),Xt=Tt.defaultAttributeValues;for(const ut in It){const zt=It[ut];if(zt.location>=0){let Ti=dt[ut];if(void 0===Ti&&("instanceMatrix"===ut&&_t.instanceMatrix&&(Ti=_t.instanceMatrix),"instanceColor"===ut&&_t.instanceColor&&(Ti=_t.instanceColor)),void 0!==Ti){const gi=Ti.normalized,Vi=Ti.itemSize,kn=e.get(Ti);if(void 0===kn)continue;const Yi=kn.buffer,mn=kn.type,mr=kn.bytesPerElement,qo=!0===n.isWebGL2&&(mn===i.INT||mn===i.UNSIGNED_INT||1013===Ti.gpuType);if(Ti.isInterleavedBufferAttribute){const Kn=Ti.data,Ue=Kn.stride,ki=Ti.offset;if(Kn.isInstancedInterleavedBuffer){for(let ti=0;ti<zt.locationSize;ti++)se(zt.location+ti,Kn.meshPerAttribute);!0!==_t.isInstancedMesh&&void 0===ot._maxInstanceCount&&(ot._maxInstanceCount=Kn.meshPerAttribute*Kn.count)}else for(let ti=0;ti<zt.locationSize;ti++)ee(zt.location+ti);i.bindBuffer(i.ARRAY_BUFFER,Yi);for(let ti=0;ti<zt.locationSize;ti++)Ce(zt.location+ti,Vi/zt.locationSize,mn,gi,Ue*mr,(ki+Vi/zt.locationSize*ti)*mr,qo)}else{if(Ti.isInstancedBufferAttribute){for(let Kn=0;Kn<zt.locationSize;Kn++)se(zt.location+Kn,Ti.meshPerAttribute);!0!==_t.isInstancedMesh&&void 0===ot._maxInstanceCount&&(ot._maxInstanceCount=Ti.meshPerAttribute*Ti.count)}else for(let Kn=0;Kn<zt.locationSize;Kn++)ee(zt.location+Kn);i.bindBuffer(i.ARRAY_BUFFER,Yi);for(let Kn=0;Kn<zt.locationSize;Kn++)Ce(zt.location+Kn,Vi/zt.locationSize,mn,gi,Vi*mr,Vi/zt.locationSize*Kn*mr,qo)}}else if(void 0!==Xt){const gi=Xt[ut];if(void 0!==gi)switch(gi.length){case 2:i.vertexAttrib2fv(zt.location,gi);break;case 3:i.vertexAttrib3fv(zt.location,gi);break;case 4:i.vertexAttrib4fv(zt.location,gi);break;default:i.vertexAttrib1fv(zt.location,gi)}}}}ve()}(_t,Tt,at,ot),null!==dt&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(dt).buffer))},reset:ni,resetDefaultState:ht,dispose:function ce(){ni();for(const _t in u){const Tt=u[_t];for(const at in Tt){const ot=Tt[at];for(const dt in ot)O(ot[dt].object),delete ot[dt];delete Tt[at]}delete u[_t]}},releaseStatesOfGeometry:function we(_t){if(void 0===u[_t.id])return;const Tt=u[_t.id];for(const at in Tt){const ot=Tt[at];for(const dt in ot)O(ot[dt].object),delete ot[dt];delete Tt[at]}delete u[_t.id]},releaseStatesOfProgram:function At(_t){for(const Tt in u){const at=u[Tt];if(void 0===at[_t.id])continue;const ot=at[_t.id];for(const dt in ot)O(ot[dt].object),delete ot[dt];delete at[_t.id]}},initAttributes:X,enableAttribute:ee,disableUnusedAttributes:ve}}function rae(i,t,e,n){const r=n.isWebGL2;let o;this.setMode=function a(y){o=y},this.render=function u(y,M){i.drawArrays(o,y,M),e.update(M,o,1)},this.renderInstances=function f(y,M,A){if(0===A)return;let I,R;if(r)I=i,R="drawArraysInstanced";else if(I=t.get("ANGLE_instanced_arrays"),R="drawArraysInstancedANGLE",null===I)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");I[R](o,y,M,A),e.update(M,o,A)}}function oae(i,t,e){let n;function o(Ce){if("highp"===Ce){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";Ce="mediump"}return"mediump"===Ce&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===i.constructor.name;let u=void 0!==e.precision?e.precision:"highp";const f=o(u);f!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",f,"instead."),u=f);const y=a||t.has("WEBGL_draw_buffers"),M=!0===e.logarithmicDepthBuffer,A=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),I=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=i.getParameter(i.MAX_TEXTURE_SIZE),O=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),H=i.getParameter(i.MAX_VERTEX_ATTRIBS),U=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),B=i.getParameter(i.MAX_VARYING_VECTORS),Z=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),X=I>0,ee=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:y,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===t.has("EXT_texture_filter_anisotropic")){const Ce=t.get("EXT_texture_filter_anisotropic");n=i.getParameter(Ce.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:o,precision:u,logarithmicDepthBuffer:M,maxTextures:A,maxVertexTextures:I,maxTextureSize:R,maxCubemapSize:O,maxAttributes:H,maxVertexUniforms:U,maxVaryings:B,maxFragmentUniforms:Z,vertexTextures:X,floatFragmentTextures:ee,floatVertexTextures:X&&ee,maxSamples:a?i.getParameter(i.MAX_SAMPLES):0}}function sae(i){const t=this;let e=null,n=0,r=!1,o=!1;const a=new q0,u=new eo,f={value:null,needsUpdate:!1};function M(A,I,R,O){const H=null!==A?A.length:0;let U=null;if(0!==H){if(U=f.value,!0!==O||null===U){const B=R+4*H,Z=I.matrixWorldInverse;u.getNormalMatrix(Z),(null===U||U.length<B)&&(U=new Float32Array(B));for(let X=0,ee=R;X!==H;++X,ee+=4)a.copy(A[X]).applyMatrix4(Z,u),a.normal.toArray(U,ee),U[ee+3]=a.constant}f.value=U,f.needsUpdate=!0}return t.numPlanes=H,t.numIntersection=0,U}this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(A,I){const R=0!==A.length||I||0!==n||r;return r=I,n=A.length,R},this.beginShadows=function(){o=!0,M(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(A,I){e=M(A,I,0)},this.setState=function(A,I,R){const O=A.clippingPlanes,H=A.clipIntersection,U=A.clipShadows,B=i.get(A);if(!r||null===O||0===O.length||o&&!U)o?M(null):function y(){f.value!==e&&(f.value=e,f.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}();else{const Z=o?0:n,X=4*Z;let ee=B.clippingState||null;f.value=ee,ee=M(O,I,X,R);for(let se=0;se!==X;++se)ee[se]=e[se];B.clippingState=ee,this.numIntersection=H?this.numPlanes:0,this.numPlanes+=Z}}}function aae(i){let t=new WeakMap;function e(a,u){return 303===u?a.mapping=R0:304===u&&(a.mapping=P0),a}function r(a){const u=a.target;u.removeEventListener("dispose",r);const f=t.get(u);void 0!==f&&(t.delete(u),f.dispose())}return{get:function n(a){if(a&&a.isTexture&&!1===a.isRenderTargetTexture){const u=a.mapping;if(303===u||304===u){if(t.has(a))return e(t.get(a).texture,a.mapping);{const f=a.image;if(f&&f.height>0){const y=new toe(f.height/2);return y.fromEquirectangularTexture(i,a),t.set(a,y),a.addEventListener("dispose",r),e(y.texture,a.mapping)}return null}}}return a},dispose:function o(){t=new WeakMap}}}class K2 extends X2{constructor(t=-1,e=1,n=1,r=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,o,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=n-t,a=n+t,u=r+e,f=r-e;if(null!==this.view&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,M=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=y*this.view.offsetX,a=o+y*this.view.width,u-=M*this.view.offsetY,f=u-M*this.view.height}this.projectionMatrix.makeOrthographic(o,a,u,f,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const U5=[.125,.215,.35,.446,.526,.582],J2=new K2,V5=new rn;let Q2=null;const Y0=(1+Math.sqrt(5))/2,D1=1/Y0,H5=[new Ee(1,1,1),new Ee(-1,1,1),new Ee(1,1,-1),new Ee(-1,1,-1),new Ee(0,Y0,D1),new Ee(0,Y0,-D1),new Ee(D1,0,Y0),new Ee(-D1,0,Y0),new Ee(Y0,D1,0),new Ee(-Y0,D1,0)];class G5{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,r=100){Q2=this._renderer.getRenderTarget(),this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(t,n,r,o),e>0&&this._blur(o,0,0,e),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=$5(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=W5(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Q2),t.scissorTest=!1,VA(t,0,0,t.width,t.height)}_fromTexture(t,e){this._setSize(t.mapping===R0||t.mapping===P0?0===t.image.length?16:t.image[0].width||t.image[0].image.width:t.image.width/4),Q2=this._renderer.getRenderTarget();const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:ql,minFilter:ql,generateMipmaps:!1,type:mC,format:df,colorSpace:pg,depthBuffer:!1},r=j5(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=j5(t,e,n);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function lae(i){const t=[],e=[],n=[];let r=i;const o=i-4+1+U5.length;for(let a=0;a<o;a++){const u=Math.pow(2,r);e.push(u);let f=1/u;a>i-4?f=U5[a-i+4-1]:0===a&&(f=0),n.push(f);const y=1/(u-2),M=-y,A=1+y,I=[M,M,A,M,A,A,M,M,A,A,M,A],R=6,O=6,H=3,U=2,B=1,Z=new Float32Array(H*O*R),X=new Float32Array(U*O*R),ee=new Float32Array(B*O*R);for(let ve=0;ve<R;ve++){const Ce=ve%3*2/3-1,Ve=ve>2?0:-1;Z.set([Ce,Ve,0,Ce+2/3,Ve,0,Ce+2/3,Ve+1,0,Ce,Ve,0,Ce+2/3,Ve+1,0,Ce,Ve+1,0],H*O*ve),X.set(I,U*O*ve),ee.set([ve,ve,ve,ve,ve,ve],B*O*ve)}const se=new po;se.setAttribute("position",new zc(Z,H)),se.setAttribute("uv",new zc(X,U)),se.setAttribute("faceIndex",new zc(ee,B)),t.push(se),r>4&&r--}return{lodPlanes:t,sizeLods:e,sigmas:n}}(o)),this._blurMaterial=function cae(i,t,e){const n=new Float32Array(20),r=new Ee(0,1,0);return new Cv({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/e,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(o,t,e)}return r}_compileMaterial(t){const e=new Hd(this._lodPlanes[0],t);this._renderer.compile(e,J2)}_sceneToCubeUV(t,e,n,r){const u=new hd(90,1,e,n),f=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],M=this._renderer,A=M.autoClear,I=M.toneMapping;M.getClearColor(V5),M.toneMapping=R_,M.autoClear=!1;const R=new W0({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),O=new Hd(new E1,R);let H=!1;const U=t.background;U?U.isColor&&(R.color.copy(U),t.background=null,H=!0):(R.color.copy(V5),H=!0);for(let B=0;B<6;B++){const Z=B%3;0===Z?(u.up.set(0,f[B],0),u.lookAt(y[B],0,0)):1===Z?(u.up.set(0,0,f[B]),u.lookAt(0,y[B],0)):(u.up.set(0,f[B],0),u.lookAt(0,0,y[B]));const X=this._cubeSize;VA(r,Z*X,B>2?X:0,X,X),M.setRenderTarget(r),H&&M.render(O,u),M.render(t,u)}O.geometry.dispose(),O.material.dispose(),M.toneMapping=I,M.autoClear=A,t.background=U}_textureToCubeUV(t,e){const n=this._renderer,r=t.mapping===R0||t.mapping===P0;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=$5()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=W5());const o=r?this._cubemapMaterial:this._equirectMaterial,a=new Hd(this._lodPlanes[0],o);o.uniforms.envMap.value=t;const f=this._cubeSize;VA(e,0,0,3*f,2*f),n.setRenderTarget(e),n.render(a,J2)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(t,r-1,r,o,H5[(r-1)%H5.length])}e.autoClear=n}_blur(t,e,n,r,o){const a=this._pingPongRenderTarget;this._halfBlur(t,a,e,n,r,"latitudinal",o),this._halfBlur(a,t,n,n,r,"longitudinal",o)}_halfBlur(t,e,n,r,o,a,u){const f=this._renderer,y=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const A=new Hd(this._lodPlanes[r],y),I=y.uniforms,R=this._sizeLods[n]-1,O=isFinite(o)?Math.PI/(2*R):2*Math.PI/39,H=o/O,U=isFinite(o)?1+Math.floor(3*H):20;U>20&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${U} samples when the maximum is set to 20`);const B=[];let Z=0;for(let Ce=0;Ce<20;++Ce){const Ve=Ce/H,ce=Math.exp(-Ve*Ve/2);B.push(ce),0===Ce?Z+=ce:Ce<U&&(Z+=2*ce)}for(let Ce=0;Ce<B.length;Ce++)B[Ce]=B[Ce]/Z;I.envMap.value=t.texture,I.samples.value=U,I.weights.value=B,I.latitudinal.value="latitudinal"===a,u&&(I.poleAxis.value=u);const{_lodMax:X}=this;I.dTheta.value=O,I.mipInt.value=X-n;const ee=this._sizeLods[r];VA(e,3*ee*(r>X-4?r-X+4:0),4*(this._cubeSize-ee),3*ee,2*ee),f.setRenderTarget(e),f.render(A,J2)}}function j5(i,t,e){const n=new H0(i,t,e);return n.texture.mapping=fC,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function VA(i,t,e,n,r){i.viewport.set(t,e,n,r),i.scissor.set(t,e,n,r)}function W5(){return new Cv({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function $5(){return new Cv({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function dae(i){let t=new WeakMap,e=null;function o(u){const f=u.target;f.removeEventListener("dispose",o);const y=t.get(f);void 0!==y&&(t.delete(f),y.dispose())}return{get:function n(u){if(u&&u.isTexture){const f=u.mapping,y=303===f||304===f,M=f===R0||f===P0;if(y||M){if(u.isRenderTargetTexture&&!0===u.needsPMREMUpdate){u.needsPMREMUpdate=!1;let A=t.get(u);return null===e&&(e=new G5(i)),A=y?e.fromEquirectangular(u,A):e.fromCubemap(u,A),t.set(u,A),A.texture}if(t.has(u))return t.get(u).texture;{const A=u.image;if(y&&A&&A.height>0||M&&A&&function r(u){let f=0;for(let M=0;M<6;M++)void 0!==u[M]&&f++;return 6===f}(A)){null===e&&(e=new G5(i));const I=y?e.fromEquirectangular(u):e.fromCubemap(u);return t.set(u,I),u.addEventListener("dispose",o),I.texture}return null}}}return u},dispose:function a(){t=new WeakMap,null!==e&&(e.dispose(),e=null)}}}function uae(i){const t={};function e(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return t[n]=r,r}return{has:function(n){return null!==e(n)},init:function(n){n.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float"),e("WEBGL_multisampled_render_to_texture")},get:function(n){const r=e(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function hae(i,t,e,n){const r={},o=new WeakMap;function a(A){const I=A.target;null!==I.index&&t.remove(I.index);for(const O in I.attributes)t.remove(I.attributes[O]);for(const O in I.morphAttributes){const H=I.morphAttributes[O];for(let U=0,B=H.length;U<B;U++)t.remove(H[U])}I.removeEventListener("dispose",a),delete r[I.id];const R=o.get(I);R&&(t.remove(R),o.delete(I)),n.releaseStatesOfGeometry(I),!0===I.isInstancedBufferGeometry&&delete I._maxInstanceCount,e.memory.geometries--}function y(A){const I=[],R=A.index,O=A.attributes.position;let H=0;if(null!==R){const Z=R.array;H=R.version;for(let X=0,ee=Z.length;X<ee;X+=3){const se=Z[X+0],ve=Z[X+1],Ce=Z[X+2];I.push(se,ve,ve,Ce,Ce,se)}}else{H=O.version;for(let X=0,ee=O.array.length/3-1;X<ee;X+=3){const se=X+0,ve=X+1,Ce=X+2;I.push(se,ve,ve,Ce,Ce,se)}}const U=new(_5(I)?R5:k5)(I,1);U.version=H;const B=o.get(A);B&&t.remove(B),o.set(A,U)}return{get:function u(A,I){return!0===r[I.id]||(I.addEventListener("dispose",a),r[I.id]=!0,e.memory.geometries++),I},update:function f(A){const I=A.attributes;for(const O in I)t.update(I[O],i.ARRAY_BUFFER);const R=A.morphAttributes;for(const O in R){const H=R[O];for(let U=0,B=H.length;U<B;U++)t.update(H[U],i.ARRAY_BUFFER)}},getWireframeAttribute:function M(A){const I=o.get(A);if(I){const R=A.index;null!==R&&I.version<R.version&&y(A)}else y(A);return o.get(A)}}}function pae(i,t,e,n){const r=n.isWebGL2;let o,u,f;this.setMode=function a(I){o=I},this.setIndex=function y(I){u=I.type,f=I.bytesPerElement},this.render=function M(I,R){i.drawElements(o,R,u,I*f),e.update(R,o,1)},this.renderInstances=function A(I,R,O){if(0===O)return;let H,U;if(r)H=i,U="drawElementsInstanced";else if(H=t.get("ANGLE_instanced_arrays"),U="drawElementsInstancedANGLE",null===H)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");H[U](o,R,u,I*f,O),e.update(R,o,O)}}function fae(i){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function r(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function n(o,a,u){switch(e.calls++,a){case i.TRIANGLES:e.triangles+=u*(o/3);break;case i.LINES:e.lines+=u*(o/2);break;case i.LINE_STRIP:e.lines+=u*(o-1);break;case i.LINE_LOOP:e.lines+=u*o;break;case i.POINTS:e.points+=u*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}function mae(i,t){return i[0]-t[0]}function gae(i,t){return Math.abs(t[1])-Math.abs(i[1])}function _ae(i,t,e){const n={},r=new Float32Array(8),o=new WeakMap,a=new bs,u=[];for(let y=0;y<8;y++)u[y]=[y,0];return{update:function f(y,M,A){const I=y.morphTargetInfluences;if(!0===t.isWebGL2){const R=M.morphAttributes.position||M.morphAttributes.normal||M.morphAttributes.color,O=void 0!==R?R.length:0;let H=o.get(M);if(void 0===H||H.count!==O){let _t=function(){ni.dispose(),o.delete(M),M.removeEventListener("dispose",_t)};void 0!==H&&H.texture.dispose();const Z=void 0!==M.morphAttributes.position,X=void 0!==M.morphAttributes.normal,ee=void 0!==M.morphAttributes.color,se=M.morphAttributes.position||[],ve=M.morphAttributes.normal||[],Ce=M.morphAttributes.color||[];let Ve=0;!0===Z&&(Ve=1),!0===X&&(Ve=2),!0===ee&&(Ve=3);let ce=M.attributes.position.count*Ve,we=1;ce>t.maxTextureSize&&(we=Math.ceil(ce/t.maxTextureSize),ce=t.maxTextureSize);const At=new Float32Array(ce*we*4*O),ni=new P2(At,ce,we,O);ni.type=P_,ni.needsUpdate=!0;const ht=4*Ve;for(let Tt=0;Tt<O;Tt++){const at=se[Tt],ot=ve[Tt],dt=Ce[Tt],It=ce*we*4*Tt;for(let Xt=0;Xt<at.count;Xt++){const ut=Xt*ht;!0===Z&&(a.fromBufferAttribute(at,Xt),At[It+ut+0]=a.x,At[It+ut+1]=a.y,At[It+ut+2]=a.z,At[It+ut+3]=0),!0===X&&(a.fromBufferAttribute(ot,Xt),At[It+ut+4]=a.x,At[It+ut+5]=a.y,At[It+ut+6]=a.z,At[It+ut+7]=0),!0===ee&&(a.fromBufferAttribute(dt,Xt),At[It+ut+8]=a.x,At[It+ut+9]=a.y,At[It+ut+10]=a.z,At[It+ut+11]=4===dt.itemSize?a.w:1)}}H={count:O,texture:ni,size:new ei(ce,we)},o.set(M,H),M.addEventListener("dispose",_t)}let U=0;for(let Z=0;Z<I.length;Z++)U+=I[Z];const B=M.morphTargetsRelative?1:1-U;A.getUniforms().setValue(i,"morphTargetBaseInfluence",B),A.getUniforms().setValue(i,"morphTargetInfluences",I),A.getUniforms().setValue(i,"morphTargetsTexture",H.texture,e),A.getUniforms().setValue(i,"morphTargetsTextureSize",H.size)}else{const R=void 0===I?0:I.length;let O=n[M.id];if(void 0===O||O.length!==R){O=[];for(let X=0;X<R;X++)O[X]=[X,0];n[M.id]=O}for(let X=0;X<R;X++){const ee=O[X];ee[0]=X,ee[1]=I[X]}O.sort(gae);for(let X=0;X<8;X++)X<R&&O[X][1]?(u[X][0]=O[X][0],u[X][1]=O[X][1]):(u[X][0]=Number.MAX_SAFE_INTEGER,u[X][1]=0);u.sort(mae);const H=M.morphAttributes.position,U=M.morphAttributes.normal;let B=0;for(let X=0;X<8;X++){const ee=u[X],se=ee[0],ve=ee[1];se!==Number.MAX_SAFE_INTEGER&&ve?(H&&M.getAttribute("morphTarget"+X)!==H[se]&&M.setAttribute("morphTarget"+X,H[se]),U&&M.getAttribute("morphNormal"+X)!==U[se]&&M.setAttribute("morphNormal"+X,U[se]),r[X]=ve,B+=ve):(H&&!0===M.hasAttribute("morphTarget"+X)&&M.deleteAttribute("morphTarget"+X),U&&!0===M.hasAttribute("morphNormal"+X)&&M.deleteAttribute("morphNormal"+X),r[X]=0)}const Z=M.morphTargetsRelative?1:1-B;A.getUniforms().setValue(i,"morphTargetBaseInfluence",Z),A.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function yae(i,t,e,n){let r=new WeakMap;function u(f){const y=f.target;y.removeEventListener("dispose",u),e.remove(y.instanceMatrix),null!==y.instanceColor&&e.remove(y.instanceColor)}return{update:function o(f){const y=n.render.frame,A=t.get(f,f.geometry);if(r.get(A)!==y&&(t.update(A),r.set(A,y)),f.isInstancedMesh&&(!1===f.hasEventListener("dispose",u)&&f.addEventListener("dispose",u),r.get(f)!==y&&(e.update(f.instanceMatrix,i.ARRAY_BUFFER),null!==f.instanceColor&&e.update(f.instanceColor,i.ARRAY_BUFFER),r.set(f,y))),f.isSkinnedMesh){const I=f.skeleton;r.get(I)!==y&&(I.update(),r.set(I,y))}return A},dispose:function a(){r=new WeakMap}}}const q5=new bv,X5=new P2,Z5=new b5,Y5=new NA,K5=[],J5=[],Q5=new Float32Array(16),eH=new Float32Array(9),tH=new Float32Array(4);function I1(i,t,e){const n=i[0];if(n<=0||n>0)return i;const r=t*e;let o=K5[r];if(void 0===o&&(o=new Float32Array(r),K5[r]=o),0!==t){n.toArray(o,0);for(let a=1,u=0;a!==t;++a)u+=e,i[a].toArray(o,u)}return o}function mc(i,t){if(i.length!==t.length)return!1;for(let e=0,n=i.length;e<n;e++)if(i[e]!==t[e])return!1;return!0}function gc(i,t){for(let e=0,n=t.length;e<n;e++)i[e]=t[e]}function HA(i,t){let e=J5[t];void 0===e&&(e=new Int32Array(t),J5[t]=e);for(let n=0;n!==t;++n)e[n]=i.allocateTextureUnit();return e}function vae(i,t){const e=this.cache;e[0]!==t&&(i.uniform1f(this.addr,t),e[0]=t)}function bae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y)&&(i.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(mc(e,t))return;i.uniform2fv(this.addr,t),gc(e,t)}}function xae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(i.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(void 0!==t.r)(e[0]!==t.r||e[1]!==t.g||e[2]!==t.b)&&(i.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(mc(e,t))return;i.uniform3fv(this.addr,t),gc(e,t)}}function wae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(i.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(mc(e,t))return;i.uniform4fv(this.addr,t),gc(e,t)}}function Mae(i,t){const e=this.cache,n=t.elements;if(void 0===n){if(mc(e,t))return;i.uniformMatrix2fv(this.addr,!1,t),gc(e,t)}else{if(mc(e,n))return;tH.set(n),i.uniformMatrix2fv(this.addr,!1,tH),gc(e,n)}}function Eae(i,t){const e=this.cache,n=t.elements;if(void 0===n){if(mc(e,t))return;i.uniformMatrix3fv(this.addr,!1,t),gc(e,t)}else{if(mc(e,n))return;eH.set(n),i.uniformMatrix3fv(this.addr,!1,eH),gc(e,n)}}function Cae(i,t){const e=this.cache,n=t.elements;if(void 0===n){if(mc(e,t))return;i.uniformMatrix4fv(this.addr,!1,t),gc(e,t)}else{if(mc(e,n))return;Q5.set(n),i.uniformMatrix4fv(this.addr,!1,Q5),gc(e,n)}}function Sae(i,t){const e=this.cache;e[0]!==t&&(i.uniform1i(this.addr,t),e[0]=t)}function Tae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y)&&(i.uniform2i(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(mc(e,t))return;i.uniform2iv(this.addr,t),gc(e,t)}}function Aae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(i.uniform3i(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else{if(mc(e,t))return;i.uniform3iv(this.addr,t),gc(e,t)}}function Dae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(i.uniform4i(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(mc(e,t))return;i.uniform4iv(this.addr,t),gc(e,t)}}function Iae(i,t){const e=this.cache;e[0]!==t&&(i.uniform1ui(this.addr,t),e[0]=t)}function kae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y)&&(i.uniform2ui(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(mc(e,t))return;i.uniform2uiv(this.addr,t),gc(e,t)}}function Rae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(i.uniform3ui(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else{if(mc(e,t))return;i.uniform3uiv(this.addr,t),gc(e,t)}}function Pae(i,t){const e=this.cache;if(void 0!==t.x)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(i.uniform4ui(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(mc(e,t))return;i.uniform4uiv(this.addr,t),gc(e,t)}}function Lae(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2D(t||q5,r)}function Fae(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture3D(t||Z5,r)}function Oae(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTextureCube(t||Y5,r)}function Nae(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2DArray(t||X5,r)}function zae(i,t){i.uniform1fv(this.addr,t)}function Uae(i,t){const e=I1(t,this.size,2);i.uniform2fv(this.addr,e)}function Vae(i,t){const e=I1(t,this.size,3);i.uniform3fv(this.addr,e)}function Hae(i,t){const e=I1(t,this.size,4);i.uniform4fv(this.addr,e)}function Gae(i,t){const e=I1(t,this.size,4);i.uniformMatrix2fv(this.addr,!1,e)}function jae(i,t){const e=I1(t,this.size,9);i.uniformMatrix3fv(this.addr,!1,e)}function Wae(i,t){const e=I1(t,this.size,16);i.uniformMatrix4fv(this.addr,!1,e)}function $ae(i,t){i.uniform1iv(this.addr,t)}function qae(i,t){i.uniform2iv(this.addr,t)}function Xae(i,t){i.uniform3iv(this.addr,t)}function Zae(i,t){i.uniform4iv(this.addr,t)}function Yae(i,t){i.uniform1uiv(this.addr,t)}function Kae(i,t){i.uniform2uiv(this.addr,t)}function Jae(i,t){i.uniform3uiv(this.addr,t)}function Qae(i,t){i.uniform4uiv(this.addr,t)}function ele(i,t,e){const n=this.cache,r=t.length,o=HA(e,r);mc(n,o)||(i.uniform1iv(this.addr,o),gc(n,o));for(let a=0;a!==r;++a)e.setTexture2D(t[a]||q5,o[a])}function tle(i,t,e){const n=this.cache,r=t.length,o=HA(e,r);mc(n,o)||(i.uniform1iv(this.addr,o),gc(n,o));for(let a=0;a!==r;++a)e.setTexture3D(t[a]||Z5,o[a])}function ile(i,t,e){const n=this.cache,r=t.length,o=HA(e,r);mc(n,o)||(i.uniform1iv(this.addr,o),gc(n,o));for(let a=0;a!==r;++a)e.setTextureCube(t[a]||Y5,o[a])}function nle(i,t,e){const n=this.cache,r=t.length,o=HA(e,r);mc(n,o)||(i.uniform1iv(this.addr,o),gc(n,o));for(let a=0;a!==r;++a)e.setTexture2DArray(t[a]||X5,o[a])}class ole{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function Bae(i){switch(i){case 5126:return vae;case 35664:return bae;case 35665:return xae;case 35666:return wae;case 35674:return Mae;case 35675:return Eae;case 35676:return Cae;case 5124:case 35670:return Sae;case 35667:case 35671:return Tae;case 35668:case 35672:return Aae;case 35669:case 35673:return Dae;case 5125:return Iae;case 36294:return kae;case 36295:return Rae;case 36296:return Pae;case 35678:case 36198:case 36298:case 36306:case 35682:return Lae;case 35679:case 36299:case 36307:return Fae;case 35680:case 36300:case 36308:case 36293:return Oae;case 36289:case 36303:case 36311:case 36292:return Nae}}(e.type)}}class sle{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function rle(i){switch(i){case 5126:return zae;case 35664:return Uae;case 35665:return Vae;case 35666:return Hae;case 35674:return Gae;case 35675:return jae;case 35676:return Wae;case 5124:case 35670:return $ae;case 35667:case 35671:return qae;case 35668:case 35672:return Xae;case 35669:case 35673:return Zae;case 5125:return Yae;case 36294:return Kae;case 36295:return Jae;case 36296:return Qae;case 35678:case 36198:case 36298:case 36306:case 35682:return ele;case 35679:case 36299:case 36307:return tle;case 35680:case 36300:case 36308:case 36293:return ile;case 36289:case 36303:case 36311:case 36292:return nle}}(e.type)}}class ale{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const r=this.seq;for(let o=0,a=r.length;o!==a;++o){const u=r[o];u.setValue(t,e[u.id],n)}}}const tP=/(\w+)(\])?(\[|\.)?/g;function iH(i,t){i.seq.push(t),i.map[t.id]=t}function lle(i,t,e){const n=i.name,r=n.length;for(tP.lastIndex=0;;){const o=tP.exec(n);let u=o[1];const y=o[3];if("]"===o[2]&&(u|=0),void 0===y||"["===y&&tP.lastIndex+2===r){iH(e,void 0===y?new ole(u,i,t):new sle(u,i,t));break}{let A=e.map[u];void 0===A&&(A=new ale(u),iH(e,A)),e=A}}}class GA{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const o=t.getActiveUniform(e,r);lle(o,t.getUniformLocation(e,o.name),this)}}setValue(t,e,n,r){const o=this.map[e];void 0!==o&&o.setValue(t,n,r)}setOptional(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)}static upload(t,e,n,r){for(let o=0,a=e.length;o!==a;++o){const u=e[o],f=n[u.id];!1!==f.needsUpdate&&u.setValue(t,f.value,r)}}static seqWithValue(t,e){const n=[];for(let r=0,o=t.length;r!==o;++r){const a=t[r];a.id in e&&n.push(a)}return n}}function nH(i,t,e){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}let cle=0;function rH(i,t,e){const n=i.getShaderParameter(t,i.COMPILE_STATUS),r=i.getShaderInfoLog(t).trim();if(n&&""===r)return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const a=parseInt(o[1]);return e.toUpperCase()+"\n\n"+r+"\n\n"+function dle(i,t){const e=i.split("\n"),n=[],r=Math.max(t-6,0),o=Math.min(t+6,e.length);for(let a=r;a<o;a++){const u=a+1;n.push(`${u===t?">":" "} ${u}: ${e[a]}`)}return n.join("\n")}(i.getShaderSource(t),a)}return r}function hle(i,t){const e=function ule(i){switch(i){case pg:return["Linear","( value )"];case Hr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",i),["Linear","( value )"]}}(t);return"vec4 "+i+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function ple(i,t){let e;switch(t){case Vne:e="Linear";break;case Hne:e="Reinhard";break;case Gne:e="OptimizedCineon";break;case jne:e="ACESFilmic";break;case Wne:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+i+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function CC(i){return""!==i}function oH(i,t){const e=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,e).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function sH(i,t){return i.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const _le=/^[ \t]*#include +<([\w\d./]+)>/gm;function iP(i){return i.replace(_le,vle)}const yle=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function vle(i,t){let e=Zr[t];if(void 0===e){const n=yle.get(t);if(void 0===n)throw new Error("Can not resolve #include <"+t+">");e=Zr[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,n)}return iP(e)}const ble=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function aH(i){return i.replace(ble,xle)}function xle(i,t,e,n){let r="";for(let o=parseInt(t);o<parseInt(e);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function lH(i){let t="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?t+="\n#define HIGH_PRECISION":"mediump"===i.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(t+="\n#define LOW_PRECISION"),t}function Tle(i,t,e,n){const r=i.getContext(),o=e.defines;let a=e.vertexShader,u=e.fragmentShader;const f=function wle(i){let t="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===S4?t="SHADOWMAP_TYPE_PCF":i.shadowMapType===vne?t="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===I_&&(t="SHADOWMAP_TYPE_VSM"),t}(e),y=function Mle(i){let t="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case R0:case P0:t="ENVMAP_TYPE_CUBE";break;case fC:t="ENVMAP_TYPE_CUBE_UV"}return t}(e),M=function Ele(i){let t="ENVMAP_MODE_REFLECTION";return i.envMap&&i.envMapMode===P0&&(t="ENVMAP_MODE_REFRACTION"),t}(e),A=function Cle(i){let t="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case lA:t="ENVMAP_BLENDING_MULTIPLY";break;case zne:t="ENVMAP_BLENDING_MIX";break;case Une:t="ENVMAP_BLENDING_ADD"}return t}(e),I=function Sle(i){const t=i.envMapCubeUVHeight;if(null===t)return null;const e=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,e),112)),texelHeight:n,maxMip:e}}(e),R=e.isWebGL2?"":function fle(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.normalMapTangentSpace||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(CC).join("\n")}(e),O=function mle(i){const t=[];for(const e in i){const n=i[e];!1!==n&&t.push("#define "+e+" "+n)}return t.join("\n")}(o),H=r.createProgram();let U,B,Z=e.glslVersion?"#version "+e.glslVersion+"\n":"";e.isRawShaderMaterial?(U=["#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,O].filter(CC).join("\n"),U.length>0&&(U+="\n"),B=[R,"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,O].filter(CC).join("\n"),B.length>0&&(B+="\n")):(U=[lH(e),"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,O,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+M:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",e.displacementMap?"#define USE_DISPLACEMENTMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaHash?"#define USE_ALPHAHASH":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",e.mapUv?"#define MAP_UV "+e.mapUv:"",e.alphaMapUv?"#define ALPHAMAP_UV "+e.alphaMapUv:"",e.lightMapUv?"#define LIGHTMAP_UV "+e.lightMapUv:"",e.aoMapUv?"#define AOMAP_UV "+e.aoMapUv:"",e.emissiveMapUv?"#define EMISSIVEMAP_UV "+e.emissiveMapUv:"",e.bumpMapUv?"#define BUMPMAP_UV "+e.bumpMapUv:"",e.normalMapUv?"#define NORMALMAP_UV "+e.normalMapUv:"",e.displacementMapUv?"#define DISPLACEMENTMAP_UV "+e.displacementMapUv:"",e.metalnessMapUv?"#define METALNESSMAP_UV "+e.metalnessMapUv:"",e.roughnessMapUv?"#define ROUGHNESSMAP_UV "+e.roughnessMapUv:"",e.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+e.anisotropyMapUv:"",e.clearcoatMapUv?"#define CLEARCOATMAP_UV "+e.clearcoatMapUv:"",e.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+e.clearcoatNormalMapUv:"",e.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+e.clearcoatRoughnessMapUv:"",e.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+e.iridescenceMapUv:"",e.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+e.iridescenceThicknessMapUv:"",e.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+e.sheenColorMapUv:"",e.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+e.sheenRoughnessMapUv:"",e.specularMapUv?"#define SPECULARMAP_UV "+e.specularMapUv:"",e.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+e.specularColorMapUv:"",e.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+e.specularIntensityMapUv:"",e.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+e.transmissionMapUv:"",e.thicknessMapUv?"#define THICKNESSMAP_UV "+e.thicknessMapUv:"",e.vertexTangents&&!1===e.flatShading?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUv1s?"#define USE_UV1":"",e.vertexUv2s?"#define USE_UV2":"",e.vertexUv3s?"#define USE_UV3":"",e.pointsUvs?"#define USE_POINTS_UV":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&!1===e.flatShading?"#define USE_MORPHNORMALS":"",e.morphColors&&e.isWebGL2?"#define USE_MORPHCOLORS":"",e.morphTargetsCount>0&&e.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",e.morphTargetsCount>0&&e.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+e.morphTextureStride:"",e.morphTargetsCount>0&&e.isWebGL2?"#define MORPHTARGETS_COUNT "+e.morphTargetsCount:"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+f:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.useLegacyLights?"#define LEGACY_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(CC).join("\n"),B=[R,lH(e),"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,O,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+y:"",e.envMap?"#define "+M:"",e.envMap?"#define "+A:"",I?"#define CUBEUV_TEXEL_WIDTH "+I.texelWidth:"",I?"#define CUBEUV_TEXEL_HEIGHT "+I.texelHeight:"",I?"#define CUBEUV_MAX_MIP "+I.maxMip+".0":"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.anisotropy?"#define USE_ANISOTROPY":"",e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",e.clearcoat?"#define USE_CLEARCOAT":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.iridescence?"#define USE_IRIDESCENCE":"",e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaTest?"#define USE_ALPHATEST":"",e.alphaHash?"#define USE_ALPHAHASH":"",e.sheen?"#define USE_SHEEN":"",e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents&&!1===e.flatShading?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUv1s?"#define USE_UV1":"",e.vertexUv2s?"#define USE_UV2":"",e.vertexUv3s?"#define USE_UV3":"",e.pointsUvs?"#define USE_POINTS_UV":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+f:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.useLegacyLights?"#define LEGACY_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==R_?"#define TONE_MAPPING":"",e.toneMapping!==R_?Zr.tonemapping_pars_fragment:"",e.toneMapping!==R_?ple("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",e.opaque?"#define OPAQUE":"",Zr.colorspace_pars_fragment,hle("linearToOutputTexel",e.outputColorSpace),e.useDepthPacking?"#define DEPTH_PACKING "+e.depthPacking:"","\n"].filter(CC).join("\n")),a=iP(a),a=oH(a,e),a=sH(a,e),u=iP(u),u=oH(u,e),u=sH(u,e),a=aH(a),u=aH(u),e.isWebGL2&&!0!==e.isRawShaderMaterial&&(Z="#version 300 es\n",U=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+U,B=["#define varying in",e.glslVersion===f5?"":"layout(location = 0) out highp vec4 pc_fragColor;",e.glslVersion===f5?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+B);const ee=Z+B+u,se=nH(r,r.VERTEX_SHADER,Z+U+a),ve=nH(r,r.FRAGMENT_SHADER,ee);if(r.attachShader(H,se),r.attachShader(H,ve),void 0!==e.index0AttributeName?r.bindAttribLocation(H,0,e.index0AttributeName):!0===e.morphTargets&&r.bindAttribLocation(H,0,"position"),r.linkProgram(H),i.debug.checkShaderErrors){const ce=r.getProgramInfoLog(H).trim(),we=r.getShaderInfoLog(se).trim(),At=r.getShaderInfoLog(ve).trim();let ni=!0,ht=!0;if(!1===r.getProgramParameter(H,r.LINK_STATUS))if(ni=!1,"function"==typeof i.debug.onShaderError)i.debug.onShaderError(r,H,se,ve);else{const _t=rH(r,se,"vertex"),Tt=rH(r,ve,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(H,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+ce+"\n"+_t+"\n"+Tt)}else""!==ce?console.warn("THREE.WebGLProgram: Program Info Log:",ce):(""===we||""===At)&&(ht=!1);ht&&(this.diagnostics={runnable:ni,programLog:ce,vertexShader:{log:we,prefix:U},fragmentShader:{log:At,prefix:B}})}let Ce,Ve;return r.deleteShader(se),r.deleteShader(ve),this.getUniforms=function(){return void 0===Ce&&(Ce=new GA(r,H)),Ce},this.getAttributes=function(){return void 0===Ve&&(Ve=function gle(i,t){const e={},n=i.getProgramParameter(t,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const o=i.getActiveAttrib(t,r),a=o.name;let u=1;o.type===i.FLOAT_MAT2&&(u=2),o.type===i.FLOAT_MAT3&&(u=3),o.type===i.FLOAT_MAT4&&(u=4),e[a]={type:o.type,location:i.getAttribLocation(t,a),locationSize:u}}return e}(r,H)),Ve},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(H),this.program=void 0},this.type=e.shaderType,this.name=e.shaderName,this.id=cle++,this.cacheKey=t,this.usedTimes=1,this.program=H,this.vertexShader=se,this.fragmentShader=ve,this}let Ale=0;class Dle{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const n=t.fragmentShader,r=this._getShaderStage(t.vertexShader),o=this._getShaderStage(n),a=this._getShaderCacheForMaterial(t);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(o)&&(a.add(o),o.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let n=e.get(t);return void 0===n&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){const e=this.shaderCache;let n=e.get(t);return void 0===n&&(n=new Ile(t),e.set(t,n)),n}}class Ile{constructor(t){this.id=Ale++,this.code=t,this.usedTimes=0}}function kle(i,t,e,n,r,o,a){const u=new U2,f=new Dle,y=[],M=r.isWebGL2,A=r.logarithmicDepthBuffer,I=r.vertexTextures;let R=r.precision;const O={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function H(ce){return 0===ce?"uv":`uv${ce}`}return{getParameters:function U(ce,we,At,ni,ht){const _t=ni.fog,Tt=ht.geometry,ot=(ce.isMeshStandardMaterial?e:t).get(ce.envMap||(ce.isMeshStandardMaterial?ni.environment:null)),dt=ot&&ot.mapping===fC?ot.image.height:null,It=O[ce.type];null!==ce.precision&&(R=r.getMaxPrecision(ce.precision),R!==ce.precision&&console.warn("THREE.WebGLProgram.getParameters:",ce.precision,"not supported, using",R,"instead."));const Xt=Tt.morphAttributes.position||Tt.morphAttributes.normal||Tt.morphAttributes.color,ut=void 0!==Xt?Xt.length:0;let Ti,gi,Vi,kn,zt=0;if(void 0!==Tt.morphAttributes.position&&(zt=1),void 0!==Tt.morphAttributes.normal&&(zt=2),void 0!==Tt.morphAttributes.color&&(zt=3),It){const vg=mg[It];Ti=vg.vertexShader,gi=vg.fragmentShader}else Ti=ce.vertexShader,gi=ce.fragmentShader,f.update(ce),Vi=f.getVertexShaderID(ce),kn=f.getFragmentShaderID(ce);const Yi=i.getRenderTarget(),mn=!0===ht.isInstancedMesh,mr=!!ce.map,Kn=!!ot,Ue=!!ce.aoMap,ki=!!ce.lightMap,ti=!!ce.bumpMap,Ci=!!ce.normalMap,di=!!ce.displacementMap,Fn=!!ce.emissiveMap,on=!!ce.metalnessMap,un=!!ce.roughnessMap,gr=ce.anisotropy>0,fo=ce.clearcoat>0,ba=ce.iridescence>0,Re=ce.sheen>0,ye=ce.transmission>0,Ht=gr&&!!ce.anisotropyMap,Ei=fo&&!!ce.clearcoatMap,wi=fo&&!!ce.clearcoatNormalMap,ze=fo&&!!ce.clearcoatRoughnessMap,hi=ba&&!!ce.iridescenceMap,vi=ba&&!!ce.iridescenceThicknessMap,Dt=Re&&!!ce.sheenColorMap,gn=Re&&!!ce.sheenRoughnessMap,Vn=!!ce.specularMap,Tn=!!ce.specularColorMap,yn=!!ce.specularIntensityMap,hn=ye&&!!ce.transmissionMap,_r=ye&&!!ce.thicknessMap,qe=!!ce.alphaMap,Pi=!!ce.extensions,Ki=!!Tt.attributes.uv1,Xo=!!Tt.attributes.uv2,Ia=!!Tt.attributes.uv3;return{isWebGL2:M,shaderID:It,shaderType:ce.type,shaderName:ce.name,vertexShader:Ti,fragmentShader:gi,defines:ce.defines,customVertexShaderID:Vi,customFragmentShaderID:kn,isRawShaderMaterial:!0===ce.isRawShaderMaterial,glslVersion:ce.glslVersion,precision:R,instancing:mn,instancingColor:mn&&null!==ht.instanceColor,supportsVertexTextures:I,outputColorSpace:null===Yi?i.outputColorSpace:!0===Yi.isXRRenderTarget?Yi.texture.colorSpace:pg,map:mr,matcap:!!ce.matcap,envMap:Kn,envMapMode:Kn&&ot.mapping,envMapCubeUVHeight:dt,aoMap:Ue,lightMap:ki,bumpMap:ti,normalMap:Ci,displacementMap:I&&di,emissiveMap:Fn,normalMapObjectSpace:Ci&&1===ce.normalMapType,normalMapTangentSpace:Ci&&0===ce.normalMapType,metalnessMap:on,roughnessMap:un,anisotropy:gr,anisotropyMap:Ht,clearcoat:fo,clearcoatMap:Ei,clearcoatNormalMap:wi,clearcoatRoughnessMap:ze,iridescence:ba,iridescenceMap:hi,iridescenceThicknessMap:vi,sheen:Re,sheenColorMap:Dt,sheenRoughnessMap:gn,specularMap:Vn,specularColorMap:Tn,specularIntensityMap:yn,transmission:ye,transmissionMap:hn,thicknessMap:_r,gradientMap:!!ce.gradientMap,opaque:!1===ce.transparent&&1===ce.blending,alphaMap:qe,alphaTest:ce.alphaTest>0,alphaHash:!!ce.alphaHash,combine:ce.combine,mapUv:mr&&H(ce.map.channel),aoMapUv:Ue&&H(ce.aoMap.channel),lightMapUv:ki&&H(ce.lightMap.channel),bumpMapUv:ti&&H(ce.bumpMap.channel),normalMapUv:Ci&&H(ce.normalMap.channel),displacementMapUv:di&&H(ce.displacementMap.channel),emissiveMapUv:Fn&&H(ce.emissiveMap.channel),metalnessMapUv:on&&H(ce.metalnessMap.channel),roughnessMapUv:un&&H(ce.roughnessMap.channel),anisotropyMapUv:Ht&&H(ce.anisotropyMap.channel),clearcoatMapUv:Ei&&H(ce.clearcoatMap.channel),clearcoatNormalMapUv:wi&&H(ce.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ze&&H(ce.clearcoatRoughnessMap.channel),iridescenceMapUv:hi&&H(ce.iridescenceMap.channel),iridescenceThicknessMapUv:vi&&H(ce.iridescenceThicknessMap.channel),sheenColorMapUv:Dt&&H(ce.sheenColorMap.channel),sheenRoughnessMapUv:gn&&H(ce.sheenRoughnessMap.channel),specularMapUv:Vn&&H(ce.specularMap.channel),specularColorMapUv:Tn&&H(ce.specularColorMap.channel),specularIntensityMapUv:yn&&H(ce.specularIntensityMap.channel),transmissionMapUv:hn&&H(ce.transmissionMap.channel),thicknessMapUv:_r&&H(ce.thicknessMap.channel),alphaMapUv:qe&&H(ce.alphaMap.channel),vertexTangents:!!Tt.attributes.tangent&&(Ci||gr),vertexColors:ce.vertexColors,vertexAlphas:!0===ce.vertexColors&&!!Tt.attributes.color&&4===Tt.attributes.color.itemSize,vertexUv1s:Ki,vertexUv2s:Xo,vertexUv3s:Ia,pointsUvs:!0===ht.isPoints&&!!Tt.attributes.uv&&(mr||qe),fog:!!_t,useFog:!0===ce.fog,fogExp2:_t&&_t.isFogExp2,flatShading:!0===ce.flatShading,sizeAttenuation:!0===ce.sizeAttenuation,logarithmicDepthBuffer:A,skinning:!0===ht.isSkinnedMesh,morphTargets:void 0!==Tt.morphAttributes.position,morphNormals:void 0!==Tt.morphAttributes.normal,morphColors:void 0!==Tt.morphAttributes.color,morphTargetsCount:ut,morphTextureStride:zt,numDirLights:we.directional.length,numPointLights:we.point.length,numSpotLights:we.spot.length,numSpotLightMaps:we.spotLightMap.length,numRectAreaLights:we.rectArea.length,numHemiLights:we.hemi.length,numDirLightShadows:we.directionalShadowMap.length,numPointLightShadows:we.pointShadowMap.length,numSpotLightShadows:we.spotShadowMap.length,numSpotLightShadowsWithMaps:we.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:ce.dithering,shadowMapEnabled:i.shadowMap.enabled&&At.length>0,shadowMapType:i.shadowMap.type,toneMapping:ce.toneMapped?i.toneMapping:R_,useLegacyLights:i.useLegacyLights,premultipliedAlpha:ce.premultipliedAlpha,doubleSided:2===ce.side,flipSided:1===ce.side,useDepthPacking:ce.depthPacking>=0,depthPacking:ce.depthPacking||0,index0AttributeName:ce.index0AttributeName,extensionDerivatives:Pi&&!0===ce.extensions.derivatives,extensionFragDepth:Pi&&!0===ce.extensions.fragDepth,extensionDrawBuffers:Pi&&!0===ce.extensions.drawBuffers,extensionShaderTextureLOD:Pi&&!0===ce.extensions.shaderTextureLOD,rendererExtensionFragDepth:M||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:M||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:M||n.has("EXT_shader_texture_lod"),customProgramCacheKey:ce.customProgramCacheKey()}},getProgramCacheKey:function B(ce){const we=[];if(ce.shaderID?we.push(ce.shaderID):(we.push(ce.customVertexShaderID),we.push(ce.customFragmentShaderID)),void 0!==ce.defines)for(const At in ce.defines)we.push(At),we.push(ce.defines[At]);return!1===ce.isRawShaderMaterial&&(function Z(ce,we){ce.push(we.precision),ce.push(we.outputColorSpace),ce.push(we.envMapMode),ce.push(we.envMapCubeUVHeight),ce.push(we.mapUv),ce.push(we.alphaMapUv),ce.push(we.lightMapUv),ce.push(we.aoMapUv),ce.push(we.bumpMapUv),ce.push(we.normalMapUv),ce.push(we.displacementMapUv),ce.push(we.emissiveMapUv),ce.push(we.metalnessMapUv),ce.push(we.roughnessMapUv),ce.push(we.anisotropyMapUv),ce.push(we.clearcoatMapUv),ce.push(we.clearcoatNormalMapUv),ce.push(we.clearcoatRoughnessMapUv),ce.push(we.iridescenceMapUv),ce.push(we.iridescenceThicknessMapUv),ce.push(we.sheenColorMapUv),ce.push(we.sheenRoughnessMapUv),ce.push(we.specularMapUv),ce.push(we.specularColorMapUv),ce.push(we.specularIntensityMapUv),ce.push(we.transmissionMapUv),ce.push(we.thicknessMapUv),ce.push(we.combine),ce.push(we.fogExp2),ce.push(we.sizeAttenuation),ce.push(we.morphTargetsCount),ce.push(we.morphAttributeCount),ce.push(we.numDirLights),ce.push(we.numPointLights),ce.push(we.numSpotLights),ce.push(we.numSpotLightMaps),ce.push(we.numHemiLights),ce.push(we.numRectAreaLights),ce.push(we.numDirLightShadows),ce.push(we.numPointLightShadows),ce.push(we.numSpotLightShadows),ce.push(we.numSpotLightShadowsWithMaps),ce.push(we.shadowMapType),ce.push(we.toneMapping),ce.push(we.numClippingPlanes),ce.push(we.numClipIntersection),ce.push(we.depthPacking)}(we,ce),function X(ce,we){u.disableAll(),we.isWebGL2&&u.enable(0),we.supportsVertexTextures&&u.enable(1),we.instancing&&u.enable(2),we.instancingColor&&u.enable(3),we.matcap&&u.enable(4),we.envMap&&u.enable(5),we.normalMapObjectSpace&&u.enable(6),we.normalMapTangentSpace&&u.enable(7),we.clearcoat&&u.enable(8),we.iridescence&&u.enable(9),we.alphaTest&&u.enable(10),we.vertexColors&&u.enable(11),we.vertexAlphas&&u.enable(12),we.vertexUv1s&&u.enable(13),we.vertexUv2s&&u.enable(14),we.vertexUv3s&&u.enable(15),we.vertexTangents&&u.enable(16),we.anisotropy&&u.enable(17),ce.push(u.mask),u.disableAll(),we.fog&&u.enable(0),we.useFog&&u.enable(1),we.flatShading&&u.enable(2),we.logarithmicDepthBuffer&&u.enable(3),we.skinning&&u.enable(4),we.morphTargets&&u.enable(5),we.morphNormals&&u.enable(6),we.morphColors&&u.enable(7),we.premultipliedAlpha&&u.enable(8),we.shadowMapEnabled&&u.enable(9),we.useLegacyLights&&u.enable(10),we.doubleSided&&u.enable(11),we.flipSided&&u.enable(12),we.useDepthPacking&&u.enable(13),we.dithering&&u.enable(14),we.transmission&&u.enable(15),we.sheen&&u.enable(16),we.opaque&&u.enable(17),we.pointsUvs&&u.enable(18),ce.push(u.mask)}(we,ce),we.push(i.outputColorSpace)),we.push(ce.customProgramCacheKey),we.join()},getUniforms:function ee(ce){const we=O[ce.type];let At;return At=we?Kre.clone(mg[we].uniforms):ce.uniforms,At},acquireProgram:function se(ce,we){let At;for(let ni=0,ht=y.length;ni<ht;ni++){const _t=y[ni];if(_t.cacheKey===we){At=_t,++At.usedTimes;break}}return void 0===At&&(At=new Tle(i,we,ce,o),y.push(At)),At},releaseProgram:function ve(ce){if(0==--ce.usedTimes){const we=y.indexOf(ce);y[we]=y[y.length-1],y.pop(),ce.destroy()}},releaseShaderCache:function Ce(ce){f.remove(ce)},programs:y,dispose:function Ve(){f.dispose()}}}function Rle(){let i=new WeakMap;return{get:function t(o){let a=i.get(o);return void 0===a&&(a={},i.set(o,a)),a},remove:function e(o){i.delete(o)},update:function n(o,a,u){i.get(o)[a]=u},dispose:function r(){i=new WeakMap}}}function Ple(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.material.id!==t.material.id?i.material.id-t.material.id:i.z!==t.z?i.z-t.z:i.id-t.id}function cH(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.z!==t.z?t.z-i.z:i.id-t.id}function dH(){const i=[];let t=0;const e=[],n=[],r=[];function a(A,I,R,O,H,U){let B=i[t];return void 0===B?(B={id:A.id,object:A,geometry:I,material:R,groupOrder:O,renderOrder:A.renderOrder,z:H,group:U},i[t]=B):(B.id=A.id,B.object=A,B.geometry=I,B.material=R,B.groupOrder=O,B.renderOrder=A.renderOrder,B.z=H,B.group=U),t++,B}return{opaque:e,transmissive:n,transparent:r,init:function o(){t=0,e.length=0,n.length=0,r.length=0},push:function u(A,I,R,O,H,U){const B=a(A,I,R,O,H,U);R.transmission>0?n.push(B):!0===R.transparent?r.push(B):e.push(B)},unshift:function f(A,I,R,O,H,U){const B=a(A,I,R,O,H,U);R.transmission>0?n.unshift(B):!0===R.transparent?r.unshift(B):e.unshift(B)},finish:function M(){for(let A=t,I=i.length;A<I;A++){const R=i[A];if(null===R.id)break;R.id=null,R.object=null,R.geometry=null,R.material=null,R.group=null}},sort:function y(A,I){e.length>1&&e.sort(A||Ple),n.length>1&&n.sort(I||cH),r.length>1&&r.sort(I||cH)}}}function Lle(){let i=new WeakMap;return{get:function t(n,r){const o=i.get(n);let a;return void 0===o?(a=new dH,i.set(n,[a])):r>=o.length?(a=new dH,o.push(a)):a=o[r],a},dispose:function e(){i=new WeakMap}}}function Fle(){const i={};return{get:function(t){if(void 0!==i[t.id])return i[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new Ee,color:new rn};break;case"SpotLight":e={position:new Ee,direction:new Ee,color:new rn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new Ee,color:new rn,distance:0,decay:0};break;case"HemisphereLight":e={direction:new Ee,skyColor:new rn,groundColor:new rn};break;case"RectAreaLight":e={color:new rn,position:new Ee,halfWidth:new Ee,halfHeight:new Ee}}return i[t.id]=e,e}}}let Nle=0;function Ble(i,t){return(t.castShadow?2:0)-(i.castShadow?2:0)+(t.map?1:0)-(i.map?1:0)}function zle(i,t){const e=new Fle,n=function Ole(){const i={};return{get:function(t){if(void 0!==i[t.id])return i[t.id];let e;switch(t.type){case"DirectionalLight":case"SpotLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ei};break;case"PointLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ei,shadowCameraNear:1,shadowCameraFar:1e3}}return i[t.id]=e,e}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let M=0;M<9;M++)r.probe.push(new Ee);const o=new Ee,a=new Fr,u=new Fr;return{setup:function f(M,A){let I=0,R=0,O=0;for(let At=0;At<9;At++)r.probe[At].set(0,0,0);let H=0,U=0,B=0,Z=0,X=0,ee=0,se=0,ve=0,Ce=0,Ve=0;M.sort(Ble);const ce=!0===A?Math.PI:1;for(let At=0,ni=M.length;At<ni;At++){const ht=M[At],_t=ht.color,Tt=ht.intensity,at=ht.distance,ot=ht.shadow&&ht.shadow.map?ht.shadow.map.texture:null;if(ht.isAmbientLight)I+=_t.r*Tt*ce,R+=_t.g*Tt*ce,O+=_t.b*Tt*ce;else if(ht.isLightProbe)for(let dt=0;dt<9;dt++)r.probe[dt].addScaledVector(ht.sh.coefficients[dt],Tt);else if(ht.isDirectionalLight){const dt=e.get(ht);if(dt.color.copy(ht.color).multiplyScalar(ht.intensity*ce),ht.castShadow){const It=ht.shadow,Xt=n.get(ht);Xt.shadowBias=It.bias,Xt.shadowNormalBias=It.normalBias,Xt.shadowRadius=It.radius,Xt.shadowMapSize=It.mapSize,r.directionalShadow[H]=Xt,r.directionalShadowMap[H]=ot,r.directionalShadowMatrix[H]=ht.shadow.matrix,ee++}r.directional[H]=dt,H++}else if(ht.isSpotLight){const dt=e.get(ht);dt.position.setFromMatrixPosition(ht.matrixWorld),dt.color.copy(_t).multiplyScalar(Tt*ce),dt.distance=at,dt.coneCos=Math.cos(ht.angle),dt.penumbraCos=Math.cos(ht.angle*(1-ht.penumbra)),dt.decay=ht.decay,r.spot[B]=dt;const It=ht.shadow;if(ht.map&&(r.spotLightMap[Ce]=ht.map,Ce++,It.updateMatrices(ht),ht.castShadow&&Ve++),r.spotLightMatrix[B]=It.matrix,ht.castShadow){const Xt=n.get(ht);Xt.shadowBias=It.bias,Xt.shadowNormalBias=It.normalBias,Xt.shadowRadius=It.radius,Xt.shadowMapSize=It.mapSize,r.spotShadow[B]=Xt,r.spotShadowMap[B]=ot,ve++}B++}else if(ht.isRectAreaLight){const dt=e.get(ht);dt.color.copy(_t).multiplyScalar(Tt),dt.halfWidth.set(.5*ht.width,0,0),dt.halfHeight.set(0,.5*ht.height,0),r.rectArea[Z]=dt,Z++}else if(ht.isPointLight){const dt=e.get(ht);if(dt.color.copy(ht.color).multiplyScalar(ht.intensity*ce),dt.distance=ht.distance,dt.decay=ht.decay,ht.castShadow){const It=ht.shadow,Xt=n.get(ht);Xt.shadowBias=It.bias,Xt.shadowNormalBias=It.normalBias,Xt.shadowRadius=It.radius,Xt.shadowMapSize=It.mapSize,Xt.shadowCameraNear=It.camera.near,Xt.shadowCameraFar=It.camera.far,r.pointShadow[U]=Xt,r.pointShadowMap[U]=ot,r.pointShadowMatrix[U]=ht.shadow.matrix,se++}r.point[U]=dt,U++}else if(ht.isHemisphereLight){const dt=e.get(ht);dt.skyColor.copy(ht.color).multiplyScalar(Tt*ce),dt.groundColor.copy(ht.groundColor).multiplyScalar(Tt*ce),r.hemi[X]=dt,X++}}Z>0&&(t.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ni.LTC_FLOAT_1,r.rectAreaLTC2=Ni.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Ni.LTC_HALF_1,r.rectAreaLTC2=Ni.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=I,r.ambient[1]=R,r.ambient[2]=O;const we=r.hash;(we.directionalLength!==H||we.pointLength!==U||we.spotLength!==B||we.rectAreaLength!==Z||we.hemiLength!==X||we.numDirectionalShadows!==ee||we.numPointShadows!==se||we.numSpotShadows!==ve||we.numSpotMaps!==Ce)&&(r.directional.length=H,r.spot.length=B,r.rectArea.length=Z,r.point.length=U,r.hemi.length=X,r.directionalShadow.length=ee,r.directionalShadowMap.length=ee,r.pointShadow.length=se,r.pointShadowMap.length=se,r.spotShadow.length=ve,r.spotShadowMap.length=ve,r.directionalShadowMatrix.length=ee,r.pointShadowMatrix.length=se,r.spotLightMatrix.length=ve+Ce-Ve,r.spotLightMap.length=Ce,r.numSpotLightShadowsWithMaps=Ve,we.directionalLength=H,we.pointLength=U,we.spotLength=B,we.rectAreaLength=Z,we.hemiLength=X,we.numDirectionalShadows=ee,we.numPointShadows=se,we.numSpotShadows=ve,we.numSpotMaps=Ce,r.version=Nle++)},setupView:function y(M,A){let I=0,R=0,O=0,H=0,U=0;const B=A.matrixWorldInverse;for(let Z=0,X=M.length;Z<X;Z++){const ee=M[Z];if(ee.isDirectionalLight){const se=r.directional[I];se.direction.setFromMatrixPosition(ee.matrixWorld),o.setFromMatrixPosition(ee.target.matrixWorld),se.direction.sub(o),se.direction.transformDirection(B),I++}else if(ee.isSpotLight){const se=r.spot[O];se.position.setFromMatrixPosition(ee.matrixWorld),se.position.applyMatrix4(B),se.direction.setFromMatrixPosition(ee.matrixWorld),o.setFromMatrixPosition(ee.target.matrixWorld),se.direction.sub(o),se.direction.transformDirection(B),O++}else if(ee.isRectAreaLight){const se=r.rectArea[H];se.position.setFromMatrixPosition(ee.matrixWorld),se.position.applyMatrix4(B),u.identity(),a.copy(ee.matrixWorld),a.premultiply(B),u.extractRotation(a),se.halfWidth.set(.5*ee.width,0,0),se.halfHeight.set(0,.5*ee.height,0),se.halfWidth.applyMatrix4(u),se.halfHeight.applyMatrix4(u),H++}else if(ee.isPointLight){const se=r.point[R];se.position.setFromMatrixPosition(ee.matrixWorld),se.position.applyMatrix4(B),R++}else if(ee.isHemisphereLight){const se=r.hemi[U];se.direction.setFromMatrixPosition(ee.matrixWorld),se.direction.transformDirection(B),U++}}},state:r}}function uH(i,t){const e=new zle(i,t),n=[],r=[];return{init:function o(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:e},setupLights:function f(A){e.setup(n,A)},setupLightsView:function y(A){e.setupView(n,A)},pushLight:function a(A){n.push(A)},pushShadow:function u(A){r.push(A)}}}function Ule(i,t){let e=new WeakMap;return{get:function n(o,a=0){const u=e.get(o);let f;return void 0===u?(f=new uH(i,t),e.set(o,[f])):a>=u.length?(f=new uH(i,t),u.push(f)):f=u[a],f},dispose:function r(){e=new WeakMap}}}class hH extends v1{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class pH extends v1{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function Gle(i,t,e){let n=new Y2;const r=new ei,o=new ei,a=new bs,u=new hH({depthPacking:3201}),f=new pH,y={},M=e.maxTextureSize,A={0:1,1:0,2:2},I=new Cv({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ei},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),R=I.clone();R.defines.HORIZONTAL_PASS=1;const O=new po;O.setAttribute("position",new zc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const H=new Hd(O,I),U=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=S4;let B=this.type;function Z(se,ve){const Ce=t.update(H);I.defines.VSM_SAMPLES!==se.blurSamples&&(I.defines.VSM_SAMPLES=se.blurSamples,R.defines.VSM_SAMPLES=se.blurSamples,I.needsUpdate=!0,R.needsUpdate=!0),null===se.mapPass&&(se.mapPass=new H0(r.x,r.y)),I.uniforms.shadow_pass.value=se.map.texture,I.uniforms.resolution.value=se.mapSize,I.uniforms.radius.value=se.radius,i.setRenderTarget(se.mapPass),i.clear(),i.renderBufferDirect(ve,null,Ce,I,H,null),R.uniforms.shadow_pass.value=se.mapPass.texture,R.uniforms.resolution.value=se.mapSize,R.uniforms.radius.value=se.radius,i.setRenderTarget(se.map),i.clear(),i.renderBufferDirect(ve,null,Ce,R,H,null)}function X(se,ve,Ce,Ve){let ce=null;const we=!0===Ce.isPointLight?se.customDistanceMaterial:se.customDepthMaterial;if(void 0!==we)ce=we;else if(ce=!0===Ce.isPointLight?f:u,i.localClippingEnabled&&!0===ve.clipShadows&&Array.isArray(ve.clippingPlanes)&&0!==ve.clippingPlanes.length||ve.displacementMap&&0!==ve.displacementScale||ve.alphaMap&&ve.alphaTest>0||ve.map&&ve.alphaTest>0){const At=ce.uuid,ni=ve.uuid;let ht=y[At];void 0===ht&&(ht={},y[At]=ht);let _t=ht[ni];void 0===_t&&(_t=ce.clone(),ht[ni]=_t),ce=_t}return ce.visible=ve.visible,ce.wireframe=ve.wireframe,ce.side=Ve===I_?null!==ve.shadowSide?ve.shadowSide:ve.side:null!==ve.shadowSide?ve.shadowSide:A[ve.side],ce.alphaMap=ve.alphaMap,ce.alphaTest=ve.alphaTest,ce.map=ve.map,ce.clipShadows=ve.clipShadows,ce.clippingPlanes=ve.clippingPlanes,ce.clipIntersection=ve.clipIntersection,ce.displacementMap=ve.displacementMap,ce.displacementScale=ve.displacementScale,ce.displacementBias=ve.displacementBias,ce.wireframeLinewidth=ve.wireframeLinewidth,ce.linewidth=ve.linewidth,!0===Ce.isPointLight&&!0===ce.isMeshDistanceMaterial&&(i.properties.get(ce).light=Ce),ce}function ee(se,ve,Ce,Ve,ce){if(!1===se.visible)return;if(se.layers.test(ve.layers)&&(se.isMesh||se.isLine||se.isPoints)&&(se.castShadow||se.receiveShadow&&ce===I_)&&(!se.frustumCulled||n.intersectsObject(se))){se.modelViewMatrix.multiplyMatrices(Ce.matrixWorldInverse,se.matrixWorld);const ni=t.update(se),ht=se.material;if(Array.isArray(ht)){const _t=ni.groups;for(let Tt=0,at=_t.length;Tt<at;Tt++){const ot=_t[Tt],dt=ht[ot.materialIndex];if(dt&&dt.visible){const It=X(se,dt,Ve,ce);i.renderBufferDirect(Ce,null,ni,It,se,ot)}}}else if(ht.visible){const _t=X(se,ht,Ve,ce);i.renderBufferDirect(Ce,null,ni,_t,se,null)}}const At=se.children;for(let ni=0,ht=At.length;ni<ht;ni++)ee(At[ni],ve,Ce,Ve,ce)}this.render=function(se,ve,Ce){if(!1===U.enabled||!1===U.autoUpdate&&!1===U.needsUpdate||0===se.length)return;const Ve=i.getRenderTarget(),ce=i.getActiveCubeFace(),we=i.getActiveMipmapLevel(),At=i.state;At.setBlending(0),At.buffers.color.setClear(1,1,1,1),At.buffers.depth.setTest(!0),At.setScissorTest(!1);const ni=B!==I_&&this.type===I_,ht=B===I_&&this.type!==I_;for(let _t=0,Tt=se.length;_t<Tt;_t++){const at=se[_t],ot=at.shadow;if(void 0===ot){console.warn("THREE.WebGLShadowMap:",at,"has no shadow.");continue}if(!1===ot.autoUpdate&&!1===ot.needsUpdate)continue;r.copy(ot.mapSize);const dt=ot.getFrameExtents();if(r.multiply(dt),o.copy(ot.mapSize),(r.x>M||r.y>M)&&(r.x>M&&(o.x=Math.floor(M/dt.x),r.x=o.x*dt.x,ot.mapSize.x=o.x),r.y>M&&(o.y=Math.floor(M/dt.y),r.y=o.y*dt.y,ot.mapSize.y=o.y)),null===ot.map||!0===ni||!0===ht){const Xt=this.type!==I_?{minFilter:$l,magFilter:$l}:{};null!==ot.map&&ot.map.dispose(),ot.map=new H0(r.x,r.y,Xt),ot.map.texture.name=at.name+".shadowMap",ot.camera.updateProjectionMatrix()}i.setRenderTarget(ot.map),i.clear();const It=ot.getViewportCount();for(let Xt=0;Xt<It;Xt++){const ut=ot.getViewport(Xt);a.set(o.x*ut.x,o.y*ut.y,o.x*ut.z,o.y*ut.w),At.viewport(a),ot.updateMatrices(at,Xt),n=ot.getFrustum(),ee(ve,Ce,ot.camera,at,this.type)}!0!==ot.isPointLightShadow&&this.type===I_&&Z(ot,Ce),ot.needsUpdate=!1}B=this.type,U.needsUpdate=!1,i.setRenderTarget(Ve,ce,we)}}function jle(i,t,e){const n=e.isWebGL2,u=new function r(){let qe=!1;const Wi=new bs;let Ft=null;const Pi=new bs(0,0,0,0);return{setMask:function(Ki){Ft!==Ki&&!qe&&(i.colorMask(Ki,Ki,Ki,Ki),Ft=Ki)},setLocked:function(Ki){qe=Ki},setClear:function(Ki,Xo,Ia,Vc,vg){!0===vg&&(Ki*=Vc,Xo*=Vc,Ia*=Vc),Wi.set(Ki,Xo,Ia,Vc),!1===Pi.equals(Wi)&&(i.clearColor(Ki,Xo,Ia,Vc),Pi.copy(Wi))},reset:function(){qe=!1,Ft=null,Pi.set(-1,0,0,0)}}},f=new function o(){let qe=!1,Wi=null,Ft=null,Pi=null;return{setTest:function(Ki){Ki?Yi(i.DEPTH_TEST):mn(i.DEPTH_TEST)},setMask:function(Ki){Wi!==Ki&&!qe&&(i.depthMask(Ki),Wi=Ki)},setFunc:function(Ki){if(Ft!==Ki){switch(Ki){case 0:i.depthFunc(i.NEVER);break;case 1:i.depthFunc(i.ALWAYS);break;case 2:i.depthFunc(i.LESS);break;case 3:default:i.depthFunc(i.LEQUAL);break;case 4:i.depthFunc(i.EQUAL);break;case 5:i.depthFunc(i.GEQUAL);break;case 6:i.depthFunc(i.GREATER);break;case 7:i.depthFunc(i.NOTEQUAL)}Ft=Ki}},setLocked:function(Ki){qe=Ki},setClear:function(Ki){Pi!==Ki&&(i.clearDepth(Ki),Pi=Ki)},reset:function(){qe=!1,Wi=null,Ft=null,Pi=null}}},y=new function a(){let qe=!1,Wi=null,Ft=null,Pi=null,Ki=null,Xo=null,Ia=null,Vc=null,vg=null;return{setTest:function(tl){qe||(tl?Yi(i.STENCIL_TEST):mn(i.STENCIL_TEST))},setMask:function(tl){Wi!==tl&&!qe&&(i.stencilMask(tl),Wi=tl)},setFunc:function(tl,bg,Lu){(Ft!==tl||Pi!==bg||Ki!==Lu)&&(i.stencilFunc(tl,bg,Lu),Ft=tl,Pi=bg,Ki=Lu)},setOp:function(tl,bg,Lu){(Xo!==tl||Ia!==bg||Vc!==Lu)&&(i.stencilOp(tl,bg,Lu),Xo=tl,Ia=bg,Vc=Lu)},setLocked:function(tl){qe=tl},setClear:function(tl){vg!==tl&&(i.clearStencil(tl),vg=tl)},reset:function(){qe=!1,Wi=null,Ft=null,Pi=null,Ki=null,Xo=null,Ia=null,Vc=null,vg=null}}},M=new WeakMap,A=new WeakMap;let I={},R={},O=new WeakMap,H=[],U=null,B=!1,Z=null,X=null,ee=null,se=null,ve=null,Ce=null,Ve=null,ce=!1,we=null,At=null,ni=null,ht=null,_t=null;const Tt=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let at=!1,ot=0;const dt=i.getParameter(i.VERSION);-1!==dt.indexOf("WebGL")?(ot=parseFloat(/^WebGL (\d)/.exec(dt)[1]),at=ot>=1):-1!==dt.indexOf("OpenGL ES")&&(ot=parseFloat(/^OpenGL ES (\d)/.exec(dt)[1]),at=ot>=2);let It=null,Xt={};const ut=i.getParameter(i.SCISSOR_BOX),zt=i.getParameter(i.VIEWPORT),Ti=(new bs).fromArray(ut),gi=(new bs).fromArray(zt);function Vi(qe,Wi,Ft,Pi){const Ki=new Uint8Array(4),Xo=i.createTexture();i.bindTexture(qe,Xo),i.texParameteri(qe,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(qe,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Ia=0;Ia<Ft;Ia++)!n||qe!==i.TEXTURE_3D&&qe!==i.TEXTURE_2D_ARRAY?i.texImage2D(Wi+Ia,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Ki):i.texImage3D(Wi,0,i.RGBA,1,1,Pi,0,i.RGBA,i.UNSIGNED_BYTE,Ki);return Xo}const kn={};function Yi(qe){!0!==I[qe]&&(i.enable(qe),I[qe]=!0)}function mn(qe){!1!==I[qe]&&(i.disable(qe),I[qe]=!1)}kn[i.TEXTURE_2D]=Vi(i.TEXTURE_2D,i.TEXTURE_2D,1),kn[i.TEXTURE_CUBE_MAP]=Vi(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(kn[i.TEXTURE_2D_ARRAY]=Vi(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),kn[i.TEXTURE_3D]=Vi(i.TEXTURE_3D,i.TEXTURE_3D,1,1)),u.setClear(0,0,0,1),f.setClear(1),y.setClear(0),Yi(i.DEPTH_TEST),f.setFunc(3),di(!1),Fn(1),Yi(i.CULL_FACE),ti(0);const Ue={100:i.FUNC_ADD,101:i.FUNC_SUBTRACT,102:i.FUNC_REVERSE_SUBTRACT};if(n)Ue[103]=i.MIN,Ue[104]=i.MAX;else{const qe=t.get("EXT_blend_minmax");null!==qe&&(Ue[103]=qe.MIN_EXT,Ue[104]=qe.MAX_EXT)}const ki={200:i.ZERO,201:i.ONE,202:i.SRC_COLOR,204:i.SRC_ALPHA,210:i.SRC_ALPHA_SATURATE,208:i.DST_COLOR,206:i.DST_ALPHA,203:i.ONE_MINUS_SRC_COLOR,205:i.ONE_MINUS_SRC_ALPHA,209:i.ONE_MINUS_DST_COLOR,207:i.ONE_MINUS_DST_ALPHA};function ti(qe,Wi,Ft,Pi,Ki,Xo,Ia,Vc){if(0!==qe){if(!1===B&&(Yi(i.BLEND),B=!0),5===qe)Ki=Ki||Wi,Xo=Xo||Ft,Ia=Ia||Pi,(Wi!==X||Ki!==ve)&&(i.blendEquationSeparate(Ue[Wi],Ue[Ki]),X=Wi,ve=Ki),(Ft!==ee||Pi!==se||Xo!==Ce||Ia!==Ve)&&(i.blendFuncSeparate(ki[Ft],ki[Pi],ki[Xo],ki[Ia]),ee=Ft,se=Pi,Ce=Xo,Ve=Ia),Z=qe,ce=!1;else if(qe!==Z||Vc!==ce){if((100!==X||100!==ve)&&(i.blendEquation(i.FUNC_ADD),X=100,ve=100),Vc)switch(qe){case 1:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case 2:i.blendFunc(i.ONE,i.ONE);break;case 3:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case 4:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",qe)}else switch(qe){case 1:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case 2:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case 3:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case 4:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",qe)}ee=null,se=null,Ce=null,Ve=null,Z=qe,ce=Vc}}else!0===B&&(mn(i.BLEND),B=!1)}function di(qe){we!==qe&&(i.frontFace(qe?i.CW:i.CCW),we=qe)}function Fn(qe){0!==qe?(Yi(i.CULL_FACE),qe!==At&&i.cullFace(1===qe?i.BACK:2===qe?i.FRONT:i.FRONT_AND_BACK)):mn(i.CULL_FACE),At=qe}function un(qe,Wi,Ft){qe?(Yi(i.POLYGON_OFFSET_FILL),(ht!==Wi||_t!==Ft)&&(i.polygonOffset(Wi,Ft),ht=Wi,_t=Ft)):mn(i.POLYGON_OFFSET_FILL)}return{buffers:{color:u,depth:f,stencil:y},enable:Yi,disable:mn,bindFramebuffer:function mr(qe,Wi){return R[qe]!==Wi&&(i.bindFramebuffer(qe,Wi),R[qe]=Wi,n&&(qe===i.DRAW_FRAMEBUFFER&&(R[i.FRAMEBUFFER]=Wi),qe===i.FRAMEBUFFER&&(R[i.DRAW_FRAMEBUFFER]=Wi)),!0)},drawBuffers:function qo(qe,Wi){let Ft=H,Pi=!1;if(qe)if(Ft=O.get(Wi),void 0===Ft&&(Ft=[],O.set(Wi,Ft)),qe.isWebGLMultipleRenderTargets){const Ki=qe.texture;if(Ft.length!==Ki.length||Ft[0]!==i.COLOR_ATTACHMENT0){for(let Xo=0,Ia=Ki.length;Xo<Ia;Xo++)Ft[Xo]=i.COLOR_ATTACHMENT0+Xo;Ft.length=Ki.length,Pi=!0}}else Ft[0]!==i.COLOR_ATTACHMENT0&&(Ft[0]=i.COLOR_ATTACHMENT0,Pi=!0);else Ft[0]!==i.BACK&&(Ft[0]=i.BACK,Pi=!0);Pi&&(e.isWebGL2?i.drawBuffers(Ft):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ft))},useProgram:function Kn(qe){return U!==qe&&(i.useProgram(qe),U=qe,!0)},setBlending:ti,setMaterial:function Ci(qe,Wi){2===qe.side?mn(i.CULL_FACE):Yi(i.CULL_FACE);let Ft=1===qe.side;Wi&&(Ft=!Ft),di(Ft),1===qe.blending&&!1===qe.transparent?ti(0):ti(qe.blending,qe.blendEquation,qe.blendSrc,qe.blendDst,qe.blendEquationAlpha,qe.blendSrcAlpha,qe.blendDstAlpha,qe.premultipliedAlpha),f.setFunc(qe.depthFunc),f.setTest(qe.depthTest),f.setMask(qe.depthWrite),u.setMask(qe.colorWrite);const Pi=qe.stencilWrite;y.setTest(Pi),Pi&&(y.setMask(qe.stencilWriteMask),y.setFunc(qe.stencilFunc,qe.stencilRef,qe.stencilFuncMask),y.setOp(qe.stencilFail,qe.stencilZFail,qe.stencilZPass)),un(qe.polygonOffset,qe.polygonOffsetFactor,qe.polygonOffsetUnits),!0===qe.alphaToCoverage?Yi(i.SAMPLE_ALPHA_TO_COVERAGE):mn(i.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:di,setCullFace:Fn,setLineWidth:function on(qe){qe!==ni&&(at&&i.lineWidth(qe),ni=qe)},setPolygonOffset:un,setScissorTest:function gr(qe){qe?Yi(i.SCISSOR_TEST):mn(i.SCISSOR_TEST)},activeTexture:function fo(qe){void 0===qe&&(qe=i.TEXTURE0+Tt-1),It!==qe&&(i.activeTexture(qe),It=qe)},bindTexture:function ba(qe,Wi,Ft){void 0===Ft&&(Ft=null===It?i.TEXTURE0+Tt-1:It);let Pi=Xt[Ft];void 0===Pi&&(Pi={type:void 0,texture:void 0},Xt[Ft]=Pi),(Pi.type!==qe||Pi.texture!==Wi)&&(It!==Ft&&(i.activeTexture(Ft),It=Ft),i.bindTexture(qe,Wi||kn[qe]),Pi.type=qe,Pi.texture=Wi)},unbindTexture:function Re(){const qe=Xt[It];void 0!==qe&&void 0!==qe.type&&(i.bindTexture(qe.type,null),qe.type=void 0,qe.texture=void 0)},compressedTexImage2D:function ye(){try{i.compressedTexImage2D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},compressedTexImage3D:function Ht(){try{i.compressedTexImage3D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},texImage2D:function gn(){try{i.texImage2D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},texImage3D:function Vn(){try{i.texImage3D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},updateUBOMapping:function hn(qe,Wi){let Ft=A.get(Wi);void 0===Ft&&(Ft=new WeakMap,A.set(Wi,Ft));let Pi=Ft.get(qe);void 0===Pi&&(Pi=i.getUniformBlockIndex(Wi,qe.name),Ft.set(qe,Pi))},uniformBlockBinding:function _r(qe,Wi){const Pi=A.get(Wi).get(qe);M.get(Wi)!==Pi&&(i.uniformBlockBinding(Wi,Pi,qe.__bindingPointIndex),M.set(Wi,Pi))},texStorage2D:function vi(){try{i.texStorage2D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},texStorage3D:function Dt(){try{i.texStorage3D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},texSubImage2D:function Ei(){try{i.texSubImage2D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},texSubImage3D:function wi(){try{i.texSubImage3D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},compressedTexSubImage2D:function ze(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},compressedTexSubImage3D:function hi(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}},scissor:function Tn(qe){!1===Ti.equals(qe)&&(i.scissor(qe.x,qe.y,qe.z,qe.w),Ti.copy(qe))},viewport:function yn(qe){!1===gi.equals(qe)&&(i.viewport(qe.x,qe.y,qe.z,qe.w),gi.copy(qe))},reset:function Eo(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),!0===n&&(i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),I={},It=null,Xt={},R={},O=new WeakMap,H=[],U=null,B=!1,Z=null,X=null,ee=null,se=null,ve=null,Ce=null,Ve=null,ce=!1,we=null,At=null,ni=null,ht=null,_t=null,Ti.set(0,0,i.canvas.width,i.canvas.height),gi.set(0,0,i.canvas.width,i.canvas.height),u.reset(),f.reset(),y.reset()}}}function Wle(i,t,e,n,r,o,a){const u=r.isWebGL2,f=r.maxTextures,y=r.maxCubemapSize,M=r.maxTextureSize,A=r.maxSamples,I=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,R=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),O=new WeakMap;let H;const U=new WeakMap;let B=!1;try{B=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function Z(Re,ye){return B?new OffscreenCanvas(Re,ye):_C("canvas")}function X(Re,ye,Ht,Ei){let wi=1;if((Re.width>Ei||Re.height>Ei)&&(wi=Ei/Math.max(Re.width,Re.height)),wi<1||!0===ye){if(typeof HTMLImageElement<"u"&&Re instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Re instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Re instanceof ImageBitmap){const ze=ye?vA:Math.floor,hi=ze(wi*Re.width),vi=ze(wi*Re.height);void 0===H&&(H=Z(hi,vi));const Dt=Ht?Z(hi,vi):H;return Dt.width=hi,Dt.height=vi,Dt.getContext("2d").drawImage(Re,0,0,hi,vi),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Re.width+"x"+Re.height+") to ("+hi+"x"+vi+")."),Dt}return"data"in Re&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Re.width+"x"+Re.height+")."),Re}return Re}function ee(Re){return D2(Re.width)&&D2(Re.height)}function ve(Re,ye){return Re.generateMipmaps&&ye&&Re.minFilter!==$l&&Re.minFilter!==ql}function Ce(Re){i.generateMipmap(Re)}function Ve(Re,ye,Ht,Ei,wi=!1){if(!1===u)return ye;if(null!==Re){if(void 0!==i[Re])return i[Re];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Re+"'")}let ze=ye;return ye===i.RED&&(Ht===i.FLOAT&&(ze=i.R32F),Ht===i.HALF_FLOAT&&(ze=i.R16F),Ht===i.UNSIGNED_BYTE&&(ze=i.R8)),ye===i.RG&&(Ht===i.FLOAT&&(ze=i.RG32F),Ht===i.HALF_FLOAT&&(ze=i.RG16F),Ht===i.UNSIGNED_BYTE&&(ze=i.RG8)),ye===i.RGBA&&(Ht===i.FLOAT&&(ze=i.RGBA32F),Ht===i.HALF_FLOAT&&(ze=i.RGBA16F),Ht===i.UNSIGNED_BYTE&&(ze=Ei===Hr&&!1===wi?i.SRGB8_ALPHA8:i.RGBA8),Ht===i.UNSIGNED_SHORT_4_4_4_4&&(ze=i.RGBA4),Ht===i.UNSIGNED_SHORT_5_5_5_1&&(ze=i.RGB5_A1)),(ze===i.R16F||ze===i.R32F||ze===i.RG16F||ze===i.RG32F||ze===i.RGBA16F||ze===i.RGBA32F)&&t.get("EXT_color_buffer_float"),ze}function ce(Re,ye,Ht){return!0===ve(Re,Ht)||Re.isFramebufferTexture&&Re.minFilter!==$l&&Re.minFilter!==ql?Math.log2(Math.max(ye.width,ye.height))+1:void 0!==Re.mipmaps&&Re.mipmaps.length>0?Re.mipmaps.length:Re.isCompressedTexture&&Array.isArray(Re.image)?ye.mipmaps.length:1}function we(Re){return Re===$l||1004===Re||1005===Re?i.NEAREST:i.LINEAR}function At(Re){const ye=Re.target;ye.removeEventListener("dispose",At),function ht(Re){const ye=n.get(Re);if(void 0===ye.__webglInit)return;const Ht=Re.source,Ei=U.get(Ht);if(Ei){const wi=Ei[ye.__cacheKey];wi.usedTimes--,0===wi.usedTimes&&_t(Re),0===Object.keys(Ei).length&&U.delete(Ht)}n.remove(Re)}(ye),ye.isVideoTexture&&O.delete(ye)}function ni(Re){const ye=Re.target;ye.removeEventListener("dispose",ni),function Tt(Re){const ye=Re.texture,Ht=n.get(Re),Ei=n.get(ye);if(void 0!==Ei.__webglTexture&&(i.deleteTexture(Ei.__webglTexture),a.memory.textures--),Re.depthTexture&&Re.depthTexture.dispose(),Re.isWebGLCubeRenderTarget)for(let wi=0;wi<6;wi++)i.deleteFramebuffer(Ht.__webglFramebuffer[wi]),Ht.__webglDepthbuffer&&i.deleteRenderbuffer(Ht.__webglDepthbuffer[wi]);else{if(i.deleteFramebuffer(Ht.__webglFramebuffer),Ht.__webglDepthbuffer&&i.deleteRenderbuffer(Ht.__webglDepthbuffer),Ht.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Ht.__webglMultisampledFramebuffer),Ht.__webglColorRenderbuffer)for(let wi=0;wi<Ht.__webglColorRenderbuffer.length;wi++)Ht.__webglColorRenderbuffer[wi]&&i.deleteRenderbuffer(Ht.__webglColorRenderbuffer[wi]);Ht.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Ht.__webglDepthRenderbuffer)}if(Re.isWebGLMultipleRenderTargets)for(let wi=0,ze=ye.length;wi<ze;wi++){const hi=n.get(ye[wi]);hi.__webglTexture&&(i.deleteTexture(hi.__webglTexture),a.memory.textures--),n.remove(ye[wi])}n.remove(ye),n.remove(Re)}(ye)}function _t(Re){const ye=n.get(Re);i.deleteTexture(ye.__webglTexture),delete U.get(Re.source)[ye.__cacheKey],a.memory.textures--}let at=0;function Xt(Re,ye){const Ht=n.get(Re);if(Re.isVideoTexture&&function fo(Re){const ye=a.render.frame;O.get(Re)!==ye&&(O.set(Re,ye),Re.update())}(Re),!1===Re.isRenderTargetTexture&&Re.version>0&&Ht.__version!==Re.version){const Ei=Re.image;if(null===Ei)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Ei.complete)return void mr(Ht,Re,ye);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}e.bindTexture(i.TEXTURE_2D,Ht.__webglTexture,i.TEXTURE0+ye)}const gi={1e3:i.REPEAT,[Du]:i.CLAMP_TO_EDGE,1002:i.MIRRORED_REPEAT},Vi={[$l]:i.NEAREST,1004:i.NEAREST_MIPMAP_NEAREST,1005:i.NEAREST_MIPMAP_LINEAR,[ql]:i.LINEAR,1007:i.LINEAR_MIPMAP_NEAREST,[L0]:i.LINEAR_MIPMAP_LINEAR},kn={512:i.NEVER,519:i.ALWAYS,513:i.LESS,515:i.LEQUAL,514:i.EQUAL,518:i.GEQUAL,516:i.GREATER,517:i.NOTEQUAL};function Yi(Re,ye,Ht){if(Ht?(i.texParameteri(Re,i.TEXTURE_WRAP_S,gi[ye.wrapS]),i.texParameteri(Re,i.TEXTURE_WRAP_T,gi[ye.wrapT]),(Re===i.TEXTURE_3D||Re===i.TEXTURE_2D_ARRAY)&&i.texParameteri(Re,i.TEXTURE_WRAP_R,gi[ye.wrapR]),i.texParameteri(Re,i.TEXTURE_MAG_FILTER,Vi[ye.magFilter]),i.texParameteri(Re,i.TEXTURE_MIN_FILTER,Vi[ye.minFilter])):(i.texParameteri(Re,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(Re,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),(Re===i.TEXTURE_3D||Re===i.TEXTURE_2D_ARRAY)&&i.texParameteri(Re,i.TEXTURE_WRAP_R,i.CLAMP_TO_EDGE),(ye.wrapS!==Du||ye.wrapT!==Du)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(Re,i.TEXTURE_MAG_FILTER,we(ye.magFilter)),i.texParameteri(Re,i.TEXTURE_MIN_FILTER,we(ye.minFilter)),ye.minFilter!==$l&&ye.minFilter!==ql&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),ye.compareFunction&&(i.texParameteri(Re,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(Re,i.TEXTURE_COMPARE_FUNC,kn[ye.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){const Ei=t.get("EXT_texture_filter_anisotropic");if(ye.magFilter===$l||1005!==ye.minFilter&&ye.minFilter!==L0||ye.type===P_&&!1===t.has("OES_texture_float_linear")||!1===u&&ye.type===mC&&!1===t.has("OES_texture_half_float_linear"))return;(ye.anisotropy>1||n.get(ye).__currentAnisotropy)&&(i.texParameterf(Re,Ei.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ye.anisotropy,r.getMaxAnisotropy())),n.get(ye).__currentAnisotropy=ye.anisotropy)}}function mn(Re,ye){let Ht=!1;void 0===Re.__webglInit&&(Re.__webglInit=!0,ye.addEventListener("dispose",At));const Ei=ye.source;let wi=U.get(Ei);void 0===wi&&(wi={},U.set(Ei,wi));const ze=function It(Re){const ye=[];return ye.push(Re.wrapS),ye.push(Re.wrapT),ye.push(Re.wrapR||0),ye.push(Re.magFilter),ye.push(Re.minFilter),ye.push(Re.anisotropy),ye.push(Re.internalFormat),ye.push(Re.format),ye.push(Re.type),ye.push(Re.generateMipmaps),ye.push(Re.premultiplyAlpha),ye.push(Re.flipY),ye.push(Re.unpackAlignment),ye.push(Re.colorSpace),ye.join()}(ye);if(ze!==Re.__cacheKey){void 0===wi[ze]&&(wi[ze]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,Ht=!0),wi[ze].usedTimes++;const hi=wi[Re.__cacheKey];void 0!==hi&&(wi[Re.__cacheKey].usedTimes--,0===hi.usedTimes&&_t(ye)),Re.__cacheKey=ze,Re.__webglTexture=wi[ze].texture}return Ht}function mr(Re,ye,Ht){let Ei=i.TEXTURE_2D;(ye.isDataArrayTexture||ye.isCompressedArrayTexture)&&(Ei=i.TEXTURE_2D_ARRAY),ye.isData3DTexture&&(Ei=i.TEXTURE_3D);const wi=mn(Re,ye),ze=ye.source;e.bindTexture(Ei,Re.__webglTexture,i.TEXTURE0+Ht);const hi=n.get(ze);if(ze.version!==hi.__version||!0===wi){e.activeTexture(i.TEXTURE0+Ht),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,ye.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ye.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,ye.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE);const vi=function se(Re){return!u&&(Re.wrapS!==Du||Re.wrapT!==Du||Re.minFilter!==$l&&Re.minFilter!==ql)}(ye)&&!1===ee(ye.image);let Dt=X(ye.image,vi,!1,M);Dt=ba(ye,Dt);const gn=ee(Dt)||u,Vn=o.convert(ye.format,ye.colorSpace);let hn,Tn=o.convert(ye.type),yn=Ve(ye.internalFormat,Vn,Tn,ye.colorSpace);Yi(Ei,ye,gn);const _r=ye.mipmaps,Eo=u&&!0!==ye.isVideoTexture,qe=void 0===hi.__version||!0===wi,Wi=ce(ye,Dt,gn);if(ye.isDepthTexture)yn=i.DEPTH_COMPONENT,u?yn=ye.type===P_?i.DEPTH_COMPONENT32F:ye.type===vv?i.DEPTH_COMPONENT24:ye.type===F0?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT16:ye.type===P_&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ye.format===O0&&yn===i.DEPTH_COMPONENT&&1012!==ye.type&&ye.type!==vv&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ye.type=vv,Tn=o.convert(ye.type)),ye.format===n1&&yn===i.DEPTH_COMPONENT&&(yn=i.DEPTH_STENCIL,ye.type!==F0&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ye.type=F0,Tn=o.convert(ye.type))),qe&&(Eo?e.texStorage2D(i.TEXTURE_2D,1,yn,Dt.width,Dt.height):e.texImage2D(i.TEXTURE_2D,0,yn,Dt.width,Dt.height,0,Vn,Tn,null));else if(ye.isDataTexture)if(_r.length>0&&gn){Eo&&qe&&e.texStorage2D(i.TEXTURE_2D,Wi,yn,_r[0].width,_r[0].height);for(let Ft=0,Pi=_r.length;Ft<Pi;Ft++)hn=_r[Ft],Eo?e.texSubImage2D(i.TEXTURE_2D,Ft,0,0,hn.width,hn.height,Vn,Tn,hn.data):e.texImage2D(i.TEXTURE_2D,Ft,yn,hn.width,hn.height,0,Vn,Tn,hn.data);ye.generateMipmaps=!1}else Eo?(qe&&e.texStorage2D(i.TEXTURE_2D,Wi,yn,Dt.width,Dt.height),e.texSubImage2D(i.TEXTURE_2D,0,0,0,Dt.width,Dt.height,Vn,Tn,Dt.data)):e.texImage2D(i.TEXTURE_2D,0,yn,Dt.width,Dt.height,0,Vn,Tn,Dt.data);else if(ye.isCompressedTexture)if(ye.isCompressedArrayTexture){Eo&&qe&&e.texStorage3D(i.TEXTURE_2D_ARRAY,Wi,yn,_r[0].width,_r[0].height,Dt.depth);for(let Ft=0,Pi=_r.length;Ft<Pi;Ft++)hn=_r[Ft],ye.format!==df?null!==Vn?Eo?e.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ft,0,0,0,hn.width,hn.height,Dt.depth,Vn,hn.data,0,0):e.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Ft,yn,hn.width,hn.height,Dt.depth,0,hn.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Eo?e.texSubImage3D(i.TEXTURE_2D_ARRAY,Ft,0,0,0,hn.width,hn.height,Dt.depth,Vn,Tn,hn.data):e.texImage3D(i.TEXTURE_2D_ARRAY,Ft,yn,hn.width,hn.height,Dt.depth,0,Vn,Tn,hn.data)}else{Eo&&qe&&e.texStorage2D(i.TEXTURE_2D,Wi,yn,_r[0].width,_r[0].height);for(let Ft=0,Pi=_r.length;Ft<Pi;Ft++)hn=_r[Ft],ye.format!==df?null!==Vn?Eo?e.compressedTexSubImage2D(i.TEXTURE_2D,Ft,0,0,hn.width,hn.height,Vn,hn.data):e.compressedTexImage2D(i.TEXTURE_2D,Ft,yn,hn.width,hn.height,0,hn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Eo?e.texSubImage2D(i.TEXTURE_2D,Ft,0,0,hn.width,hn.height,Vn,Tn,hn.data):e.texImage2D(i.TEXTURE_2D,Ft,yn,hn.width,hn.height,0,Vn,Tn,hn.data)}else if(ye.isDataArrayTexture)Eo?(qe&&e.texStorage3D(i.TEXTURE_2D_ARRAY,Wi,yn,Dt.width,Dt.height,Dt.depth),e.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Dt.width,Dt.height,Dt.depth,Vn,Tn,Dt.data)):e.texImage3D(i.TEXTURE_2D_ARRAY,0,yn,Dt.width,Dt.height,Dt.depth,0,Vn,Tn,Dt.data);else if(ye.isData3DTexture)Eo?(qe&&e.texStorage3D(i.TEXTURE_3D,Wi,yn,Dt.width,Dt.height,Dt.depth),e.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Dt.width,Dt.height,Dt.depth,Vn,Tn,Dt.data)):e.texImage3D(i.TEXTURE_3D,0,yn,Dt.width,Dt.height,Dt.depth,0,Vn,Tn,Dt.data);else if(ye.isFramebufferTexture){if(qe)if(Eo)e.texStorage2D(i.TEXTURE_2D,Wi,yn,Dt.width,Dt.height);else{let Ft=Dt.width,Pi=Dt.height;for(let Ki=0;Ki<Wi;Ki++)e.texImage2D(i.TEXTURE_2D,Ki,yn,Ft,Pi,0,Vn,Tn,null),Ft>>=1,Pi>>=1}}else if(_r.length>0&&gn){Eo&&qe&&e.texStorage2D(i.TEXTURE_2D,Wi,yn,_r[0].width,_r[0].height);for(let Ft=0,Pi=_r.length;Ft<Pi;Ft++)hn=_r[Ft],Eo?e.texSubImage2D(i.TEXTURE_2D,Ft,0,0,Vn,Tn,hn):e.texImage2D(i.TEXTURE_2D,Ft,yn,Vn,Tn,hn);ye.generateMipmaps=!1}else Eo?(qe&&e.texStorage2D(i.TEXTURE_2D,Wi,yn,Dt.width,Dt.height),e.texSubImage2D(i.TEXTURE_2D,0,0,0,Vn,Tn,Dt)):e.texImage2D(i.TEXTURE_2D,0,yn,Vn,Tn,Dt);ve(ye,gn)&&Ce(Ei),hi.__version=ze.version,ye.onUpdate&&ye.onUpdate(ye)}Re.__version=ye.version}function Kn(Re,ye,Ht,Ei,wi){const ze=o.convert(Ht.format,Ht.colorSpace),hi=o.convert(Ht.type),vi=Ve(Ht.internalFormat,ze,hi,Ht.colorSpace);n.get(ye).__hasExternalTextures||(wi===i.TEXTURE_3D||wi===i.TEXTURE_2D_ARRAY?e.texImage3D(wi,0,vi,ye.width,ye.height,ye.depth,0,ze,hi,null):e.texImage2D(wi,0,vi,ye.width,ye.height,0,ze,hi,null)),e.bindFramebuffer(i.FRAMEBUFFER,Re),gr(ye)?I.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Ei,wi,n.get(Ht).__webglTexture,0,un(ye)):(wi===i.TEXTURE_2D||wi>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&wi<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Ei,wi,n.get(Ht).__webglTexture,0),e.bindFramebuffer(i.FRAMEBUFFER,null)}function Ue(Re,ye,Ht){if(i.bindRenderbuffer(i.RENDERBUFFER,Re),ye.depthBuffer&&!ye.stencilBuffer){let Ei=i.DEPTH_COMPONENT16;if(Ht||gr(ye)){const wi=ye.depthTexture;wi&&wi.isDepthTexture&&(wi.type===P_?Ei=i.DEPTH_COMPONENT32F:wi.type===vv&&(Ei=i.DEPTH_COMPONENT24));const ze=un(ye);gr(ye)?I.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,ze,Ei,ye.width,ye.height):i.renderbufferStorageMultisample(i.RENDERBUFFER,ze,Ei,ye.width,ye.height)}else i.renderbufferStorage(i.RENDERBUFFER,Ei,ye.width,ye.height);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,Re)}else if(ye.depthBuffer&&ye.stencilBuffer){const Ei=un(ye);Ht&&!1===gr(ye)?i.renderbufferStorageMultisample(i.RENDERBUFFER,Ei,i.DEPTH24_STENCIL8,ye.width,ye.height):gr(ye)?I.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Ei,i.DEPTH24_STENCIL8,ye.width,ye.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,ye.width,ye.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,Re)}else{const Ei=!0===ye.isWebGLMultipleRenderTargets?ye.texture:[ye.texture];for(let wi=0;wi<Ei.length;wi++){const ze=Ei[wi],hi=o.convert(ze.format,ze.colorSpace),vi=o.convert(ze.type),Dt=Ve(ze.internalFormat,hi,vi,ze.colorSpace),gn=un(ye);Ht&&!1===gr(ye)?i.renderbufferStorageMultisample(i.RENDERBUFFER,gn,Dt,ye.width,ye.height):gr(ye)?I.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,gn,Dt,ye.width,ye.height):i.renderbufferStorage(i.RENDERBUFFER,Dt,ye.width,ye.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function ti(Re){const ye=n.get(Re),Ht=!0===Re.isWebGLCubeRenderTarget;if(Re.depthTexture&&!ye.__autoAllocateDepthBuffer){if(Ht)throw new Error("target.depthTexture not supported in Cube render targets");!function ki(Re,ye){if(ye&&ye.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(i.FRAMEBUFFER,Re),!ye.depthTexture||!ye.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(ye.depthTexture).__webglTexture||ye.depthTexture.image.width!==ye.width||ye.depthTexture.image.height!==ye.height)&&(ye.depthTexture.image.width=ye.width,ye.depthTexture.image.height=ye.height,ye.depthTexture.needsUpdate=!0),Xt(ye.depthTexture,0);const Ei=n.get(ye.depthTexture).__webglTexture,wi=un(ye);if(ye.depthTexture.format===O0)gr(ye)?I.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Ei,0,wi):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Ei,0);else{if(ye.depthTexture.format!==n1)throw new Error("Unknown depthTexture format");gr(ye)?I.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Ei,0,wi):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Ei,0)}}(ye.__webglFramebuffer,Re)}else if(Ht){ye.__webglDepthbuffer=[];for(let Ei=0;Ei<6;Ei++)e.bindFramebuffer(i.FRAMEBUFFER,ye.__webglFramebuffer[Ei]),ye.__webglDepthbuffer[Ei]=i.createRenderbuffer(),Ue(ye.__webglDepthbuffer[Ei],Re,!1)}else e.bindFramebuffer(i.FRAMEBUFFER,ye.__webglFramebuffer),ye.__webglDepthbuffer=i.createRenderbuffer(),Ue(ye.__webglDepthbuffer,Re,!1);e.bindFramebuffer(i.FRAMEBUFFER,null)}function un(Re){return Math.min(A,Re.samples)}function gr(Re){const ye=n.get(Re);return u&&Re.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==ye.__useRenderToTexture}function ba(Re,ye){const Ht=Re.colorSpace,Ei=Re.format,wi=Re.type;return!0===Re.isCompressedTexture||1035===Re.format||Ht!==pg&&""!==Ht&&(Ht===Hr?!1===u?!0===t.has("EXT_sRGB")&&Ei===df?(Re.format=1035,Re.minFilter=ql,Re.generateMipmaps=!1):ye=v5.sRGBToLinear(ye):(Ei!==df||wi!==yv)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ht)),ye}this.allocateTextureUnit=function dt(){const Re=at;return Re>=f&&console.warn("THREE.WebGLTextures: Trying to use "+Re+" texture units while this GPU supports only "+f),at+=1,Re},this.resetTextureUnits=function ot(){at=0},this.setTexture2D=Xt,this.setTexture2DArray=function ut(Re,ye){const Ht=n.get(Re);Re.version>0&&Ht.__version!==Re.version?mr(Ht,Re,ye):e.bindTexture(i.TEXTURE_2D_ARRAY,Ht.__webglTexture,i.TEXTURE0+ye)},this.setTexture3D=function zt(Re,ye){const Ht=n.get(Re);Re.version>0&&Ht.__version!==Re.version?mr(Ht,Re,ye):e.bindTexture(i.TEXTURE_3D,Ht.__webglTexture,i.TEXTURE0+ye)},this.setTextureCube=function Ti(Re,ye){const Ht=n.get(Re);Re.version>0&&Ht.__version!==Re.version?function qo(Re,ye,Ht){if(6!==ye.image.length)return;const Ei=mn(Re,ye),wi=ye.source;e.bindTexture(i.TEXTURE_CUBE_MAP,Re.__webglTexture,i.TEXTURE0+Ht);const ze=n.get(wi);if(wi.version!==ze.__version||!0===Ei){e.activeTexture(i.TEXTURE0+Ht),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,ye.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ye.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,ye.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE);const hi=ye.isCompressedTexture||ye.image[0].isCompressedTexture,vi=ye.image[0]&&ye.image[0].isDataTexture,Dt=[];for(let Ft=0;Ft<6;Ft++)Dt[Ft]=hi||vi?vi?ye.image[Ft].image:ye.image[Ft]:X(ye.image[Ft],!1,!0,y),Dt[Ft]=ba(ye,Dt[Ft]);const gn=Dt[0],Vn=ee(gn)||u,Tn=o.convert(ye.format,ye.colorSpace),yn=o.convert(ye.type),hn=Ve(ye.internalFormat,Tn,yn,ye.colorSpace),_r=u&&!0!==ye.isVideoTexture,Eo=void 0===ze.__version||!0===Ei;let Wi,qe=ce(ye,gn,Vn);if(Yi(i.TEXTURE_CUBE_MAP,ye,Vn),hi){_r&&Eo&&e.texStorage2D(i.TEXTURE_CUBE_MAP,qe,hn,gn.width,gn.height);for(let Ft=0;Ft<6;Ft++){Wi=Dt[Ft].mipmaps;for(let Pi=0;Pi<Wi.length;Pi++){const Ki=Wi[Pi];ye.format!==df?null!==Tn?_r?e.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Pi,0,0,Ki.width,Ki.height,Tn,Ki.data):e.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Pi,hn,Ki.width,Ki.height,0,Ki.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_r?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Pi,0,0,Ki.width,Ki.height,Tn,yn,Ki.data):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Pi,hn,Ki.width,Ki.height,0,Tn,yn,Ki.data)}}}else{Wi=ye.mipmaps,_r&&Eo&&(Wi.length>0&&qe++,e.texStorage2D(i.TEXTURE_CUBE_MAP,qe,hn,Dt[0].width,Dt[0].height));for(let Ft=0;Ft<6;Ft++)if(vi){_r?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,0,0,0,Dt[Ft].width,Dt[Ft].height,Tn,yn,Dt[Ft].data):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,0,hn,Dt[Ft].width,Dt[Ft].height,0,Tn,yn,Dt[Ft].data);for(let Pi=0;Pi<Wi.length;Pi++){const Xo=Wi[Pi].image[Ft].image;_r?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Pi+1,0,0,Xo.width,Xo.height,Tn,yn,Xo.data):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Pi+1,hn,Xo.width,Xo.height,0,Tn,yn,Xo.data)}}else{_r?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,0,0,0,Tn,yn,Dt[Ft]):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,0,hn,Tn,yn,Dt[Ft]);for(let Pi=0;Pi<Wi.length;Pi++){const Ki=Wi[Pi];_r?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Pi+1,0,0,Tn,yn,Ki.image[Ft]):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Pi+1,hn,Tn,yn,Ki.image[Ft])}}}ve(ye,Vn)&&Ce(i.TEXTURE_CUBE_MAP),ze.__version=wi.version,ye.onUpdate&&ye.onUpdate(ye)}Re.__version=ye.version}(Ht,Re,ye):e.bindTexture(i.TEXTURE_CUBE_MAP,Ht.__webglTexture,i.TEXTURE0+ye)},this.rebindTextures=function Ci(Re,ye,Ht){const Ei=n.get(Re);void 0!==ye&&Kn(Ei.__webglFramebuffer,Re,Re.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D),void 0!==Ht&&ti(Re)},this.setupRenderTarget=function di(Re){const ye=Re.texture,Ht=n.get(Re),Ei=n.get(ye);Re.addEventListener("dispose",ni),!0!==Re.isWebGLMultipleRenderTargets&&(void 0===Ei.__webglTexture&&(Ei.__webglTexture=i.createTexture()),Ei.__version=ye.version,a.memory.textures++);const wi=!0===Re.isWebGLCubeRenderTarget,ze=!0===Re.isWebGLMultipleRenderTargets,hi=ee(Re)||u;if(wi){Ht.__webglFramebuffer=[];for(let vi=0;vi<6;vi++)Ht.__webglFramebuffer[vi]=i.createFramebuffer()}else{if(Ht.__webglFramebuffer=i.createFramebuffer(),ze)if(r.drawBuffers){const vi=Re.texture;for(let Dt=0,gn=vi.length;Dt<gn;Dt++){const Vn=n.get(vi[Dt]);void 0===Vn.__webglTexture&&(Vn.__webglTexture=i.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(u&&Re.samples>0&&!1===gr(Re)){const vi=ze?ye:[ye];Ht.__webglMultisampledFramebuffer=i.createFramebuffer(),Ht.__webglColorRenderbuffer=[],e.bindFramebuffer(i.FRAMEBUFFER,Ht.__webglMultisampledFramebuffer);for(let Dt=0;Dt<vi.length;Dt++){const gn=vi[Dt];Ht.__webglColorRenderbuffer[Dt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,Ht.__webglColorRenderbuffer[Dt]);const Vn=o.convert(gn.format,gn.colorSpace),Tn=o.convert(gn.type),yn=Ve(gn.internalFormat,Vn,Tn,gn.colorSpace,!0===Re.isXRRenderTarget),hn=un(Re);i.renderbufferStorageMultisample(i.RENDERBUFFER,hn,yn,Re.width,Re.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Dt,i.RENDERBUFFER,Ht.__webglColorRenderbuffer[Dt])}i.bindRenderbuffer(i.RENDERBUFFER,null),Re.depthBuffer&&(Ht.__webglDepthRenderbuffer=i.createRenderbuffer(),Ue(Ht.__webglDepthRenderbuffer,Re,!0)),e.bindFramebuffer(i.FRAMEBUFFER,null)}}if(wi){e.bindTexture(i.TEXTURE_CUBE_MAP,Ei.__webglTexture),Yi(i.TEXTURE_CUBE_MAP,ye,hi);for(let vi=0;vi<6;vi++)Kn(Ht.__webglFramebuffer[vi],Re,ye,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+vi);ve(ye,hi)&&Ce(i.TEXTURE_CUBE_MAP),e.unbindTexture()}else if(ze){const vi=Re.texture;for(let Dt=0,gn=vi.length;Dt<gn;Dt++){const Vn=vi[Dt],Tn=n.get(Vn);e.bindTexture(i.TEXTURE_2D,Tn.__webglTexture),Yi(i.TEXTURE_2D,Vn,hi),Kn(Ht.__webglFramebuffer,Re,Vn,i.COLOR_ATTACHMENT0+Dt,i.TEXTURE_2D),ve(Vn,hi)&&Ce(i.TEXTURE_2D)}e.unbindTexture()}else{let vi=i.TEXTURE_2D;(Re.isWebGL3DRenderTarget||Re.isWebGLArrayRenderTarget)&&(u?vi=Re.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),e.bindTexture(vi,Ei.__webglTexture),Yi(vi,ye,hi),Kn(Ht.__webglFramebuffer,Re,ye,i.COLOR_ATTACHMENT0,vi),ve(ye,hi)&&Ce(vi),e.unbindTexture()}Re.depthBuffer&&ti(Re)},this.updateRenderTargetMipmap=function Fn(Re){const ye=ee(Re)||u,Ht=!0===Re.isWebGLMultipleRenderTargets?Re.texture:[Re.texture];for(let Ei=0,wi=Ht.length;Ei<wi;Ei++){const ze=Ht[Ei];if(ve(ze,ye)){const hi=Re.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,vi=n.get(ze).__webglTexture;e.bindTexture(hi,vi),Ce(hi),e.unbindTexture()}}},this.updateMultisampleRenderTarget=function on(Re){if(u&&Re.samples>0&&!1===gr(Re)){const ye=Re.isWebGLMultipleRenderTargets?Re.texture:[Re.texture],Ht=Re.width,Ei=Re.height;let wi=i.COLOR_BUFFER_BIT;const ze=[],hi=Re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,vi=n.get(Re),Dt=!0===Re.isWebGLMultipleRenderTargets;if(Dt)for(let gn=0;gn<ye.length;gn++)e.bindFramebuffer(i.FRAMEBUFFER,vi.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+gn,i.RENDERBUFFER,null),e.bindFramebuffer(i.FRAMEBUFFER,vi.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+gn,i.TEXTURE_2D,null,0);e.bindFramebuffer(i.READ_FRAMEBUFFER,vi.__webglMultisampledFramebuffer),e.bindFramebuffer(i.DRAW_FRAMEBUFFER,vi.__webglFramebuffer);for(let gn=0;gn<ye.length;gn++){ze.push(i.COLOR_ATTACHMENT0+gn),Re.depthBuffer&&ze.push(hi);const Vn=void 0!==vi.__ignoreDepthValues&&vi.__ignoreDepthValues;if(!1===Vn&&(Re.depthBuffer&&(wi|=i.DEPTH_BUFFER_BIT),Re.stencilBuffer&&(wi|=i.STENCIL_BUFFER_BIT)),Dt&&i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,vi.__webglColorRenderbuffer[gn]),!0===Vn&&(i.invalidateFramebuffer(i.READ_FRAMEBUFFER,[hi]),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[hi])),Dt){const Tn=n.get(ye[gn]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Tn,0)}i.blitFramebuffer(0,0,Ht,Ei,0,0,Ht,Ei,wi,i.NEAREST),R&&i.invalidateFramebuffer(i.READ_FRAMEBUFFER,ze)}if(e.bindFramebuffer(i.READ_FRAMEBUFFER,null),e.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Dt)for(let gn=0;gn<ye.length;gn++){e.bindFramebuffer(i.FRAMEBUFFER,vi.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+gn,i.RENDERBUFFER,vi.__webglColorRenderbuffer[gn]);const Vn=n.get(ye[gn]).__webglTexture;e.bindFramebuffer(i.FRAMEBUFFER,vi.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+gn,i.TEXTURE_2D,Vn,0)}e.bindFramebuffer(i.DRAW_FRAMEBUFFER,vi.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ti,this.setupFrameBufferTexture=Kn,this.useMultisampledRTT=gr}function $le(i,t,e){const n=e.isWebGL2;return{convert:function r(o,a=""){let u;if(o===yv)return i.UNSIGNED_BYTE;if(1017===o)return i.UNSIGNED_SHORT_4_4_4_4;if(1018===o)return i.UNSIGNED_SHORT_5_5_5_1;if(1010===o)return i.BYTE;if(1011===o)return i.SHORT;if(1012===o)return i.UNSIGNED_SHORT;if(1013===o)return i.INT;if(o===vv)return i.UNSIGNED_INT;if(o===P_)return i.FLOAT;if(o===mC)return n?i.HALF_FLOAT:(u=t.get("OES_texture_half_float"),null!==u?u.HALF_FLOAT_OES:null);if(1021===o)return i.ALPHA;if(o===df)return i.RGBA;if(1024===o)return i.LUMINANCE;if(1025===o)return i.LUMINANCE_ALPHA;if(o===O0)return i.DEPTH_COMPONENT;if(o===n1)return i.DEPTH_STENCIL;if(1035===o)return u=t.get("EXT_sRGB"),null!==u?u.SRGB_ALPHA_EXT:null;if(1028===o)return i.RED;if(1029===o)return i.RED_INTEGER;if(1030===o)return i.RG;if(1031===o)return i.RG_INTEGER;if(1033===o)return i.RGBA_INTEGER;if(33776===o||33777===o||33778===o||33779===o)if(a===Hr){if(u=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===u)return null;if(33776===o)return u.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===o)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===o)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===o)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(u=t.get("WEBGL_compressed_texture_s3tc"),null===u)return null;if(33776===o)return u.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===o)return u.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===o)return u.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===o)return u.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===o||35841===o||35842===o||35843===o){if(u=t.get("WEBGL_compressed_texture_pvrtc"),null===u)return null;if(35840===o)return u.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===o)return u.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===o)return u.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===o)return u.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===o)return u=t.get("WEBGL_compressed_texture_etc1"),null!==u?u.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===o||37496===o){if(u=t.get("WEBGL_compressed_texture_etc"),null===u)return null;if(37492===o)return a===Hr?u.COMPRESSED_SRGB8_ETC2:u.COMPRESSED_RGB8_ETC2;if(37496===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:u.COMPRESSED_RGBA8_ETC2_EAC}if(37808===o||37809===o||37810===o||37811===o||37812===o||37813===o||37814===o||37815===o||37816===o||37817===o||37818===o||37819===o||37820===o||37821===o){if(u=t.get("WEBGL_compressed_texture_astc"),null===u)return null;if(37808===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:u.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:u.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:u.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:u.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:u.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:u.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:u.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:u.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:u.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:u.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:u.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:u.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:u.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===o)return a===Hr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:u.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===o){if(u=t.get("EXT_texture_compression_bptc"),null===u)return null;if(36492===o)return a===Hr?u.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:u.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===o||36284===o||36285===o||36286===o){if(u=t.get("EXT_texture_compression_rgtc"),null===u)return null;if(36492===o)return u.COMPRESSED_RED_RGTC1_EXT;if(36284===o)return u.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===o)return u.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===o)return u.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return o===F0?n?i.UNSIGNED_INT_24_8:(u=t.get("WEBGL_depth_texture"),null!==u?u.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[o]?i[o]:null}}}class qle extends hd{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class SC extends mp{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Xle={type:"move"};class nP{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new SC,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new SC,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ee),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new SC,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ee),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let r=null,o=null,a=null;const u=this._targetRay,f=this._grip,y=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(y&&t.hand){a=!0;for(const H of t.hand.values()){const U=e.getJointPose(H,n),B=this._getHandJoint(y,H);null!==U&&(B.matrix.fromArray(U.transform.matrix),B.matrix.decompose(B.position,B.rotation,B.scale),B.matrixWorldNeedsUpdate=!0,B.jointRadius=U.radius),B.visible=null!==U}const I=y.joints["index-finger-tip"].position.distanceTo(y.joints["thumb-tip"].position),R=.02,O=.005;y.inputState.pinching&&I>R+O?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!y.inputState.pinching&&I<=R-O&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==f&&t.gripSpace&&(o=e.getPose(t.gripSpace,n),null!==o&&(f.matrix.fromArray(o.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,o.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(o.linearVelocity)):f.hasLinearVelocity=!1,o.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(o.angularVelocity)):f.hasAngularVelocity=!1));null!==u&&(r=e.getPose(t.targetRaySpace,n),null===r&&null!==o&&(r=o),null!==r&&(u.matrix.fromArray(r.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,r.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(r.linearVelocity)):u.hasLinearVelocity=!1,r.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(r.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(Xle)))}return null!==u&&(u.visible=null!==r),null!==f&&(f.visible=null!==o),null!==y&&(y.visible=null!==a),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const n=new SC;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}}class Zle extends bv{constructor(t,e,n,r,o,a,u,f,y,M){if((M=void 0!==M?M:O0)!==O0&&M!==n1)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&M===O0&&(n=vv),void 0===n&&M===n1&&(n=F0),super(null,r,o,a,u,f,M,n,y),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==u?u:$l,this.minFilter=void 0!==f?f:$l,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}class Yle extends U0{constructor(t,e){super();const n=this;let r=null,o=1,a=null,u="local-floor",f=1,y=null,M=null,A=null,I=null,R=null,O=null;const H=e.getContextAttributes();let U=null,B=null;const Z=[],X=[],ee=new hd;ee.layers.enable(1),ee.viewport=new bs;const se=new hd;se.layers.enable(2),se.viewport=new bs;const ve=[ee,se],Ce=new qle;Ce.layers.enable(1),Ce.layers.enable(2);let Ve=null,ce=null;function we(ut){const zt=X.indexOf(ut.inputSource);if(-1===zt)return;const Ti=Z[zt];void 0!==Ti&&(Ti.update(ut.inputSource,ut.frame,y||a),Ti.dispatchEvent({type:ut.type,data:ut.inputSource}))}function At(){r.removeEventListener("select",we),r.removeEventListener("selectstart",we),r.removeEventListener("selectend",we),r.removeEventListener("squeeze",we),r.removeEventListener("squeezestart",we),r.removeEventListener("squeezeend",we),r.removeEventListener("end",At),r.removeEventListener("inputsourceschange",ni);for(let ut=0;ut<Z.length;ut++){const zt=X[ut];null!==zt&&(X[ut]=null,Z[ut].disconnect(zt))}Ve=null,ce=null,t.setRenderTarget(U),R=null,I=null,A=null,r=null,B=null,Xt.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function ni(ut){for(let zt=0;zt<ut.removed.length;zt++){const Ti=ut.removed[zt],gi=X.indexOf(Ti);gi>=0&&(X[gi]=null,Z[gi].disconnect(Ti))}for(let zt=0;zt<ut.added.length;zt++){const Ti=ut.added[zt];let gi=X.indexOf(Ti);if(-1===gi){for(let kn=0;kn<Z.length;kn++){if(kn>=X.length){X.push(Ti),gi=kn;break}if(null===X[kn]){X[kn]=Ti,gi=kn;break}}if(-1===gi)break}const Vi=Z[gi];Vi&&Vi.connect(Ti)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ut){let zt=Z[ut];return void 0===zt&&(zt=new nP,Z[ut]=zt),zt.getTargetRaySpace()},this.getControllerGrip=function(ut){let zt=Z[ut];return void 0===zt&&(zt=new nP,Z[ut]=zt),zt.getGripSpace()},this.getHand=function(ut){let zt=Z[ut];return void 0===zt&&(zt=new nP,Z[ut]=zt),zt.getHandSpace()},this.setFramebufferScaleFactor=function(ut){o=ut,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ut){u=ut,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y||a},this.setReferenceSpace=function(ut){y=ut},this.getBaseLayer=function(){return null!==I?I:R},this.getBinding=function(){return A},this.getFrame=function(){return O},this.getSession=function(){return r},this.setSession=function(){var ut=function gne(i){return function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(f){E4(o,n,r,a,u,"next",f)}function u(f){E4(o,n,r,a,u,"throw",f)}a(void 0)})}}(function*(zt){if(r=zt,null!==r){if(U=t.getRenderTarget(),r.addEventListener("select",we),r.addEventListener("selectstart",we),r.addEventListener("selectend",we),r.addEventListener("squeeze",we),r.addEventListener("squeezestart",we),r.addEventListener("squeezeend",we),r.addEventListener("end",At),r.addEventListener("inputsourceschange",ni),!0!==H.xrCompatible&&(yield e.makeXRCompatible()),void 0===r.renderState.layers||!1===t.capabilities.isWebGL2)R=new XRWebGLLayer(r,e,{antialias:void 0!==r.renderState.layers||H.antialias,alpha:!0,depth:H.depth,stencil:H.stencil,framebufferScaleFactor:o}),r.updateRenderState({baseLayer:R}),B=new H0(R.framebufferWidth,R.framebufferHeight,{format:df,type:yv,colorSpace:t.outputColorSpace,stencilBuffer:H.stencil});else{let Ti=null,gi=null,Vi=null;H.depth&&(Vi=H.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,Ti=H.stencil?n1:O0,gi=H.stencil?F0:vv);const kn={colorFormat:e.RGBA8,depthFormat:Vi,scaleFactor:o};A=new XRWebGLBinding(r,e),I=A.createProjectionLayer(kn),r.updateRenderState({layers:[I]}),B=new H0(I.textureWidth,I.textureHeight,{format:df,type:yv,depthTexture:new Zle(I.textureWidth,I.textureHeight,gi,void 0,void 0,void 0,void 0,void 0,void 0,Ti),stencilBuffer:H.stencil,colorSpace:t.outputColorSpace,samples:H.antialias?4:0}),t.properties.get(B).__ignoreDepthValues=I.ignoreDepthValues}B.isXRRenderTarget=!0,this.setFoveation(f),y=null,a=yield r.requestReferenceSpace(u),Xt.setContext(r),Xt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(zt){return ut.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const ht=new Ee,_t=new Ee;function at(ut,zt){null===zt?ut.matrixWorld.copy(ut.matrix):ut.matrixWorld.multiplyMatrices(zt.matrixWorld,ut.matrix),ut.matrixWorldInverse.copy(ut.matrixWorld).invert()}this.updateCamera=function(ut){if(null===r)return;Ce.near=se.near=ee.near=ut.near,Ce.far=se.far=ee.far=ut.far,(Ve!==Ce.near||ce!==Ce.far)&&(r.updateRenderState({depthNear:Ce.near,depthFar:Ce.far}),Ve=Ce.near,ce=Ce.far);const zt=ut.parent,Ti=Ce.cameras;at(Ce,zt);for(let gi=0;gi<Ti.length;gi++)at(Ti[gi],zt);2===Ti.length?function Tt(ut,zt,Ti){ht.setFromMatrixPosition(zt.matrixWorld),_t.setFromMatrixPosition(Ti.matrixWorld);const gi=ht.distanceTo(_t),Vi=zt.projectionMatrix.elements,kn=Ti.projectionMatrix.elements,Yi=Vi[14]/(Vi[10]-1),mn=Vi[14]/(Vi[10]+1),mr=(Vi[9]+1)/Vi[5],qo=(Vi[9]-1)/Vi[5],Kn=(Vi[8]-1)/Vi[0],Ue=(kn[8]+1)/kn[0],ki=Yi*Kn,ti=Yi*Ue,Ci=gi/(-Kn+Ue),di=Ci*-Kn;zt.matrixWorld.decompose(ut.position,ut.quaternion,ut.scale),ut.translateX(di),ut.translateZ(Ci),ut.matrixWorld.compose(ut.position,ut.quaternion,ut.scale),ut.matrixWorldInverse.copy(ut.matrixWorld).invert();const Fn=Yi+Ci,on=mn+Ci;ut.projectionMatrix.makePerspective(ki-di,ti+(gi-di),mr*mn/on*Fn,qo*mn/on*Fn,Fn,on),ut.projectionMatrixInverse.copy(ut.projectionMatrix).invert()}(Ce,ee,se):Ce.projectionMatrix.copy(ee.projectionMatrix),function ot(ut,zt,Ti){null===Ti?ut.matrix.copy(zt.matrixWorld):(ut.matrix.copy(Ti.matrixWorld),ut.matrix.invert(),ut.matrix.multiply(zt.matrixWorld)),ut.matrix.decompose(ut.position,ut.quaternion,ut.scale),ut.updateMatrixWorld(!0);const gi=ut.children;for(let Vi=0,kn=gi.length;Vi<kn;Vi++)gi[Vi].updateMatrixWorld(!0);ut.projectionMatrix.copy(zt.projectionMatrix),ut.projectionMatrixInverse.copy(zt.projectionMatrixInverse),ut.isPerspectiveCamera&&(ut.fov=2*s1*Math.atan(1/ut.projectionMatrix.elements[5]),ut.zoom=1)}(ut,Ce,zt)},this.getCamera=function(){return Ce},this.getFoveation=function(){if(null!==I||null!==R)return f},this.setFoveation=function(ut){f=ut,null!==I&&(I.fixedFoveation=ut),null!==R&&void 0!==R.fixedFoveation&&(R.fixedFoveation=ut)};let dt=null;const Xt=new z5;Xt.setAnimationLoop(function It(ut,zt){if(M=zt.getViewerPose(y||a),O=zt,null!==M){const Ti=M.views;null!==R&&(t.setRenderTargetFramebuffer(B,R.framebuffer),t.setRenderTarget(B));let gi=!1;Ti.length!==Ce.cameras.length&&(Ce.cameras.length=0,gi=!0);for(let Vi=0;Vi<Ti.length;Vi++){const kn=Ti[Vi];let Yi=null;if(null!==R)Yi=R.getViewport(kn);else{const mr=A.getViewSubImage(I,kn);Yi=mr.viewport,0===Vi&&(t.setRenderTargetTextures(B,mr.colorTexture,I.ignoreDepthValues?void 0:mr.depthStencilTexture),t.setRenderTarget(B))}let mn=ve[Vi];void 0===mn&&(mn=new hd,mn.layers.enable(Vi),mn.viewport=new bs,ve[Vi]=mn),mn.matrix.fromArray(kn.transform.matrix),mn.matrix.decompose(mn.position,mn.quaternion,mn.scale),mn.projectionMatrix.fromArray(kn.projectionMatrix),mn.projectionMatrixInverse.copy(mn.projectionMatrix).invert(),mn.viewport.set(Yi.x,Yi.y,Yi.width,Yi.height),0===Vi&&(Ce.matrix.copy(mn.matrix),Ce.matrix.decompose(Ce.position,Ce.quaternion,Ce.scale)),!0===gi&&Ce.cameras.push(mn)}}for(let Ti=0;Ti<Z.length;Ti++){const gi=X[Ti],Vi=Z[Ti];null!==gi&&void 0!==Vi&&Vi.update(gi,zt,y||a)}dt&&dt(ut,zt),zt.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:zt}),O=null}),this.setAnimationLoop=function(ut){dt=ut},this.dispose=function(){}}}function Kle(i,t){function e(U,B){!0===U.matrixAutoUpdate&&U.updateMatrix(),B.value.copy(U.matrix)}function o(U,B){U.opacity.value=B.opacity,B.color&&U.diffuse.value.copy(B.color),B.emissive&&U.emissive.value.copy(B.emissive).multiplyScalar(B.emissiveIntensity),B.map&&(U.map.value=B.map,e(B.map,U.mapTransform)),B.alphaMap&&(U.alphaMap.value=B.alphaMap,e(B.alphaMap,U.alphaMapTransform)),B.bumpMap&&(U.bumpMap.value=B.bumpMap,e(B.bumpMap,U.bumpMapTransform),U.bumpScale.value=B.bumpScale,1===B.side&&(U.bumpScale.value*=-1)),B.normalMap&&(U.normalMap.value=B.normalMap,e(B.normalMap,U.normalMapTransform),U.normalScale.value.copy(B.normalScale),1===B.side&&U.normalScale.value.negate()),B.displacementMap&&(U.displacementMap.value=B.displacementMap,e(B.displacementMap,U.displacementMapTransform),U.displacementScale.value=B.displacementScale,U.displacementBias.value=B.displacementBias),B.emissiveMap&&(U.emissiveMap.value=B.emissiveMap,e(B.emissiveMap,U.emissiveMapTransform)),B.specularMap&&(U.specularMap.value=B.specularMap,e(B.specularMap,U.specularMapTransform)),B.alphaTest>0&&(U.alphaTest.value=B.alphaTest);const Z=t.get(B).envMap;if(Z&&(U.envMap.value=Z,U.flipEnvMap.value=Z.isCubeTexture&&!1===Z.isRenderTargetTexture?-1:1,U.reflectivity.value=B.reflectivity,U.ior.value=B.ior,U.refractionRatio.value=B.refractionRatio),B.lightMap){U.lightMap.value=B.lightMap;const X=!0===i.useLegacyLights?Math.PI:1;U.lightMapIntensity.value=B.lightMapIntensity*X,e(B.lightMap,U.lightMapTransform)}B.aoMap&&(U.aoMap.value=B.aoMap,U.aoMapIntensity.value=B.aoMapIntensity,e(B.aoMap,U.aoMapTransform))}return{refreshFogUniforms:function n(U,B){B.color.getRGB(U.fogColor.value,B5(i)),B.isFog?(U.fogNear.value=B.near,U.fogFar.value=B.far):B.isFogExp2&&(U.fogDensity.value=B.density)},refreshMaterialUniforms:function r(U,B,Z,X,ee){B.isMeshBasicMaterial||B.isMeshLambertMaterial?o(U,B):B.isMeshToonMaterial?(o(U,B),function A(U,B){B.gradientMap&&(U.gradientMap.value=B.gradientMap)}(U,B)):B.isMeshPhongMaterial?(o(U,B),function M(U,B){U.specular.value.copy(B.specular),U.shininess.value=Math.max(B.shininess,1e-4)}(U,B)):B.isMeshStandardMaterial?(o(U,B),function I(U,B){U.metalness.value=B.metalness,B.metalnessMap&&(U.metalnessMap.value=B.metalnessMap,e(B.metalnessMap,U.metalnessMapTransform)),U.roughness.value=B.roughness,B.roughnessMap&&(U.roughnessMap.value=B.roughnessMap,e(B.roughnessMap,U.roughnessMapTransform)),t.get(B).envMap&&(U.envMapIntensity.value=B.envMapIntensity)}(U,B),B.isMeshPhysicalMaterial&&function R(U,B,Z){U.ior.value=B.ior,B.sheen>0&&(U.sheenColor.value.copy(B.sheenColor).multiplyScalar(B.sheen),U.sheenRoughness.value=B.sheenRoughness,B.sheenColorMap&&(U.sheenColorMap.value=B.sheenColorMap,e(B.sheenColorMap,U.sheenColorMapTransform)),B.sheenRoughnessMap&&(U.sheenRoughnessMap.value=B.sheenRoughnessMap,e(B.sheenRoughnessMap,U.sheenRoughnessMapTransform))),B.clearcoat>0&&(U.clearcoat.value=B.clearcoat,U.clearcoatRoughness.value=B.clearcoatRoughness,B.clearcoatMap&&(U.clearcoatMap.value=B.clearcoatMap,e(B.clearcoatMap,U.clearcoatMapTransform)),B.clearcoatRoughnessMap&&(U.clearcoatRoughnessMap.value=B.clearcoatRoughnessMap,e(B.clearcoatRoughnessMap,U.clearcoatRoughnessMapTransform)),B.clearcoatNormalMap&&(U.clearcoatNormalMap.value=B.clearcoatNormalMap,e(B.clearcoatNormalMap,U.clearcoatNormalMapTransform),U.clearcoatNormalScale.value.copy(B.clearcoatNormalScale),1===B.side&&U.clearcoatNormalScale.value.negate())),B.iridescence>0&&(U.iridescence.value=B.iridescence,U.iridescenceIOR.value=B.iridescenceIOR,U.iridescenceThicknessMinimum.value=B.iridescenceThicknessRange[0],U.iridescenceThicknessMaximum.value=B.iridescenceThicknessRange[1],B.iridescenceMap&&(U.iridescenceMap.value=B.iridescenceMap,e(B.iridescenceMap,U.iridescenceMapTransform)),B.iridescenceThicknessMap&&(U.iridescenceThicknessMap.value=B.iridescenceThicknessMap,e(B.iridescenceThicknessMap,U.iridescenceThicknessMapTransform))),B.transmission>0&&(U.transmission.value=B.transmission,U.transmissionSamplerMap.value=Z.texture,U.transmissionSamplerSize.value.set(Z.width,Z.height),B.transmissionMap&&(U.transmissionMap.value=B.transmissionMap,e(B.transmissionMap,U.transmissionMapTransform)),U.thickness.value=B.thickness,B.thicknessMap&&(U.thicknessMap.value=B.thicknessMap,e(B.thicknessMap,U.thicknessMapTransform)),U.attenuationDistance.value=B.attenuationDistance,U.attenuationColor.value.copy(B.attenuationColor)),B.anisotropy>0&&(U.anisotropyVector.value.set(B.anisotropy*Math.cos(B.anisotropyRotation),B.anisotropy*Math.sin(B.anisotropyRotation)),B.anisotropyMap&&(U.anisotropyMap.value=B.anisotropyMap,e(B.anisotropyMap,U.anisotropyMapTransform))),U.specularIntensity.value=B.specularIntensity,U.specularColor.value.copy(B.specularColor),B.specularColorMap&&(U.specularColorMap.value=B.specularColorMap,e(B.specularColorMap,U.specularColorMapTransform)),B.specularIntensityMap&&(U.specularIntensityMap.value=B.specularIntensityMap,e(B.specularIntensityMap,U.specularIntensityMapTransform))}(U,B,ee)):B.isMeshMatcapMaterial?(o(U,B),function O(U,B){B.matcap&&(U.matcap.value=B.matcap)}(U,B)):B.isMeshDepthMaterial?o(U,B):B.isMeshDistanceMaterial?(o(U,B),function H(U,B){const Z=t.get(B).light;U.referencePosition.value.setFromMatrixPosition(Z.matrixWorld),U.nearDistance.value=Z.shadow.camera.near,U.farDistance.value=Z.shadow.camera.far}(U,B)):B.isMeshNormalMaterial?o(U,B):B.isLineBasicMaterial?(function a(U,B){U.diffuse.value.copy(B.color),U.opacity.value=B.opacity,B.map&&(U.map.value=B.map,e(B.map,U.mapTransform))}(U,B),B.isLineDashedMaterial&&function u(U,B){U.dashSize.value=B.dashSize,U.totalSize.value=B.dashSize+B.gapSize,U.scale.value=B.scale}(U,B)):B.isPointsMaterial?function f(U,B,Z,X){U.diffuse.value.copy(B.color),U.opacity.value=B.opacity,U.size.value=B.size*Z,U.scale.value=.5*X,B.map&&(U.map.value=B.map,e(B.map,U.uvTransform)),B.alphaMap&&(U.alphaMap.value=B.alphaMap,e(B.alphaMap,U.alphaMapTransform)),B.alphaTest>0&&(U.alphaTest.value=B.alphaTest)}(U,B,Z,X):B.isSpriteMaterial?function y(U,B){U.diffuse.value.copy(B.color),U.opacity.value=B.opacity,U.rotation.value=B.rotation,B.map&&(U.map.value=B.map,e(B.map,U.mapTransform)),B.alphaMap&&(U.alphaMap.value=B.alphaMap,e(B.alphaMap,U.alphaMapTransform)),B.alphaTest>0&&(U.alphaTest.value=B.alphaTest)}(U,B):B.isShadowMaterial?(U.color.value.copy(B.color),U.opacity.value=B.opacity):B.isShaderMaterial&&(B.uniformsNeedUpdate=!1)}}}function Jle(i,t,e,n){let r={},o={},a=[];const u=e.isWebGL2?i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS):0;function R(Z,X,ee){const se=Z.value;if(void 0===ee[X]){if("number"==typeof se)ee[X]=se;else{const ve=Array.isArray(se)?se:[se],Ce=[];for(let Ve=0;Ve<ve.length;Ve++)Ce.push(ve[Ve].clone());ee[X]=Ce}return!0}if("number"==typeof se){if(ee[X]!==se)return ee[X]=se,!0}else{const ve=Array.isArray(ee[X])?ee[X]:[ee[X]],Ce=Array.isArray(se)?se:[se];for(let Ve=0;Ve<ve.length;Ve++){const ce=ve[Ve];if(!1===ce.equals(Ce[Ve]))return ce.copy(Ce[Ve]),!0}}return!1}function H(Z){const X={boundary:0,storage:0};return"number"==typeof Z?(X.boundary=4,X.storage=4):Z.isVector2?(X.boundary=8,X.storage=8):Z.isVector3||Z.isColor?(X.boundary=16,X.storage=12):Z.isVector4?(X.boundary=16,X.storage=16):Z.isMatrix3?(X.boundary=48,X.storage=48):Z.isMatrix4?(X.boundary=64,X.storage=64):Z.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Z),X}function U(Z){const X=Z.target;X.removeEventListener("dispose",U);const ee=a.indexOf(X.__bindingPointIndex);a.splice(ee,1),i.deleteBuffer(r[X.id]),delete r[X.id],delete o[X.id]}return{bind:function f(Z,X){n.uniformBlockBinding(Z,X.program)},update:function y(Z,X){let ee=r[Z.id];void 0===ee&&(function O(Z){const X=Z.uniforms;let ee=0;let ve=0;for(let Ce=0,Ve=X.length;Ce<Ve;Ce++){const ce=X[Ce],we={boundary:0,storage:0},At=Array.isArray(ce.value)?ce.value:[ce.value];for(let ni=0,ht=At.length;ni<ht;ni++){const Tt=H(At[ni]);we.boundary+=Tt.boundary,we.storage+=Tt.storage}ce.__data=new Float32Array(we.storage/Float32Array.BYTES_PER_ELEMENT),ce.__offset=ee,Ce>0&&(ve=ee%16,0!==ve&&16-ve-we.boundary<0&&(ee+=16-ve,ce.__offset=ee)),ee+=we.storage}ve=ee%16,ve>0&&(ee+=16-ve),Z.__size=ee,Z.__cache={}}(Z),ee=function M(Z){const X=function A(){for(let Z=0;Z<u;Z++)if(-1===a.indexOf(Z))return a.push(Z),Z;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();Z.__bindingPointIndex=X;const ee=i.createBuffer(),se=Z.__size,ve=Z.usage;return i.bindBuffer(i.UNIFORM_BUFFER,ee),i.bufferData(i.UNIFORM_BUFFER,se,ve),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,X,ee),ee}(Z),r[Z.id]=ee,Z.addEventListener("dispose",U)),n.updateUBOMapping(Z,X.program);const ve=t.render.frame;o[Z.id]!==ve&&(function I(Z){const ee=Z.uniforms,se=Z.__cache;i.bindBuffer(i.UNIFORM_BUFFER,r[Z.id]);for(let ve=0,Ce=ee.length;ve<Ce;ve++){const Ve=ee[ve];if(!0===R(Ve,ve,se)){const ce=Ve.__offset,we=Array.isArray(Ve.value)?Ve.value:[Ve.value];let At=0;for(let ni=0;ni<we.length;ni++){const ht=we[ni],_t=H(ht);"number"==typeof ht?(Ve.__data[0]=ht,i.bufferSubData(i.UNIFORM_BUFFER,ce+At,Ve.__data)):ht.isMatrix3?(Ve.__data[0]=ht.elements[0],Ve.__data[1]=ht.elements[1],Ve.__data[2]=ht.elements[2],Ve.__data[3]=ht.elements[0],Ve.__data[4]=ht.elements[3],Ve.__data[5]=ht.elements[4],Ve.__data[6]=ht.elements[5],Ve.__data[7]=ht.elements[0],Ve.__data[8]=ht.elements[6],Ve.__data[9]=ht.elements[7],Ve.__data[10]=ht.elements[8],Ve.__data[11]=ht.elements[0]):(ht.toArray(Ve.__data,At),At+=_t.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,ce,Ve.__data)}}i.bindBuffer(i.UNIFORM_BUFFER,null)}(Z),o[Z.id]=ve)},dispose:function B(){for(const Z in r)i.deleteBuffer(r[Z]);a=[],r={},o={}}}}function Qle(){const i=_C("canvas");return i.style.display="block",i}class fH{constructor(t={}){const{canvas:e=Qle(),context:n=null,depth:r=!0,stencil:o=!0,alpha:a=!1,antialias:u=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:y=!1,powerPreference:M="default",failIfMajorPerformanceCaveat:A=!1}=t;let I;this.isWebGLRenderer=!0,I=null!==n?n.getContextAttributes().alpha:a;const R=new Uint32Array(4),O=new Int32Array(4);let H=null,U=null;const B=[],Z=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=Hr,this.useLegacyLights=!0,this.toneMapping=R_,this.toneMappingExposure=1;const X=this;let ee=!1,se=0,ve=0,Ce=null,Ve=-1,ce=null;const we=new bs,At=new bs;let ni=null;const ht=new rn(0);let _t=0,Tt=e.width,at=e.height,ot=1,dt=null,It=null;const Xt=new bs(0,0,Tt,at),ut=new bs(0,0,Tt,at);let zt=!1;const Ti=new Y2;let gi=!1,Vi=!1,kn=null;const Yi=new Fr,mn=new ei,mr=new Ee,qo={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Kn(){return null===Ce?ot:1}let ti,Ci,di,Fn,on,un,gr,fo,ba,Re,ye,Ht,Ei,wi,ze,hi,vi,Dt,gn,Vn,Tn,yn,hn,_r,Ue=n;function ki(Se,xt){for(let jt=0;jt<Se.length;jt++){const Wt=e.getContext(Se[jt],xt);if(null!==Wt)return Wt}return null}try{const Se={alpha:!0,depth:r,stencil:o,antialias:u,premultipliedAlpha:f,preserveDrawingBuffer:y,powerPreference:M,failIfMajorPerformanceCaveat:A};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r154"),e.addEventListener("webglcontextlost",Wi,!1),e.addEventListener("webglcontextrestored",Ft,!1),e.addEventListener("webglcontextcreationerror",Pi,!1),null===Ue){const xt=["webgl2","webgl","experimental-webgl"];if(!0===X.isWebGL1Renderer&&xt.shift(),Ue=ki(xt,Se),null===Ue)throw ki(xt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Ue instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===Ue.getShaderPrecisionFormat&&(Ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Se){throw console.error("THREE.WebGLRenderer: "+Se.message),Se}function Eo(){ti=new uae(Ue),Ci=new oae(Ue,ti,t),ti.init(Ci),yn=new $le(Ue,ti,Ci),di=new jle(Ue,ti,Ci),Fn=new fae(Ue),on=new Rle,un=new Wle(Ue,ti,di,on,Ci,yn,Fn),gr=new aae(X),fo=new dae(X),ba=new roe(Ue,Ci),hn=new nae(Ue,ti,ba,Ci),Re=new hae(Ue,ba,Fn,hn),ye=new yae(Ue,Re,ba,Fn),gn=new _ae(Ue,Ci,un),hi=new sae(on),Ht=new kle(X,gr,fo,ti,Ci,hn,hi),Ei=new Kle(X,on),wi=new Lle,ze=new Ule(ti,Ci),Dt=new iae(X,gr,fo,di,ye,I,f),vi=new Gle(X,ye,Ci),_r=new Jle(Ue,Fn,Ci,di),Vn=new rae(Ue,ti,Fn,Ci),Tn=new pae(Ue,ti,Fn,Ci),Fn.programs=Ht.programs,X.capabilities=Ci,X.extensions=ti,X.properties=on,X.renderLists=wi,X.shadowMap=vi,X.state=di,X.info=Fn}Eo();const qe=new Yle(X,Ue);function Wi(Se){Se.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ee=!0}function Ft(){console.log("THREE.WebGLRenderer: Context Restored."),ee=!1;const Se=Fn.autoReset,xt=vi.enabled,jt=vi.autoUpdate,pt=vi.needsUpdate,Wt=vi.type;Eo(),Fn.autoReset=Se,vi.enabled=xt,vi.autoUpdate=jt,vi.needsUpdate=pt,vi.type=Wt}function Pi(Se){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Se.statusMessage)}function Ki(Se){const xt=Se.target;xt.removeEventListener("dispose",Ki),function Xo(Se){(function Ia(Se){const xt=on.get(Se).programs;void 0!==xt&&(xt.forEach(function(jt){Ht.releaseProgram(jt)}),Se.isShaderMaterial&&Ht.releaseShaderCache(Se))})(Se),on.remove(Se)}(xt)}this.xr=qe,this.getContext=function(){return Ue},this.getContextAttributes=function(){return Ue.getContextAttributes()},this.forceContextLoss=function(){const Se=ti.get("WEBGL_lose_context");Se&&Se.loseContext()},this.forceContextRestore=function(){const Se=ti.get("WEBGL_lose_context");Se&&Se.restoreContext()},this.getPixelRatio=function(){return ot},this.setPixelRatio=function(Se){void 0!==Se&&(ot=Se,this.setSize(Tt,at,!1))},this.getSize=function(Se){return Se.set(Tt,at)},this.setSize=function(Se,xt,jt=!0){qe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Tt=Se,at=xt,e.width=Math.floor(Se*ot),e.height=Math.floor(xt*ot),!0===jt&&(e.style.width=Se+"px",e.style.height=xt+"px"),this.setViewport(0,0,Se,xt))},this.getDrawingBufferSize=function(Se){return Se.set(Tt*ot,at*ot).floor()},this.setDrawingBufferSize=function(Se,xt,jt){Tt=Se,at=xt,ot=jt,e.width=Math.floor(Se*jt),e.height=Math.floor(xt*jt),this.setViewport(0,0,Se,xt)},this.getCurrentViewport=function(Se){return Se.copy(we)},this.getViewport=function(Se){return Se.copy(Xt)},this.setViewport=function(Se,xt,jt,pt){Se.isVector4?Xt.set(Se.x,Se.y,Se.z,Se.w):Xt.set(Se,xt,jt,pt),di.viewport(we.copy(Xt).multiplyScalar(ot).floor())},this.getScissor=function(Se){return Se.copy(ut)},this.setScissor=function(Se,xt,jt,pt){Se.isVector4?ut.set(Se.x,Se.y,Se.z,Se.w):ut.set(Se,xt,jt,pt),di.scissor(At.copy(ut).multiplyScalar(ot).floor())},this.getScissorTest=function(){return zt},this.setScissorTest=function(Se){di.setScissorTest(zt=Se)},this.setOpaqueSort=function(Se){dt=Se},this.setTransparentSort=function(Se){It=Se},this.getClearColor=function(Se){return Se.copy(Dt.getClearColor())},this.setClearColor=function(){Dt.setClearColor.apply(Dt,arguments)},this.getClearAlpha=function(){return Dt.getClearAlpha()},this.setClearAlpha=function(){Dt.setClearAlpha.apply(Dt,arguments)},this.clear=function(Se=!0,xt=!0,jt=!0){let pt=0;if(Se){let Wt=!1;if(null!==Ce){const pn=Ce.texture.format;Wt=1033===pn||1031===pn||1029===pn}if(Wt){const pn=Ce.texture.type,cr=pn===yv||pn===vv||1012===pn||pn===F0||1017===pn||1018===pn,br=Dt.getClearColor(),wr=Dt.getClearAlpha(),mo=br.r,Or=br.g,Yr=br.b;cr?(R[0]=mo,R[1]=Or,R[2]=Yr,R[3]=wr,Ue.clearBufferuiv(Ue.COLOR,0,R)):(O[0]=mo,O[1]=Or,O[2]=Yr,O[3]=wr,Ue.clearBufferiv(Ue.COLOR,0,O))}else pt|=Ue.COLOR_BUFFER_BIT}xt&&(pt|=Ue.DEPTH_BUFFER_BIT),jt&&(pt|=Ue.STENCIL_BUFFER_BIT),Ue.clear(pt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Wi,!1),e.removeEventListener("webglcontextrestored",Ft,!1),e.removeEventListener("webglcontextcreationerror",Pi,!1),wi.dispose(),ze.dispose(),on.dispose(),gr.dispose(),fo.dispose(),ye.dispose(),hn.dispose(),_r.dispose(),Ht.dispose(),qe.dispose(),qe.removeEventListener("sessionstart",tl),qe.removeEventListener("sessionend",bg),kn&&(kn.dispose(),kn=null),Lu.stop()},this.renderBufferDirect=function(Se,xt,jt,pt,Wt,pn){null===xt&&(xt=qo);const cr=Wt.isMesh&&Wt.matrixWorld.determinant()<0,br=function xfe(Se,xt,jt,pt,Wt){!0!==xt.isScene&&(xt=qo),un.resetTextureUnits();const pn=xt.fog,br=null===Ce?X.outputColorSpace:!0===Ce.isXRRenderTarget?Ce.texture.colorSpace:pg,wr=(pt.isMeshStandardMaterial?fo:gr).get(pt.envMap||(pt.isMeshStandardMaterial?xt.environment:null)),mo=!0===pt.vertexColors&&!!jt.attributes.color&&4===jt.attributes.color.itemSize,Or=!!jt.attributes.tangent&&(!!pt.normalMap||pt.anisotropy>0),Yr=!!jt.morphAttributes.position,il=!!jt.morphAttributes.normal,El=!!jt.morphAttributes.color,um=pt.toneMapped?X.toneMapping:R_,$_=jt.morphAttributes.position||jt.morphAttributes.normal||jt.morphAttributes.color,Zl=void 0!==$_?$_.length:0,Fo=on.get(pt),TL=U.state.lights;!0!==gi||!0!==Vi&&Se===ce||hi.setState(pt,Se,Se===ce&&pt.id===Ve);let Hc=!1;pt.version===Fo.__version?(Fo.needsLights&&Fo.lightsStateVersion!==TL.state.version||Fo.outputColorSpace!==br||Wt.isInstancedMesh&&!1===Fo.instancing||!Wt.isInstancedMesh&&!0===Fo.instancing||Wt.isSkinnedMesh&&!1===Fo.skinning||!Wt.isSkinnedMesh&&!0===Fo.skinning||Fo.envMap!==wr||!0===pt.fog&&Fo.fog!==pn||void 0!==Fo.numClippingPlanes&&(Fo.numClippingPlanes!==hi.numPlanes||Fo.numIntersection!==hi.numIntersection)||Fo.vertexAlphas!==mo||Fo.vertexTangents!==Or||Fo.morphTargets!==Yr||Fo.morphNormals!==il||Fo.morphColors!==El||Fo.toneMapping!==um||!0===Ci.isWebGL2&&Fo.morphTargetsCount!==Zl)&&(Hc=!0):(Hc=!0,Fo.__version=pt.version);let cx=Fo.currentProgram;!0===Hc&&(cx=HD(pt,xt,Wt));let LG=!1,ZC=!1,AL=!1;const Fu=cx.getUniforms(),dx=Fo.uniforms;if(di.useProgram(cx.program)&&(LG=!0,ZC=!0,AL=!0),pt.id!==Ve&&(Ve=pt.id,ZC=!0),LG||ce!==Se){if(Fu.setValue(Ue,"projectionMatrix",Se.projectionMatrix),Ci.logarithmicDepthBuffer&&Fu.setValue(Ue,"logDepthBufFC",2/(Math.log(Se.far+1)/Math.LN2)),ce!==Se&&(ce=Se,ZC=!0,AL=!0),pt.isShaderMaterial||pt.isMeshPhongMaterial||pt.isMeshToonMaterial||pt.isMeshStandardMaterial||pt.envMap){const wp=Fu.map.cameraPosition;void 0!==wp&&wp.setValue(Ue,mr.setFromMatrixPosition(Se.matrixWorld))}(pt.isMeshPhongMaterial||pt.isMeshToonMaterial||pt.isMeshLambertMaterial||pt.isMeshBasicMaterial||pt.isMeshStandardMaterial||pt.isShaderMaterial)&&Fu.setValue(Ue,"isOrthographic",!0===Se.isOrthographicCamera),(pt.isMeshPhongMaterial||pt.isMeshToonMaterial||pt.isMeshLambertMaterial||pt.isMeshBasicMaterial||pt.isMeshStandardMaterial||pt.isShaderMaterial||pt.isShadowMaterial||Wt.isSkinnedMesh)&&Fu.setValue(Ue,"viewMatrix",Se.matrixWorldInverse)}if(Wt.isSkinnedMesh){Fu.setOptional(Ue,Wt,"bindMatrix"),Fu.setOptional(Ue,Wt,"bindMatrixInverse");const wp=Wt.skeleton;wp&&(Ci.floatVertexTextures?(null===wp.boneTexture&&wp.computeBoneTexture(),Fu.setValue(Ue,"boneTexture",wp.boneTexture,un),Fu.setValue(Ue,"boneTextureSize",wp.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const DL=jt.morphAttributes;if((void 0!==DL.position||void 0!==DL.normal||void 0!==DL.color&&!0===Ci.isWebGL2)&&gn.update(Wt,jt,cx),(ZC||Fo.receiveShadow!==Wt.receiveShadow)&&(Fo.receiveShadow=Wt.receiveShadow,Fu.setValue(Ue,"receiveShadow",Wt.receiveShadow)),pt.isMeshGouraudMaterial&&null!==pt.envMap&&(dx.envMap.value=wr,dx.flipEnvMap.value=wr.isCubeTexture&&!1===wr.isRenderTargetTexture?-1:1),ZC&&(Fu.setValue(Ue,"toneMappingExposure",X.toneMappingExposure),Fo.needsLights&&function wfe(Se,xt){Se.ambientLightColor.needsUpdate=xt,Se.lightProbe.needsUpdate=xt,Se.directionalLights.needsUpdate=xt,Se.directionalLightShadows.needsUpdate=xt,Se.pointLights.needsUpdate=xt,Se.pointLightShadows.needsUpdate=xt,Se.spotLights.needsUpdate=xt,Se.spotLightShadows.needsUpdate=xt,Se.rectAreaLights.needsUpdate=xt,Se.hemisphereLights.needsUpdate=xt}(dx,AL),pn&&!0===pt.fog&&Ei.refreshFogUniforms(dx,pn),Ei.refreshMaterialUniforms(dx,pt,ot,at,kn),GA.upload(Ue,Fo.uniformsList,dx,un)),pt.isShaderMaterial&&!0===pt.uniformsNeedUpdate&&(GA.upload(Ue,Fo.uniformsList,dx,un),pt.uniformsNeedUpdate=!1),pt.isSpriteMaterial&&Fu.setValue(Ue,"center",Wt.center),Fu.setValue(Ue,"modelViewMatrix",Wt.modelViewMatrix),Fu.setValue(Ue,"normalMatrix",Wt.normalMatrix),Fu.setValue(Ue,"modelMatrix",Wt.matrixWorld),pt.isShaderMaterial||pt.isRawShaderMaterial){const wp=pt.uniformsGroups;for(let IL=0,Efe=wp.length;IL<Efe;IL++)if(Ci.isWebGL2){const FG=wp[IL];_r.update(FG,cx),_r.bind(FG,cx)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return cx}(Se,xt,jt,pt,Wt);di.setMaterial(pt,cr);let wr=jt.index,mo=1;!0===pt.wireframe&&(wr=Re.getWireframeAttribute(jt),mo=2);const Or=jt.drawRange,Yr=jt.attributes.position;let il=Or.start*mo,El=(Or.start+Or.count)*mo;null!==pn&&(il=Math.max(il,pn.start*mo),El=Math.min(El,(pn.start+pn.count)*mo)),null!==wr?(il=Math.max(il,0),El=Math.min(El,wr.count)):null!=Yr&&(il=Math.max(il,0),El=Math.min(El,Yr.count));const um=El-il;if(um<0||um===1/0)return;hn.setup(Wt,pt,br,jt,wr);let $_,Zl=Vn;if(null!==wr&&($_=ba.get(wr),Zl=Tn,Zl.setIndex($_)),Wt.isMesh)!0===pt.wireframe?(di.setLineWidth(pt.wireframeLinewidth*Kn()),Zl.setMode(Ue.LINES)):Zl.setMode(Ue.TRIANGLES);else if(Wt.isLine){let Fo=pt.linewidth;void 0===Fo&&(Fo=1),di.setLineWidth(Fo*Kn()),Zl.setMode(Wt.isLineSegments?Ue.LINES:Wt.isLineLoop?Ue.LINE_LOOP:Ue.LINE_STRIP)}else Wt.isPoints?Zl.setMode(Ue.POINTS):Wt.isSprite&&Zl.setMode(Ue.TRIANGLES);if(Wt.isInstancedMesh)Zl.renderInstances(il,um,Wt.count);else if(jt.isInstancedBufferGeometry){const TL=Math.min(jt.instanceCount,void 0!==jt._maxInstanceCount?jt._maxInstanceCount:1/0);Zl.renderInstances(il,um,TL)}else Zl.render(il,um)},this.compile=function(Se,xt){function jt(pt,Wt,pn){!0===pt.transparent&&2===pt.side&&!1===pt.forceSinglePass?(pt.side=1,pt.needsUpdate=!0,HD(pt,Wt,pn),pt.side=0,pt.needsUpdate=!0,HD(pt,Wt,pn),pt.side=2):HD(pt,Wt,pn)}U=ze.get(Se),U.init(),Z.push(U),Se.traverseVisible(function(pt){pt.isLight&&pt.layers.test(xt.layers)&&(U.pushLight(pt),pt.castShadow&&U.pushShadow(pt))}),U.setupLights(X.useLegacyLights),Se.traverse(function(pt){const Wt=pt.material;if(Wt)if(Array.isArray(Wt))for(let pn=0;pn<Wt.length;pn++)jt(Wt[pn],Se,pt);else jt(Wt,Se,pt)}),Z.pop(),U=null};let Vc=null;function tl(){Lu.stop()}function bg(){Lu.start()}const Lu=new z5;function IG(Se,xt,jt,pt){if(!1===Se.visible)return;if(Se.layers.test(xt.layers))if(Se.isGroup)jt=Se.renderOrder;else if(Se.isLOD)!0===Se.autoUpdate&&Se.update(xt);else if(Se.isLight)U.pushLight(Se),Se.castShadow&&U.pushShadow(Se);else if(Se.isSprite){if(!Se.frustumCulled||Ti.intersectsSprite(Se)){pt&&mr.setFromMatrixPosition(Se.matrixWorld).applyMatrix4(Yi);const cr=ye.update(Se),br=Se.material;br.visible&&H.push(Se,cr,br,jt,mr.z,null)}}else if((Se.isMesh||Se.isLine||Se.isPoints)&&(!Se.frustumCulled||Ti.intersectsObject(Se))){const cr=ye.update(Se),br=Se.material;if(pt&&(void 0!==Se.boundingSphere?(null===Se.boundingSphere&&Se.computeBoundingSphere(),mr.copy(Se.boundingSphere.center)):(null===cr.boundingSphere&&cr.computeBoundingSphere(),mr.copy(cr.boundingSphere.center)),mr.applyMatrix4(Se.matrixWorld).applyMatrix4(Yi)),Array.isArray(br)){const wr=cr.groups;for(let mo=0,Or=wr.length;mo<Or;mo++){const Yr=wr[mo],il=br[Yr.materialIndex];il&&il.visible&&H.push(Se,cr,il,jt,mr.z,Yr)}}else br.visible&&H.push(Se,cr,br,jt,mr.z,null)}const pn=Se.children;for(let cr=0,br=pn.length;cr<br;cr++)IG(pn[cr],xt,jt,pt)}function kG(Se,xt,jt,pt){const Wt=Se.opaque,pn=Se.transmissive,cr=Se.transparent;U.setupLightsView(jt),!0===gi&&hi.setGlobalState(X.clippingPlanes,jt),pn.length>0&&function bfe(Se,xt,jt,pt){const Wt=Ci.isWebGL2;null===kn&&(kn=new H0(1,1,{generateMipmaps:!0,type:ti.has("EXT_color_buffer_half_float")?mC:yv,minFilter:L0,samples:Wt?4:0})),X.getDrawingBufferSize(mn),Wt?kn.setSize(mn.x,mn.y):kn.setSize(vA(mn.x),vA(mn.y));const pn=X.getRenderTarget();X.setRenderTarget(kn),X.getClearColor(ht),_t=X.getClearAlpha(),_t<1&&X.setClearColor(16777215,.5),X.clear();const cr=X.toneMapping;X.toneMapping=R_,VD(Se,jt,pt),un.updateMultisampleRenderTarget(kn),un.updateRenderTargetMipmap(kn);let br=!1;for(let wr=0,mo=xt.length;wr<mo;wr++){const Or=xt[wr],Yr=Or.object,il=Or.geometry,El=Or.material,um=Or.group;if(2===El.side&&Yr.layers.test(pt.layers)){const $_=El.side;El.side=1,El.needsUpdate=!0,RG(Yr,jt,pt,il,El,um),El.side=$_,El.needsUpdate=!0,br=!0}}!0===br&&(un.updateMultisampleRenderTarget(kn),un.updateRenderTargetMipmap(kn)),X.setRenderTarget(pn),X.setClearColor(ht,_t),X.toneMapping=cr}(Wt,pn,xt,jt),pt&&di.viewport(we.copy(pt)),Wt.length>0&&VD(Wt,xt,jt),pn.length>0&&VD(pn,xt,jt),cr.length>0&&VD(cr,xt,jt),di.buffers.depth.setTest(!0),di.buffers.depth.setMask(!0),di.buffers.color.setMask(!0),di.setPolygonOffset(!1)}function VD(Se,xt,jt){const pt=!0===xt.isScene?xt.overrideMaterial:null;for(let Wt=0,pn=Se.length;Wt<pn;Wt++){const cr=Se[Wt],br=cr.object,wr=cr.geometry,mo=null===pt?cr.material:pt,Or=cr.group;br.layers.test(jt.layers)&&RG(br,xt,jt,wr,mo,Or)}}function RG(Se,xt,jt,pt,Wt,pn){Se.onBeforeRender(X,xt,jt,pt,Wt,pn),Se.modelViewMatrix.multiplyMatrices(jt.matrixWorldInverse,Se.matrixWorld),Se.normalMatrix.getNormalMatrix(Se.modelViewMatrix),Wt.onBeforeRender(X,xt,jt,pt,Se,pn),!0===Wt.transparent&&2===Wt.side&&!1===Wt.forceSinglePass?(Wt.side=1,Wt.needsUpdate=!0,X.renderBufferDirect(jt,xt,pt,Wt,Se,pn),Wt.side=0,Wt.needsUpdate=!0,X.renderBufferDirect(jt,xt,pt,Wt,Se,pn),Wt.side=2):X.renderBufferDirect(jt,xt,pt,Wt,Se,pn),Se.onAfterRender(X,xt,jt,pt,Wt,pn)}function HD(Se,xt,jt){!0!==xt.isScene&&(xt=qo);const pt=on.get(Se),Wt=U.state.lights,cr=Wt.state.version,br=Ht.getParameters(Se,Wt.state,U.state.shadowsArray,xt,jt),wr=Ht.getProgramCacheKey(br);let mo=pt.programs;pt.environment=Se.isMeshStandardMaterial?xt.environment:null,pt.fog=xt.fog,pt.envMap=(Se.isMeshStandardMaterial?fo:gr).get(Se.envMap||pt.environment),void 0===mo&&(Se.addEventListener("dispose",Ki),mo=new Map,pt.programs=mo);let Or=mo.get(wr);if(void 0!==Or){if(pt.currentProgram===Or&&pt.lightsStateVersion===cr)return PG(Se,br),Or}else br.uniforms=Ht.getUniforms(Se),Se.onBuild(jt,br,X),Se.onBeforeCompile(br,X),Or=Ht.acquireProgram(br,wr),mo.set(wr,Or),pt.uniforms=br.uniforms;const Yr=pt.uniforms;(!Se.isShaderMaterial&&!Se.isRawShaderMaterial||!0===Se.clipping)&&(Yr.clippingPlanes=hi.uniform),PG(Se,br),pt.needsLights=function Mfe(Se){return Se.isMeshLambertMaterial||Se.isMeshToonMaterial||Se.isMeshPhongMaterial||Se.isMeshStandardMaterial||Se.isShadowMaterial||Se.isShaderMaterial&&!0===Se.lights}(Se),pt.lightsStateVersion=cr,pt.needsLights&&(Yr.ambientLightColor.value=Wt.state.ambient,Yr.lightProbe.value=Wt.state.probe,Yr.directionalLights.value=Wt.state.directional,Yr.directionalLightShadows.value=Wt.state.directionalShadow,Yr.spotLights.value=Wt.state.spot,Yr.spotLightShadows.value=Wt.state.spotShadow,Yr.rectAreaLights.value=Wt.state.rectArea,Yr.ltc_1.value=Wt.state.rectAreaLTC1,Yr.ltc_2.value=Wt.state.rectAreaLTC2,Yr.pointLights.value=Wt.state.point,Yr.pointLightShadows.value=Wt.state.pointShadow,Yr.hemisphereLights.value=Wt.state.hemi,Yr.directionalShadowMap.value=Wt.state.directionalShadowMap,Yr.directionalShadowMatrix.value=Wt.state.directionalShadowMatrix,Yr.spotShadowMap.value=Wt.state.spotShadowMap,Yr.spotLightMatrix.value=Wt.state.spotLightMatrix,Yr.spotLightMap.value=Wt.state.spotLightMap,Yr.pointShadowMap.value=Wt.state.pointShadowMap,Yr.pointShadowMatrix.value=Wt.state.pointShadowMatrix);const il=Or.getUniforms(),El=GA.seqWithValue(il.seq,Yr);return pt.currentProgram=Or,pt.uniformsList=El,Or}function PG(Se,xt){const jt=on.get(Se);jt.outputColorSpace=xt.outputColorSpace,jt.instancing=xt.instancing,jt.skinning=xt.skinning,jt.morphTargets=xt.morphTargets,jt.morphNormals=xt.morphNormals,jt.morphColors=xt.morphColors,jt.morphTargetsCount=xt.morphTargetsCount,jt.numClippingPlanes=xt.numClippingPlanes,jt.numIntersection=xt.numClipIntersection,jt.vertexAlphas=xt.vertexAlphas,jt.vertexTangents=xt.vertexTangents,jt.toneMapping=xt.toneMapping}Lu.setAnimationLoop(function vg(Se){Vc&&Vc(Se)}),typeof self<"u"&&Lu.setContext(self),this.setAnimationLoop=function(Se){Vc=Se,qe.setAnimationLoop(Se),null===Se?Lu.stop():Lu.start()},qe.addEventListener("sessionstart",tl),qe.addEventListener("sessionend",bg),this.render=function(Se,xt){if(void 0===xt||!0===xt.isCamera){if(!0!==ee){if(!0===Se.matrixWorldAutoUpdate&&Se.updateMatrixWorld(),null===xt.parent&&!0===xt.matrixWorldAutoUpdate&&xt.updateMatrixWorld(),!0===qe.enabled&&!0===qe.isPresenting&&(!0===qe.cameraAutoUpdate&&qe.updateCamera(xt),xt=qe.getCamera()),!0===Se.isScene&&Se.onBeforeRender(X,Se,xt,Ce),U=ze.get(Se,Z.length),U.init(),Z.push(U),Yi.multiplyMatrices(xt.projectionMatrix,xt.matrixWorldInverse),Ti.setFromProjectionMatrix(Yi),Vi=this.localClippingEnabled,gi=hi.init(this.clippingPlanes,Vi),H=wi.get(Se,B.length),H.init(),B.push(H),IG(Se,xt,0,X.sortObjects),H.finish(),!0===X.sortObjects&&H.sort(dt,It),this.info.render.frame++,!0===gi&&hi.beginShadows(),vi.render(U.state.shadowsArray,Se,xt),!0===gi&&hi.endShadows(),!0===this.info.autoReset&&this.info.reset(),Dt.render(H,Se),U.setupLights(X.useLegacyLights),xt.isArrayCamera){const pt=xt.cameras;for(let Wt=0,pn=pt.length;Wt<pn;Wt++){const cr=pt[Wt];kG(H,Se,cr,cr.viewport)}}else kG(H,Se,xt);null!==Ce&&(un.updateMultisampleRenderTarget(Ce),un.updateRenderTargetMipmap(Ce)),!0===Se.isScene&&Se.onAfterRender(X,Se,xt),hn.resetDefaultState(),Ve=-1,ce=null,Z.pop(),U=Z.length>0?Z[Z.length-1]:null,B.pop(),H=B.length>0?B[B.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return se},this.getActiveMipmapLevel=function(){return ve},this.getRenderTarget=function(){return Ce},this.setRenderTargetTextures=function(Se,xt,jt){on.get(Se.texture).__webglTexture=xt,on.get(Se.depthTexture).__webglTexture=jt;const pt=on.get(Se);pt.__hasExternalTextures=!0,pt.__hasExternalTextures&&(pt.__autoAllocateDepthBuffer=void 0===jt,pt.__autoAllocateDepthBuffer||!0===ti.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),pt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Se,xt){const jt=on.get(Se);jt.__webglFramebuffer=xt,jt.__useDefaultFramebuffer=void 0===xt},this.setRenderTarget=function(Se,xt=0,jt=0){Ce=Se,se=xt,ve=jt;let pt=!0,Wt=null,pn=!1,cr=!1;if(Se){const wr=on.get(Se);void 0!==wr.__useDefaultFramebuffer?(di.bindFramebuffer(Ue.FRAMEBUFFER,null),pt=!1):void 0===wr.__webglFramebuffer?un.setupRenderTarget(Se):wr.__hasExternalTextures&&un.rebindTextures(Se,on.get(Se.texture).__webglTexture,on.get(Se.depthTexture).__webglTexture);const mo=Se.texture;(mo.isData3DTexture||mo.isDataArrayTexture||mo.isCompressedArrayTexture)&&(cr=!0);const Or=on.get(Se).__webglFramebuffer;Se.isWebGLCubeRenderTarget?(Wt=Or[xt],pn=!0):Wt=Ci.isWebGL2&&Se.samples>0&&!1===un.useMultisampledRTT(Se)?on.get(Se).__webglMultisampledFramebuffer:Or,we.copy(Se.viewport),At.copy(Se.scissor),ni=Se.scissorTest}else we.copy(Xt).multiplyScalar(ot).floor(),At.copy(ut).multiplyScalar(ot).floor(),ni=zt;if(di.bindFramebuffer(Ue.FRAMEBUFFER,Wt)&&Ci.drawBuffers&&pt&&di.drawBuffers(Se,Wt),di.viewport(we),di.scissor(At),di.setScissorTest(ni),pn){const wr=on.get(Se.texture);Ue.framebufferTexture2D(Ue.FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Ue.TEXTURE_CUBE_MAP_POSITIVE_X+xt,wr.__webglTexture,jt)}else if(cr){const wr=on.get(Se.texture);Ue.framebufferTextureLayer(Ue.FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,wr.__webglTexture,jt||0,xt||0)}Ve=-1},this.readRenderTargetPixels=function(Se,xt,jt,pt,Wt,pn,cr){if(!Se||!Se.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let br=on.get(Se).__webglFramebuffer;if(Se.isWebGLCubeRenderTarget&&void 0!==cr&&(br=br[cr]),br){di.bindFramebuffer(Ue.FRAMEBUFFER,br);try{const wr=Se.texture,mo=wr.format,Or=wr.type;if(mo!==df&&yn.convert(mo)!==Ue.getParameter(Ue.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Yr=Or===mC&&(ti.has("EXT_color_buffer_half_float")||Ci.isWebGL2&&ti.has("EXT_color_buffer_float"));if(!(Or===yv||yn.convert(Or)===Ue.getParameter(Ue.IMPLEMENTATION_COLOR_READ_TYPE)||Or===P_&&(Ci.isWebGL2||ti.has("OES_texture_float")||ti.has("WEBGL_color_buffer_float"))||Yr))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");xt>=0&&xt<=Se.width-pt&&jt>=0&&jt<=Se.height-Wt&&Ue.readPixels(xt,jt,pt,Wt,yn.convert(mo),yn.convert(Or),pn)}finally{const wr=null!==Ce?on.get(Ce).__webglFramebuffer:null;di.bindFramebuffer(Ue.FRAMEBUFFER,wr)}}},this.copyFramebufferToTexture=function(Se,xt,jt=0){const pt=Math.pow(2,-jt),Wt=Math.floor(xt.image.width*pt),pn=Math.floor(xt.image.height*pt);un.setTexture2D(xt,0),Ue.copyTexSubImage2D(Ue.TEXTURE_2D,jt,0,0,Se.x,Se.y,Wt,pn),di.unbindTexture()},this.copyTextureToTexture=function(Se,xt,jt,pt=0){const Wt=xt.image.width,pn=xt.image.height,cr=yn.convert(jt.format),br=yn.convert(jt.type);un.setTexture2D(jt,0),Ue.pixelStorei(Ue.UNPACK_FLIP_Y_WEBGL,jt.flipY),Ue.pixelStorei(Ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,jt.premultiplyAlpha),Ue.pixelStorei(Ue.UNPACK_ALIGNMENT,jt.unpackAlignment),xt.isDataTexture?Ue.texSubImage2D(Ue.TEXTURE_2D,pt,Se.x,Se.y,Wt,pn,cr,br,xt.image.data):xt.isCompressedTexture?Ue.compressedTexSubImage2D(Ue.TEXTURE_2D,pt,Se.x,Se.y,xt.mipmaps[0].width,xt.mipmaps[0].height,cr,xt.mipmaps[0].data):Ue.texSubImage2D(Ue.TEXTURE_2D,pt,Se.x,Se.y,cr,br,xt.image),0===pt&&jt.generateMipmaps&&Ue.generateMipmap(Ue.TEXTURE_2D),di.unbindTexture()},this.copyTextureToTexture3D=function(Se,xt,jt,pt,Wt=0){if(X.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const pn=Se.max.x-Se.min.x+1,cr=Se.max.y-Se.min.y+1,br=Se.max.z-Se.min.z+1,wr=yn.convert(pt.format),mo=yn.convert(pt.type);let Or;if(pt.isData3DTexture)un.setTexture3D(pt,0),Or=Ue.TEXTURE_3D;else{if(!pt.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");un.setTexture2DArray(pt,0),Or=Ue.TEXTURE_2D_ARRAY}Ue.pixelStorei(Ue.UNPACK_FLIP_Y_WEBGL,pt.flipY),Ue.pixelStorei(Ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pt.premultiplyAlpha),Ue.pixelStorei(Ue.UNPACK_ALIGNMENT,pt.unpackAlignment);const Yr=Ue.getParameter(Ue.UNPACK_ROW_LENGTH),il=Ue.getParameter(Ue.UNPACK_IMAGE_HEIGHT),El=Ue.getParameter(Ue.UNPACK_SKIP_PIXELS),um=Ue.getParameter(Ue.UNPACK_SKIP_ROWS),$_=Ue.getParameter(Ue.UNPACK_SKIP_IMAGES),Zl=jt.isCompressedTexture?jt.mipmaps[0]:jt.image;Ue.pixelStorei(Ue.UNPACK_ROW_LENGTH,Zl.width),Ue.pixelStorei(Ue.UNPACK_IMAGE_HEIGHT,Zl.height),Ue.pixelStorei(Ue.UNPACK_SKIP_PIXELS,Se.min.x),Ue.pixelStorei(Ue.UNPACK_SKIP_ROWS,Se.min.y),Ue.pixelStorei(Ue.UNPACK_SKIP_IMAGES,Se.min.z),jt.isDataTexture||jt.isData3DTexture?Ue.texSubImage3D(Or,Wt,xt.x,xt.y,xt.z,pn,cr,br,wr,mo,Zl.data):jt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ue.compressedTexSubImage3D(Or,Wt,xt.x,xt.y,xt.z,pn,cr,br,wr,Zl.data)):Ue.texSubImage3D(Or,Wt,xt.x,xt.y,xt.z,pn,cr,br,wr,mo,Zl),Ue.pixelStorei(Ue.UNPACK_ROW_LENGTH,Yr),Ue.pixelStorei(Ue.UNPACK_IMAGE_HEIGHT,il),Ue.pixelStorei(Ue.UNPACK_SKIP_PIXELS,El),Ue.pixelStorei(Ue.UNPACK_SKIP_ROWS,um),Ue.pixelStorei(Ue.UNPACK_SKIP_IMAGES,$_),0===Wt&&pt.generateMipmaps&&Ue.generateMipmap(Or),di.unbindTexture()},this.initTexture=function(Se){Se.isCubeTexture?un.setTextureCube(Se,0):Se.isData3DTexture?un.setTexture3D(Se,0):Se.isDataArrayTexture||Se.isCompressedArrayTexture?un.setTexture2DArray(Se,0):un.setTexture2D(Se,0),di.unbindTexture()},this.resetState=function(){se=0,ve=0,Ce=null,di.reset(),hn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return L_}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(t){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!t}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Hr?N0:3e3}set outputEncoding(t){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=t===N0?Hr:pg}}(class ece extends fH{}).prototype.isWebGL1Renderer=!0;class mH extends mp{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e}}class Q0 extends po{constructor(t=1,e=32,n=16,r=0,o=2*Math.PI,a=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:o,thetaStart:a,thetaLength:u},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const f=Math.min(a+u,Math.PI);let y=0;const M=[],A=new Ee,I=new Ee,R=[],O=[],H=[],U=[];for(let B=0;B<=n;B++){const Z=[],X=B/n;let ee=0;0===B&&0===a?ee=.5/e:B===n&&f===Math.PI&&(ee=-.5/e);for(let se=0;se<=e;se++){const ve=se/e;A.x=-t*Math.cos(r+ve*o)*Math.sin(a+X*u),A.y=t*Math.cos(a+X*u),A.z=t*Math.sin(r+ve*o)*Math.sin(a+X*u),O.push(A.x,A.y,A.z),I.copy(A).normalize(),H.push(I.x,I.y,I.z),U.push(ve+ee,1-X),Z.push(y++)}M.push(Z)}for(let B=0;B<n;B++)for(let Z=0;Z<e;Z++){const ee=M[B][Z],se=M[B+1][Z],ve=M[B+1][Z+1];(0!==B||a>0)&&R.push(M[B][Z+1],ee,ve),(B!==n-1||f<Math.PI)&&R.push(ee,se,ve)}this.setIndex(R),this.setAttribute("position",new xn(O,3)),this.setAttribute("normal",new xn(H,3)),this.setAttribute("uv",new xn(U,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Q0(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class cD extends v1{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new rn(16777215),this.specular=new rn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new rn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ei(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=lA,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}function hf(i,t,e){return LP(i)?new i.constructor(i.subarray(t,void 0!==e?e:i.length)):i.slice(t,e)}function ex(i,t,e){return!i||!e&&i.constructor===t?i:"number"==typeof t.BYTES_PER_ELEMENT?new t(i):Array.prototype.slice.call(i)}function LP(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}class dD{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],o=e[n-1];e:{t:{let a;i:{n:if(!(t<r)){for(let u=n+2;;){if(void 0===r){if(t<o)break n;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===u)break;if(o=r,r=e[++n],t<r)break t}a=e.length;break i}if(t>=o)break e;{const u=e[1];t<u&&(n=2,o=u);for(let f=n-2;;){if(void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(n===f)break;if(r=o,o=e[--n-1],t>=o)break t}a=n,n=0}}for(;n<a;){const u=n+a>>>1;t<e[u]?a=u:n=u+1}if(r=e[n],o=e[n-1],void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=t*r;for(let a=0;a!==r;++a)e[a]=n[o+a];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ide extends dD{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(t,e,n){const r=this.parameterPositions;let o=t-2,a=t+1,u=r[o],f=r[a];if(void 0===u)switch(this.getSettings_().endingStart){case 2401:o=t,u=2*e-n;break;case 2402:o=r.length-2,u=e+r[o]-r[o+1];break;default:o=t,u=n}if(void 0===f)switch(this.getSettings_().endingEnd){case 2401:a=t,f=2*n-e;break;case 2402:a=1,f=n+r[1]-r[0];break;default:a=t-1,f=e}const y=.5*(n-e),M=this.valueSize;this._weightPrev=y/(e-u),this._weightNext=y/(f-n),this._offsetPrev=o*M,this._offsetNext=a*M}interpolate_(t,e,n,r){const o=this.resultBuffer,a=this.sampleValues,u=this.valueSize,f=t*u,y=f-u,M=this._offsetPrev,A=this._offsetNext,I=this._weightPrev,R=this._weightNext,O=(n-e)/(r-e),H=O*O,U=H*O,B=-I*U+2*I*H-I*O,Z=(1+I)*U+(-1.5-2*I)*H+(-.5+I)*O+1,X=(-1-R)*U+(1.5+R)*H+.5*O,ee=R*U-R*H;for(let se=0;se!==u;++se)o[se]=B*a[M+se]+Z*a[y+se]+X*a[f+se]+ee*a[A+se];return o}}class e6 extends dD{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const o=this.resultBuffer,a=this.sampleValues,u=this.valueSize,f=t*u,y=f-u,M=(n-e)/(r-e),A=1-M;for(let I=0;I!==u;++I)o[I]=a[y+I]*A+a[f+I]*M;return o}}class nde extends dD{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class _g{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ex(e,this.TimeBufferType),this.values=ex(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:ex(t.times,Array),values:ex(t.values,Array)};const r=t.getInterpolation();r!==t.DefaultInterpolation&&(n.interpolation=r)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new nde(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new e6(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new ide(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let o=0,a=r-1;for(;o!==r&&n[o]<t;)++o;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==o||a!==r){o>=a&&(a=Math.max(a,1),o=a-1);const u=this.getValueSize();this.times=hf(n,o,a),this.values=hf(this.values,o*u,a*u)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,o=n.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let a=null;for(let u=0;u!==o;u++){const f=n[u];if("number"==typeof f&&isNaN(f)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,f),t=!1;break}if(null!==a&&a>f){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,f,a),t=!1;break}a=f}if(void 0!==r&&LP(r))for(let u=0,f=r.length;u!==f;++u){const y=r[u];if(isNaN(y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,y),t=!1;break}}return t}optimize(){const t=hf(this.times),e=hf(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),o=t.length-1;let a=1;for(let u=1;u<o;++u){let f=!1;const y=t[u];if(y!==t[u+1]&&(1!==u||y!==t[0]))if(r)f=!0;else{const A=u*n,I=A-n,R=A+n;for(let O=0;O!==n;++O){const H=e[A+O];if(H!==e[I+O]||H!==e[R+O]){f=!0;break}}}if(f){if(u!==a){t[a]=t[u];const A=u*n,I=a*n;for(let R=0;R!==n;++R)e[I+R]=e[A+R]}++a}}if(o>0){t[a]=t[o];for(let u=o*n,f=a*n,y=0;y!==n;++y)e[f+y]=e[u+y];++a}return a!==t.length?(this.times=hf(t,0,a),this.values=hf(e,0,a*n)):(this.times=t,this.values=e),this}clone(){const t=hf(this.times,0),e=hf(this.values,0),r=new(0,this.constructor)(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}}_g.prototype.TimeBufferType=Float32Array,_g.prototype.ValueBufferType=Float32Array,_g.prototype.DefaultInterpolation=2301;class U1 extends _g{}U1.prototype.ValueTypeName="bool",U1.prototype.ValueBufferType=Array,U1.prototype.DefaultInterpolation=2300,U1.prototype.InterpolantFactoryMethodLinear=void 0,U1.prototype.InterpolantFactoryMethodSmooth=void 0;(class t6 extends _g{}).prototype.ValueTypeName="color";(class uD extends _g{}).prototype.ValueTypeName="number";class rde extends dD{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const o=this.resultBuffer,a=this.sampleValues,u=this.valueSize,f=(n-e)/(r-e);let y=t*u;for(let M=y+u;y!==M;y+=4)Iu.slerpFlat(o,0,a,y-u,a,y,f);return o}}class UC extends _g{InterpolantFactoryMethodLinear(t){return new rde(this.times,this.values,this.getValueSize(),t)}}UC.prototype.ValueTypeName="quaternion",UC.prototype.DefaultInterpolation=2301,UC.prototype.InterpolantFactoryMethodSmooth=void 0;class V1 extends _g{}V1.prototype.ValueTypeName="string",V1.prototype.ValueBufferType=Array,V1.prototype.DefaultInterpolation=2300,V1.prototype.InterpolantFactoryMethodLinear=void 0,V1.prototype.InterpolantFactoryMethodSmooth=void 0;(class hD extends _g{}).prototype.ValueTypeName="vector";class lde extends mp{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new rn(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}const NP=new Fr,n6=new Ee,r6=new Ee;class dde{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ei(512,512),this.map=null,this.mapPass=null,this.matrix=new Fr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Y2,this._frameExtents=new ei(1,1),this._viewportCount=1,this._viewports=[new bs(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;n6.setFromMatrixPosition(t.matrixWorld),e.position.copy(n6),r6.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(r6),e.updateMatrixWorld(),NP.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(NP),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(NP)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}const o6=new Fr,VC=new Ee,BP=new Ee;class pde extends dde{constructor(){super(new hd(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ei(4,2),this._viewportCount=6,this._viewports=[new bs(2,1,1,1),new bs(0,1,1,1),new bs(3,1,1,1),new bs(1,1,1,1),new bs(3,0,1,1),new bs(1,0,1,1)],this._cubeDirections=[new Ee(1,0,0),new Ee(-1,0,0),new Ee(0,0,1),new Ee(0,0,-1),new Ee(0,1,0),new Ee(0,-1,0)],this._cubeUps=[new Ee(0,1,0),new Ee(0,1,0),new Ee(0,1,0),new Ee(0,1,0),new Ee(0,0,1),new Ee(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,o=t.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),VC.setFromMatrixPosition(t.matrixWorld),n.position.copy(VC),BP.copy(n.position),BP.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(BP),n.updateMatrixWorld(),r.makeTranslation(-VC.x,-VC.y,-VC.z),o6.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o6)}}class s6 extends lde{constructor(t,e,n=0,r=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new pde}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}const UP="\\[\\]\\.:\\/",Tde=new RegExp("["+UP+"]","g"),VP="[^"+UP+"]",Ade="[^"+UP.replace("\\.","")+"]",Pde=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",VP)+/(WCOD+)?/.source.replace("WCOD",Ade)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",VP)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",VP)+"$"),Lde=["material","materials","bones","map"];class Fde{constructor(t,e,n){const r=n||ea.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=n.length;r!==o;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}let ea=(()=>{class i{constructor(e,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,r){return e&&e.isAnimationObjectGroup?new i.Composite(e,n,r):new i(e,n,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Tde,"")}static parseTrackName(e){const n=Pde.exec(e);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o){const a=r.nodeName.substring(o+1);-1!==Lde.indexOf(a)&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=a)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,n){if(void 0===n||""===n||"."===n||-1===n||n===e.name||n===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(n);if(void 0!==r)return r}if(e.children){const r=function(a){for(let u=0;u<a.length;u++){const f=a[u];if(f.name===n||f.uuid===n)return f;const y=r(f.children);if(y)return y}return null},o=r(e.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const r=this.resolvedProperty;for(let o=0,a=r.length;o!==a;++o)e[n++]=r[o]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const r=this.resolvedProperty;for(let o=0,a=r.length;o!==a;++o)r[o]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const r=this.resolvedProperty;for(let o=0,a=r.length;o!==a;++o)r[o]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const r=this.resolvedProperty;for(let o=0,a=r.length;o!==a;++o)r[o]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,r=n.objectName,o=n.propertyName;let a=n.propertyIndex;if(e||(e=i.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let M=n.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let A=0;A<e.length;A++)if(e[A].name===M){M=A;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==M){if(void 0===e[M])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[M]}}const u=e[o];if(void 0===u)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+o+" but it wasn't found.",e);let f=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?f=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(f=this.Versioning.MatrixWorldNeedsUpdate);let y=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===o){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[a]&&(a=e.morphTargetDictionary[a])}y=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=a}else void 0!==u.fromArray&&void 0!==u.toArray?(y=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(y=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=o;this.getValue=this.GetterByBindingType[y],this.setValue=this.SetterByBindingTypeAndVersioning[y][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=Fde,i})();ea.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ea.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ea.prototype.GetterByBindingType=[ea.prototype._getValue_direct,ea.prototype._getValue_array,ea.prototype._getValue_arrayElement,ea.prototype._getValue_toArray],ea.prototype.SetterByBindingTypeAndVersioning=[[ea.prototype._setValue_direct,ea.prototype._setValue_direct_setNeedsUpdate,ea.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ea.prototype._setValue_array,ea.prototype._setValue_array_setNeedsUpdate,ea.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ea.prototype._setValue_arrayElement,ea.prototype._setValue_arrayElement_setNeedsUpdate,ea.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ea.prototype._setValue_fromArray,ea.prototype._setValue_fromArray_setNeedsUpdate,ea.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class y6{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(Qa(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"154"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="154");const A6={type:"change"},WP={type:"start"},D6={type:"end"};class Ude extends U0{constructor(t,e){super(),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ee,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(ze){ze.addEventListener("keydown",gr),this._domElementKeyEvents=ze},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",gr),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(A6),n.update(),o=r.NONE},this.update=function(){const ze=new Ee,hi=(new Iu).setFromUnitVectors(t.up,new Ee(0,1,0)),vi=hi.clone().invert(),Dt=new Ee,gn=new Iu,Vn=new Ee,Tn=2*Math.PI;return function(){const hn=n.object.position;ze.copy(hn).sub(n.target),ze.applyQuaternion(hi),u.setFromVector3(ze),n.autoRotate&&o===r.NONE&&ce(function Ce(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(u.theta+=f.theta*n.dampingFactor,u.phi+=f.phi*n.dampingFactor):(u.theta+=f.theta,u.phi+=f.phi);let _r=n.minAzimuthAngle,Eo=n.maxAzimuthAngle;return isFinite(_r)&&isFinite(Eo)&&(_r<-Math.PI?_r+=Tn:_r>Math.PI&&(_r-=Tn),Eo<-Math.PI?Eo+=Tn:Eo>Math.PI&&(Eo-=Tn),u.theta=_r<=Eo?Math.max(_r,Math.min(Eo,u.theta)):u.theta>(_r+Eo)/2?Math.max(_r,u.theta):Math.min(Eo,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=y,u.radius=Math.max(n.minDistance,Math.min(n.maxDistance,u.radius)),!0===n.enableDamping?n.target.addScaledVector(M,n.dampingFactor):n.target.add(M),ze.setFromSpherical(u),ze.applyQuaternion(vi),hn.copy(n.target).add(ze),n.object.lookAt(n.target),!0===n.enableDamping?(f.theta*=1-n.dampingFactor,f.phi*=1-n.dampingFactor,M.multiplyScalar(1-n.dampingFactor)):(f.set(0,0,0),M.set(0,0,0)),y=1,!!(A||Dt.distanceToSquared(n.object.position)>a||8*(1-gn.dot(n.object.quaternion))>a||Vn.distanceToSquared(n.target)>0)&&(n.dispatchEvent(A6),Dt.copy(n.object.position),gn.copy(n.object.quaternion),Vn.copy(n.target),A=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Re),n.domElement.removeEventListener("pointerdown",ti),n.domElement.removeEventListener("pointercancel",di),n.domElement.removeEventListener("wheel",un),n.domElement.removeEventListener("pointermove",Ci),n.domElement.removeEventListener("pointerup",di),null!==n._domElementKeyEvents&&(n._domElementKeyEvents.removeEventListener("keydown",gr),n._domElementKeyEvents=null)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=r.NONE;const a=1e-6,u=new y6,f=new y6;let y=1;const M=new Ee;let A=!1;const I=new ei,R=new ei,O=new ei,H=new ei,U=new ei,B=new ei,Z=new ei,X=new ei,ee=new ei,se=[],ve={};function Ve(){return Math.pow(.95,n.zoomSpeed)}function ce(ze){f.theta-=ze}function we(ze){f.phi-=ze}const At=function(){const ze=new Ee;return function(vi,Dt){ze.setFromMatrixColumn(Dt,0),ze.multiplyScalar(-vi),M.add(ze)}}(),ni=function(){const ze=new Ee;return function(vi,Dt){!0===n.screenSpacePanning?ze.setFromMatrixColumn(Dt,1):(ze.setFromMatrixColumn(Dt,0),ze.crossVectors(n.object.up,ze)),ze.multiplyScalar(vi),M.add(ze)}}(),ht=function(){const ze=new Ee;return function(vi,Dt){const gn=n.domElement;if(n.object.isPerspectiveCamera){ze.copy(n.object.position).sub(n.target);let Tn=ze.length();Tn*=Math.tan(n.object.fov/2*Math.PI/180),At(2*vi*Tn/gn.clientHeight,n.object.matrix),ni(2*Dt*Tn/gn.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(At(vi*(n.object.right-n.object.left)/n.object.zoom/gn.clientWidth,n.object.matrix),ni(Dt*(n.object.top-n.object.bottom)/n.object.zoom/gn.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function _t(ze){n.object.isPerspectiveCamera?y/=ze:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*ze)),n.object.updateProjectionMatrix(),A=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Tt(ze){n.object.isPerspectiveCamera?y*=ze:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/ze)),n.object.updateProjectionMatrix(),A=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function at(ze){I.set(ze.clientX,ze.clientY)}function dt(ze){H.set(ze.clientX,ze.clientY)}function gi(){1===se.length?I.set(se[0].pageX,se[0].pageY):I.set(.5*(se[0].pageX+se[1].pageX),.5*(se[0].pageY+se[1].pageY))}function Vi(){1===se.length?H.set(se[0].pageX,se[0].pageY):H.set(.5*(se[0].pageX+se[1].pageX),.5*(se[0].pageY+se[1].pageY))}function kn(){const ze=se[0].pageX-se[1].pageX,hi=se[0].pageY-se[1].pageY,vi=Math.sqrt(ze*ze+hi*hi);Z.set(0,vi)}function mr(ze){if(1==se.length)R.set(ze.pageX,ze.pageY);else{const vi=wi(ze);R.set(.5*(ze.pageX+vi.x),.5*(ze.pageY+vi.y))}O.subVectors(R,I).multiplyScalar(n.rotateSpeed);const hi=n.domElement;ce(2*Math.PI*O.x/hi.clientHeight),we(2*Math.PI*O.y/hi.clientHeight),I.copy(R)}function qo(ze){if(1===se.length)U.set(ze.pageX,ze.pageY);else{const hi=wi(ze);U.set(.5*(ze.pageX+hi.x),.5*(ze.pageY+hi.y))}B.subVectors(U,H).multiplyScalar(n.panSpeed),ht(B.x,B.y),H.copy(U)}function Kn(ze){const hi=wi(ze),vi=ze.pageX-hi.x,Dt=ze.pageY-hi.y,gn=Math.sqrt(vi*vi+Dt*Dt);X.set(0,gn),ee.set(0,Math.pow(X.y/Z.y,n.zoomSpeed)),_t(ee.y),Z.copy(X)}function ti(ze){!1!==n.enabled&&(0===se.length&&(n.domElement.setPointerCapture(ze.pointerId),n.domElement.addEventListener("pointermove",Ci),n.domElement.addEventListener("pointerup",di)),function ye(ze){se.push(ze)}(ze),"touch"===ze.pointerType?function fo(ze){switch(Ei(ze),se.length){case 1:switch(n.touches.ONE){case 0:if(!1===n.enableRotate)return;gi(),o=r.TOUCH_ROTATE;break;case 1:if(!1===n.enablePan)return;Vi(),o=r.TOUCH_PAN;break;default:o=r.NONE}break;case 2:switch(n.touches.TWO){case 2:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Yi(){n.enableZoom&&kn(),n.enablePan&&Vi()})(),o=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function mn(){n.enableZoom&&kn(),n.enableRotate&&gi()})(),o=r.TOUCH_DOLLY_ROTATE;break;default:o=r.NONE}break;default:o=r.NONE}o!==r.NONE&&n.dispatchEvent(WP)}(ze):function Fn(ze){let hi;switch(ze.button){case 0:hi=n.mouseButtons.LEFT;break;case 1:hi=n.mouseButtons.MIDDLE;break;case 2:hi=n.mouseButtons.RIGHT;break;default:hi=-1}switch(hi){case 1:if(!1===n.enableZoom)return;(function ot(ze){Z.set(ze.clientX,ze.clientY)})(ze),o=r.DOLLY;break;case 0:if(ze.ctrlKey||ze.metaKey||ze.shiftKey){if(!1===n.enablePan)return;dt(ze),o=r.PAN}else{if(!1===n.enableRotate)return;at(ze),o=r.ROTATE}break;case 2:if(ze.ctrlKey||ze.metaKey||ze.shiftKey){if(!1===n.enableRotate)return;at(ze),o=r.ROTATE}else{if(!1===n.enablePan)return;dt(ze),o=r.PAN}break;default:o=r.NONE}o!==r.NONE&&n.dispatchEvent(WP)}(ze))}function Ci(ze){!1!==n.enabled&&("touch"===ze.pointerType?function ba(ze){switch(Ei(ze),o){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;mr(ze),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;qo(ze),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Ue(ze){n.enableZoom&&Kn(ze),n.enablePan&&qo(ze)})(ze),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function ki(ze){n.enableZoom&&Kn(ze),n.enableRotate&&mr(ze)})(ze),n.update();break;default:o=r.NONE}}(ze):function on(ze){switch(o){case r.ROTATE:if(!1===n.enableRotate)return;!function It(ze){R.set(ze.clientX,ze.clientY),O.subVectors(R,I).multiplyScalar(n.rotateSpeed);const hi=n.domElement;ce(2*Math.PI*O.x/hi.clientHeight),we(2*Math.PI*O.y/hi.clientHeight),I.copy(R),n.update()}(ze);break;case r.DOLLY:if(!1===n.enableZoom)return;!function Xt(ze){X.set(ze.clientX,ze.clientY),ee.subVectors(X,Z),ee.y>0?_t(Ve()):ee.y<0&&Tt(Ve()),Z.copy(X),n.update()}(ze);break;case r.PAN:if(!1===n.enablePan)return;!function ut(ze){U.set(ze.clientX,ze.clientY),B.subVectors(U,H).multiplyScalar(n.panSpeed),ht(B.x,B.y),H.copy(U),n.update()}(ze)}}(ze))}function di(ze){(function Ht(ze){delete ve[ze.pointerId];for(let hi=0;hi<se.length;hi++)if(se[hi].pointerId==ze.pointerId)return void se.splice(hi,1)})(ze),0===se.length&&(n.domElement.releasePointerCapture(ze.pointerId),n.domElement.removeEventListener("pointermove",Ci),n.domElement.removeEventListener("pointerup",di)),n.dispatchEvent(D6),o=r.NONE}function un(ze){!1===n.enabled||!1===n.enableZoom||o!==r.NONE||(ze.preventDefault(),n.dispatchEvent(WP),function zt(ze){ze.deltaY<0?Tt(Ve()):ze.deltaY>0&&_t(Ve()),n.update()}(ze),n.dispatchEvent(D6))}function gr(ze){!1===n.enabled||!1===n.enablePan||function Ti(ze){let hi=!1;switch(ze.code){case n.keys.UP:ze.ctrlKey||ze.metaKey||ze.shiftKey?we(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):ht(0,n.keyPanSpeed),hi=!0;break;case n.keys.BOTTOM:ze.ctrlKey||ze.metaKey||ze.shiftKey?we(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):ht(0,-n.keyPanSpeed),hi=!0;break;case n.keys.LEFT:ze.ctrlKey||ze.metaKey||ze.shiftKey?ce(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):ht(n.keyPanSpeed,0),hi=!0;break;case n.keys.RIGHT:ze.ctrlKey||ze.metaKey||ze.shiftKey?ce(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):ht(-n.keyPanSpeed,0),hi=!0}hi&&(ze.preventDefault(),n.update())}(ze)}function Re(ze){!1!==n.enabled&&ze.preventDefault()}function Ei(ze){let hi=ve[ze.pointerId];void 0===hi&&(hi=new ei,ve[ze.pointerId]=hi),hi.set(ze.pageX,ze.pageY)}function wi(ze){return ve[(ze.pointerId===se[0].pointerId?se[1]:se[0]).pointerId]}n.domElement.addEventListener("contextmenu",Re),n.domElement.addEventListener("pointerdown",ti),n.domElement.addEventListener("pointercancel",di),n.domElement.addEventListener("wheel",un,{passive:!1}),this.update()}}const Vde=["container"];let Hde=(()=>{class i{ngAfterViewInit(){const e=new fH({canvas:this.container.nativeElement}),n=new mH,r=new hd(45,2,.1,100);r.position.z=50;const o=new s6(16777215,1);n.add(o);const a=new Hd(new Q0(3),new cD({emissive:16750592}));n.add(a);const u=new Hd(new Q0(2),new cD({color:4149685}));u.position.x=20,a.add(u);const f=new Hd(new Q0(1),new cD({color:16772962}));f.position.x=6,u.add(f),new Ude(r,e.domElement);const M=A=>{if(A*=.001,(A=>{const I=A.domElement,R=I.clientWidth,O=I.clientHeight,H=I.width!==R||I.height!==O;return H&&A.setSize(R,O,!1),H})(e)){const I=e.domElement;r.aspect=I.clientWidth/I.clientHeight,r.updateProjectionMatrix()}a.rotation.z=A,u.rotation.z=A,e.render(n,r),requestAnimationFrame(M)};requestAnimationFrame(M)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ui({type:i,selectors:[["view-three"]],viewQuery:function(e,n){if(1&e&&uo(Vde,5),2&e){let r;zi(r=Ui())&&(n.container=r.first)}},standalone:!0,features:[tm],decls:2,vars:0,consts:[[2,"display","block","width","100%","height","100%"],["container",""]],template:function(e,n){1&e&&En(0,"canvas",0,1)},encapsulation:2}),i})();var Gde=Mp(574);const Wde=["container"];let $de=(()=>{class i{ngAfterViewInit(){setTimeout(()=>{new Gde.Map({accessToken:"pk.eyJ1IjoiZG9nZ3ktMDY4IiwiYSI6ImNsa3NjNmk3djAwbjEzY240a3F6Zjc3c20ifQ.Sjh9oAivcu7VaZiOVfKOMA",container:this.container.nativeElement,style:"mapbox://styles/mapbox/streets-v12"})})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ui({type:i,selectors:[["view-map"]],viewQuery:function(e,n){if(1&e&&uo(Wde,5),2&e){let r;zi(r=Ui())&&(n.container=r.first)}},standalone:!0,features:[tm],decls:2,vars:0,consts:[[2,"width","100%","height","100%"],["container",""]],template:function(e,n){1&e&&En(0,"div",0,1)},encapsulation:2}),i})();function I6(i,t){return t?e=>c0(t.pipe(ss(1),function qde(){return to((i,t)=>{i.subscribe(go(t,Yl))})}()),e.pipe(I6(i))):Ms((e,n)=>Tr(i(e,n)).pipe(ss(1),YS(e)))}function k6(i,t=_T){const e=xz(i,t);return I6(()=>e)}const Xde=["mat-menu-item",""];function Zde(i,t){1&i&&(qs(),rt(0,"svg",3),En(1,"polygon",4),mt())}const Yde=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],Kde=["mat-icon, [matMenuItemIcon]","*"];function Jde(i,t){if(1&i){const e=yh();rt(0,"div",0),ji("keydown",function(r){return $r(e),lo(ln()._handleKeydown(r))})("click",function(){return $r(e),lo(ln().closed.emit("click"))})("@transformMenu.start",function(r){return $r(e),lo(ln()._onAnimationStart(r))})("@transformMenu.done",function(r){return $r(e),lo(ln()._onAnimationDone(r))}),rt(1,"div",1),Hi(2),mt()()}if(2&i){const e=ln();Vt("id",e.panelId)("ngClass",e._classList)("@transformMenu",e._panelAnimationState),Mn("aria-label",e.ariaLabel||null)("aria-labelledby",e.ariaLabelledby||null)("aria-describedby",e.ariaDescribedby||null)}}const Qde=["*"],$P=new Ot("MAT_MENU_PANEL"),eue=NE(OE(class{}));let wD=(()=>{class i extends eue{constructor(e,n,r,o,a){super(),this._elementRef=e,this._document=n,this._focusMonitor=r,this._parentMenu=o,this._changeDetectorRef=a,this.role="menuitem",this._hovered=new Fi,this._focused=new Fi,this._highlighted=!1,this._triggersSubmenu=!1,o?.addItem?.(this)}focus(e,n){this._focusMonitor&&e?this._focusMonitor.focusVia(this._getHostElement(),e,n):this._getHostElement().focus(n),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const e=this._elementRef.nativeElement.cloneNode(!0),n=e.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<n.length;r++)n[r].remove();return e.textContent?.trim()||""}_setHighlighted(e){this._highlighted=e,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(e){this._triggersSubmenu=e,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(lr),oe(dg),oe($P,8),oe(vs))},i.\u0275cmp=ui({type:i,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator","mdc-list-item"],hostVars:8,hostBindings:function(e,n){1&e&&ji("click",function(o){return n._checkDisabled(o)})("mouseenter",function(){return n._handleMouseEnter()}),2&e&&(Mn("role",n.role)("tabindex",n._getTabIndex())("aria-disabled",n.disabled)("disabled",n.disabled||null),Un("mat-mdc-menu-item-highlighted",n._highlighted)("mat-mdc-menu-item-submenu-trigger",n._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[Zi],attrs:Xde,ngContentSelectors:Kde,decls:5,vars:3,consts:[[1,"mdc-list-item__primary-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-mdc-menu-submenu-icon","viewBox","0 0 5 10","focusable","false","aria-hidden","true",4,"ngIf"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(e,n){1&e&&(Lo(Yde),Hi(0),rt(1,"span",0),Hi(2,1),mt(),En(3,"div",1),Oi(4,Zde,2,0,"svg",2)),2&e&&(ft(3),Vt("matRippleDisabled",n.disableRipple||n.disabled)("matRippleTrigger",n._getHostElement()),ft(1),Vt("ngIf",n._triggersSubmenu))},dependencies:[cp,S_],encapsulation:2,changeDetection:0}),i})();const tue=new Ot("MatMenuContent"),MD={transformMenu:A_("transformMenu",[ug("void",Qs({opacity:0,transform:"scale(0.8)"})),Su("void => enter",xh("120ms cubic-bezier(0, 0, 0.2, 1)",Qs({opacity:1,transform:"scale(1)"}))),Su("* => void",xh("100ms 25ms linear",Qs({opacity:0})))]),fadeInItems:A_("fadeInItems",[ug("showing",Qs({opacity:1})),Su("void => *",[Qs({opacity:0}),xh("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let iue=0;const R6=new Ot("mat-menu-default-options",{providedIn:"root",factory:function nue(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let HC=(()=>{class i{get xPosition(){return this._xPosition}set xPosition(e){this._xPosition=e,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(e){this._yPosition=e,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(e){this._overlapTrigger=dn(e)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=dn(e)}set panelClass(e){const n=this._previousPanelClass;n&&n.length&&n.split(" ").forEach(r=>{this._classList[r]=!1}),this._previousPanelClass=e,e&&e.length&&(e.split(" ").forEach(r=>{this._classList[r]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(e){this.panelClass=e}constructor(e,n,r,o){this._elementRef=e,this._ngZone=n,this._changeDetectorRef=o,this._directDescendantItems=new Jy,this._classList={},this._panelAnimationState="void",this._animationDone=new Fi,this.closed=new Mi,this.close=this.closed,this.panelId="mat-menu-panel-"+iue++,this.overlayPanelClass=r.overlayPanelClass||"",this._xPosition=r.xPosition,this._yPosition=r.yPosition,this.backdropClass=r.backdropClass,this._overlapTrigger=r.overlapTrigger,this._hasBackdrop=r.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new Jk(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(Oc(this._directDescendantItems),Co(e=>oi(...e.map(n=>n._focused)))).subscribe(e=>this._keyManager.updateActiveItem(e)),this._directDescendantItems.changes.subscribe(e=>{const n=this._keyManager;if("enter"===this._panelAnimationState&&n.activeItem?._hasFocus()){const r=e.toArray(),o=Math.max(0,Math.min(r.length-1,n.activeItemIndex||0));r[o]&&!r[o].disabled?n.setActiveItem(o):n.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusSubscription?.unsubscribe()}_hovered(){return this._directDescendantItems.changes.pipe(Oc(this._directDescendantItems),Co(n=>oi(...n.map(r=>r._hovered))))}addItem(e){}removeItem(e){}_handleKeydown(e){const n=e.keyCode,r=this._keyManager;switch(n){case 27:Nc(e)||(e.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===n||40===n)&&r.setFocusOrigin("keyboard"),void r.onKeydown(e)}e.stopPropagation()}focusFirstItem(e="program"){this._firstItemFocusSubscription?.unsubscribe(),this._firstItemFocusSubscription=this._ngZone.onStable.pipe(ss(1)).subscribe(()=>{let n=null;if(this._directDescendantItems.length&&(n=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!n||!n.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(e).setFirstItemActive(),!r.activeItem&&n&&n.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(e){const n=Math.min(this._baseElevation+e,24),r=`${this._elevationPrefix}${n}`,o=Object.keys(this._classList).find(a=>a.startsWith(this._elevationPrefix));(!o||o===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[r]=!0,this._previousElevation=r)}setPositionClasses(e=this.xPosition,n=this.yPosition){const r=this._classList;r["mat-menu-before"]="before"===e,r["mat-menu-after"]="after"===e,r["mat-menu-above"]="above"===n,r["mat-menu-below"]="below"===n,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(e){this._animationDone.next(e),this._isAnimating=!1}_onAnimationStart(e){this._isAnimating=!0,"enter"===e.toState&&0===this._keyManager.activeItemIndex&&(e.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(Oc(this._allItems)).subscribe(e=>{this._directDescendantItems.reset(e.filter(n=>n._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Ji),oe(R6),oe(vs))},i.\u0275dir=si({type:i,contentQueries:function(e,n,r){if(1&e&&(Qr(r,tue,5),Qr(r,wD,5),Qr(r,wD,4)),2&e){let o;zi(o=Ui())&&(n.lazyContent=o.first),zi(o=Ui())&&(n._allItems=o),zi(o=Ui())&&(n.items=o)}},viewQuery:function(e,n){if(1&e&&uo(sf,5),2&e){let r;zi(r=Ui())&&(n.templateRef=r.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),i})(),rue=(()=>{class i extends HC{constructor(e,n,r,o){super(e,n,r,o),this._elevationPrefix="mat-elevation-z",this._baseElevation=8}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Ji),oe(R6),oe(vs))},i.\u0275cmp=ui({type:i,selectors:[["mat-menu"]],hostAttrs:["ngSkipHydration",""],hostVars:3,hostBindings:function(e,n){2&e&&Mn("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[Qn([{provide:$P,useExisting:i}]),Zi],ngContentSelectors:Qde,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mdc-menu-surface","mdc-menu-surface--open","mat-mdc-elevation-specific",3,"id","ngClass","keydown","click"],[1,"mat-mdc-menu-content","mdc-list"]],template:function(e,n){1&e&&(Lo(),Oi(0,Jde,3,6,"ng-template"))},dependencies:[dE],styles:['.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:none}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(0.8);opacity:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0}[dir=rtl] .mdc-menu-surface,.mdc-menu-surface[dir=rtl]{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}.mdc-menu-surface{max-width:var(--mdc-menu-max-width, calc(100vw - 32px));max-height:var(--mdc-menu-max-height, calc(100vh - 32px));z-index:8;border-radius:var(--mdc-shape-medium, 4px)}mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;list-style-type:none}.mat-mdc-menu-content:focus{outline:none}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-mdc-menu-panel.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;position:relative}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;min-height:48px}.mat-mdc-menu-item:focus{outline:none}[dir=rtl] .mat-mdc-menu-item,.mat-mdc-menu-item[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item.mdc-list-item{align-items:center}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item .mat-icon{margin-right:16px}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:16px}.mat-mdc-menu-item .mdc-list-item__primary-text{white-space:normal}.mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-mdc-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[MD.transformMenu,MD.fadeInItems]},changeDetection:0}),i})();const P6=new Ot("mat-menu-scroll-strategy"),sue={provide:P6,deps:[cf],useFactory:function oue(i){return()=>i.scrollStrategies.reposition()}},L6=w_({passive:!0});let aue=(()=>{class i{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(e){this.menu=e}get menu(){return this._menu}set menu(e){e!==this._menu&&(this._menu=e,this._menuCloseSubscription.unsubscribe(),e&&(this._menuCloseSubscription=e.close.subscribe(n=>{this._destroyMenu(n),("click"===n||"tab"===n)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(n)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(e,n,r,o,a,u,f,y,M){this._overlay=e,this._element=n,this._viewContainerRef=r,this._menuItemInstance=u,this._dir=f,this._focusMonitor=y,this._ngZone=M,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=gt.EMPTY,this._hoverSubscription=gt.EMPTY,this._menuCloseSubscription=gt.EMPTY,this._changeDetectorRef=mi(vs),this._handleTouchStart=A=>{eR(A)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new Mi,this.onMenuOpen=this.menuOpened,this.menuClosed=new Mi,this.onMenuClose=this.menuClosed,this._scrollStrategy=o,this._parentMaterialMenu=a instanceof HC?a:void 0,n.nativeElement.addEventListener("touchstart",this._handleTouchStart,L6)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,L6),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const e=this.menu;if(this._menuOpen||!e)return;const n=this._createOverlay(e),r=n.getConfig(),o=r.positionStrategy;this._setPosition(e,o),r.hasBackdrop=null==e.hasBackdrop?!this.triggersSubmenu():e.hasBackdrop,n.attach(this._getPortal(e)),e.lazyContent&&e.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(e),e instanceof HC&&(e._startAnimation(),e._directDescendantItems.changes.pipe(oo(e.close)).subscribe(()=>{o.withLockedPosition(!1).reapplyLastPosition(),o.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(e,n){this._focusMonitor&&e?this._focusMonitor.focusVia(this._element,e,n):this._element.nativeElement.focus(n)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(e){if(!this._overlayRef||!this.menuOpen)return;const n=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===e||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,n instanceof HC?(n._resetAnimation(),n.lazyContent?n._animationDone.pipe(Ko(r=>"void"===r.toState),ss(1),oo(n.lazyContent._attached)).subscribe({next:()=>n.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),n?.lazyContent?.detach())}_initMenu(e){e.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,e.direction=this.dir,this._setMenuElevation(e),e.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(e){if(e.setElevation){let n=0,r=e.parentMenu;for(;r;)n++,r=r.parentMenu;e.setElevation(n)}}_setIsMenuOpen(e){e!==this._menuOpen&&(this._menuOpen=e,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(e),this._changeDetectorRef.markForCheck())}_createOverlay(e){if(!this._overlayRef){const n=this._getOverlayConfig(e);this._subscribeToPositions(e,n.positionStrategy),this._overlayRef=this._overlay.create(n),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(e){return new uC({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:e.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:e.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(e,n){e.setPositionClasses&&n.positionChanges.subscribe(r=>{const o="start"===r.connectionPair.overlayX?"after":"before",a="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>e.setPositionClasses(o,a)):e.setPositionClasses(o,a)})}_setPosition(e,n){let[r,o]="before"===e.xPosition?["end","start"]:["start","end"],[a,u]="above"===e.yPosition?["bottom","top"]:["top","bottom"],[f,y]=[a,u],[M,A]=[r,o],I=0;if(this.triggersSubmenu()){if(A=r="before"===e.xPosition?"start":"end",o=M="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const R=this._parentMaterialMenu.items.first;this._parentInnerPadding=R?R._getHostElement().offsetTop:0}I="bottom"===a?this._parentInnerPadding:-this._parentInnerPadding}}else e.overlapTrigger||(f="top"===a?"bottom":"top",y="top"===u?"bottom":"top");n.withPositions([{originX:r,originY:f,overlayX:M,overlayY:a,offsetY:I},{originX:o,originY:f,overlayX:A,overlayY:a,offsetY:I},{originX:r,originY:y,overlayX:M,overlayY:u,offsetY:-I},{originX:o,originY:y,overlayX:A,overlayY:u,offsetY:-I}])}_menuClosingActions(){const e=this._overlayRef.backdropClick(),n=this._overlayRef.detachments();return oi(e,this._parentMaterialMenu?this._parentMaterialMenu.closed:Jt(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(Ko(a=>a!==this._menuItemInstance),Ko(()=>this._menuOpen)):Jt(),n)}_handleMousedown(e){Qk(e)||(this._openedBy=0===e.button?"mouse":void 0,this.triggersSubmenu()&&e.preventDefault())}_handleKeydown(e){const n=e.keyCode;(13===n||32===n)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===n&&"ltr"===this.dir||37===n&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(e){this.triggersSubmenu()?(e.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(Ko(e=>e===this._menuItemInstance&&!e.disabled),k6(0,aR)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof HC&&this.menu._isAnimating?this.menu._animationDone.pipe(ss(1),k6(0,aR),oo(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(e){return(!this._portal||this._portal.templateRef!==e.templateRef)&&(this._portal=new rA(e.templateRef,this._viewContainerRef)),this._portal}}return i.\u0275fac=function(e){return new(e||i)(oe(cf),oe(tn),oe(bu),oe(P6),oe($P,8),oe(wD,10),oe(Cu,8),oe(dg),oe(Ji))},i.\u0275dir=si({type:i,hostVars:3,hostBindings:function(e,n){1&e&&ji("click",function(o){return n._handleClick(o)})("mousedown",function(o){return n._handleMousedown(o)})("keydown",function(o){return n._handleKeydown(o)}),2&e&&Mn("aria-haspopup",n.menu?"menu":null)("aria-expanded",n.menuOpen)("aria-controls",n.menuOpen?n.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),i})(),lue=(()=>{class i extends aue{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275dir=si({type:i,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],exportAs:["matMenuTrigger"],features:[Zi]}),i})(),cue=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[sue],imports:[wu,Hw,$o,pC,w0,$o]}),i})(),due=(()=>{class i{constructor(e){this.translateService=e,this.onLocaleItemClick=n=>this.translateService.use(n),this.onThemeItemClick=n=>{fetch(n).then(()=>{document.getElementById("style-manager-theme").href=n})}}}return i.\u0275fac=function(e){return new(e||i)(oe(KT))},i.\u0275cmp=ui({type:i,selectors:[["view-setting"]],standalone:!0,features:[tm],decls:36,vars:8,consts:[[2,"padding","1em"],["role","list"],["role","listitem"],[1,"list-item-container"],["mat-icon-button","",3,"matMenuTriggerFor"],["locale","matMenu"],["mat-menu-item","",3,"click"],["theme","matMenu"]],template:function(e,n){if(1&e&&(rt(0,"div",0)(1,"mat-list",1)(2,"mat-list-item",2)(3,"div",3)(4,"span"),sn(5),Ka(6,"translate"),mt(),rt(7,"button",4)(8,"mat-icon"),sn(9,"translate"),mt()(),rt(10,"mat-menu",null,5)(12,"button",6),ji("click",function(){return n.onLocaleItemClick("en")}),sn(13,"English"),mt(),rt(14,"button",6),ji("click",function(){return n.onLocaleItemClick("zh-CN")}),sn(15,"\u7b80\u4f53\u4e2d\u6587"),mt()()()(),En(16,"mat-divider"),rt(17,"mat-list-item",2)(18,"div",3)(19,"span"),sn(20),Ka(21,"translate"),mt(),rt(22,"button",4)(23,"mat-icon"),sn(24,"palette"),mt()(),rt(25,"mat-menu",null,7)(27,"button",6),ji("click",function(){return n.onThemeItemClick("deeppurple-amber.css")}),sn(28,"Deep Purple & Amber"),mt(),rt(29,"button",6),ji("click",function(){return n.onThemeItemClick("indigo-pink.css")}),sn(30,"Indigo & Pink"),mt(),rt(31,"button",6),ji("click",function(){return n.onThemeItemClick("pink-bluegrey.css")}),sn(32,"Pink & Blue-grey"),mt(),rt(33,"button",6),ji("click",function(){return n.onThemeItemClick("purple-green.css")}),sn(34,"Purple & Green"),mt()()()(),En(35,"mat-divider"),mt()()),2&e){const r=yu(11),o=yu(26);ft(5),Pr(Ja(6,4,"index._view.setting.language")),ft(2),Vt("matMenuTriggerFor",r),ft(13),Pr(Ja(21,6,"index._view.setting.theme")),ft(2),Vt("matMenuTriggerFor",o)}},dependencies:[Zw,rC,tC,eC,jR,lU,vR,uv,M0,T0,S0,cue,rue,wD,lue],styles:[".list-item-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}"]}),i})(),F6=(()=>{class i{fetchData(e){return Yw.getInstance().findTodoById(e)}deteleData(e){return Yw.getInstance().deleteTodoById(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();function uue(i,t){if(1&i){const e=yh();rt(0,"div")(1,"mat-list")(2,"mat-list-item")(3,"span",2),sn(4),Ka(5,"translate"),mt(),rt(6,"span",3),sn(7),mt()(),rt(8,"mat-list-item")(9,"span",2),sn(10),Ka(11,"translate"),mt(),rt(12,"span",3),sn(13),mt()(),rt(14,"mat-list-item")(15,"span",2),sn(16),Ka(17,"translate"),mt(),rt(18,"span",3),sn(19),mt()(),rt(20,"mat-list-item")(21,"span",2),sn(22),Ka(23,"translate"),mt(),rt(24,"span",3),sn(25),mt()()(),rt(26,"div",4)(27,"button",5),ji("click",function(){return $r(e),lo(ln().onDeleteButtonClick())}),sn(28),Ka(29,"translate"),mt(),rt(30,"button",6),ji("click",function(){return $r(e),lo(ln().onEditButtonClick())}),sn(31),Ka(32,"translate"),mt()()()}if(2&i){const e=ln();ft(4),Pr(Ja(5,10,"detail.title")),ft(3),Pr(e.todo.title),ft(3),Pr(Ja(11,12,"detail.type")),ft(3),Pr(e.todo.color),ft(3),Pr(Ja(17,14,"detail.startTime")),ft(3),Pr(e.todo.startTime),ft(3),Pr(Ja(23,16,"detail.content")),ft(3),Pr(e.todo.content),ft(3),Pr(Ja(29,18,"detail.delete")),ft(3),Pr(Ja(32,20,"detail.edit"))}}let hue=(()=>{class i{constructor(e,n,r){this.location=e,this.router=n,this.detailService=r,this.route=mi(sv),this.todo=null,this.onBackClick=()=>this.location.back(),this.onDeleteButtonClick=()=>{const a=Number(this.route.snapshot.queryParams.id);this.detailService.deteleData(a)&&this.location.back()},this.onEditButtonClick=()=>{this.router.navigateByUrl(`/edit?id=${this.route.snapshot.queryParams.id}`)};const o=Number(this.route.snapshot.queryParams.id);this.todo=this.detailService.fetchData(o)}}return i.\u0275fac=function(e){return new(e||i)(oe(s0),oe(Mu),oe(F6))},i.\u0275cmp=ui({type:i,selectors:[["page-detail"]],standalone:!0,features:[Qn([F6]),tm],decls:8,vars:4,consts:[["mat-icon-button","",3,"click"],[4,"ngIf"],["matListItemTitle",""],["matListItemLine",""],[2,"padding","8px 16px","display","flex","justify-content","flex-end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",2,"margin-left","1em",3,"click"]],template:function(e,n){1&e&&(rt(0,"mat-toolbar")(1,"button",0),ji("click",function(){return n.onBackClick()}),rt(2,"mat-icon"),sn(3,"arrow_back"),mt()(),rt(4,"span"),sn(5),Ka(6,"translate"),mt()(),Oi(7,uue,33,22,"div",1)),2&e&&(ft(5),Pr(Ja(6,2,"detail.detail")),ft(2),Vt("ngIf",n.todo))},dependencies:[wu,cp,Zw,rC,oR,rR,tC,eC,jR,HR,VR,uv,WE,M0,T0,S0],encapsulation:2}),i})();const pue=["mat-calendar-body",""];function fue(i,t){if(1&i&&(rt(0,"tr",3)(1,"td",4),sn(2),mt()()),2&i){const e=ln();ft(1),Jf("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),Mn("colspan",e.numCols),ft(1),__(" ",e.label," ")}}function mue(i,t){if(1&i&&(rt(0,"td",4),sn(1),mt()),2&i){const e=ln(2);Jf("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),Mn("colspan",e._firstRowOffset),ft(1),__(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function gue(i,t){if(1&i){const e=yh();rt(0,"td",8)(1,"button",9),ji("click",function(r){const a=$r(e).$implicit;return lo(ln(2)._cellClicked(a,r))})("focus",function(r){const a=$r(e).$implicit;return lo(ln(2)._emitActiveDateChange(a,r))}),rt(2,"span",10),sn(3),mt(),En(4,"span",11),mt()()}if(2&i){const e=t.$implicit,n=t.index,r=ln().index,o=ln();Jf("width",o._cellWidth)("padding-top",o._cellPadding)("padding-bottom",o._cellPadding),Mn("data-mat-row",r)("data-mat-col",n),ft(1),Un("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",o._isActiveCell(r,n))("mat-calendar-body-range-start",o._isRangeStart(e.compareValue))("mat-calendar-body-range-end",o._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",o._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",o._isComparisonBridgeStart(e.compareValue,r,n))("mat-calendar-body-comparison-bridge-end",o._isComparisonBridgeEnd(e.compareValue,r,n))("mat-calendar-body-comparison-start",o._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",o._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",o._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",o._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",o._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",o._isInPreview(e.compareValue)),Vt("ngClass",e.cssClasses)("tabindex",o._isActiveCell(r,n)?0:-1),Mn("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",o._isSelected(e.compareValue))("aria-current",o.todayValue===e.compareValue?"date":null)("aria-describedby",o._getDescribedby(e.compareValue)),ft(1),Un("mat-calendar-body-selected",o._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",o._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",o.todayValue===e.compareValue),ft(1),__(" ",e.displayValue," ")}}function _ue(i,t){if(1&i&&(rt(0,"tr",5),Oi(1,mue,2,6,"td",6),Oi(2,gue,5,48,"td",7),mt()),2&i){const e=t.$implicit,n=t.index,r=ln();ft(1),Vt("ngIf",0===n&&r._firstRowOffset),ft(1),Vt("ngForOf",e)}}function yue(i,t){if(1&i&&(rt(0,"th",5)(1,"span",6),sn(2),mt(),rt(3,"span",7),sn(4),mt()()),2&i){const e=t.$implicit;ft(2),Pr(e.long),ft(2),Pr(e.narrow)}}const vue=["*"];function bue(i,t){}function xue(i,t){if(1&i){const e=yh();rt(0,"mat-month-view",5),ji("activeDateChange",function(r){return $r(e),lo(ln().activeDate=r)})("_userSelection",function(r){return $r(e),lo(ln()._dateSelected(r))})("dragStarted",function(r){return $r(e),lo(ln()._dragStarted(r))})("dragEnded",function(r){return $r(e),lo(ln()._dragEnded(r))}),mt()}if(2&i){const e=ln();Vt("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)("startDateAccessibleName",e.startDateAccessibleName)("endDateAccessibleName",e.endDateAccessibleName)("activeDrag",e._activeDrag)}}function wue(i,t){if(1&i){const e=yh();rt(0,"mat-year-view",6),ji("activeDateChange",function(r){return $r(e),lo(ln().activeDate=r)})("monthSelected",function(r){return $r(e),lo(ln()._monthSelectedInYearView(r))})("selectedChange",function(r){return $r(e),lo(ln()._goToDateInView(r,"month"))}),mt()}if(2&i){const e=ln();Vt("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function Mue(i,t){if(1&i){const e=yh();rt(0,"mat-multi-year-view",7),ji("activeDateChange",function(r){return $r(e),lo(ln().activeDate=r)})("yearSelected",function(r){return $r(e),lo(ln()._yearSelectedInMultiYearView(r))})("selectedChange",function(r){return $r(e),lo(ln()._goToDateInView(r,"year"))}),mt()}if(2&i){const e=ln();Vt("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function Eue(i,t){}const Cue=["button"];function Sue(i,t){1&i&&(qs(),rt(0,"svg",3),En(1,"path",4),mt())}const Tue=[[["","matDatepickerToggleIcon",""]]],Aue=["[matDatepickerToggleIcon]"];let GC=(()=>{class i{constructor(){this.changes=new Fi,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(e,n){return`${e} \u2013 ${n}`}formatYearRangeLabel(e,n){return`${e} to ${n}`}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class qP{constructor(t,e,n,r,o={},a=t,u){this.value=t,this.displayValue=e,this.ariaLabel=n,this.enabled=r,this.cssClasses=o,this.compareValue=a,this.rawValue=u}}let Due=1;const O6=w_({passive:!1,capture:!0}),Av=w_({passive:!0,capture:!0}),ED=w_({passive:!0});let G1=(()=>{class i{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(e,n){this._elementRef=e,this._ngZone=n,this._platform=mi(Js),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new Mi,this.previewChange=new Mi,this.activeDateChange=new Mi,this.dragStarted=new Mi,this.dragEnded=new Mi,this._didDragSinceMouseDown=!1,this._enterHandler=r=>{if(this._skipNextFocus&&"focus"===r.type)this._skipNextFocus=!1;else if(r.target&&this.isRange){const o=this._getCellFromElement(r.target);o&&this._ngZone.run(()=>this.previewChange.emit({value:o.enabled?o:null,event:r}))}},this._touchmoveHandler=r=>{if(!this.isRange)return;const o=N6(r),a=o?this._getCellFromElement(o):null;o!==r.target&&(this._didDragSinceMouseDown=!0),ZP(r.target)&&r.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:a?.enabled?a:null,event:r}))},this._leaveHandler=r=>{null!==this.previewEnd&&this.isRange&&("blur"!==r.type&&(this._didDragSinceMouseDown=!0),r.target&&this._getCellFromElement(r.target)&&(!r.relatedTarget||!this._getCellFromElement(r.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:r})))},this._mousedownHandler=r=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;const o=r.target&&this._getCellFromElement(r.target);!o||!this._isInRange(o.rawValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:o.rawValue,event:r})})},this._mouseupHandler=r=>{if(!this.isRange)return;const o=ZP(r.target);o?o.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{const a=this._getCellFromElement(o);this.dragEnded.emit({value:a?.rawValue??null,event:r})}):this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:r})})},this._touchendHandler=r=>{const o=N6(r);o&&this._mouseupHandler({target:o})},this._id="mat-calendar-body-"+Due++,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,n.runOutsideAngular(()=>{const r=e.nativeElement;r.addEventListener("touchmove",this._touchmoveHandler,O6),r.addEventListener("mouseenter",this._enterHandler,Av),r.addEventListener("focus",this._enterHandler,Av),r.addEventListener("mouseleave",this._leaveHandler,Av),r.addEventListener("blur",this._leaveHandler,Av),r.addEventListener("mousedown",this._mousedownHandler,ED),r.addEventListener("touchstart",this._mousedownHandler,ED),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(e,n){this._didDragSinceMouseDown||e.enabled&&this.selectedValueChange.emit({value:e.value,event:n})}_emitActiveDateChange(e,n){e.enabled&&this.activeDateChange.emit({value:e.value,event:n})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){const n=e.numCols,{rows:r,numCols:o}=this;(e.rows||n)&&(this._firstRowOffset=r&&r.length&&r[0].length?o-r[0].length:0),(e.cellAspectRatio||n||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/o+"%"),(n||!this._cellWidth)&&(this._cellWidth=100/o+"%")}ngOnDestroy(){const e=this._elementRef.nativeElement;e.removeEventListener("touchmove",this._touchmoveHandler,O6),e.removeEventListener("mouseenter",this._enterHandler,Av),e.removeEventListener("focus",this._enterHandler,Av),e.removeEventListener("mouseleave",this._leaveHandler,Av),e.removeEventListener("blur",this._leaveHandler,Av),e.removeEventListener("mousedown",this._mousedownHandler,ED),e.removeEventListener("touchstart",this._mousedownHandler,ED),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(e,n){let r=e*this.numCols+n;return e&&(r-=this._firstRowOffset),r==this.activeCell}_focusActiveCell(e=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(ss(1)).subscribe(()=>{setTimeout(()=>{const n=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");n&&(e||(this._skipNextFocus=!0),n.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return YP(e,this.startValue,this.endValue)}_isRangeEnd(e){return KP(e,this.startValue,this.endValue)}_isInRange(e){return JP(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return YP(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,n,r){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let o=this.rows[n][r-1];if(!o){const a=this.rows[n-1];o=a&&a[a.length-1]}return o&&!this._isRangeEnd(o.compareValue)}_isComparisonBridgeEnd(e,n,r){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let o=this.rows[n][r+1];if(!o){const a=this.rows[n+1];o=a&&a[0]}return o&&!this._isRangeStart(o.compareValue)}_isComparisonEnd(e){return KP(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return JP(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return YP(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return KP(e,this.previewStart,this.previewEnd)}_isInPreview(e){return JP(e,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(e){return this.isRange?this.startValue===e&&this.endValue===e?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===e?this._startDateLabelId:this.endValue===e?this._endDateLabelId:null:null}_getCellFromElement(e){const n=ZP(e);if(n){const r=n.getAttribute("data-mat-row"),o=n.getAttribute("data-mat-col");if(r&&o)return this.rows[parseInt(r)][parseInt(o)]}return null}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(Ji))},i.\u0275cmp=ui({type:i,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[le],attrs:pue,decls:6,vars:6,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],[1,"mat-calendar-body-hidden-label",3,"id"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click","focus"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(e,n){1&e&&(Oi(0,fue,3,6,"tr",0),Oi(1,_ue,3,2,"tr",1),rt(2,"label",2),sn(3),mt(),rt(4,"label",2),sn(5),mt()),2&e&&(Vt("ngIf",n._firstRowOffset<n.labelMinRequiredCells),ft(1),Vt("ngForOf",n.rows),ft(1),Vt("id",n._startDateLabelId),ft(1),__(" ",n.startDateAccessibleName,"\n"),ft(1),Vt("id",n._endDateLabelId),ft(1),__(" ",n.endDateAccessibleName,"\n"))},dependencies:[dE,a0,cp],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}'],encapsulation:2,changeDetection:0}),i})();function XP(i){return"TD"===i?.nodeName}function ZP(i){let t;return XP(i)?t=i:XP(i.parentNode)?t=i.parentNode:XP(i.parentNode?.parentNode)&&(t=i.parentNode.parentNode),null!=t?.getAttribute("data-mat-row")?t:null}function YP(i,t,e){return null!==e&&t!==e&&i<e&&i===t}function KP(i,t,e){return null!==t&&t!==e&&i>=t&&i===e}function JP(i,t,e,n){return n&&null!==t&&null!==e&&t!==e&&i>=t&&i<=e}function N6(i){const t=i.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)}class Pu{constructor(t,e){this.start=t,this.end=e}}let Dv=(()=>{class i{constructor(e,n){this.selection=e,this._adapter=n,this._selectionChanged=new Fi,this.selectionChanged=this._selectionChanged,this.selection=e}updateSelection(e,n){const r=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:n,oldValue:r})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}}return i.\u0275fac=function(e){lp()},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})(),Iue=(()=>{class i extends Dv{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const e=new i(this._adapter);return e.updateSelection(this.selection,this),e}}return i.\u0275fac=function(e){return new(e||i)(it(ud))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const B6={provide:Dv,deps:[[new Id,new Qh,Dv],ud],useFactory:function Rue(i,t){return i||new Iue(t)}},CD=new Ot("MAT_DATE_RANGE_SELECTION_STRATEGY");let z6=(()=>{class i{get activeDate(){return this._activeDate}set activeDate(e){const n=this._activeDate,r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this._hasSameMonthAndYear(n,this._activeDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof Pu?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,n,r,o,a){this._changeDetectorRef=e,this._dateFormats=n,this._dateAdapter=r,this._dir=o,this._rangeStrategy=a,this._rerenderSubscription=gt.EMPTY,this.activeDrag=null,this.selectedChange=new Mi,this._userSelection=new Mi,this.dragStarted=new Mi,this.dragEnded=new Mi,this.activeDateChange=new Mi,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Oc(null)).subscribe(()=>this._init())}ngOnChanges(e){const n=e.comparisonStart||e.comparisonEnd;n&&!n.firstChange&&this._setRanges(this.selected),e.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){const n=e.value,r=this._getDateFromDayOfMonth(n);let o,a;this._selected instanceof Pu?(o=this._getDateInCurrentMonth(this._selected.start),a=this._getDateInCurrentMonth(this._selected.end)):o=a=this._getDateInCurrentMonth(this._selected),(o!==n||a!==n)&&this.selectedChange.emit(r),this._userSelection.emit({value:r,event:e.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){const n=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&e.preventDefault());case 27:return void(null!=this._previewEnd&&!Nc(e)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:e}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e})),e.preventDefault(),e.stopPropagation()));default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:n}){if(this._rangeStrategy){const r=n?n.rawValue:null,o=this._rangeStrategy.createPreview(r,this.selected,e);if(this._previewStart=this._getCellCompareValue(o.start),this._previewEnd=this._getCellCompareValue(o.end),this.activeDrag&&r){const a=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,r,e);a&&(this._previewStart=this._getCellCompareValue(a.start),this._previewEnd=this._getCellCompareValue(a.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(e){if(this.activeDrag)if(e.value){const n=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,e.value,e.event);this.dragEnded.emit({value:n??null,event:e.event})}else this.dragEnded.emit({value:null,event:e.event})}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){const e=this._dateAdapter.getFirstDayOfWeek(),n=this._dateAdapter.getDayOfWeekNames("narrow");let o=this._dateAdapter.getDayOfWeekNames("long").map((a,u)=>({long:a,narrow:n[u]}));this._weekdays=o.slice(e).concat(o.slice(0,e))}_createWeekCells(){const e=this._dateAdapter.getNumDaysInMonth(this.activeDate),n=this._dateAdapter.getDateNames();this._weeks=[[]];for(let r=0,o=this._firstWeekOffset;r<e;r++,o++){7==o&&(this._weeks.push([]),o=0);const a=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),r+1),u=this._shouldEnableDate(a),f=this._dateAdapter.format(a,this._dateFormats.display.dateA11yLabel),y=this.dateClass?this.dateClass(a,"month"):void 0;this._weeks[this._weeks.length-1].push(new qP(r+1,n[r],f,u,y,this._getCellCompareValue(a),a))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,n){return!(!e||!n||this._dateAdapter.getMonth(e)!=this._dateAdapter.getMonth(n)||this._dateAdapter.getYear(e)!=this._dateAdapter.getYear(n))}_getCellCompareValue(e){if(e){const n=this._dateAdapter.getYear(e),r=this._dateAdapter.getMonth(e),o=this._dateAdapter.getDate(e);return new Date(n,r,o).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(e){e instanceof Pu?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}_clearPreview(){this._previewStart=this._previewEnd=null}}return i.\u0275fac=function(e){return new(e||i)(oe(vs),oe(v0,8),oe(ud,8),oe(Cu,8),oe(CD,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-month-view"]],viewQuery:function(e,n){if(1&e&&uo(G1,5),2&e){let r;zi(r=Ui())&&(n._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[le],decls:7,vars:15,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName","selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown"],["scope","col"],[1,"cdk-visually-hidden"],["aria-hidden","true"]],template:function(e,n){1&e&&(rt(0,"table",0)(1,"thead",1)(2,"tr"),Oi(3,yue,5,2,"th",2),mt(),rt(4,"tr"),En(5,"th",3),mt()(),rt(6,"tbody",4),ji("selectedValueChange",function(o){return n._dateSelected(o)})("activeDateChange",function(o){return n._updateActiveDate(o)})("previewChange",function(o){return n._previewChanged(o)})("dragStarted",function(o){return n.dragStarted.emit(o)})("dragEnded",function(o){return n._dragEnded(o)})("keyup",function(o){return n._handleCalendarBodyKeyup(o)})("keydown",function(o){return n._handleCalendarBodyKeydown(o)}),mt()()),2&e&&(ft(3),Vt("ngForOf",n._weekdays),ft(3),Vt("label",n._monthLabel)("rows",n._weeks)("todayValue",n._todayDate)("startValue",n._rangeStart)("endValue",n._rangeEnd)("comparisonStart",n._comparisonRangeStart)("comparisonEnd",n._comparisonRangeEnd)("previewStart",n._previewStart)("previewEnd",n._previewEnd)("isRange",n._isRange)("labelMinRequiredCells",3)("activeCell",n._dateAdapter.getDate(n.activeDate)-1)("startDateAccessibleName",n.startDateAccessibleName)("endDateAccessibleName",n.endDateAccessibleName))},dependencies:[a0,G1],encapsulation:2,changeDetection:0}),i})();const vp=24;let U6=(()=>{class i{get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate;const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),V6(this._dateAdapter,n,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof Pu?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,n,r){this._changeDetectorRef=e,this._dateAdapter=n,this._dir=r,this._rerenderSubscription=gt.EMPTY,this.selectedChange=new Mi,this.yearSelected=new Mi,this.activeDateChange=new Mi,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Oc(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const n=this._dateAdapter.getYear(this._activeDate)-jC(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let r=0,o=[];r<vp;r++)o.push(n+r),4==o.length&&(this._years.push(o.map(a=>this._createCellForYear(a))),o=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){const n=e.value,r=this._dateAdapter.createDate(n,0,1),o=this._getDateFromYear(n);this.yearSelected.emit(r),this.selectedChange.emit(o)}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromYear(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const n=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-jC(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,vp-jC(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*-vp:-vp);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*vp:vp);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return jC(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){const n=this._dateAdapter.getMonth(this.activeDate),r=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,n,1));return this._dateAdapter.createDate(e,n,Math.min(this._dateAdapter.getDate(this.activeDate),r))}_createCellForYear(e){const n=this._dateAdapter.createDate(e,0,1),r=this._dateAdapter.getYearName(n),o=this.dateClass?this.dateClass(n,"multi-year"):void 0;return new qP(e,r,r,this._shouldEnableYear(e),o)}_shouldEnableYear(e){if(null==e||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let r=this._dateAdapter.createDate(e,0,1);this._dateAdapter.getYear(r)==e;r=this._dateAdapter.addCalendarDays(r,1))if(this.dateFilter(r))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(e){if(this._selectedYear=null,e instanceof Pu){const n=e.start||e.end;n&&(this._selectedYear=this._dateAdapter.getYear(n))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}}return i.\u0275fac=function(e){return new(e||i)(oe(vs),oe(ud,8),oe(Cu,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-multi-year-view"]],viewQuery:function(e,n){if(1&e&&uo(G1,5),2&e){let r;zi(r=Ui())&&(n._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(e,n){1&e&&(rt(0,"table",0)(1,"thead",1)(2,"tr"),En(3,"th",2),mt()(),rt(4,"tbody",3),ji("selectedValueChange",function(o){return n._yearSelected(o)})("activeDateChange",function(o){return n._updateActiveDate(o)})("keyup",function(o){return n._handleCalendarBodyKeyup(o)})("keydown",function(o){return n._handleCalendarBodyKeydown(o)}),mt()()),2&e&&(ft(4),Vt("rows",n._years)("todayValue",n._todayYear)("startValue",n._selectedYear)("endValue",n._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",n._getActiveCell()))},dependencies:[G1],encapsulation:2,changeDetection:0}),i})();function V6(i,t,e,n,r){const o=i.getYear(t),a=i.getYear(e),u=H6(i,n,r);return Math.floor((o-u)/vp)===Math.floor((a-u)/vp)}function jC(i,t,e,n){return function Oue(i,t){return(i%t+t)%t}(i.getYear(t)-H6(i,e,n),vp)}function H6(i,t,e){let n=0;return e?n=i.getYear(e)-vp+1:t&&(n=i.getYear(t)),n}let G6=(()=>{class i{get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate;const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this._dateAdapter.getYear(n)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof Pu?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,n,r,o){this._changeDetectorRef=e,this._dateFormats=n,this._dateAdapter=r,this._dir=o,this._rerenderSubscription=gt.EMPTY,this.selectedChange=new Mi,this.monthSelected=new Mi,this.activeDateChange=new Mi,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Oc(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){const n=e.value,r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1);this.monthSelected.emit(r);const o=this._getDateFromMonth(n);this.selectedChange.emit(o)}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromMonth(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const n=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(n=>n.map(r=>this._createCellForMonth(r,e[r]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){const n=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),r=this._dateAdapter.getNumDaysInMonth(n);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),r))}_createCellForMonth(e,n){const r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),o=this._dateAdapter.format(r,this._dateFormats.display.monthYearA11yLabel),a=this.dateClass?this.dateClass(r,"year"):void 0;return new qP(e,n.toLocaleUpperCase(),o,this._shouldEnableMonth(e),a)}_shouldEnableMonth(e){const n=this._dateAdapter.getYear(this.activeDate);if(null==e||this._isYearAndMonthAfterMaxDate(n,e)||this._isYearAndMonthBeforeMinDate(n,e))return!1;if(!this.dateFilter)return!0;for(let o=this._dateAdapter.createDate(n,e,1);this._dateAdapter.getMonth(o)==e;o=this._dateAdapter.addCalendarDays(o,1))if(this.dateFilter(o))return!0;return!1}_isYearAndMonthAfterMaxDate(e,n){if(this.maxDate){const r=this._dateAdapter.getYear(this.maxDate),o=this._dateAdapter.getMonth(this.maxDate);return e>r||e===r&&n>o}return!1}_isYearAndMonthBeforeMinDate(e,n){if(this.minDate){const r=this._dateAdapter.getYear(this.minDate),o=this._dateAdapter.getMonth(this.minDate);return e<r||e===r&&n<o}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(e){this._selectedMonth=e instanceof Pu?this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._getMonthInCurrentYear(e)}}return i.\u0275fac=function(e){return new(e||i)(oe(vs),oe(v0,8),oe(ud,8),oe(Cu,8))},i.\u0275cmp=ui({type:i,selectors:[["mat-year-view"]],viewQuery:function(e,n){if(1&e&&uo(G1,5),2&e){let r;zi(r=Ui())&&(n._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(e,n){1&e&&(rt(0,"table",0)(1,"thead",1)(2,"tr"),En(3,"th",2),mt()(),rt(4,"tbody",3),ji("selectedValueChange",function(o){return n._monthSelected(o)})("activeDateChange",function(o){return n._updateActiveDate(o)})("keyup",function(o){return n._handleCalendarBodyKeyup(o)})("keydown",function(o){return n._handleCalendarBodyKeydown(o)}),mt()()),2&e&&(ft(4),Vt("label",n._yearLabel)("rows",n._months)("todayValue",n._todayMonth)("startValue",n._selectedMonth)("endValue",n._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",n._dateAdapter.getMonth(n.activeDate)))},dependencies:[G1],encapsulation:2,changeDetection:0}),i})(),Nue=1,Bue=(()=>{class i{constructor(e,n,r,o,a){this._intl=e,this.calendar=n,this._dateAdapter=r,this._dateFormats=o,this._id="mat-calendar-header-"+Nue++,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>a.markForCheck())}get periodButtonText(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-vp)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:vp)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,n){return"month"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(n):"year"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n):V6(this._dateAdapter,e,n,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){const n=this._dateAdapter.getYear(this.calendar.activeDate)-jC(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),r=n+vp-1;return[this._dateAdapter.getYearName(this._dateAdapter.createDate(n,0,1)),this._dateAdapter.getYearName(this._dateAdapter.createDate(r,0,1))]}}return i.\u0275fac=function(e){return new(e||i)(oe(GC),oe(ir(()=>tL)),oe(ud,8),oe(v0,8),oe(vs))},i.\u0275cmp=ui({type:i,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:vue,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"],[1,"mat-calendar-hidden-label",3,"id"]],template:function(e,n){1&e&&(Lo(),rt(0,"div",0)(1,"div",1)(2,"button",2),ji("click",function(){return n.currentPeriodClicked()}),rt(3,"span",3),sn(4),mt(),qs(),rt(5,"svg",4),En(6,"polygon",5),mt()(),Og(),En(7,"div",6),Hi(8),rt(9,"button",7),ji("click",function(){return n.previousClicked()}),mt(),rt(10,"button",8),ji("click",function(){return n.nextClicked()}),mt()()(),rt(11,"label",9),sn(12),mt()),2&e&&(ft(2),Mn("aria-label",n.periodButtonLabel)("aria-describedby",n._periodButtonLabelId),ft(2),Pr(n.periodButtonText),ft(1),Un("mat-calendar-invert","month"!==n.calendar.currentView),ft(4),Vt("disabled",!n.previousEnabled()),Mn("aria-label",n.prevButtonLabel),ft(1),Vt("disabled",!n.nextEnabled()),Mn("aria-label",n.nextButtonLabel),ft(1),Vt("id",n._periodButtonLabelId),ft(1),Pr(n.periodButtonDescription))},dependencies:[WE,M0],encapsulation:2,changeDetection:0}),i})(),tL=(()=>{class i{get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get selected(){return this._selected}set selected(e){this._selected=e instanceof Pu?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(e){const n=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),n&&this.viewChanged.emit(n)}constructor(e,n,r,o){this._dateAdapter=n,this._dateFormats=r,this._changeDetectorRef=o,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new Mi,this.yearSelected=new Mi,this.monthSelected=new Mi,this.viewChanged=new Mi(!0),this._userSelection=new Mi,this._userDragDrop=new Mi,this._activeDrag=null,this.stateChanges=new Fi,this._intlChanges=e.changes.subscribe(()=>{o.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new lC(this.headerComponent||Bue),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){const n=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,r=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,o=n||r||e.dateFilter;if(o&&!o.firstChange){const a=this._getCurrentViewComponent();a&&(this._changeDetectorRef.detectChanges(),a._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){const n=e.value;(this.selected instanceof Pu||n&&!this._dateAdapter.sameDate(n,this.selected))&&this.selectedChange.emit(n),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,n){this.activeDate=e,this.currentView=n}_dragStarted(e){this._activeDrag=e}_dragEnded(e){this._activeDrag&&(e.value&&this._userDragDrop.emit(e),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}}return i.\u0275fac=function(e){return new(e||i)(oe(GC),oe(ud,8),oe(v0,8),oe(vs))},i.\u0275cmp=ui({type:i,selectors:[["mat-calendar"]],viewQuery:function(e,n){if(1&e&&(uo(z6,5),uo(G6,5),uo(U6,5)),2&e){let r;zi(r=Ui())&&(n.monthView=r.first),zi(r=Ui())&&(n.yearView=r.first),zi(r=Ui())&&(n.multiYearView=r.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[Qn([B6]),le],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(e,n){1&e&&(Oi(0,bue,0,0,"ng-template",0),rt(1,"div",1),Oi(2,xue,1,11,"mat-month-view",2),Oi(3,wue,1,6,"mat-year-view",3),Oi(4,Mue,1,6,"mat-multi-year-view",4),mt()),2&e&&(Vt("cdkPortalOutlet",n._calendarHeaderPortal),ft(1),Vt("ngSwitch",n.currentView),ft(1),Vt("ngSwitchCase","month"),ft(1),Vt("ngSwitchCase","year"),ft(1),Vt("ngSwitchCase","multi-year"))},dependencies:[l0,uE,iK,cC,z6,G6,U6],styles:['.mat-calendar{display:block}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}.mat-calendar-hidden-label{display:none}'],encapsulation:2,changeDetection:0}),i})();const j6={transformPanel:A_("transformPanel",[Su("void => enter-dropdown",xh("120ms cubic-bezier(0, 0, 0.2, 1)",Tz([Qs({opacity:0,transform:"scale(1, 0.8)"}),Qs({opacity:1,transform:"scale(1, 1)"})]))),Su("void => enter-dialog",xh("150ms cubic-bezier(0, 0, 0.2, 1)",Tz([Qs({opacity:0,transform:"scale(0.7)"}),Qs({transform:"none",opacity:1})]))),Su("* => void",xh("100ms linear",Qs({opacity:0})))]),fadeInCalendar:A_("fadeInCalendar",[ug("void",Qs({opacity:0})),ug("enter",Qs({opacity:1})),Su("void => *",xh("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let zue=0;const W6=new Ot("mat-datepicker-scroll-strategy"),Vue={provide:W6,deps:[cf],useFactory:function Uue(i){return()=>i.scrollStrategies.reposition()}},Hue=Vw(class{constructor(i){this._elementRef=i}});let Gue=(()=>{class i extends Hue{constructor(e,n,r,o,a,u){super(e),this._changeDetectorRef=n,this._globalModel=r,this._dateAdapter=o,this._rangeSelectionStrategy=a,this._subscriptions=new gt,this._animationDone=new Fi,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=u.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){const n=this._model.selection,r=e.value,o=n instanceof Pu;if(o&&this._rangeSelectionStrategy){const a=this._rangeSelectionStrategy.selectionFinished(r,n,e.event);this._model.updateSelection(a,this)}else r&&(o||!this._dateAdapter.sameDate(r,n))&&this._model.add(r);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(e){this._model.updateSelection(e.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(e){this._isAnimating="start"===e.phaseName,this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,n){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,n&&this._changeDetectorRef.detectChanges()}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(vs),oe(Dv),oe(ud),oe(CD,8),oe(GC))},i.\u0275cmp=ui({type:i,selectors:[["mat-datepicker-content"]],viewQuery:function(e,n){if(1&e&&uo(tL,5),2&e){let r;zi(r=Ui())&&(n._calendar=r.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(e,n){1&e&&yS("@transformPanel.start",function(o){return n._handleAnimationEvent(o)})("@transformPanel.done",function(o){return n._handleAnimationEvent(o)}),2&e&&(xS("@transformPanel",n._animationState),Un("mat-datepicker-content-touch",n.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[Zi],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(e,n){if(1&e&&(rt(0,"div",0)(1,"mat-calendar",1),ji("yearSelected",function(o){return n.datepicker._selectYear(o)})("monthSelected",function(o){return n.datepicker._selectMonth(o)})("viewChanged",function(o){return n.datepicker._viewChanged(o)})("_userSelection",function(o){return n._handleUserSelection(o)})("_userDragDrop",function(o){return n._handleUserDragDrop(o)}),mt(),Oi(2,Eue,0,0,"ng-template",2),rt(3,"button",3),ji("focus",function(){return n._closeButtonFocused=!0})("blur",function(){return n._closeButtonFocused=!1})("click",function(){return n.datepicker.close()}),sn(4),mt()()),2&e){let r;Un("mat-datepicker-content-container-with-custom-header",n.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",n._actionsPortal),Mn("aria-modal",!0)("aria-labelledby",null!==(r=n._dialogLabelId)&&void 0!==r?r:void 0),ft(1),Vt("id",n.datepicker.id)("ngClass",n.datepicker.panelClass)("startAt",n.datepicker.startAt)("startView",n.datepicker.startView)("minDate",n.datepicker._getMinDate())("maxDate",n.datepicker._getMaxDate())("dateFilter",n.datepicker._getDateFilter())("headerComponent",n.datepicker.calendarHeaderComponent)("selected",n._getSelected())("dateClass",n.datepicker.dateClass)("comparisonStart",n.comparisonStart)("comparisonEnd",n.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",n.startDateAccessibleName)("endDateAccessibleName",n.endDateAccessibleName),ft(1),Vt("cdkPortalOutlet",n._actionsPortal),ft(1),Un("cdk-visually-hidden",!n._closeButtonFocused),Vt("color",n.color||"primary"),ft(1),Pr(n._closeButtonText)}},dependencies:[dE,WE,$Y,cC,tL],styles:[".mat-datepicker-content{display:block;border-radius:4px}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[j6.transformPanel,j6.fadeInCalendar]},changeDetection:0}),i})(),$6=(()=>{class i{get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(e){this._color=e}get touchUi(){return this._touchUi}set touchUi(e){this._touchUi=dn(e)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(e){const n=dn(e);n!==this._disabled&&(this._disabled=n,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(e){this._restoreFocus=dn(e)}get panelClass(){return this._panelClass}set panelClass(e){this._panelClass=function CY(i,t=/\s+/){const e=[];if(null!=i){const n=Array.isArray(i)?i:`${i}`.split(t);for(const r of n){const o=`${r}`.trim();o&&e.push(o)}}return e}(e)}get opened(){return this._opened}set opened(e){dn(e)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}constructor(e,n,r,o,a,u,f){this._overlay=e,this._ngZone=n,this._viewContainerRef=r,this._dateAdapter=a,this._dir=u,this._model=f,this._inputStateChanges=gt.EMPTY,this._document=mi(lr),this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new Mi,this.monthSelected=new Mi,this.viewChanged=new Mi(!0),this.openedStream=new Mi,this.closedStream=new Mi,this._opened=!1,this.id="mat-datepicker-"+zue++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new Fi,this._scrollStrategy=o}ngOnChanges(e){const n=e.xPosition||e.yPosition;if(n&&!n.firstChange&&this._overlayRef){const r=this._overlayRef.getConfig().positionStrategy;r instanceof e4&&(this._setConnectedPositions(r),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(e){this._model.add(e)}_selectYear(e){this.yearSelected.emit(e)}_selectMonth(e){this.monthSelected.emit(e)}_viewChanged(e){this.viewChanged.emit(e)}registerInput(e){return this._inputStateChanges.unsubscribe(),this.datepickerInput=e,this._inputStateChanges=e.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(e){this._actionsPortal=e,this._componentRef?.instance._assignActions(e,!0)}removeActions(e){e===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this._focusedElementBeforeOpen=zw(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;const e=this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus,n=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){const{instance:r,location:o}=this._componentRef;r._startExitAnimation(),r._animationDone.pipe(ss(1)).subscribe(()=>{const a=this._document.activeElement;e&&(!a||a===this._document.activeElement||o.nativeElement.contains(a))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}e?setTimeout(n):n()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(e){e.datepicker=this,e.color=this.color,e._dialogLabelId=this.datepickerInput.getOverlayLabelId(),e._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();const e=this.touchUi,n=new lC(Gue,this._viewContainerRef),r=this._overlayRef=this._overlay.create(new uC({positionStrategy:e?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[e?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:e?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(e?"dialog":"popup")}));this._getCloseStream(r).subscribe(o=>{o&&o.preventDefault(),this.close()}),r.keydownEvents().subscribe(o=>{const a=o.keyCode;(38===a||40===a||37===a||39===a||33===a||34===a)&&o.preventDefault()}),this._componentRef=r.attach(n),this._forwardContentValues(this._componentRef.instance),e||this._ngZone.onStable.pipe(ss(1)).subscribe(()=>r.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const e=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){const n="end"===this.xPosition?"end":"start",r="start"===n?"end":"start",o="above"===this.yPosition?"bottom":"top",a="top"===o?"bottom":"top";return e.withPositions([{originX:n,originY:a,overlayX:n,overlayY:o},{originX:n,originY:o,overlayX:n,overlayY:a},{originX:r,originY:a,overlayX:r,overlayY:o},{originX:r,originY:o,overlayX:r,overlayY:a}])}_getCloseStream(e){const n=["ctrlKey","shiftKey","metaKey"];return oi(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(Ko(r=>27===r.keyCode&&!Nc(r)||this.datepickerInput&&Nc(r,"altKey")&&38===r.keyCode&&n.every(o=>!Nc(r,o)))))}}return i.\u0275fac=function(e){return new(e||i)(oe(cf),oe(Ji),oe(bu),oe(W6),oe(ud,8),oe(Cu,8),oe(Dv))},i.\u0275dir=si({type:i,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[le]}),i})(),jue=(()=>{class i extends $6{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275cmp=ui({type:i,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[Qn([B6,{provide:$6,useExisting:i}]),Zi],decls:0,vars:0,template:function(e,n){},encapsulation:2,changeDetection:0}),i})();class SD{constructor(t,e){this.target=t,this.targetElement=e,this.value=this.target.value}}let Wue=(()=>{class i{get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(e){this._assignValueProgrammatically(e)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(e){const n=dn(e),r=this._elementRef.nativeElement;this._disabled!==n&&(this._disabled=n,this.stateChanges.next(void 0)),n&&this._isInitialized&&r.blur&&r.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(e){this._model=e,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(n=>{if(this._shouldHandleChangeEvent(n)){const r=this._getValueFromModel(n.selection);this._lastValueValid=this._isValidValue(r),this._cvaOnChange(r),this._onTouched(),this._formatValue(r),this.dateInput.emit(new SD(this,this._elementRef.nativeElement)),this.dateChange.emit(new SD(this,this._elementRef.nativeElement))}})}constructor(e,n,r){this._elementRef=e,this._dateAdapter=n,this._dateFormats=r,this.dateChange=new Mi,this.dateInput=new Mi,this.stateChanges=new Fi,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=gt.EMPTY,this._localeSubscription=gt.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=o=>{const a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(o.value));return!a||this._matchesFilter(a)?null:{matDatepickerFilter:!0}},this._minValidator=o=>{const a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(o.value)),u=this._getMinDate();return!u||!a||this._dateAdapter.compareDate(u,a)<=0?null:{matDatepickerMin:{min:u,actual:a}}},this._maxValidator=o=>{const a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(o.value)),u=this._getMaxDate();return!u||!a||this._dateAdapter.compareDate(u,a)>=0?null:{matDatepickerMax:{max:u,actual:a}}},this._lastValueValid=!1,this._localeSubscription=n.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(e){(function $ue(i,t){const e=Object.keys(i);for(let n of e){const{previousValue:r,currentValue:o}=i[n];if(!t.isDateInstance(r)||!t.isDateInstance(o))return!0;if(!t.sameDate(r,o))return!0}return!1})(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}writeValue(e){this._assignValueProgrammatically(e)}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){Nc(e,"altKey")&&40===e.keyCode&&["ctrlKey","shiftKey","metaKey"].every(o=>!Nc(e,o))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),e.preventDefault())}_onInput(e){const n=this._lastValueValid;let r=this._dateAdapter.parse(e,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(r),r=this._dateAdapter.getValidDateOrNull(r);const o=!this._dateAdapter.sameDate(r,this.value);!r||o?this._cvaOnChange(r):(e&&!this.value&&this._cvaOnChange(r),n!==this._lastValueValid&&this._validatorOnChange()),o&&(this._assignValue(r),this.dateInput.emit(new SD(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new SD(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(e){this._elementRef.nativeElement.value=null!=e?this._dateAdapter.format(e,this._dateFormats.display.dateInput):""}_assignValue(e){this._model?(this._assignValueToModel(e),this._pendingValue=null):this._pendingValue=e}_isValidValue(e){return!e||this._dateAdapter.isValid(e)}_parentDisabled(){return!1}_assignValueProgrammatically(e){e=this._dateAdapter.deserialize(e),this._lastValueValid=this._isValidValue(e),e=this._dateAdapter.getValidDateOrNull(e),this._assignValue(e),this._formatValue(e)}_matchesFilter(e){const n=this._getDateFilter();return!n||n(e)}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(ud,8),oe(v0,8))},i.\u0275dir=si({type:i,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[le]}),i})();const que={provide:wh,useExisting:ir(()=>iL),multi:!0},Xue={provide:Bc,useExisting:ir(()=>iL),multi:!0};let iL=(()=>{class i extends Wue{set matDatepicker(e){e&&(this._datepicker=e,this._closedSubscription=e.closedStream.subscribe(()=>this._onTouched()),this._registerModel(e.registerInput(this)))}get min(){return this._min}set min(e){const n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(n,this._min)||(this._min=n,this._validatorOnChange())}get max(){return this._max}set max(e){const n=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(n,this._max)||(this._max=n,this._validatorOnChange())}get dateFilter(){return this._dateFilter}set dateFilter(e){const n=this._matchesFilter(this.value);this._dateFilter=e,this._matchesFilter(this.value)!==n&&this._validatorOnChange()}constructor(e,n,r,o){super(e,n,r),this._formField=o,this._closedSubscription=gt.EMPTY,this._validator=OT.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(e){return e}_assignValueToModel(e){this._model&&this._model.updateSelection(e,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(e){return e.source!==this}}return i.\u0275fac=function(e){return new(e||i)(oe(tn),oe(ud,8),oe(v0,8),oe(oC,8))},i.\u0275dir=si({type:i,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(e,n){1&e&&ji("input",function(o){return n._onInput(o.target.value)})("change",function(){return n._onChange()})("blur",function(){return n._onBlur()})("keydown",function(o){return n._onKeydown(o)}),2&e&&(vh("disabled",n.disabled),Mn("aria-haspopup",n._datepicker?"dialog":null)("aria-owns",(null==n._datepicker?null:n._datepicker.opened)&&n._datepicker.id||null)("min",n.min?n._dateAdapter.toIso8601(n.min):null)("max",n.max?n._dateAdapter.toIso8601(n.max):null)("data-mat-calendar",n._datepicker?n._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:["matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[Qn([que,Xue,{provide:b4,useExisting:i}]),Zi]}),i})(),Zue=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=si({type:i,selectors:[["","matDatepickerToggleIcon",""]]}),i})(),Yue=(()=>{class i{get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=dn(e)}constructor(e,n,r){this._intl=e,this._changeDetectorRef=n,this._stateChanges=gt.EMPTY;const o=Number(r);this.tabIndex=o||0===o?o:null}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){const e=this.datepicker?this.datepicker.stateChanges:Jt(),n=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:Jt(),r=this.datepicker?oi(this.datepicker.openedStream,this.datepicker.closedStream):Jt();this._stateChanges.unsubscribe(),this._stateChanges=oi(this._intl.changes,e,n,r).subscribe(()=>this._changeDetectorRef.markForCheck())}}return i.\u0275fac=function(e){return new(e||i)(oe(GC),oe(vs),Bl("tabindex"))},i.\u0275cmp=ui({type:i,selectors:[["mat-datepicker-toggle"]],contentQueries:function(e,n,r){if(1&e&&Qr(r,Zue,5),2&e){let o;zi(o=Ui())&&(n._customIcon=o.first)}},viewQuery:function(e,n){if(1&e&&uo(Cue,5),2&e){let r;zi(r=Ui())&&(n._button=r.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(e,n){1&e&&ji("click",function(o){return n._open(o)}),2&e&&(Mn("tabindex",null)("data-mat-calendar",n.datepicker?n.datepicker.id:null),Un("mat-datepicker-toggle-active",n.datepicker&&n.datepicker.opened)("mat-accent",n.datepicker&&"accent"===n.datepicker.color)("mat-warn",n.datepicker&&"warn"===n.datepicker.color))},inputs:{datepicker:["for","datepicker"],tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],disabled:"disabled",disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[le],ngContentSelectors:Aue,decls:4,vars:6,consts:[["mat-icon-button","","type","button",3,"disabled","disableRipple"],["button",""],["class","mat-datepicker-toggle-default-icon","viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",4,"ngIf"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(e,n){1&e&&(Lo(Tue),rt(0,"button",0,1),Oi(2,Sue,2,0,"svg",2),Hi(3),mt()),2&e&&(Vt("disabled",n.disabled)("disableRipple",n.disableRipple),Mn("aria-haspopup",n.datepicker?"dialog":null)("aria-label",n.ariaLabel||n._intl.openCalendarLabel)("tabindex",n.disabled?-1:n.tabIndex),ft(2),Vt("ngIf",!n._customIcon))},dependencies:[cp,M0],styles:[".mat-datepicker-toggle{pointer-events:auto}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0}),i})(),Que=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[GC,Vue],imports:[wu,uv,pC,sz,dC,$o,w0]}),i})();const ehe=["trigger"],the=["panel"];function ihe(i,t){if(1&i&&(rt(0,"span",10),sn(1),mt()),2&i){const e=ln();ft(1),Pr(e.placeholder)}}function nhe(i,t){if(1&i&&(rt(0,"span",14),sn(1),mt()),2&i){const e=ln(2);ft(1),Pr(e.triggerValue)}}function rhe(i,t){1&i&&Hi(0,0,["*ngSwitchCase","true"])}function ohe(i,t){1&i&&(rt(0,"span",11),Oi(1,nhe,2,1,"span",12),Oi(2,rhe,1,0,"ng-content",13),mt()),2&i&&(Vt("ngSwitch",!!ln().customTrigger),ft(2),Vt("ngSwitchCase",!0))}function she(i,t){if(1&i){const e=yh();qs(),Og(),rt(0,"div",15,16),ji("@transformPanel.done",function(r){return $r(e),lo(ln()._panelDoneAnimatingStream.next(r.toState))})("keydown",function(r){return $r(e),lo(ln()._handleKeydown(r))}),Hi(2,1),mt()}if(2&i){const e=ln();FF("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",e._getPanelTheme(),""),Vt("ngClass",e.panelClass)("@transformPanel","showing"),Mn("id",e.id+"-panel")("aria-multiselectable",e.multiple)("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby())}}const ahe=[[["mat-select-trigger"]],"*"],lhe=["mat-select-trigger","*"],che={transformPanelWrap:A_("transformPanelWrap",[Su("* => void",cR("@transformPanel",[lR()],{optional:!0}))]),transformPanel:A_("transformPanel",[ug("void",Qs({opacity:0,transform:"scale(1, 0.8)"})),Su("void => showing",xh("120ms cubic-bezier(0, 0, 0.2, 1)",Qs({opacity:1,transform:"scale(1, 1)"}))),Su("* => void",xh("100ms linear",Qs({opacity:0})))])};let X6=0;const Z6=new Ot("mat-select-scroll-strategy"),uhe=new Ot("MAT_SELECT_CONFIG"),hhe={provide:Z6,deps:[cf],useFactory:function dhe(i){return()=>i.scrollStrategies.reposition()}},phe=new Ot("MatSelectTrigger");class fhe{constructor(t,e){this.source=t,this.value=e}}const mhe=NE(BE(OE(iR(class{constructor(i,t,e,n,r){this._elementRef=i,this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=n,this.ngControl=r,this.stateChanges=new Fi}}))));let ghe=(()=>{class i extends mhe{get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(OT.required)??!1}set required(e){this._required=dn(e),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(e){this._multiple=dn(e)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(e){this._disableOptionCentering=dn(e)}get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this._assignValue(e)&&this._onChange(e)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(e){this._typeaheadDebounceInterval=dv(e)}get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}constructor(e,n,r,o,a,u,f,y,M,A,I,R,O,H){super(a,o,f,y,A),this._viewportRuler=e,this._changeDetectorRef=n,this._ngZone=r,this._dir=u,this._parentFormField=M,this._liveAnnouncer=O,this._defaultOptions=H,this._panelOpen=!1,this._compareWith=(U,B)=>U===B,this._uid="mat-select-"+X6++,this._triggerAriaLabelledBy=null,this._destroy=new Fi,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+X6++,this._panelDoneAnimatingStream=new Fi,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=d0(()=>{const U=this.options;return U?U.changes.pipe(Oc(U),Co(()=>oi(...U.map(B=>B.onSelectionChange)))):this._ngZone.onStable.pipe(ss(1),Co(()=>this.optionSelectionChanges))}),this.openedChange=new Mi,this._openedStream=this.openedChange.pipe(Ko(U=>U),vn(()=>{})),this._closedStream=this.openedChange.pipe(Ko(U=>!U),vn(()=>{})),this.selectionChange=new Mi,this.valueChange=new Mi,this._trackedModal=null,this.ngControl&&(this.ngControl.valueAccessor=this),null!=H?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=H.typeaheadDebounceInterval),this._scrollStrategyFactory=R,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(I)||0,this.id=this.id}ngOnInit(){this._selectionModel=new bR(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(Jn(),oo(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(oo(this._destroy)).subscribe(e=>{e.added.forEach(n=>n.select()),e.removed.forEach(n=>n.deselect())}),this.options.changes.pipe(Oc(null),oo(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const e=this._getTriggerAriaLabelledby(),n=this.ngControl;if(e!==this._triggerAriaLabelledBy){const r=this._elementRef.nativeElement;this._triggerAriaLabelledBy=e,e?r.setAttribute("aria-labelledby",e):r.removeAttribute("aria-labelledby")}n&&(this._previousControl!==n.control&&(void 0!==this._previousControl&&null!==n.disabled&&n.disabled!==this.disabled&&(this.disabled=n.disabled),this._previousControl=n.control),this.updateErrorState())}ngOnChanges(e){(e.disabled||e.userAriaDescribedBy)&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}_applyModalPanelOwnership(){const e=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;const n=`${this.id}-panel`;this._trackedModal&&K3(this._trackedModal,"aria-owns",n),function kY(i,t,e){const n=J3(i,t);n.some(r=>r.trim()==e.trim())||(n.push(e.trim()),i.setAttribute(t,n.join(" ")))}(e,"aria-owns",n),this._trackedModal=e}_clearFromModal(){this._trackedModal&&(K3(this._trackedModal,"aria-owns",`${this.id}-panel`),this._trackedModal=null)}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(e){this._assignValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const e=this._selectionModel.selected.map(n=>n.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){const n=e.keyCode,r=40===n||38===n||37===n||39===n,o=13===n||32===n,a=this._keyManager;if(!a.isTyping()&&o&&!Nc(e)||(this.multiple||e.altKey)&&r)e.preventDefault(),this.open();else if(!this.multiple){const u=this.selected;a.onKeydown(e);const f=this.selected;f&&u!==f&&this._liveAnnouncer.announce(f.viewValue,1e4)}}_handleOpenKeydown(e){const n=this._keyManager,r=e.keyCode,o=40===r||38===r,a=n.isTyping();if(o&&e.altKey)e.preventDefault(),this.close();else if(a||13!==r&&32!==r||!n.activeItem||Nc(e))if(!a&&this._multiple&&65===r&&e.ctrlKey){e.preventDefault();const u=this.options.some(f=>!f.disabled&&!f.selected);this.options.forEach(f=>{f.disabled||(u?f.select():f.deselect())})}else{const u=n.activeItemIndex;n.onKeydown(e),this._multiple&&o&&e.shiftKey&&n.activeItem&&n.activeItemIndex!==u&&n.activeItem._selectViaInteraction()}else e.preventDefault(),n.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(ss(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this.options.forEach(n=>n.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&e)Array.isArray(e),e.forEach(n=>this._selectOptionByValue(n)),this._sortValues();else{const n=this._selectOptionByValue(e);n?this._keyManager.updateActiveItem(n):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(e){const n=this.options.find(r=>{if(this._selectionModel.isSelected(r))return!1;try{return null!=r.value&&this._compareWith(r.value,e)}catch{return!1}});return n&&this._selectionModel.select(n),n}_assignValue(e){return!!(e!==this._value||this._multiple&&Array.isArray(e))&&(this.options&&this._setSelectionByValue(e),this._value=e,!0)}_skipPredicate(e){return e.disabled}_initKeyManager(){this._keyManager=new LY(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const e=oi(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(oo(e)).subscribe(n=>{this._onSelect(n.source,n.isUserInput),n.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),oi(...this.options.map(n=>n._stateChanges)).pipe(oo(e)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(e,n){const r=this._selectionModel.isSelected(e);null!=e.value||this._multiple?(r!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),n&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),n&&this.focus())):(e.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(e.value)),r!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const e=this.options.toArray();this._selectionModel.sort((n,r)=>this.sortComparator?this.sortComparator(n,r,e):e.indexOf(n)-e.indexOf(r)),this.stateChanges.next()}}_propagateChanges(e){let n=null;n=this.multiple?this.selected.map(r=>r.value):this.selected?this.selected.value:e,this._value=n,this.valueChange.emit(n),this._onChange(n),this.selectionChange.emit(this._getChangeEvent(n)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let e=-1;for(let n=0;n<this.options.length;n++)if(!this.options.get(n).disabled){e=n;break}this._keyManager.setActiveItem(e)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(e){this._elementRef.nativeElement.focus(e)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();return this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();let n=(e?e+" ":"")+this._valueId;return this.ariaLabelledby&&(n+=" "+this.ariaLabelledby),n}_panelDoneAnimating(e){this.openedChange.emit(e)}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}}return i.\u0275fac=function(e){return new(e||i)(oe(CT),oe(vs),oe(Ji),oe(xT),oe(tn),oe(Cu,8),oe($w,8),oe(qw,8),oe(oC,8),oe(sm,10),Bl("tabindex"),oe(Z6),oe(eK),oe(uhe,8))},i.\u0275dir=si({type:i,viewQuery:function(e,n){if(1&e&&(uo(ehe,5),uo(the,5),uo(o4,5)),2&e){let r;zi(r=Ui())&&(n.trigger=r.first),zi(r=Ui())&&(n.panel=r.first),zi(r=Ui())&&(n._overlayDir=r.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[Zi,le]}),i})(),_he=(()=>{class i extends ghe{constructor(){super(...arguments),this.panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto",this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._skipPredicate=e=>!this.panelOpen&&e.disabled}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe(oo(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}open(){this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),super.open(),this.stateChanges.next()}close(){super.close(),this.stateChanges.next()}_scrollOptionIntoView(e){const n=this.options.toArray()[e];if(n){const r=this.panel.nativeElement,o=function IK(i,t,e){if(e.length){let n=t.toArray(),r=e.toArray(),o=0;for(let a=0;a<i+1;a++)n[a].group&&n[a].group===r[o]&&o++;return o}return 0}(e,this.options,this.optionGroups),a=n._getHostElement();r.scrollTop=0===e&&1===o?0:function kK(i,t,e,n){return i<e?i:i+t>e+n?Math.max(0,i-n+t):e}(a.offsetTop,a.offsetHeight,r.scrollTop,r.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(e){return new fhe(this,e)}_getOverlayWidth(e){return"auto"===this.panelWidth?(e instanceof d2?e.elementRef:e||this._elementRef).nativeElement.getBoundingClientRect().width:null===this.panelWidth?"":this.panelWidth}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=dn(e),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const e of this.options)e._changeDetectorRef.markForCheck()}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Gn(i)))(n||i)}}(),i.\u0275cmp=ui({type:i,selectors:[["mat-select"]],contentQueries:function(e,n,r){if(1&e&&(Qr(r,phe,5),Qr(r,_z,5),Qr(r,gz,5)),2&e){let o;zi(o=Ui())&&(n.customTrigger=o.first),zi(o=Ui())&&(n.options=o),zi(o=Ui())&&(n.optionGroups=o)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox","ngSkipHydration","",1,"mat-mdc-select"],hostVars:19,hostBindings:function(e,n){1&e&&ji("keydown",function(o){return n._handleKeydown(o)})("focus",function(){return n._onFocus()})("blur",function(){return n._onBlur()}),2&e&&(Mn("id",n.id)("tabindex",n.tabIndex)("aria-controls",n.panelOpen?n.id+"-panel":null)("aria-expanded",n.panelOpen)("aria-label",n.ariaLabel||null)("aria-required",n.required.toString())("aria-disabled",n.disabled.toString())("aria-invalid",n.errorState)("aria-activedescendant",n._getAriaActiveDescendant()),Un("mat-mdc-select-disabled",n.disabled)("mat-mdc-select-invalid",n.errorState)("mat-mdc-select-required",n.required)("mat-mdc-select-empty",n.empty)("mat-mdc-select-multiple",n.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",panelWidth:"panelWidth",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matSelect"],features:[Qn([{provide:eA,useExisting:i},{provide:mz,useExisting:i}]),Zi],ngContentSelectors:lhe,decls:11,vars:10,consts:[["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],[1,"mat-mdc-select-value",3,"ngSwitch"],["class","mat-mdc-select-placeholder mat-mdc-select-min-line",4,"ngSwitchCase"],["class","mat-mdc-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","backdropClick","attach","detach"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text",3,"ngSwitch"],["class","mat-mdc-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(e,n){if(1&e&&(Lo(ahe),rt(0,"div",0,1),ji("click",function(){return n.toggle()}),rt(3,"div",2),Oi(4,ihe,2,1,"span",3),Oi(5,ohe,3,2,"span",4),mt(),rt(6,"div",5)(7,"div",6),qs(),rt(8,"svg",7),En(9,"path",8),mt()()()(),Oi(10,she,3,9,"ng-template",9),ji("backdropClick",function(){return n.close()})("attach",function(){return n._onAttached()})("detach",function(){return n.close()})),2&e){const r=yu(1);ft(3),Vt("ngSwitch",n.empty),Mn("id",n._valueId),ft(1),Vt("ngSwitchCase",!0),ft(1),Vt("ngSwitchCase",!1),ft(5),Vt("cdkConnectedOverlayPanelClass",n._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",n._scrollStrategy)("cdkConnectedOverlayOrigin",n._preferredOverlayOrigin||r)("cdkConnectedOverlayOpen",n.panelOpen)("cdkConnectedOverlayPositions",n._positions)("cdkConnectedOverlayWidth",n._overlayWidth)}},dependencies:[dE,l0,uE,lB,o4,d2],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color);font-family:var(--mat-select-trigger-text-font);line-height:var(--mat-select-trigger-text-line-height);font-size:var(--mat-select-trigger-text-size);font-weight:var(--mat-select-trigger-text-weight);letter-spacing:var(--mat-select-trigger-text-tracking)}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color)}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:translateY(-8px)}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color)}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow{color:var(--mat-select-invalid-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color)}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}div.mat-mdc-select-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color)}.cdk-high-contrast-active div.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[che.transformPanel]},changeDetection:0}),i})(),yhe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:[hhe],imports:[wu,pC,yz,$o,w0,sC,yz,$o]}),i})(),Y6=(()=>{class i{fetchData(e){return Yw.getInstance().findTodoById(e)}insertData(e){return Yw.getInstance().insertTodo(e)}updateData(e,n){return Yw.getInstance().modifyTodoById(e,n)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();const vhe=[{path:"",redirectTo:"/index/home",pathMatch:"full"},{path:"index",component:jee,children:[{path:"home",component:tte},{path:"daily",component:mne},{path:"three",component:Hde},{path:"map",component:$de},{path:"setting",component:due}]},{path:"detail",component:hue},{path:"edit",component:(()=>{class i{constructor(e,n){this.location=e,this.editService=n,this.route=mi(sv),this.onBackClick=()=>this.location.back(),this.typeOption=Au,this.titleControl=new D_(""),this.typeControl=new D_(Au.GREEN),this.startTimeControl=new D_(new Date),this.contentControl=new D_(""),this.onSaveClick=()=>{const a={title:this.titleControl.getRawValue()||"",type:this.typeControl.getRawValue()||Au.GREEN,startTime:this.startTimeControl.getRawValue()?.toJSON()||"",content:this.contentControl.getRawValue()||""},u=Number(this.route.snapshot.queryParams.id);this.editService.fetchData(u)?this.editService.updateData(u,a)&&this.location.back():this.editService.insertData(a)&&this.location.back()};const r=Number(this.route.snapshot.queryParams.id),o=this.editService.fetchData(r);null!==o&&(this.titleControl.setValue(o.title),this.typeControl.setValue(o.type),this.startTimeControl.setValue(new Date(o.startTime)),this.contentControl.setValue(o.content))}}return i.\u0275fac=function(e){return new(e||i)(oe(s0),oe(Y6))},i.\u0275cmp=ui({type:i,selectors:[["page-edit"]],standalone:!0,features:[Qn([Y6]),tm],decls:41,vars:27,consts:[["mat-icon-button","",3,"click"],[2,"padding","1em"],["appearance","outline",2,"width","100%"],["matInput","",3,"formControl"],[3,"formControl"],[3,"value"],["matInput","",3,"matDatepicker","formControl"],["matIconSuffix","",3,"for"],["picker",""],[2,"display","flex","justify-content","flex-end"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,n){if(1&e&&(rt(0,"mat-toolbar")(1,"button",0),ji("click",function(){return n.onBackClick()}),rt(2,"mat-icon"),sn(3,"arrow_back"),mt()(),rt(4,"span"),sn(5),Ka(6,"translate"),mt()(),rt(7,"div",1)(8,"mat-form-field",2)(9,"mat-label"),sn(10),Ka(11,"translate"),mt(),En(12,"input",3),mt(),rt(13,"mat-form-field",2)(14,"mat-label"),sn(15),Ka(16,"translate"),mt(),rt(17,"mat-select",4)(18,"mat-option",5),sn(19,"GREEN"),mt(),rt(20,"mat-option",5),sn(21,"ORANGE"),mt(),rt(22,"mat-option",5),sn(23,"RED"),mt()()(),rt(24,"mat-form-field",2)(25,"mat-label"),sn(26),Ka(27,"translate"),mt(),En(28,"input",6)(29,"mat-datepicker-toggle",7)(30,"mat-datepicker",null,8),mt(),rt(32,"mat-form-field",2)(33,"mat-label"),sn(34),Ka(35,"translate"),mt(),En(36,"textarea",3),mt(),rt(37,"div",9)(38,"button",10),ji("click",function(){return n.onSaveClick()}),sn(39),Ka(40,"translate"),mt()()()),2&e){const r=yu(31);ft(5),Pr(Ja(6,15,"edit.edit")),ft(5),Pr(Ja(11,17,"edit.title")),ft(2),Vt("formControl",n.titleControl),ft(3),Pr(Ja(16,19,"edit.type")),ft(2),Vt("formControl",n.typeControl),ft(1),Vt("value",n.typeOption.GREEN),ft(2),Vt("value",n.typeOption.ORANGE),ft(2),Vt("value",n.typeOption.RED),ft(4),Pr(Ja(27,21,"edit.startTime")),ft(2),Vt("matDatepicker",r)("formControl",n.startTimeControl),ft(1),Vt("for",r),ft(5),Pr(Ja(35,23,"edit.content")),ft(2),Vt("formControl",n.contentControl),ft(3),Pr(Ja(40,25,"edit.save"))}},dependencies:[Zw,rC,cV,ZE,ER,qT,oR,rR,uv,WE,M0,T0,S0,sC,NV,JT,AV,w4,x4,Que,jue,iL,Yue,yhe,_he,_z],encapsulation:2}),i})()}];let bhe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({imports:[Vk.forRoot(vhe,{useHash:!0}),Vk]}),i})(),xhe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=ui({type:i,selectors:[["app-root"]],decls:1,vars:0,template:function(e,n){1&e&&En(0,"router-outlet")},dependencies:[oT]}),i})();function K6(i){return new Ct(3e3,!1)}function Iv(i){switch(i.length){case 0:return new GE;case 1:return i[0];default:return new Az(i)}}function J6(i,t,e=new Map,n=new Map){const r=[],o=[];let a=-1,u=null;if(t.forEach(f=>{const y=f.get("offset"),M=y==a,A=M&&u||new Map;f.forEach((I,R)=>{let O=R,H=I;if("offset"!==R)switch(O=i.normalizePropertyName(O,r),H){case"!":H=e.get(R);break;case T_:H=n.get(R);break;default:H=i.normalizeStyleValue(R,O,H,r)}A.set(O,H)}),M||o.push(A),u=A,a=y}),r.length)throw function jhe(i){return new Ct(3502,!1)}();return o}function rL(i,t,e,n){switch(t){case"start":i.onStart(()=>n(e&&oL(e,"start",i)));break;case"done":i.onDone(()=>n(e&&oL(e,"done",i)));break;case"destroy":i.onDestroy(()=>n(e&&oL(e,"destroy",i)))}}function oL(i,t,e){const o=sL(i.element,i.triggerName,i.fromState,i.toState,t||i.phaseName,e.totalTime??i.totalTime,!!e.disabled),a=i._data;return null!=a&&(o._data=a),o}function sL(i,t,e,n,r="",o=0,a){return{element:i,triggerName:t,fromState:e,toState:n,phaseName:r,totalTime:o,disabled:!!a}}function bp(i,t,e){let n=i.get(t);return n||i.set(t,n=e),n}function Q6(i){const t=i.indexOf(":");return[i.substring(1,t),i.slice(t+1)]}const ipe=(()=>typeof document>"u"?null:document.documentElement)();function aL(i){const t=i.parentNode||i.host||null;return t===ipe?null:t}let sx=null,eG=!1;function tG(i,t){for(;t;){if(t===i)return!0;t=aL(t)}return!1}function iG(i,t,e){if(e)return Array.from(i.querySelectorAll(t));const n=i.querySelector(t);return n?[n]:[]}let nG=(()=>{class i{validateStyleProperty(e){return function rpe(i){sx||(sx=function ope(){return typeof document<"u"?document.body:null}()||{},eG=!!sx.style&&"WebkitAppearance"in sx.style);let t=!0;return sx.style&&!function npe(i){return"ebkit"==i.substring(1,6)}(i)&&(t=i in sx.style,!t&&eG&&(t="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in sx.style)),t}(e)}matchesElement(e,n){return!1}containsElement(e,n){return tG(e,n)}getParentElement(e){return aL(e)}query(e,n,r){return iG(e,n,r)}computeStyle(e,n,r){return r||""}animate(e,n,r,o,a,u=[],f){return new GE(r,o)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})(),lL=(()=>{class i{}return i.NOOP=new nG,i})();const spe=1e3,cL="ng-enter",TD="ng-leave",AD="ng-trigger",DD=".ng-trigger",oG="ng-animating",dL=".ng-animating";function W_(i){if("number"==typeof i)return i;const t=i.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:uL(parseFloat(t[1]),t[2])}function uL(i,t){return"s"===t?i*spe:i}function ID(i,t,e){return i.hasOwnProperty("duration")?i:function lpe(i,t,e){let r,o=0,a="";if("string"==typeof i){const u=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===u)return t.push(K6()),{duration:0,delay:0,easing:""};r=uL(parseFloat(u[1]),u[2]);const f=u[3];null!=f&&(o=uL(parseFloat(f),u[4]));const y=u[5];y&&(a=y)}else r=i;if(!e){let u=!1,f=t.length;r<0&&(t.push(function whe(){return new Ct(3100,!1)}()),u=!0),o<0&&(t.push(function Mhe(){return new Ct(3101,!1)}()),u=!0),u&&t.splice(f,0,K6())}return{duration:r,delay:o,easing:a}}(i,t,e)}function WC(i,t={}){return Object.keys(i).forEach(e=>{t[e]=i[e]}),t}function sG(i){const t=new Map;return Object.keys(i).forEach(e=>{t.set(e,i[e])}),t}function kv(i,t=new Map,e){if(e)for(let[n,r]of e)t.set(n,r);for(let[n,r]of i)t.set(n,r);return t}function yg(i,t,e){t.forEach((n,r)=>{const o=pL(r);e&&!e.has(r)&&e.set(r,i.style[o]),i.style[o]=n})}function ax(i,t){t.forEach((e,n)=>{const r=pL(n);i.style[r]=""})}function $C(i){return Array.isArray(i)?1==i.length?i[0]:Sz(i):i}const hL=new RegExp("{{\\s*(.+?)\\s*}}","g");function lG(i){let t=[];if("string"==typeof i){let e;for(;e=hL.exec(i);)t.push(e[1]);hL.lastIndex=0}return t}function qC(i,t,e){const n=i.toString(),r=n.replace(hL,(o,a)=>{let u=t[a];return null==u&&(e.push(function Che(i){return new Ct(3003,!1)}()),u=""),u.toString()});return r==n?i:r}function kD(i){const t=[];let e=i.next();for(;!e.done;)t.push(e.value),e=i.next();return t}const upe=/-+([a-z0-9])/g;function pL(i){return i.replace(upe,(...t)=>t[1].toUpperCase())}function xp(i,t,e){switch(t.type){case 7:return i.visitTrigger(t,e);case 0:return i.visitState(t,e);case 1:return i.visitTransition(t,e);case 2:return i.visitSequence(t,e);case 3:return i.visitGroup(t,e);case 4:return i.visitAnimate(t,e);case 5:return i.visitKeyframes(t,e);case 6:return i.visitStyle(t,e);case 8:return i.visitReference(t,e);case 9:return i.visitAnimateChild(t,e);case 10:return i.visitAnimateRef(t,e);case 11:return i.visitQuery(t,e);case 12:return i.visitStagger(t,e);default:throw function She(i){return new Ct(3004,!1)}()}}function cG(i,t){return window.getComputedStyle(i)[t]}const RD="*";function fpe(i,t){const e=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function mpe(i,t,e){if(":"==i[0]){const f=function gpe(i,t){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return t.push(function Uhe(i){return new Ct(3016,!1)}()),"* => *"}}(i,e);if("function"==typeof f)return void t.push(f);i=f}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return e.push(function zhe(i){return new Ct(3015,!1)}()),t;const r=n[1],o=n[2],a=n[3];t.push(dG(r,a));"<"==o[0]&&!(r==RD&&a==RD)&&t.push(dG(a,r))}(n,e,t)):e.push(i),e}const PD=new Set(["true","1"]),LD=new Set(["false","0"]);function dG(i,t){const e=PD.has(i)||LD.has(i),n=PD.has(t)||LD.has(t);return(r,o)=>{let a=i==RD||i==r,u=t==RD||t==o;return!a&&e&&"boolean"==typeof r&&(a=r?PD.has(i):LD.has(i)),!u&&n&&"boolean"==typeof o&&(u=o?PD.has(t):LD.has(t)),a&&u}}const _pe=new RegExp("s*:selfs*,?","g");function fL(i,t,e,n){return new ype(i).build(t,e,n)}class ype{constructor(t){this._driver=t}build(t,e,n){const r=new xpe(e);return this._resetContextStyleTimingState(r),xp(this,$C(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const o=[],a=[];return"@"==t.name.charAt(0)&&e.errors.push(function Ahe(){return new Ct(3006,!1)}()),t.definitions.forEach(u=>{if(this._resetContextStyleTimingState(e),0==u.type){const f=u,y=f.name;y.toString().split(/\s*,\s*/).forEach(M=>{f.name=M,o.push(this.visitState(f,e))}),f.name=y}else if(1==u.type){const f=this.visitTransition(u,e);n+=f.queryCount,r+=f.depCount,a.push(f)}else e.errors.push(function Dhe(){return new Ct(3007,!1)}())}),{type:7,name:t.name,states:o,transitions:a,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const o=new Set,a=r||{};n.styles.forEach(u=>{u instanceof Map&&u.forEach(f=>{lG(f).forEach(y=>{a.hasOwnProperty(y)||o.add(y)})})}),o.size&&(kD(o.values()),e.errors.push(function Ihe(i,t){return new Ct(3008,!1)}()))}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=xp(this,$C(t.animation),e);return{type:1,matchers:fpe(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:lx(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(n=>xp(this,n,e)),options:lx(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const o=t.steps.map(a=>{e.currentTime=n;const u=xp(this,a,e);return r=Math.max(r,e.currentTime),u});return e.currentTime=r,{type:3,steps:o,options:lx(t.options)}}visitAnimate(t,e){const n=function Mpe(i,t){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return mL(ID(i,t).duration,0,"");const e=i;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=mL(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=ID(e,t);return mL(r.duration,r.delay,r.easing)}(t.timings,e.errors);e.currentAnimateTimings=n;let r,o=t.styles?t.styles:Qs({});if(5==o.type)r=this.visitKeyframes(o,e);else{let a=t.styles,u=!1;if(!a){u=!0;const y={};n.easing&&(y.easing=n.easing),a=Qs(y)}e.currentTime+=n.duration+n.delay;const f=this.visitStyle(a,e);f.isEmptyStep=u,r=f}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let u of r)"string"==typeof u?u===T_?n.push(u):e.errors.push(new Ct(3002,!1)):n.push(sG(u));let o=!1,a=null;return n.forEach(u=>{if(u instanceof Map&&(u.has("easing")&&(a=u.get("easing"),u.delete("easing")),!o))for(let f of u.values())if(f.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:n,easing:a,offset:t.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;n&&o>0&&(o-=n.duration+n.delay),t.styles.forEach(a=>{"string"!=typeof a&&a.forEach((u,f)=>{const y=e.collectedStyles.get(e.currentQuerySelector),M=y.get(f);let A=!0;M&&(o!=r&&o>=M.startTime&&r<=M.endTime&&(e.errors.push(function Rhe(i,t,e,n,r){return new Ct(3010,!1)}()),A=!1),o=M.startTime),A&&y.set(f,{startTime:o,endTime:r}),e.options&&function dpe(i,t,e){const n=t.params||{},r=lG(i);r.length&&r.forEach(o=>{n.hasOwnProperty(o)||e.push(function Ehe(i){return new Ct(3001,!1)}())})}(u,e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function Phe(){return new Ct(3011,!1)}()),n;let o=0;const a=[];let u=!1,f=!1,y=0;const M=t.steps.map(B=>{const Z=this._makeStyleAst(B,e);let X=null!=Z.offset?Z.offset:function wpe(i){if("string"==typeof i)return null;let t=null;if(Array.isArray(i))i.forEach(e=>{if(e instanceof Map&&e.has("offset")){const n=e;t=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const e=i;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(Z.styles),ee=0;return null!=X&&(o++,ee=Z.offset=X),f=f||ee<0||ee>1,u=u||ee<y,y=ee,a.push(ee),Z});f&&e.errors.push(function Lhe(){return new Ct(3012,!1)}()),u&&e.errors.push(function Fhe(){return new Ct(3200,!1)}());const A=t.steps.length;let I=0;o>0&&o<A?e.errors.push(function Ohe(){return new Ct(3202,!1)}()):0==o&&(I=1/(A-1));const R=A-1,O=e.currentTime,H=e.currentAnimateTimings,U=H.duration;return M.forEach((B,Z)=>{const X=I>0?Z==R?1:I*Z:a[Z],ee=X*U;e.currentTime=O+H.delay+ee,H.duration=ee,this._validateStyleAst(B,e),B.offset=X,n.styles.push(B)}),n}visitReference(t,e){return{type:8,animation:xp(this,$C(t.animation),e),options:lx(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:lx(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:lx(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[o,a]=function vpe(i){const t=!!i.split(/\s*,\s*/).find(e=>":self"==e);return t&&(i=i.replace(_pe,"")),i=i.replace(/@\*/g,DD).replace(/@\w+/g,e=>DD+"-"+e.slice(1)).replace(/:animating/g,dL),[i,t]}(t.selector);e.currentQuerySelector=n.length?n+" "+o:o,bp(e.collectedStyles,e.currentQuerySelector,new Map);const u=xp(this,$C(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:u,originalSelector:t.selector,options:lx(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function Nhe(){return new Ct(3013,!1)}());const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:ID(t.timings,e.errors,!0);return{type:12,animation:xp(this,$C(t.animation),e),timings:n,options:null}}}class xpe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function lx(i){return i?(i=WC(i)).params&&(i.params=function bpe(i){return i?WC(i):null}(i.params)):i={},i}function mL(i,t,e){return{duration:i,delay:t,easing:e}}function gL(i,t,e,n,r,o,a=null,u=!1){return{type:1,element:i,keyframes:t,preStyleProps:e,postStyleProps:n,duration:r,delay:o,totalTime:r+o,easing:a,subTimeline:u}}class FD{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Spe=new RegExp(":enter","g"),Ape=new RegExp(":leave","g");function _L(i,t,e,n,r,o=new Map,a=new Map,u,f,y=[]){return(new Dpe).buildKeyframes(i,t,e,n,r,o,a,u,f,y)}class Dpe{buildKeyframes(t,e,n,r,o,a,u,f,y,M=[]){y=y||new FD;const A=new yL(t,e,y,r,o,M,[]);A.options=f;const I=f.delay?W_(f.delay):0;A.currentTimeline.delayNextStep(I),A.currentTimeline.setStyles([a],null,A.errors,f),xp(this,n,A);const R=A.timelines.filter(O=>O.containsAnimation());if(R.length&&u.size){let O;for(let H=R.length-1;H>=0;H--){const U=R[H];if(U.element===e){O=U;break}}O&&!O.allowOnlyTimelineStyles()&&O.setStyles([u],null,A.errors,f)}return R.length?R.map(O=>O.buildKeyframes()):[gL(e,[],[],[],0,I,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.get(e.element);if(n){const r=e.createSubContext(t.options),o=e.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);o!=a&&e.transformIntoNewTimeline(a)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,n),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,n){for(const r of t){const o=r?.delay;if(o){const a="number"==typeof o?o:W_(qC(o,r?.params??{},e.errors));n.delayNextStep(a)}}}_visitSubInstructions(t,e,n){let o=e.currentTimeline.currentTime;const a=null!=n.duration?W_(n.duration):null,u=null!=n.delay?W_(n.delay):null;return 0!==a&&t.forEach(f=>{const y=e.appendInstructionToTimeline(f,a,u);o=Math.max(o,y.duration+y.delay)}),o}visitReference(t,e){e.updateOptions(t.options,!0),xp(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const o=t.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=OD);const a=W_(o.delay);r.delayNextStep(a)}t.steps.length&&(t.steps.forEach(a=>xp(this,a,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const o=t.options&&t.options.delay?W_(t.options.delay):0;t.steps.forEach(a=>{const u=e.createSubContext(t.options);o&&u.delayNextStep(o),xp(this,a,u),r=Math.max(r,u.currentTimeline.currentTime),n.push(u.currentTimeline)}),n.forEach(a=>e.currentTimeline.mergeTimelineCollectedStyles(a)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return ID(e.params?qC(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const o=t.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(n.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();const o=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(o):n.setStyles(t.styles,o,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,o=n.duration,u=e.createSubContext().currentTimeline;u.easing=n.easing,t.styles.forEach(f=>{u.forwardTime((f.offset||0)*o),u.setStyles(f.styles,f.easing,e.errors,e.options),u.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(u),e.transformIntoNewTimeline(r+o),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},o=r.delay?W_(r.delay):0;o&&(6===e.previousNode.type||0==n&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=OD);let a=n;const u=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=u.length;let f=null;u.forEach((y,M)=>{e.currentQueryIndex=M;const A=e.createSubContext(t.options,y);o&&A.delayNextStep(o),y===e.element&&(f=A.currentTimeline),xp(this,t.animation,A),A.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,A.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(a),f&&(e.currentTimeline.mergeTimelineCollectedStyles(f),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,o=t.timings,a=Math.abs(o.duration),u=a*(e.currentQueryTotal-1);let f=a*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":f=u-f;break;case"full":f=n.currentStaggerTime}const M=e.currentTimeline;f&&M.delayNextStep(f);const A=M.currentTime;xp(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-A+(r.startTime-n.currentTimeline.startTime)}}const OD={};class yL{constructor(t,e,n,r,o,a,u,f){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=o,this.errors=a,this.timelines=u,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=OD,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=f||new ND(this._driver,e,0),u.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=W_(n.duration)),null!=n.delay&&(r.delay=W_(n.delay));const o=n.params;if(o){let a=r.params;a||(a=this.options.params={}),Object.keys(o).forEach(u=>{(!e||!a.hasOwnProperty(u))&&(a[u]=qC(o[u],a,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(r=>{n[r]=e[r]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,o=new yL(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=OD,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:e??t.duration,delay:this.currentTimeline.currentTime+(n??0)+t.delay,easing:""},o=new Ipe(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,o,a){let u=[];if(r&&u.push(this.element),t.length>0){t=(t=t.replace(Spe,"."+this._enterClassName)).replace(Ape,"."+this._leaveClassName);let y=this._driver.query(this.element,t,1!=n);0!==n&&(y=n<0?y.slice(y.length+n,y.length):y.slice(0,n)),u.push(...y)}return!o&&0==u.length&&a.push(function Bhe(i){return new Ct(3014,!1)}()),u}}class ND{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new ND(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,n]of this._globalTimelineStyles)this._backFill.set(e,n||T_),this._currentKeyframe.set(e,T_);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},a=function kpe(i,t){const e=new Map;let n;return i.forEach(r=>{if("*"===r){n=n||t.keys();for(let o of n)e.set(o,T_)}else kv(r,e)}),e}(t,this._globalTimelineStyles);for(let[u,f]of a){const y=qC(f,o,n);this._pendingStyles.set(u,y),this._localTimelineStyles.has(u)||this._backFill.set(u,this._globalTimelineStyles.get(u)??T_),this._updateStyle(u,y)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,n)=>{const r=this._styleSummary.get(n);(!r||e.time>r.time)&&this._updateStyle(n,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((u,f)=>{const y=kv(u,new Map,this._backFill);y.forEach((M,A)=>{"!"===M?t.add(A):M===T_&&e.add(A)}),n||y.set("offset",f/this.duration),r.push(y)});const o=t.size?kD(t.values()):[],a=e.size?kD(e.values()):[];if(n){const u=r[0],f=new Map(u);u.set("offset",0),f.set("offset",1),r=[u,f]}return gL(this.element,r,o,a,this.duration,this.startTime,this.easing,!1)}}class Ipe extends ND{constructor(t,e,n,r,o,a,u=!1){super(t,e,a.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=u,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],a=n+e,u=e/a,f=kv(t[0]);f.set("offset",0),o.push(f);const y=kv(t[0]);y.set("offset",pG(u)),o.push(y);const M=t.length-1;for(let A=1;A<=M;A++){let I=kv(t[A]);const R=I.get("offset");I.set("offset",pG((e+R*n)/a)),o.push(I)}n=a,e=0,r="",t=o}return gL(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function pG(i,t=3){const e=Math.pow(10,t-1);return Math.round(i*e)/e}class vL{}const Rpe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Ppe extends vL{normalizePropertyName(t,e){return pL(t)}normalizeStyleValue(t,e,n,r){let o="";const a=n.toString().trim();if(Rpe.has(e)&&0!==n&&"0"!==n)if("number"==typeof n)o="px";else{const u=n.match(/^[+-]?[\d\.]+([a-z]*)$/);u&&0==u[1].length&&r.push(function The(i,t){return new Ct(3005,!1)}())}return a+o}}function fG(i,t,e,n,r,o,a,u,f,y,M,A,I){return{type:0,element:i,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:o,toState:n,toStyles:a,timelines:u,queriedElements:f,preStyleProps:y,postStyleProps:M,totalTime:A,errors:I}}const bL={};class mG{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function Lpe(i,t,e,n,r){return i.some(o=>o(t,e,n,r))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){let r=this._stateStyles.get("*");return void 0!==t&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(e,n):new Map}build(t,e,n,r,o,a,u,f,y,M){const A=[],I=this.ast.options&&this.ast.options.params||bL,O=this.buildStyles(n,u&&u.params||bL,A),H=f&&f.params||bL,U=this.buildStyles(r,H,A),B=new Set,Z=new Map,X=new Map,ee="void"===r,se={params:Fpe(H,I),delay:this.ast.options?.delay},ve=M?[]:_L(t,e,this.ast.animation,o,a,O,U,se,y,A);let Ce=0;if(ve.forEach(ce=>{Ce=Math.max(ce.duration+ce.delay,Ce)}),A.length)return fG(e,this._triggerName,n,r,ee,O,U,[],[],Z,X,Ce,A);ve.forEach(ce=>{const we=ce.element,At=bp(Z,we,new Set);ce.preStyleProps.forEach(ht=>At.add(ht));const ni=bp(X,we,new Set);ce.postStyleProps.forEach(ht=>ni.add(ht)),we!==e&&B.add(we)});const Ve=kD(B.values());return fG(e,this._triggerName,n,r,ee,O,U,ve,Ve,Z,X,Ce)}}function Fpe(i,t){const e=WC(t);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(e[n]=i[n]);return e}class Ope{constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){const n=new Map,r=WC(this.defaultParams);return Object.keys(t).forEach(o=>{const a=t[o];null!==a&&(r[o]=a)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,u)=>{a&&(a=qC(a,r,e));const f=this.normalizer.normalizePropertyName(u,e);a=this.normalizer.normalizeStyleValue(u,f,a,e),n.set(u,a)})}),n}}class Bpe{constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new Ope(r.style,r.options&&r.options.params||{},n))}),gG(this.states,"true","1"),gG(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new mG(t,r,this.states))}),this.fallbackTransition=function zpe(i,t,e){return new mG(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(a,u)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(a=>a.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function gG(i,t,e){i.has(t)?i.has(e)||i.set(e,i.get(t)):i.has(e)&&i.set(t,i.get(e))}const Upe=new FD;class Vpe{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const n=[],o=fL(this._driver,e,n,[]);if(n.length)throw function Whe(i){return new Ct(3503,!1)}();this._animations.set(t,o)}_buildPlayer(t,e,n){const r=t.element,o=J6(this._normalizer,t.keyframes,e,n);return this._driver.animate(r,o,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],o=this._animations.get(t);let a;const u=new Map;if(o?(a=_L(this._driver,e,o,cL,TD,new Map,new Map,n,Upe,r),a.forEach(M=>{const A=bp(u,M.element,new Map);M.postStyleProps.forEach(I=>A.set(I,null))})):(r.push(function $he(){return new Ct(3300,!1)}()),a=[]),r.length)throw function qhe(i){return new Ct(3504,!1)}();u.forEach((M,A)=>{M.forEach((I,R)=>{M.set(R,this._driver.computeStyle(A,R,T_))})});const y=Iv(a.map(M=>{const A=u.get(M.element);return this._buildPlayer(M,new Map,A)}));return this._playersById.set(t,y),y.onDestroy(()=>this.destroy(t)),this.players.push(y),y}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function Xhe(i){return new Ct(3301,!1)}();return e}listen(t,e,n,r){const o=sL(e,"","","");return rL(this._getPlayer(t),n,o,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const o=this._getPlayer(t);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const _G="ng-animate-queued",xL="ng-animate-disabled",$pe=[],yG={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},qpe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},pf="__ng_removed";class wL{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function Kpe(i){return i??null}(n?t.value:t),n){const o=WC(t);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const e=t.params;if(e){const n=this.options.params;Object.keys(e).forEach(r=>{null==n[r]&&(n[r]=e[r])})}}}const XC="void",ML=new wL(XC);class Xpe{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,ff(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.has(e))throw function Zhe(i,t){return new Ct(3302,!1)}();if(null==n||0==n.length)throw function Yhe(i){return new Ct(3303,!1)}();if(!function Jpe(i){return"start"==i||"done"==i}(n))throw function Khe(i,t){return new Ct(3400,!1)}();const o=bp(this._elementListeners,t,[]),a={name:e,phase:n,callback:r};o.push(a);const u=bp(this._engine.statesByElement,t,new Map);return u.has(e)||(ff(t,AD),ff(t,AD+"-"+e),u.set(e,ML)),()=>{this._engine.afterFlush(()=>{const f=o.indexOf(a);f>=0&&o.splice(f,1),this._triggers.has(e)||u.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function Jhe(i){return new Ct(3401,!1)}();return e}trigger(t,e,n,r=!0){const o=this._getTrigger(e),a=new EL(this.id,e,t);let u=this._engine.statesByElement.get(t);u||(ff(t,AD),ff(t,AD+"-"+e),this._engine.statesByElement.set(t,u=new Map));let f=u.get(e);const y=new wL(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&f&&y.absorbOptions(f.options),u.set(e,y),f||(f=ML),y.value!==XC&&f.value===y.value){if(!function tfe(i,t){const e=Object.keys(i),n=Object.keys(t);if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!t.hasOwnProperty(o)||i[o]!==t[o])return!1}return!0}(f.params,y.params)){const H=[],U=o.matchStyles(f.value,f.params,H),B=o.matchStyles(y.value,y.params,H);H.length?this._engine.reportError(H):this._engine.afterFlush(()=>{ax(t,U),yg(t,B)})}return}const I=bp(this._engine.playersByElement,t,[]);I.forEach(H=>{H.namespaceId==this.id&&H.triggerName==e&&H.queued&&H.destroy()});let R=o.matchTransition(f.value,y.value,t,y.params),O=!1;if(!R){if(!r)return;R=o.fallbackTransition,O=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:R,fromState:f,toState:y,player:a,isFallbackTransition:O}),O||(ff(t,_G),a.onStart(()=>{j1(t,_G)})),a.onDone(()=>{let H=this.players.indexOf(a);H>=0&&this.players.splice(H,1);const U=this._engine.playersByElement.get(t);if(U){let B=U.indexOf(a);B>=0&&U.splice(B,1)}}),this.players.push(a),I.push(a),a}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,DD,!0);n.forEach(r=>{if(r[pf])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(a=>a.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,n,r){const o=this._engine.statesByElement.get(t),a=new Map;if(o){const u=[];if(o.forEach((f,y)=>{if(a.set(y,f.value),this._triggers.has(y)){const M=this.trigger(t,y,XC,r);M&&u.push(M)}}),u.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,a),n&&Iv(u).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const r=new Set;e.forEach(o=>{const a=o.name;if(r.has(a))return;r.add(a);const f=this._triggers.get(a).fallbackTransition,y=n.get(a)||ML,M=new wL(XC),A=new EL(this.id,a,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:a,transition:f,fromState:y,toState:M,player:A,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const o=n.players.length?n.playersByQueriedElement.get(t):[];if(o&&o.length)r=!0;else{let a=t;for(;a=a.parentNode;)if(n.statesByElement.get(a)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{const o=t[pf];(!o||o===yG)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){ff(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const o=n.element,a=this._elementListeners.get(o);a&&a.forEach(u=>{if(u.name==n.triggerName){const f=sL(o,n.triggerName,n.fromState.value,n.toState.value);f._data=t,rL(n.player,u.phase,f,u.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((n,r)=>{const o=n.transition.ast.depCount,a=r.transition.ast.depCount;return 0==o||0==a?o-a:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(n=>n.element===t)||e,e}}class Zpe{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,e){const n=new Xpe(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let a=!1,u=this.driver.getParentElement(e);for(;u;){const f=r.get(u);if(f){const y=n.indexOf(f);n.splice(y+1,0,t),a=!0;break}u=this.driver.getParentElement(u)}a||n.unshift(t)}else n.push(t);return r.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n)for(let r of n.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(t,e,n,r){if(BD(e)){const o=this._fetchNamespace(t);if(o)return o.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!BD(e))return;const o=e[pf];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const a=this.collectedLeaveElements.indexOf(e);a>=0&&this.collectedLeaveElements.splice(a,1)}if(t){const a=this._fetchNamespace(t);a&&a.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),ff(t,xL)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),j1(t,xL))}removeNode(t,e,n){if(BD(e)){const r=t?this._fetchNamespace(t):null;r?r.removeNode(e,n):this.markElementAsRemoved(t,e,!1,n);const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,n)}else this._onRemovalComplete(e,n)}markElementAsRemoved(t,e,n,r,o){this.collectedLeaveElements.push(e),e[pf]={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,e,n,r,o){return BD(e)?this._fetchNamespace(t).listen(e,n,r,o):()=>{}}_buildInstruction(t,e,n,r,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,o)}destroyInnerAnimations(t){let e=this.driver.query(t,DD,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,dL,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Iv(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[pf];if(e&&e.setForRemoval){if(t[pf]=yG,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(xL)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)ff(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],e.length?Iv(e).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(t){throw function Qhe(i){return new Ct(3402,!1)}()}_flushAnimations(t,e){const n=new FD,r=[],o=new Map,a=[],u=new Map,f=new Map,y=new Map,M=new Set;this.disabledNodes.forEach(at=>{M.add(at);const ot=this.driver.query(at,".ng-animate-queued",!0);for(let dt=0;dt<ot.length;dt++)M.add(ot[dt])});const A=this.bodyNode,I=Array.from(this.statesByElement.keys()),R=xG(I,this.collectedEnterElements),O=new Map;let H=0;R.forEach((at,ot)=>{const dt=cL+H++;O.set(ot,dt),at.forEach(It=>ff(It,dt))});const U=[],B=new Set,Z=new Set;for(let at=0;at<this.collectedLeaveElements.length;at++){const ot=this.collectedLeaveElements[at],dt=ot[pf];dt&&dt.setForRemoval&&(U.push(ot),B.add(ot),dt.hasAnimation?this.driver.query(ot,".ng-star-inserted",!0).forEach(It=>B.add(It)):Z.add(ot))}const X=new Map,ee=xG(I,Array.from(B));ee.forEach((at,ot)=>{const dt=TD+H++;X.set(ot,dt),at.forEach(It=>ff(It,dt))}),t.push(()=>{R.forEach((at,ot)=>{const dt=O.get(ot);at.forEach(It=>j1(It,dt))}),ee.forEach((at,ot)=>{const dt=X.get(ot);at.forEach(It=>j1(It,dt))}),U.forEach(at=>{this.processLeaveNode(at)})});const se=[],ve=[];for(let at=this._namespaceList.length-1;at>=0;at--)this._namespaceList[at].drainQueuedTransitions(e).forEach(dt=>{const It=dt.player,Xt=dt.element;if(se.push(It),this.collectedEnterElements.length){const Yi=Xt[pf];if(Yi&&Yi.setForMove){if(Yi.previousTriggersValues&&Yi.previousTriggersValues.has(dt.triggerName)){const mn=Yi.previousTriggersValues.get(dt.triggerName),mr=this.statesByElement.get(dt.element);if(mr&&mr.has(dt.triggerName)){const qo=mr.get(dt.triggerName);qo.value=mn,mr.set(dt.triggerName,qo)}}return void It.destroy()}}const ut=!A||!this.driver.containsElement(A,Xt),zt=X.get(Xt),Ti=O.get(Xt),gi=this._buildInstruction(dt,n,Ti,zt,ut);if(gi.errors&&gi.errors.length)return void ve.push(gi);if(ut)return It.onStart(()=>ax(Xt,gi.fromStyles)),It.onDestroy(()=>yg(Xt,gi.toStyles)),void r.push(It);if(dt.isFallbackTransition)return It.onStart(()=>ax(Xt,gi.fromStyles)),It.onDestroy(()=>yg(Xt,gi.toStyles)),void r.push(It);const Vi=[];gi.timelines.forEach(Yi=>{Yi.stretchStartingKeyframe=!0,this.disabledNodes.has(Yi.element)||Vi.push(Yi)}),gi.timelines=Vi,n.append(Xt,gi.timelines),a.push({instruction:gi,player:It,element:Xt}),gi.queriedElements.forEach(Yi=>bp(u,Yi,[]).push(It)),gi.preStyleProps.forEach((Yi,mn)=>{if(Yi.size){let mr=f.get(mn);mr||f.set(mn,mr=new Set),Yi.forEach((qo,Kn)=>mr.add(Kn))}}),gi.postStyleProps.forEach((Yi,mn)=>{let mr=y.get(mn);mr||y.set(mn,mr=new Set),Yi.forEach((qo,Kn)=>mr.add(Kn))})});if(ve.length){const at=[];ve.forEach(ot=>{at.push(function epe(i,t){return new Ct(3505,!1)}())}),se.forEach(ot=>ot.destroy()),this.reportError(at)}const Ce=new Map,Ve=new Map;a.forEach(at=>{const ot=at.element;n.has(ot)&&(Ve.set(ot,ot),this._beforeAnimationBuild(at.player.namespaceId,at.instruction,Ce))}),r.forEach(at=>{const ot=at.element;this._getPreviousPlayers(ot,!1,at.namespaceId,at.triggerName,null).forEach(It=>{bp(Ce,ot,[]).push(It),It.destroy()})});const ce=U.filter(at=>MG(at,f,y)),we=new Map;bG(we,this.driver,Z,y,T_).forEach(at=>{MG(at,f,y)&&ce.push(at)});const ni=new Map;R.forEach((at,ot)=>{bG(ni,this.driver,new Set(at),f,"!")}),ce.forEach(at=>{const ot=we.get(at),dt=ni.get(at);we.set(at,new Map([...ot?.entries()??[],...dt?.entries()??[]]))});const ht=[],_t=[],Tt={};a.forEach(at=>{const{element:ot,player:dt,instruction:It}=at;if(n.has(ot)){if(M.has(ot))return dt.onDestroy(()=>yg(ot,It.toStyles)),dt.disabled=!0,dt.overrideTotalTime(It.totalTime),void r.push(dt);let Xt=Tt;if(Ve.size>1){let zt=ot;const Ti=[];for(;zt=zt.parentNode;){const gi=Ve.get(zt);if(gi){Xt=gi;break}Ti.push(zt)}Ti.forEach(gi=>Ve.set(gi,Xt))}const ut=this._buildAnimation(dt.namespaceId,It,Ce,o,ni,we);if(dt.setRealPlayer(ut),Xt===Tt)ht.push(dt);else{const zt=this.playersByElement.get(Xt);zt&&zt.length&&(dt.parentPlayer=Iv(zt)),r.push(dt)}}else ax(ot,It.fromStyles),dt.onDestroy(()=>yg(ot,It.toStyles)),_t.push(dt),M.has(ot)&&r.push(dt)}),_t.forEach(at=>{const ot=o.get(at.element);if(ot&&ot.length){const dt=Iv(ot);at.setRealPlayer(dt)}}),r.forEach(at=>{at.parentPlayer?at.syncPlayerEvents(at.parentPlayer):at.destroy()});for(let at=0;at<U.length;at++){const ot=U[at],dt=ot[pf];if(j1(ot,TD),dt&&dt.hasAnimation)continue;let It=[];if(u.size){let ut=u.get(ot);ut&&ut.length&&It.push(...ut);let zt=this.driver.query(ot,dL,!0);for(let Ti=0;Ti<zt.length;Ti++){let gi=u.get(zt[Ti]);gi&&gi.length&&It.push(...gi)}}const Xt=It.filter(ut=>!ut.destroyed);Xt.length?Qpe(this,ot,Xt):this.processLeaveNode(ot)}return U.length=0,ht.forEach(at=>{this.players.push(at),at.onDone(()=>{at.destroy();const ot=this.players.indexOf(at);this.players.splice(ot,1)}),at.play()}),ht}elementContainsData(t,e){let n=!1;const r=e[pf];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,o){let a=[];if(e){const u=this.playersByQueriedElement.get(t);u&&(a=u)}else{const u=this.playersByElement.get(t);if(u){const f=!o||o==XC;u.forEach(y=>{y.queued||!f&&y.triggerName!=r||a.push(y)})}}return(n||r)&&(a=a.filter(u=>!(n&&n!=u.namespaceId||r&&r!=u.triggerName))),a}_beforeAnimationBuild(t,e,n){const o=e.element,a=e.isRemovalTransition?void 0:t,u=e.isRemovalTransition?void 0:e.triggerName;for(const f of e.timelines){const y=f.element,M=y!==o,A=bp(n,y,[]);this._getPreviousPlayers(y,M,a,u,e.toState).forEach(R=>{const O=R.getRealPlayer();O.beforeDestroy&&O.beforeDestroy(),R.destroy(),A.push(R)})}ax(o,e.fromStyles)}_buildAnimation(t,e,n,r,o,a){const u=e.triggerName,f=e.element,y=[],M=new Set,A=new Set,I=e.timelines.map(O=>{const H=O.element;M.add(H);const U=H[pf];if(U&&U.removedBeforeQueried)return new GE(O.duration,O.delay);const B=H!==f,Z=function efe(i){const t=[];return wG(i,t),t}((n.get(H)||$pe).map(Ce=>Ce.getRealPlayer())).filter(Ce=>!!Ce.element&&Ce.element===H),X=o.get(H),ee=a.get(H),se=J6(this._normalizer,O.keyframes,X,ee),ve=this._buildPlayer(O,se,Z);if(O.subTimeline&&r&&A.add(H),B){const Ce=new EL(t,u,H);Ce.setRealPlayer(ve),y.push(Ce)}return ve});y.forEach(O=>{bp(this.playersByQueriedElement,O.element,[]).push(O),O.onDone(()=>function Ype(i,t,e){let n=i.get(t);if(n){if(n.length){const r=n.indexOf(e);n.splice(r,1)}0==n.length&&i.delete(t)}return n}(this.playersByQueriedElement,O.element,O))}),M.forEach(O=>ff(O,oG));const R=Iv(I);return R.onDestroy(()=>{M.forEach(O=>j1(O,oG)),yg(f,e.toStyles)}),A.forEach(O=>{bp(r,O,[]).push(R)}),R}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new GE(t.duration,t.delay)}}class EL{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new GE,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,n)=>{e.forEach(r=>rL(t,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){bp(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function BD(i){return i&&1===i.nodeType}function vG(i,t){const e=i.style.display;return i.style.display=t??"none",e}function bG(i,t,e,n,r){const o=[];e.forEach(f=>o.push(vG(f)));const a=[];n.forEach((f,y)=>{const M=new Map;f.forEach(A=>{const I=t.computeStyle(y,A,r);M.set(A,I),(!I||0==I.length)&&(y[pf]=qpe,a.push(y))}),i.set(y,M)});let u=0;return e.forEach(f=>vG(f,o[u++])),a}function xG(i,t){const e=new Map;if(i.forEach(u=>e.set(u,[])),0==t.length)return e;const r=new Set(t),o=new Map;function a(u){if(!u)return 1;let f=o.get(u);if(f)return f;const y=u.parentNode;return f=e.has(y)?y:r.has(y)?1:a(y),o.set(u,f),f}return t.forEach(u=>{const f=a(u);1!==f&&e.get(f).push(u)}),e}function ff(i,t){i.classList?.add(t)}function j1(i,t){i.classList?.remove(t)}function Qpe(i,t,e){Iv(e).onDone(()=>i.processLeaveNode(t))}function wG(i,t){for(let e=0;e<i.length;e++){const n=i[e];n instanceof Az?wG(n.players,t):t.push(n)}}function MG(i,t,e){const n=e.get(i);if(!n)return!1;let r=t.get(i);return r?n.forEach(o=>r.add(o)):t.set(i,n),e.delete(i),!0}class zD{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new Zpe(t,e,n),this._timelineEngine=new Vpe(t,e,n),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(t,e,n,r,o){const a=t+"-"+r;let u=this._triggerCache[a];if(!u){const f=[],M=fL(this._driver,o,f,[]);if(f.length)throw function Ghe(i,t){return new Ct(3404,!1)}();u=function Npe(i,t,e){return new Bpe(i,t,e)}(r,M,this._normalizer),this._triggerCache[a]=u}this._transitionEngine.registerTrigger(e,r,u)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n){this._transitionEngine.removeNode(t,e,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[o,a]=Q6(n);this._timelineEngine.command(o,e,a,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,o){if("@"==n.charAt(0)){const[a,u]=Q6(n);return this._timelineEngine.listen(a,e,u,o)}return this._transitionEngine.listen(t,e,n,r,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}}let nfe=(()=>{class i{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let o=i.initialStylesByElement.get(e);o||i.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&yg(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(yg(this._element,this._initialStyles),this._endStyles&&(yg(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(ax(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ax(this._element,this._endStyles),this._endStyles=null),yg(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function CL(i){let t=null;return i.forEach((e,n)=>{(function rfe(i){return"display"===i||"position"===i})(n)&&(t=t||new Map,t.set(n,e))}),t}class EG{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(n=>{e.push(Object.fromEntries(n))}),e}_triggerWebAnimation(t,e,n){return t.animate(this._convertKeyframesToObject(e),n)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{"offset"!==r&&t.set(r,this._finished?n:cG(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class ofe{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return tG(t,e)}getParentElement(t){return aL(t)}query(t,e,n){return iG(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}animate(t,e,n,r,o,a=[]){const f={duration:n,delay:r,fill:0==r?"both":"forwards"};o&&(f.easing=o);const y=new Map,M=a.filter(R=>R instanceof EG);(function hpe(i,t){return 0===i||0===t})(n,r)&&M.forEach(R=>{R.currentSnapshot.forEach((O,H)=>y.set(H,O))});let A=function cpe(i){return i.length?i[0]instanceof Map?i:i.map(t=>sG(t)):[]}(e).map(R=>kv(R));A=function ppe(i,t,e){if(e.size&&t.length){let n=t[0],r=[];if(e.forEach((o,a)=>{n.has(a)||r.push(a),n.set(a,o)}),r.length)for(let o=1;o<t.length;o++){let a=t[o];r.forEach(u=>a.set(u,cG(i,u)))}}return t}(t,A,y);const I=function ife(i,t){let e=null,n=null;return Array.isArray(t)&&t.length?(e=CL(t[0]),t.length>1&&(n=CL(t[t.length-1]))):t instanceof Map&&(e=CL(t)),e||n?new nfe(i,e,n):null}(t,A);return new EG(t,A,f,I)}}let sfe=(()=>{class i extends Ez{constructor(e,n){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(n.body,{id:"0",encapsulation:sa.None,styles:[],data:{animation:[]}})}build(e){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?Sz(e):e;return CG(this._renderer,null,n,"register",[r]),new afe(n,this._renderer)}}return i.\u0275fac=function(e){return new(e||i)(it(f_),it(lr))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();class afe extends tJ{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new lfe(this._id,t,e||{},this._renderer)}}class lfe{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return CG(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function CG(i,t,e,n,r){return i.setProperty(t,`@@${e}:${n}`,r)}const SG="@.disabled";let cfe=(()=>{class i{constructor(e,n,r){this.delegate=e,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,n.onRemovalComplete=(o,a)=>{const u=a?.parentNode(o);u&&a.removeChild(u,o)}}createRenderer(e,n){const o=this.delegate.createRenderer(e,n);if(!(e&&n&&n.data&&n.data.animation)){let M=this._rendererCache.get(o);return M||(M=new TG("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,M)),M}const a=n.id,u=n.id+"-"+this._currentId;this._currentId++,this.engine.register(u,e);const f=M=>{Array.isArray(M)?M.forEach(f):this.engine.registerTrigger(a,u,e,M.name,M)};return n.data.animation.forEach(f),new dfe(this,u,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,r){e>=0&&e<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[a,u]=o;a(u)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(e){return new(e||i)(it(f_),it(zD),it(Ji))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})();class TG{constructor(t,e,n,r){this.namespaceId=t,this.delegate=e,this.engine=n,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,r=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&e==SG?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class dfe extends TG{constructor(t,e,n,r,o){super(e,n,r,o),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&e==SG?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.slice(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const r=function ufe(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(t);let o=e.slice(1),a="";return"@"!=o.charAt(0)&&([o,a]=function hfe(i){const t=i.indexOf(".");return[i.substring(0,t),i.slice(t+1)]}(o)),this.engine.listen(this.namespaceId,r,o,a,u=>{this.factory.scheduleListenerCallback(u._data||-1,n,u)})}return this.delegate.listen(t,e,n)}}const AG=[{provide:Ez,useClass:sfe},{provide:vL,useFactory:function ffe(){return new Ppe}},{provide:zD,useClass:(()=>{class i extends zD{constructor(e,n,r,o){super(e.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(e){return new(e||i)(it(lr),it(lL),it(vL),it(ev))},i.\u0275prov=Qt({token:i,factory:i.\u0275fac}),i})()},{provide:f_,useFactory:function mfe(i,t,e){return new cfe(i,t,e)},deps:[hk,zD,Ji]}],SL=[{provide:lL,useFactory:()=>new ofe},{provide:ma,useValue:"BrowserAnimations"},...AG],DG=[{provide:lL,useClass:nG},{provide:ma,useValue:"NoopAnimations"},...AG];let gfe=(()=>{class i{static withConfig(e){return{ngModule:i,providers:e.disableAnimations?DG:SL}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i}),i.\u0275inj=Rn({providers:SL,imports:[I7]}),i})();class _fe{constructor(t,e="/assets/i18n/",n=".json"){Yn(this,"http",void 0),Yn(this,"prefix",void 0),Yn(this,"suffix",void 0),this.http=t,this.prefix=e,this.suffix=n}getTranslation(t){return this.http.get(`${this.prefix}${t}${this.suffix}`)}}function yfe(i){return new _fe(i,"./assets/i18n/",".json")}let vfe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=Nn({type:i,bootstrap:[xhe]}),i.\u0275inj=Rn({imports:[gfe,bhe,xK,ZJ,Zw.forRoot({loader:{provide:nC,useFactory:yfe,deps:[kT]},defaultLanguage:"en"})]}),i})();A7().bootstrapModule(vfe).catch(i=>console.error(i))},990:function(Ch,Ou,Mp){var Sr;Ch=Mp.nmd(Ch),function(){var Oe,xs="Expected a function",Hn="__lodash_hash_undefined__",hs="__lodash_placeholder__",Cn=1/0,Bo=9007199254740991,xa=4294967295,ws=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],fd="[object Arguments]",to="[object Array]",rr="[object Boolean]",vn="[object Date]",Bu="[object Error]",_o="[object Function]",Kl="[object GeneratorFunction]",Tl="[object Map]",Jl="[object Number]",bc="[object Object]",Ep="[object Promise]",xc="[object RegExp]",wa="[object Set]",zu="[object String]",Wd="[object Symbol]",Al="[object WeakMap]",Wc="[object ArrayBuffer]",$c="[object DataView]",Ah="[object Float32Array]",Ra="[object Float64Array]",qc="[object Int8Array]",$d="[object Int16Array]",md="[object Int32Array]",Uu="[object Uint8Array]",Sp="[object Uint8ClampedArray]",Te="[object Uint16Array]",ie="[object Uint32Array]",re=/\b__p \+= '';/g,Me=/\b(__p \+=) '' \+/g,Fe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,He=/&(?:amp|lt|gt|quot|#39);/g,Ke=/[&<>"']/g,Ze=RegExp(He.source),Ge=RegExp(Ke.source),lt=/<%-([\s\S]+?)%>/g,ri=/<%([\s\S]+?)%>/g,fi=/<%=([\s\S]+?)%>/g,Kt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,On=/^\w*$/,or=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,An=/[\\^$.*+?()[\]{}|]/g,tr=RegExp(An.source),dr=/^\s+/,zo=/\s/,Tr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pa=/\{\n\/\* \[wrapped with (.+)\] \*/,Ps=/,? & /,gd=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,na=/[()=,{}\[\]\/\s]/,La=/\\(\\)?/g,Tp=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,q_=/\w*$/,_d=/^[-+]0x[0-9a-f]+$/i,Gr=/^0b[01]+$/i,Ms=/^\[object .+?Constructor\]$/,yd=/^0o[0-7]+$/i,Ql=/^(?:0|[1-9]\d*)$/,xg=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ec=/($^)/,vd=/['\n\r\u2028\u2029\\]/g,Vu="\\ud800-\\udfff",Dh="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",yt="\\u2700-\\u27bf",bd="a-z\\xdf-\\xf6\\xf8-\\xff",mm="A-Z\\xc0-\\xd6\\xd8-\\xde",wg="\\ufe0e\\ufe0f",Zo="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Jt="["+Vu+"]",Wn="["+Zo+"]",oa="["+Dh+"]",Co="\\d+",Jn="["+yt+"]",Dl="["+bd+"]",jr="[^"+Vu+Zo+Co+yt+bd+mm+"]",Mc="\\ud83c[\\udffb-\\udfff]",So="[^"+Vu+"]",gm="(?:\\ud83c[\\udde6-\\uddff]){2}",ir="[\\ud800-\\udbff][\\udc00-\\udfff]",_n="["+mm+"]",Ap="(?:"+Dl+"|"+jr+")",Pv="(?:"+_n+"|"+jr+")",Ih="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Ct="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Gu="(?:"+oa+"|"+Mc+")?",Dn="["+wg+"]?",_m=Dn+Gu+"(?:\\u200d(?:"+[So,gm,ir].join("|")+")"+Dn+Gu+")*",Ma="(?:"+[Jn,gm,ir].join("|")+")"+_m,es="(?:"+[So+oa+"?",oa,gm,ir,Jt].join("|")+")",Lv=RegExp("['\u2019]","g"),gf=RegExp(oa,"g"),ts=RegExp(Mc+"(?="+Mc+")|"+es+_m,"g"),Ec=RegExp([_n+"?"+Dl+"+"+Ih+"(?="+[Wn,_n,"$"].join("|")+")",Pv+"+"+Ct+"(?="+[Wn,_n+Ap,"$"].join("|")+")",_n+"?"+Ap+"+"+Ih,_n+"+"+Ct,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Co,Ma].join("|"),"g"),Y_=RegExp("[\\u200d"+Vu+Dh+wg+"]"),Dp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fa=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],K_=-1,Oo={};Oo[Ah]=Oo[Ra]=Oo[qc]=Oo[$d]=Oo[md]=Oo[Uu]=Oo[Sp]=Oo[Te]=Oo[ie]=!0,Oo[fd]=Oo[to]=Oo[Wc]=Oo[rr]=Oo[$c]=Oo[vn]=Oo[Bu]=Oo[_o]=Oo[Tl]=Oo[Jl]=Oo[bc]=Oo[xc]=Oo[wa]=Oo[zu]=Oo[Al]=!1;var Kr={};Kr[fd]=Kr[to]=Kr[Wc]=Kr[$c]=Kr[rr]=Kr[vn]=Kr[Ah]=Kr[Ra]=Kr[qc]=Kr[$d]=Kr[md]=Kr[Tl]=Kr[Jl]=Kr[bc]=Kr[xc]=Kr[wa]=Kr[zu]=Kr[Wd]=Kr[Uu]=Kr[Sp]=Kr[Te]=Kr[ie]=!0,Kr[Bu]=Kr[_o]=Kr[Al]=!1;var io={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},_f=parseFloat,Xd=parseInt,Eg="object"==typeof global&&global&&global.Object===Object&&global,Qt="object"==typeof self&&self&&self.Object===Object&&self,is=Eg||Qt||Function("return this")(),Rn=Ou&&!Ou.nodeType&&Ou,Oa=Rn&&Ch&&!Ch.nodeType&&Ch,yf=Oa&&Oa.exports===Rn,Zd=yf&&Eg.process,Na=function(){try{return Oa&&Oa.require&&Oa.require("util").types||Zd&&Zd.binding&&Zd.binding("util")}catch{}}(),ym=Na&&Na.isArrayBuffer,Wu=Na&&Na.isDate,Ip=Na&&Na.isMap,vf=Na&&Na.isRegExp,kh=Na&&Na.isSet,xi=Na&&Na.isTypedArray;function ol(Xe,kt,wt){switch(wt.length){case 0:return Xe.call(kt);case 1:return Xe.call(kt,wt[0]);case 2:return Xe.call(kt,wt[0],wt[1]);case 3:return Xe.call(kt,wt[0],wt[1],wt[2])}return Xe.apply(kt,wt)}function vm(Xe,kt,wt,Gi){for(var ui=-1,so=null==Xe?0:Xe.length;++ui<so;){var js=Xe[ui];kt(Gi,js,wt(js),Xe)}return Gi}function Uo(Xe,kt){for(var wt=-1,Gi=null==Xe?0:Xe.length;++wt<Gi&&!1!==kt(Xe[wt],wt,Xe););return Xe}function bm(Xe,kt){for(var wt=null==Xe?0:Xe.length;wt--&&!1!==kt(Xe[wt],wt,Xe););return Xe}function J_(Xe,kt){for(var wt=-1,Gi=null==Xe?0:Xe.length;++wt<Gi;)if(!kt(Xe[wt],wt,Xe))return!1;return!0}function Nr(Xe,kt){for(var wt=-1,Gi=null==Xe?0:Xe.length,ui=0,so=[];++wt<Gi;){var js=Xe[wt];kt(js,wt,Xe)&&(so[ui++]=js)}return so}function $u(Xe,kt){return!(null==Xe||!Xe.length)&&sl(Xe,kt,0)>-1}function bf(Xe,kt,wt){for(var Gi=-1,ui=null==Xe?0:Xe.length;++Gi<ui;)if(wt(kt,Xe[Gi]))return!0;return!1}function Ro(Xe,kt){for(var wt=-1,Gi=null==Xe?0:Xe.length,ui=Array(Gi);++wt<Gi;)ui[wt]=kt(Xe[wt],wt,Xe);return ui}function Ls(Xe,kt){for(var wt=-1,Gi=kt.length,ui=Xe.length;++wt<Gi;)Xe[ui+wt]=kt[wt];return Xe}function Yc(Xe,kt,wt,Gi){var ui=-1,so=null==Xe?0:Xe.length;for(Gi&&so&&(wt=Xe[++ui]);++ui<so;)wt=kt(wt,Xe[ui],ui,Xe);return wt}function Rh(Xe,kt,wt,Gi){var ui=null==Xe?0:Xe.length;for(Gi&&ui&&(wt=Xe[--ui]);ui--;)wt=kt(wt,Xe[ui],ui,Xe);return wt}function xm(Xe,kt){for(var wt=-1,Gi=null==Xe?0:Xe.length;++wt<Gi;)if(kt(Xe[wt],wt,Xe))return!0;return!1}var xf=mi("length");function xd(Xe,kt,wt){var Gi;return wt(Xe,function(ui,so,js){if(kt(ui,so,js))return Gi=so,!1}),Gi}function Ph(Xe,kt,wt,Gi){for(var ui=Xe.length,so=wt+(Gi?1:-1);Gi?so--:++so<ui;)if(kt(Xe[so],so,Xe))return so;return-1}function sl(Xe,kt,wt){return kt==kt?function Dg(Xe,kt,wt){for(var Gi=wt-1,ui=Xe.length;++Gi<ui;)if(Xe[Gi]===kt)return Gi;return-1}(Xe,kt,wt):Ph(Xe,it,wt)}function Mr(Xe,kt,wt,Gi){for(var ui=wt-1,so=Xe.length;++ui<so;)if(Gi(Xe[ui],kt))return ui;return-1}function it(Xe){return Xe!=Xe}function Mm(Xe,kt){var wt=null==Xe?0:Xe.length;return wt?Sg(Xe,kt)/wt:NaN}function mi(Xe){return function(kt){return null==kt?Oe:kt[Xe]}}function Lh(Xe){return function(kt){return null==Xe?Oe:Xe[kt]}}function wd(Xe,kt,wt,Gi,ui){return ui(Xe,function(so,js,Po){wt=Gi?(Gi=!1,so):kt(wt,so,js,Po)}),wt}function Sg(Xe,kt){for(var wt,Gi=-1,ui=Xe.length;++Gi<ui;){var so=kt(Xe[Gi]);so!==Oe&&(wt=wt===Oe?so:wt+so)}return wt}function Tg(Xe,kt){for(var wt=-1,Gi=Array(Xe);++wt<Xe;)Gi[wt]=kt(wt);return Gi}function Sc(Xe){return Xe&&Xe.slice(0,Il(Xe)+1).replace(dr,"")}function ns(Xe){return function(kt){return Xe(kt)}}function sa(Xe,kt){return Ro(kt,function(wt){return Xe[wt]})}function Ea(Xe,kt){return Xe.has(kt)}function Wr(Xe,kt){for(var wt=-1,Gi=Xe.length;++wt<Gi&&sl(kt,Xe[wt],0)>-1;);return wt}function kp(Xe,kt){for(var wt=Xe.length;wt--&&sl(kt,Xe[wt],0)>-1;);return wt}var Oh=Lh({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Nh=Lh({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Kc(Xe){return"\\"+io[Xe]}function Kd(Xe){return Y_.test(Xe)}function Pp(Xe){var kt=-1,wt=Array(Xe.size);return Xe.forEach(function(Gi,ui){wt[++kt]=[ui,Gi]}),wt}function Lp(Xe,kt){return function(wt){return Xe(kt(wt))}}function tc(Xe,kt){for(var wt=-1,Gi=Xe.length,ui=0,so=[];++wt<Gi;){var js=Xe[wt];(js===kt||js===hs)&&(Xe[wt]=hs,so[ui++]=wt)}return so}function Bh(Xe){var kt=-1,wt=Array(Xe.size);return Xe.forEach(function(Gi){wt[++kt]=Gi}),wt}function Md(Xe){return Kd(Xe)?function Em(Xe){for(var kt=ts.lastIndex=0;ts.test(Xe);)++kt;return kt}(Xe):xf(Xe)}function Tc(Xe){return Kd(Xe)?function ey(Xe){return Xe.match(ts)||[]}(Xe):function Cg(Xe){return Xe.split("")}(Xe)}function Il(Xe){for(var kt=Xe.length;kt--&&zo.test(Xe.charAt(kt)););return kt}var Ov=Lh({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),zh=function Xe(kt){var _,wt=(kt=null==kt?is:zh.defaults(is.Object(),kt,zh.pick(is,Fa))).Array,Gi=kt.Date,ui=kt.Error,so=kt.Function,js=kt.Math,Po=kt.Object,Nn=kt.RegExp,Fp=kt.String,kl=kt.TypeError,si=wt.prototype,vr=Po.prototype,vo=kt["__core-js_shared__"],Cs=so.prototype.toString,Br=vr.hasOwnProperty,Ws=0,qu=(_=/[^.]+$/.exec(vo&&vo.keys&&vo.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",Xu=vr.toString,Uh=Cs.call(Po),Ar=is._,Ef=Nn("^"+Cs.call(Br).replace(An,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ls=yf?kt.Buffer:Oe,Si=kt.Symbol,Sn=kt.Uint8Array,Yo=ls?ls.allocUnsafe:Oe,Ca=Lp(Po.getPrototypeOf,Po),Rl=Po.create,aa=vr.propertyIsEnumerable,Ac=si.splice,Vo=Si?Si.isConcatSpreadable:Oe,al=Si?Si.iterator:Oe,ll=Si?Si.toStringTag:Oe,In=function(){try{var _=rh(Po,"defineProperty");return _({},"",{}),_}catch{}}(),Jd=kt.clearTimeout!==is.clearTimeout&&kt.clearTimeout,Cf=Gi&&Gi.now!==is.Date.now&&Gi.now,Qd=kt.setTimeout!==is.setTimeout&&kt.setTimeout,ii=js.ceil,la=js.floor,eu=Po.getOwnPropertySymbols,Pl=ls?ls.isBuffer:Oe,Ed=kt.isFinite,$s=si.join,Dc=Lp(Po.keys,Po),bo=js.max,Ss=js.min,Vh=Gi.now,Er=kt.parseInt,Cm=js.random,Zu=si.reverse,Op=rh(kt,"DataView"),Ll=rh(kt,"Map"),Hh=rh(kt,"Promise"),Ba=rh(kt,"Set"),Qc=rh(kt,"WeakMap"),ms=rh(Po,"create"),Sf=Qc&&new Qc,Ts={},ca=pa(Op),Gh=pa(Ll),tu=pa(Hh),Tf=pa(Ba),ic=pa(Qc),jh=Si?Si.prototype:Oe,Ic=jh?jh.valueOf:Oe,Ig=jh?jh.toString:Oe;function ue(_){if(rs(_)&&!Pn(_)&&!(_ instanceof Dr)){if(_ instanceof nc)return _;if(Br.call(_,"__wrapped__"))return kr(_)}return new nc(_)}var Np=function(){function _(){}return function(E){if(!ks(E))return{};if(Rl)return Rl(E);_.prototype=E;var L=new _;return _.prototype=Oe,L}}();function Af(){}function nc(_,E){this.__wrapped__=_,this.__actions__=[],this.__chain__=!!E,this.__index__=0,this.__values__=Oe}function Dr(_){this.__wrapped__=_,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=xa,this.__views__=[]}function Wh(_){var E=-1,L=null==_?0:_.length;for(this.clear();++E<L;){var $=_[E];this.set($[0],$[1])}}function da(_){var E=-1,L=null==_?0:_.length;for(this.clear();++E<L;){var $=_[E];this.set($[0],$[1])}}function Sa(_){var E=-1,L=null==_?0:_.length;for(this.clear();++E<L;){var $=_[E];this.set($[0],$[1])}}function Ku(_){var E=-1,L=null==_?0:_.length;for(this.__data__=new Sa;++E<L;)this.add(_[E])}function kc(_){var E=this.__data__=new da(_);this.size=E.size}function iu(_,E){var L=Pn(_),$=!L&&ad(_),te=!L&&!$&&Zp(_),fe=!L&&!$&&!te&&Hf(_),Pe=L||$||te||fe,je=Pe?Tg(_.length,Fp):[],Qe=je.length;for(var $t in _)(E||Br.call(_,$t))&&(!Pe||!("length"==$t||te&&("offset"==$t||"parent"==$t)||fe&&("buffer"==$t||"byteLength"==$t||"byteOffset"==$t)||Lc($t,Qe)))&&je.push($t);return je}function v(_){var E=_.length;return E?_[ru(0,E-1)]:Oe}function d(_,E){return Zv(Va(_),K(E,0,_.length))}function p(_){return Zv(Va(_))}function x(_,E,L){(L!==Oe&&!Ul(_[E],L)||L===Oe&&!(E in _))&&j(_,E,L)}function C(_,E,L){var $=_[E];(!Br.call(_,E)||!Ul($,L)||L===Oe&&!(E in _))&&j(_,E,L)}function T(_,E){for(var L=_.length;L--;)if(Ul(_[L][0],E))return L;return-1}function P(_,E,L,$){return J(_,function(te,fe,Pe){E($,te,L(te),Pe)}),$}function F(_,E){return _&&Ds(E,Zs(E),_)}function j(_,E,L){"__proto__"==E&&In?In(_,E,{configurable:!0,enumerable:!0,value:L,writable:!0}):_[E]=L}function W(_,E){for(var L=-1,$=E.length,te=wt($),fe=null==_;++L<$;)te[L]=fe?Oe:$m(_,E[L]);return te}function K(_,E,L){return _==_&&(L!==Oe&&(_=_<=L?_:L),E!==Oe&&(_=_>=E?_:E)),_}function ne(_,E,L,$,te,fe){var Pe,je=1&E,Qe=2&E,$t=4&E;if(L&&(Pe=te?L(_,$,te,fe):L(_)),Pe!==Oe)return Pe;if(!ks(_))return _;var qt=Pn(_);if(qt){if(Pe=function Bl(_){var E=_.length,L=new _.constructor(E);return E&&"string"==typeof _[0]&&Br.call(_,"index")&&(L.index=_.index,L.input=_.input),L}(_),!je)return Va(_,Pe)}else{var ci=Gn(_),Li=ci==_o||ci==Kl;if(Zp(_))return cs(_,je);if(ci==bc||ci==fd||Li&&!te){if(Pe=Qe||Li?{}:lu(_),!je)return Qe?function Xh(_,E){return Ds(_,ul(_),E)}(_,function z(_,E){return _&&Ds(E,qa(E),_)}(Pe,_)):function Dm(_,E){return Ds(_,oh(_),E)}(_,F(Pe,_))}else{if(!Kr[ci])return te?_:{};Pe=function hl(_,E,L){var $=_.constructor;switch(E){case Wc:return qs(_);case rr:case vn:return new $(+_);case $c:return function $1(_,E){var L=E?qs(_.buffer):_.buffer;return new _.constructor(L,_.byteOffset,_.byteLength)}(_,L);case Ah:case Ra:case qc:case $d:case md:case Uu:case Sp:case Te:case ie:return Xi(_,L);case Tl:return new $;case Jl:case zu:return new $(_);case xc:return function Og(_){var E=new _.constructor(_.source,q_.exec(_));return E.lastIndex=_.lastIndex,E}(_);case wa:return new $;case Wd:return function As(_){return Ic?Po(Ic.call(_)):{}}(_)}}(_,ci,je)}}fe||(fe=new kc);var an=fe.get(_);if(an)return an;fe.set(_,Pe),Wa(_)?_.forEach(function(bn){Pe.add(ne(bn,E,L,bn,_,fe))}):s_(_)&&_.forEach(function(bn,Ln){Pe.set(Ln,ne(bn,E,L,Ln,_,fe))});var yr=qt?Oe:($t?Qe?Ug:zg:Qe?qa:Zs)(_);return Uo(yr||_,function(bn,Ln){yr&&(bn=_[Ln=bn]),C(Pe,Ln,ne(bn,E,L,Ln,_,fe))}),Pe}function pe(_,E,L){var $=L.length;if(null==_)return!$;for(_=Po(_);$--;){var te=L[$],Pe=_[te];if(Pe===Oe&&!(te in _)||!(0,E[te])(Pe))return!1}return!0}function le(_,E,L){if("function"!=typeof _)throw new kl(xs);return du(function(){_.apply(Oe,L)},E)}function me(_,E,L,$){var te=-1,fe=$u,Pe=!0,je=_.length,Qe=[],$t=E.length;if(!je)return Qe;L&&(E=Ro(E,ns(L))),$?(fe=bf,Pe=!1):E.length>=200&&(fe=Ea,Pe=!1,E=new Ku(E));e:for(;++te<je;){var qt=_[te],ci=null==L?qt:L(qt);if(qt=$||0!==qt?qt:0,Pe&&ci==ci){for(var Li=$t;Li--;)if(E[Li]===ci)continue e;Qe.push(qt)}else fe(E,ci,$)||Qe.push(qt)}return Qe}ue.templateSettings={escape:lt,evaluate:ri,interpolate:fi,variable:"",imports:{_:ue}},(ue.prototype=Af.prototype).constructor=ue,(nc.prototype=Np(Af.prototype)).constructor=nc,(Dr.prototype=Np(Af.prototype)).constructor=Dr,Wh.prototype.clear=function hx(){this.__data__=ms?ms(null):{},this.size=0},Wh.prototype.delete=function px(_){var E=this.has(_)&&delete this.__data__[_];return this.size-=E?1:0,E},Wh.prototype.get=function ed(_){var E=this.__data__;if(ms){var L=E[_];return L===Hn?Oe:L}return Br.call(E,_)?E[_]:Oe},Wh.prototype.has=function Bv(_){var E=this.__data__;return ms?E[_]!==Oe:Br.call(E,_)},Wh.prototype.set=function fx(_,E){var L=this.__data__;return this.size+=this.has(_)?0:1,L[_]=ms&&E===Oe?Hn:E,this},da.prototype.clear=function td(){this.__data__=[],this.size=0},da.prototype.delete=function Yu(_){var E=this.__data__,L=T(E,_);return!(L<0||(L==E.length-1?E.pop():Ac.call(E,L,1),--this.size,0))},da.prototype.get=function kg(_){var E=this.__data__,L=T(E,_);return L<0?Oe:E[L][1]},da.prototype.has=function Ii(_){return T(this.__data__,_)>-1},da.prototype.set=function iy(_,E){var L=this.__data__,$=T(L,_);return $<0?(++this.size,L.push([_,E])):L[$][1]=E,this},Sa.prototype.clear=function $h(){this.size=0,this.__data__={hash:new Wh,map:new(Ll||da),string:new Wh}},Sa.prototype.delete=function Bp(_){var E=au(this,_).delete(_);return this.size-=E?1:0,E},Sa.prototype.get=function yi(_){return au(this,_).get(_)},Sa.prototype.has=function Sm(_){return au(this,_).has(_)},Sa.prototype.set=function zv(_,E){var L=au(this,_),$=L.size;return L.set(_,E),this.size+=L.size==$?0:1,this},Ku.prototype.add=Ku.prototype.push=function Rg(_){return this.__data__.set(_,Hn),this},Ku.prototype.has=function Uv(_){return this.__data__.has(_)},kc.prototype.clear=function Cd(){this.__data__=new da,this.size=0},kc.prototype.delete=function Tm(_){var E=this.__data__,L=E.delete(_);return this.size=E.size,L},kc.prototype.get=function Fs(_){return this.__data__.get(_)},kc.prototype.has=function Am(_){return this.__data__.has(_)},kc.prototype.set=function ny(_,E){var L=this.__data__;if(L instanceof da){var $=L.__data__;if(!Ll||$.length<199)return $.push([_,E]),this.size=++L.size,this;L=this.__data__=new Sa($)}return L.set(_,E),this.size=L.size,this};var J=cy(Ye),de=cy(St,!0);function be(_,E){var L=!0;return J(_,function($,te,fe){return L=!!E($,te,fe)}),L}function xe(_,E,L){for(var $=-1,te=_.length;++$<te;){var fe=_[$],Pe=E(fe);if(null!=Pe&&(je===Oe?Pe==Pe&&!cd(Pe):L(Pe,je)))var je=Pe,Qe=fe}return Qe}function Be(_,E){var L=[];return J(_,function($,te,fe){E($,te,fe)&&L.push($)}),L}function ke(_,E,L,$,te){var fe=-1,Pe=_.length;for(L||(L=gx),te||(te=[]);++fe<Pe;){var je=_[fe];E>0&&L(je)?E>1?ke(je,E-1,L,$,te):Ls(te,je):$||(te[te.length]=je)}return te}var We=th(),$e=th(!0);function Ye(_,E){return _&&We(_,E,Zs)}function St(_,E){return _&&$e(_,E,Zs)}function Je(_,E){return Nr(E,function(L){return np(_[L])})}function vt(_,E){for(var L=0,$=(E=Vp(E,_)).length;null!=_&&L<$;)_=_[rd(E[L++])];return L&&L==$?_:Oe}function et(_,E,L){var $=E(_);return Pn(_)?$:Ls($,L(_))}function Rt(_){return null==_?_===Oe?"[object Undefined]":"[object Null]":ll&&ll in Po(_)?function hy(_){var E=Br.call(_,ll),L=_[ll];try{_[ll]=Oe;var $=!0}catch{}var te=Xu.call(_);return $&&(E?_[ll]=L:delete _[ll]),te}(_):function Is(_){return Xu.call(_)}(_)}function tt(_,E){return _>E}function Mt(_,E){return null!=_&&Br.call(_,E)}function Nt(_,E){return null!=_&&E in Po(_)}function Zt(_,E,L){for(var $=L?bf:$u,te=_[0].length,fe=_.length,Pe=fe,je=wt(fe),Qe=1/0,$t=[];Pe--;){var qt=_[Pe];Pe&&E&&(qt=Ro(qt,ns(E))),Qe=Ss(qt.length,Qe),je[Pe]=!L&&(E||te>=120&&qt.length>=120)?new Ku(Pe&&qt):Oe}qt=_[0];var ci=-1,Li=je[0];e:for(;++ci<te&&$t.length<Qe;){var an=qt[ci],zn=E?E(an):an;if(an=L||0!==an?an:0,!(Li?Ea(Li,zn):$($t,zn,L))){for(Pe=fe;--Pe;){var yr=je[Pe];if(!(yr?Ea(yr,zn):$(_[Pe],zn,L)))continue e}Li&&Li.push(zn),$t.push(an)}}return $t}function Qi(_,E,L){var $=null==(_=Ff(_,E=Vp(E,_)))?_:_[rd(kd(E))];return null==$?Oe:ol($,_,L)}function Ai(_){return rs(_)&&Rt(_)==fd}function Bn(_,E,L,$,te){return _===E||(null==_||null==E||!rs(_)&&!rs(E)?_!=_&&E!=E:function Bi(_,E,L,$,te,fe){var Pe=Pn(_),je=Pn(E),Qe=Pe?to:Gn(_),$t=je?to:Gn(E),qt=(Qe=Qe==fd?bc:Qe)==bc,ci=($t=$t==fd?bc:$t)==bc,Li=Qe==$t;if(Li&&Zp(_)){if(!Zp(E))return!1;Pe=!0,qt=!1}if(Li&&!qt)return fe||(fe=new kc),Pe||Hf(_)?dy(_,E,L,$,te,fe):function uy(_,E,L,$,te,fe,Pe){switch(L){case $c:if(_.byteLength!=E.byteLength||_.byteOffset!=E.byteOffset)return!1;_=_.buffer,E=E.buffer;case Wc:return!(_.byteLength!=E.byteLength||!fe(new Sn(_),new Sn(E)));case rr:case vn:case Jl:return Ul(+_,+E);case Bu:return _.name==E.name&&_.message==E.message;case xc:case zu:return _==E+"";case Tl:var je=Pp;case wa:if(je||(je=Bh),_.size!=E.size&&!(1&$))return!1;var $t=Pe.get(_);if($t)return $t==E;$|=2,Pe.set(_,E);var qt=dy(je(_),je(E),$,te,fe,Pe);return Pe.delete(_),qt;case Wd:if(Ic)return Ic.call(_)==Ic.call(E)}return!1}(_,E,Qe,L,$,te,fe);if(!(1&L)){var an=qt&&Br.call(_,"__wrapped__"),zn=ci&&Br.call(E,"__wrapped__");if(an||zn){var yr=an?_.value():_,bn=zn?E.value():E;return fe||(fe=new kc),te(yr,bn,L,$,fe)}}return!!Li&&(fe||(fe=new kc),function Kh(_,E,L,$,te,fe){var Pe=1&L,je=zg(_),Qe=je.length;if(Qe!=zg(E).length&&!Pe)return!1;for(var ci=Qe;ci--;){var Li=je[ci];if(!(Pe?Li in E:Br.call(E,Li)))return!1}var an=fe.get(_),zn=fe.get(E);if(an&&zn)return an==E&&zn==_;var yr=!0;fe.set(_,E),fe.set(E,_);for(var bn=Pe;++ci<Qe;){var Ln=_[Li=je[ci]],zr=E[Li];if($)var Ld=Pe?$(zr,Ln,Li,E,_,fe):$(Ln,zr,Li,_,E,fe);if(!(Ld===Oe?Ln===zr||te(Ln,zr,L,$,fe):Ld)){yr=!1;break}bn||(bn="constructor"==Li)}if(yr&&!bn){var dc=_.constructor,uc=E.constructor;dc!=uc&&"constructor"in _&&"constructor"in E&&!("function"==typeof dc&&dc instanceof dc&&"function"==typeof uc&&uc instanceof uc)&&(yr=!1)}return fe.delete(_),fe.delete(E),yr}(_,E,L,$,te,fe))}(_,E,L,$,Bn,te))}function Di(_,E,L,$){var te=L.length,fe=te,Pe=!$;if(null==_)return!fe;for(_=Po(_);te--;){var je=L[te];if(Pe&&je[2]?je[1]!==_[je[0]]:!(je[0]in _))return!1}for(;++te<fe;){var Qe=(je=L[te])[0],$t=_[Qe],qt=je[1];if(Pe&&je[2]){if($t===Oe&&!(Qe in _))return!1}else{var ci=new kc;if($)var Li=$($t,qt,Qe,_,E,ci);if(!(Li===Oe?Bn(qt,$t,3,$,ci):Li))return!1}}return!0}function no(_){return!(!ks(_)||function Fm(_){return!!qu&&qu in _}(_))&&(np(_)?Ef:Ms).test(pa(_))}function rc(_){return"function"==typeof _?_:null==_?ga:"object"==typeof _?Pn(_)?Ua(_[0],_[1]):gs(_):Xb(_)}function oc(_){if(!Gg(_))return Dc(_);var E=[];for(var L in Po(_))Br.call(_,L)&&"constructor"!=L&&E.push(L);return E}function ro(_,E){return _<E}function Ir(_,E){var L=-1,$=Vl(_)?wt(_.length):[];return J(_,function(te,fe,Pe){$[++L]=E(te,fe,Pe)}),$}function gs(_){var E=Pf(_);return 1==E.length&&E[0][2]?fy(E[0][0],E[0][1]):function(L){return L===_||Di(L,_,E)}}function Ua(_,E){return _x(_)&&Z1(E)?fy(rd(_),E):function(L){var $=$m(L,_);return $===Oe&&$===E?lc(L,_):Bn(E,$,3)}}function xo(_,E,L,$,te){_!==E&&We(E,function(fe,Pe){if(te||(te=new kc),ks(fe))!function Ut(_,E,L,$,te,fe,Pe){var je=zl(_,L),Qe=zl(E,L),$t=Pe.get(Qe);if($t)x(_,L,$t);else{var qt=fe?fe(je,Qe,L+"",_,E,Pe):Oe,ci=qt===Oe;if(ci){var Li=Pn(Qe),an=!Li&&Zp(Qe),zn=!Li&&!an&&Hf(Qe);qt=Qe,Li||an||zn?Pn(je)?qt=je:Us(je)?qt=Va(je):an?(ci=!1,qt=cs(Qe,!0)):zn?(ci=!1,qt=Xi(Qe,!0)):qt=[]:uh(Qe)||ad(Qe)?(qt=je,ad(je)?qt=hh(je):(!ks(je)||np(je))&&(qt=lu(Qe))):ci=!1}ci&&(Pe.set(Qe,qt),te(qt,Qe,$,fe,Pe),Pe.delete(Qe)),x(_,L,qt)}}(_,E,Pe,L,xo,$,te);else{var je=$?$(zl(_,Pe),fe,Pe+"",_,E,te):Oe;je===Oe&&(je=fe),x(_,Pe,je)}},qa)}function xr(_,E){var L=_.length;if(L)return Lc(E+=E<0?L:0,L)?_[E]:Oe}function $r(_,E,L){E=E.length?Ro(E,function(fe){return Pn(fe)?function(Pe){return vt(Pe,1===fe.length?fe[0]:fe)}:fe}):[ga];var $=-1;return E=Ro(E,ns(wn())),function Fh(Xe,kt){var wt=Xe.length;for(Xe.sort(kt);wt--;)Xe[wt]=Xe[wt].value;return Xe}(Ir(_,function(fe,Pe,je){return{criteria:Ro(E,function($t){return $t(fe)}),index:++$,value:fe}}),function(fe,Pe){return function kf(_,E,L){for(var $=-1,te=_.criteria,fe=E.criteria,Pe=te.length,je=L.length;++$<Pe;){var Qe=eh(te[$],fe[$]);if(Qe)return $>=je?Qe:Qe*("desc"==L[$]?-1:1)}return _.index-E.index}(fe,Pe,L)})}function Ho(_,E,L){for(var $=-1,te=E.length,fe={};++$<te;){var Pe=E[$],je=vt(_,Pe);L(je,Pe)&&Ol(fe,Vp(Pe,_),je)}return fe}function sc(_,E,L,$){var te=$?Mr:sl,fe=-1,Pe=E.length,je=_;for(_===E&&(E=Va(E)),L&&(je=Ro(_,ns(L)));++fe<Pe;)for(var Qe=0,$t=E[fe],qt=L?L($t):$t;(Qe=te(je,qt,Qe,$))>-1;)je!==_&&Ac.call(je,Qe,1),Ac.call(_,Qe,1);return _}function Fl(_,E){for(var L=_?E.length:0,$=L-1;L--;){var te=E[L];if(L==$||te!==fe){var fe=te;Lc(te)?Ac.call(_,te,1):If(_,te)}}return _}function ru(_,E){return _+la(Cm()*(E-_+1))}function ry(_,E){var L="";if(!_||E<1||E>Bo)return L;do{E%2&&(L+=_),(E=la(E/2))&&(_+=_)}while(E);return L}function Cr(_,E){return Nf($g(_,E,ga),_+"")}function mx(_){return v(rp(_))}function dl(_,E){var L=rp(_);return Zv(L,K(E,0,L.length))}function Ol(_,E,L,$){if(!ks(_))return _;for(var te=-1,fe=(E=Vp(E,_)).length,Pe=fe-1,je=_;null!=je&&++te<fe;){var Qe=rd(E[te]),$t=L;if("__proto__"===Qe||"constructor"===Qe||"prototype"===Qe)return _;if(te!=Pe){var qt=je[Qe];($t=$?$(qt,Qe,je):Oe)===Oe&&($t=ks(qt)?qt:Lc(E[te+1])?[]:{})}C(je,Qe,$t),je=je[Qe]}return _}var oy=Sf?function(_,E){return Sf.set(_,E),_}:ga,zp=In?function(_,E){return In(_,"toString",{configurable:!0,enumerable:!1,value:gu(E),writable:!0})}:ga;function Sd(_){return Zv(rp(_))}function ha(_,E,L){var $=-1,te=_.length;E<0&&(E=-E>te?0:te+E),(L=L>te?te:L)<0&&(L+=te),te=E>L?0:L-E>>>0,E>>>=0;for(var fe=wt(te);++$<te;)fe[$]=_[$+E];return fe}function Pg(_,E){var L;return J(_,function($,te,fe){return!(L=E($,te,fe))}),!!L}function Lg(_,E,L){var $=0,te=null==_?$:_.length;if("number"==typeof E&&E==E&&te<=2147483647){for(;$<te;){var fe=$+te>>>1,Pe=_[fe];null!==Pe&&!cd(Pe)&&(L?Pe<=E:Pe<E)?$=fe+1:te=fe}return te}return sy(_,E,ga,L)}function sy(_,E,L,$){var te=0,fe=null==_?0:_.length;if(0===fe)return 0;for(var Pe=(E=L(E))!=E,je=null===E,Qe=cd(E),$t=E===Oe;te<fe;){var qt=la((te+fe)/2),ci=L(_[qt]),Li=ci!==Oe,an=null===ci,zn=ci==ci,yr=cd(ci);if(Pe)var bn=$||zn;else bn=$t?zn&&($||Li):je?zn&&Li&&($||!an):Qe?zn&&Li&&!an&&($||!yr):!an&&!yr&&($?ci<=E:ci<E);bn?te=qt+1:fe=qt}return Ss(fe,4294967294)}function ay(_,E){for(var L=-1,$=_.length,te=0,fe=[];++L<$;){var Pe=_[L],je=E?E(Pe):Pe;if(!L||!Ul(je,Qe)){var Qe=je;fe[te++]=0===Pe?0:Pe}}return fe}function ly(_){return"number"==typeof _?_:cd(_)?NaN:+_}function Rc(_){if("string"==typeof _)return _;if(Pn(_))return Ro(_,Rc)+"";if(cd(_))return Ig?Ig.call(_):"";var E=_+"";return"0"==E&&1/_==-Cn?"-0":E}function Td(_,E,L){var $=-1,te=$u,fe=_.length,Pe=!0,je=[],Qe=je;if(L)Pe=!1,te=bf;else if(fe>=200){var $t=E?null:ds(_);if($t)return Bh($t);Pe=!1,te=Ea,Qe=new Ku}else Qe=E?[]:je;e:for(;++$<fe;){var qt=_[$],ci=E?E(qt):qt;if(qt=L||0!==qt?qt:0,Pe&&ci==ci){for(var Li=Qe.length;Li--;)if(Qe[Li]===ci)continue e;E&&Qe.push(ci),je.push(qt)}else te(Qe,ci,L)||(Qe!==je&&Qe.push(ci),je.push(qt))}return je}function If(_,E){return null==(_=Ff(_,E=Vp(E,_)))||delete _[rd(kd(E))]}function Up(_,E,L,$){return Ol(_,E,L(vt(_,E)),$)}function Pc(_,E,L,$){for(var te=_.length,fe=$?te:-1;($?fe--:++fe<te)&&E(_[fe],fe,_););return L?ha(_,$?0:fe,$?fe+1:te):ha(_,$?fe+1:0,$?te:fe)}function id(_,E){var L=_;return L instanceof Dr&&(L=L.value()),Yc(E,function($,te){return te.func.apply(te.thisArg,Ls([$],te.args))},L)}function ou(_,E,L){var $=_.length;if($<2)return $?Td(_[0]):[];for(var te=-1,fe=wt($);++te<$;)for(var Pe=_[te],je=-1;++je<$;)je!=te&&(fe[te]=me(fe[te]||Pe,_[je],E,L));return Td(ke(fe,1),E,L)}function Ju(_,E,L){for(var $=-1,te=_.length,fe=E.length,Pe={};++$<te;)L(Pe,_[$],$<fe?E[$]:Oe);return Pe}function Qu(_){return Us(_)?_:[]}function Fg(_){return"function"==typeof _?_:ga}function Vp(_,E){return Pn(_)?_:_x(_,E)?[_]:yx(Do(_))}var W1=Cr;function Os(_,E,L){var $=_.length;return L=L===Oe?$:L,!E&&L>=$?_:ha(_,E,L)}var qh=Jd||function(_){return is.clearTimeout(_)};function cs(_,E){if(E)return _.slice();var L=_.length,$=Yo?Yo(L):new _.constructor(L);return _.copy($),$}function qs(_){var E=new _.constructor(_.byteLength);return new Sn(E).set(new Sn(_)),E}function Xi(_,E){var L=E?qs(_.buffer):_.buffer;return new _.constructor(L,_.byteOffset,_.length)}function eh(_,E){if(_!==E){var L=_!==Oe,$=null===_,te=_==_,fe=cd(_),Pe=E!==Oe,je=null===E,Qe=E==E,$t=cd(E);if(!je&&!$t&&!fe&&_>E||fe&&Pe&&Qe&&!je&&!$t||$&&Pe&&Qe||!L&&Qe||!te)return 1;if(!$&&!fe&&!$t&&_<E||$t&&L&&te&&!$&&!fe||je&&L&&te||!Pe&&te||!Qe)return-1}return 0}function Ns(_,E,L,$){for(var te=-1,fe=_.length,Pe=L.length,je=-1,Qe=E.length,$t=bo(fe-Pe,0),qt=wt(Qe+$t),ci=!$;++je<Qe;)qt[je]=E[je];for(;++te<Pe;)(ci||te<fe)&&(qt[L[te]]=_[te]);for(;$t--;)qt[je++]=_[te++];return qt}function Vv(_,E,L,$){for(var te=-1,fe=_.length,Pe=-1,je=L.length,Qe=-1,$t=E.length,qt=bo(fe-je,0),ci=wt(qt+$t),Li=!$;++te<qt;)ci[te]=_[te];for(var an=te;++Qe<$t;)ci[an+Qe]=E[Qe];for(;++Pe<je;)(Li||te<fe)&&(ci[an+L[Pe]]=_[te++]);return ci}function Va(_,E){var L=-1,$=_.length;for(E||(E=wt($));++L<$;)E[L]=_[L];return E}function Ds(_,E,L,$){var te=!L;L||(L={});for(var fe=-1,Pe=E.length;++fe<Pe;){var je=E[fe],Qe=$?$(L[je],_[je],je,L,_):Oe;Qe===Oe&&(Qe=_[je]),te?j(L,je,Qe):C(L,je,Qe)}return L}function Zh(_,E){return function(L,$){var te=Pn(L)?vm:P,fe=E?E():{};return te(L,_,wn($,2),fe)}}function nd(_){return Cr(function(E,L){var $=-1,te=L.length,fe=te>1?L[te-1]:Oe,Pe=te>2?L[2]:Oe;for(fe=_.length>3&&"function"==typeof fe?(te--,fe):Oe,Pe&&Xs(L[0],L[1],Pe)&&(fe=te<3?Oe:fe,te=1),E=Po(E);++$<te;){var je=L[$];je&&_(E,je,$,fe)}return E})}function cy(_,E){return function(L,$){if(null==L)return L;if(!Vl(L))return _(L,$);for(var te=L.length,fe=E?te:-1,Pe=Po(L);(E?fe--:++fe<te)&&!1!==$(Pe[fe],fe,Pe););return L}}function th(_){return function(E,L,$){for(var te=-1,fe=Po(E),Pe=$(E),je=Pe.length;je--;){var Qe=Pe[_?je:++te];if(!1===L(fe[Qe],Qe,fe))break}return E}}function Hv(_){return function(E){var L=Kd(E=Do(E))?Tc(E):Oe,$=L?L[0]:E.charAt(0),te=L?Os(L,1).join(""):E.slice(1);return $[_]()+te}}function Ng(_){return function(E){return Yc(tw(dd(E).replace(Lv,"")),_,"")}}function Yh(_){return function(){var E=arguments;switch(E.length){case 0:return new _;case 1:return new _(E[0]);case 2:return new _(E[0],E[1]);case 3:return new _(E[0],E[1],E[2]);case 4:return new _(E[0],E[1],E[2],E[3]);case 5:return new _(E[0],E[1],E[2],E[3],E[4]);case 6:return new _(E[0],E[1],E[2],E[3],E[4],E[5]);case 7:return new _(E[0],E[1],E[2],E[3],E[4],E[5],E[6])}var L=Np(_.prototype),$=_.apply(L,E);return ks($)?$:L}}function km(_){return function(E,L,$){var te=Po(E);if(!Vl(E)){var fe=wn(L,3);E=Zs(E),L=function(je){return fe(te[je],je,te)}}var Pe=_(E,L,$);return Pe>-1?te[fe?E[Pe]:Pe]:Oe}}function Rf(_){return nh(function(E){var L=E.length,$=L,te=nc.prototype.thru;for(_&&E.reverse();$--;){var fe=E[$];if("function"!=typeof fe)throw new kl(xs);if(te&&!Pe&&"wrapper"==Hg(fe))var Pe=new nc([],!0)}for($=Pe?$:L;++$<L;){var je=Hg(fe=E[$]),Qe="wrapper"==je?Vg(fe):Oe;Pe=Qe&&cu(Qe[0])&&424==Qe[1]&&!Qe[4].length&&1==Qe[9]?Pe[Hg(Qe[0])].apply(Pe,Qe[3]):1==fe.length&&cu(fe)?Pe[je]():Pe.thru(fe)}return function(){var $t=arguments,qt=$t[0];if(Pe&&1==$t.length&&Pn(qt))return Pe.plant(qt).value();for(var ci=0,Li=L?E[ci].apply(this,$t):qt;++ci<L;)Li=E[ci].call(this,Li);return Li}})}function su(_,E,L,$,te,fe,Pe,je,Qe,$t){var qt=128&E,ci=1&E,Li=2&E,an=24&E,zn=512&E,yr=Li?Oe:Yh(_);return function bn(){for(var Ln=arguments.length,zr=wt(Ln),Ld=Ln;Ld--;)zr[Ld]=arguments[Ld];if(an)var dc=Lm(bn),uc=function Ag(Xe,kt){for(var wt=Xe.length,Gi=0;wt--;)Xe[wt]===kt&&++Gi;return Gi}(zr,dc);if($&&(zr=Ns(zr,$,te,an)),fe&&(zr=Vv(zr,fe,Pe,an)),Ln-=uc,an&&Ln<$t){var _a=tc(zr,dc);return Ad(_,E,su,bn.placeholder,L,zr,_a,je,Qe,$t-Ln)}var yl=ci?L:this,Fd=Li?yl[_]:_;return Ln=zr.length,je?zr=function qg(_,E){for(var L=_.length,$=Ss(E.length,L),te=Va(_);$--;){var fe=E[$];_[$]=Lc(fe,L)?te[fe]:Oe}return _}(zr,je):zn&&Ln>1&&zr.reverse(),qt&&Qe<Ln&&(zr.length=Qe),this&&this!==is&&this instanceof bn&&(Fd=yr||Yh(Fd)),Fd.apply(yl,zr)}}function Gv(_,E){return function(L,$){return function $i(_,E,L,$){return Ye(_,function(te,fe,Pe){E($,L(te),fe,Pe)}),$}(L,_,E($),{})}}function Rm(_,E){return function(L,$){var te;if(L===Oe&&$===Oe)return E;if(L!==Oe&&(te=L),$!==Oe){if(te===Oe)return $;"string"==typeof L||"string"==typeof $?(L=Rc(L),$=Rc($)):(L=ly(L),$=ly($)),te=_(L,$)}return te}}function ih(_){return nh(function(E){return E=Ro(E,ns(wn())),Cr(function(L){var $=this;return _(E,function(te){return ol(te,$,L)})})})}function Hp(_,E){var L=(E=E===Oe?" ":Rc(E)).length;if(L<2)return L?ry(E,_):E;var $=ry(E,ii(_/Md(E)));return Kd(E)?Os(Tc($),0,_).join(""):$.slice(0,_)}function Gp(_){return function(E,L,$){return $&&"number"!=typeof $&&Xs(E,L,$)&&(L=$=Oe),E=_l(E),L===Oe?(L=E,E=0):L=_l(L),function Df(_,E,L,$){for(var te=-1,fe=bo(ii((E-_)/(L||1)),0),Pe=wt(fe);fe--;)Pe[$?fe:++te]=_,_+=L;return Pe}(E,L,$=$===Oe?E<L?1:-1:_l($),_)}}function Bs(_){return function(E,L){return"string"==typeof E&&"string"==typeof L||(E=ac(E),L=ac(L)),_(E,L)}}function Ad(_,E,L,$,te,fe,Pe,je,Qe,$t){var qt=8&E;E|=qt?32:64,4&(E&=~(qt?64:32))||(E&=-4);var yr=[_,E,te,qt?fe:Oe,qt?Pe:Oe,qt?Oe:fe,qt?Oe:Pe,je,Qe,$t],bn=L.apply(Oe,yr);return cu(_)&&Of(bn,yr),bn.placeholder=$,jp(bn,_,E)}function Pm(_){var E=js[_];return function(L,$){if(L=ac(L),($=null==$?0:Ss(ar($),292))&&Ed(L)){var te=(Do(L)+"e").split("e");return+((te=(Do(E(te[0]+"e"+(+te[1]+$)))+"e").split("e"))[0]+"e"+(+te[1]-$))}return E(L)}}var ds=Ba&&1/Bh(new Ba([,-0]))[1]==Cn?function(_){return new Ba(_)}:jy;function jv(_){return function(E){var L=Gn(E);return L==Tl?Pp(E):L==wa?function Q_(Xe){var kt=-1,wt=Array(Xe.size);return Xe.forEach(function(Gi){wt[++kt]=[Gi,Gi]}),wt}(E):function Fv(Xe,kt){return Ro(kt,function(wt){return[wt,Xe[wt]]})}(E,_(E))}}function zs(_,E,L,$,te,fe,Pe,je){var Qe=2&E;if(!Qe&&"function"!=typeof _)throw new kl(xs);var $t=$?$.length:0;if($t||(E&=-97,$=te=Oe),Pe=Pe===Oe?Pe:bo(ar(Pe),0),je=je===Oe?je:ar(je),$t-=te?te.length:0,64&E){var qt=$,ci=te;$=te=Oe}var Li=Qe?Oe:Vg(_),an=[_,E,L,$,te,qt,ci,fe,Pe,je];if(Li&&function jg(_,E){var L=_[1],$=E[1],te=L|$;if(!(te<131)&&!(128==$&&8==L||128==$&&256==L&&_[7].length<=E[8]||384==$&&E[7].length<=E[8]&&8==L))return _;1&$&&(_[2]=E[2],te|=1&L?0:4);var je=E[3];if(je){var Qe=_[3];_[3]=Qe?Ns(Qe,je,E[4]):je,_[4]=Qe?tc(_[3],hs):E[4]}(je=E[5])&&(_[5]=(Qe=_[5])?Vv(Qe,je,E[6]):je,_[6]=Qe?tc(_[5],hs):E[6]),(je=E[7])&&(_[7]=je),128&$&&(_[8]=null==_[8]?E[8]:Ss(_[8],E[8])),null==_[9]&&(_[9]=E[9]),_[0]=E[0],_[1]=te}(an,Li),_=an[0],E=an[1],L=an[2],$=an[3],te=an[4],!(je=an[9]=an[9]===Oe?Qe?0:_.length:bo(an[9]-$t,0))&&24&E&&(E&=-25),E&&1!=E)zn=8==E||16==E?function q1(_,E,L){var $=Yh(_);return function te(){for(var fe=arguments.length,Pe=wt(fe),je=fe,Qe=Lm(te);je--;)Pe[je]=arguments[je];var $t=fe<3&&Pe[0]!==Qe&&Pe[fe-1]!==Qe?[]:tc(Pe,Qe);return(fe-=$t.length)<L?Ad(_,E,su,te.placeholder,Oe,Pe,$t,Oe,Oe,L-fe):ol(this&&this!==is&&this instanceof te?$:_,this,Pe)}}(_,E,je):32!=E&&33!=E||te.length?su.apply(Oe,an):function Nl(_,E,L,$){var te=1&E,fe=Yh(_);return function Pe(){for(var je=-1,Qe=arguments.length,$t=-1,qt=$.length,ci=wt(qt+Qe),Li=this&&this!==is&&this instanceof Pe?fe:_;++$t<qt;)ci[$t]=$[$t];for(;Qe--;)ci[$t++]=arguments[++je];return ol(Li,te?L:this,ci)}}(_,E,L,$);else var zn=function Im(_,E,L){var $=1&E,te=Yh(_);return function fe(){return(this&&this!==is&&this instanceof fe?te:_).apply($?L:this,arguments)}}(_,E,L);return jp((Li?oy:Of)(zn,an),_,E)}function Dd(_,E,L,$){return _===Oe||Ul(_,vr[L])&&!Br.call($,L)?E:_}function Bg(_,E,L,$,te,fe){return ks(_)&&ks(E)&&(fe.set(E,_),xo(_,E,Oe,Bg,fe),fe.delete(E)),_}function Wv(_){return uh(_)?Oe:_}function dy(_,E,L,$,te,fe){var Pe=1&L,je=_.length,Qe=E.length;if(je!=Qe&&!(Pe&&Qe>je))return!1;var $t=fe.get(_),qt=fe.get(E);if($t&&qt)return $t==E&&qt==_;var ci=-1,Li=!0,an=2&L?new Ku:Oe;for(fe.set(_,E),fe.set(E,_);++ci<je;){var zn=_[ci],yr=E[ci];if($)var bn=Pe?$(yr,zn,ci,E,_,fe):$(zn,yr,ci,_,E,fe);if(bn!==Oe){if(bn)continue;Li=!1;break}if(an){if(!xm(E,function(Ln,zr){if(!Ea(an,zr)&&(zn===Ln||te(zn,Ln,L,$,fe)))return an.push(zr)})){Li=!1;break}}else if(zn!==yr&&!te(zn,yr,L,$,fe)){Li=!1;break}}return fe.delete(_),fe.delete(E),Li}function nh(_){return Nf($g(_,Oe,Qh),_+"")}function zg(_){return et(_,Zs,oh)}function Ug(_){return et(_,qa,ul)}var Vg=Sf?function(_){return Sf.get(_)}:jy;function Hg(_){for(var E=_.name+"",L=Ts[E],$=Br.call(Ts,E)?L.length:0;$--;){var te=L[$],fe=te.func;if(null==fe||fe==_)return te.name}return E}function Lm(_){return(Br.call(ue,"placeholder")?ue:_).placeholder}function wn(){var _=ue.iteratee||Yf;return _=_===Yf?rc:_,arguments.length?_(arguments[0],arguments[1]):_}function au(_,E){var L=_.__data__;return function qv(_){var E=typeof _;return"string"==E||"number"==E||"symbol"==E||"boolean"==E?"__proto__"!==_:null===_}(E)?L["string"==typeof E?"string":"hash"]:L.map}function Pf(_){for(var E=Zs(_),L=E.length;L--;){var $=E[L],te=_[$];E[L]=[$,te,Z1(te)]}return E}function rh(_,E){var L=function Yd(Xe,kt){return null==Xe?Oe:Xe[kt]}(_,E);return no(L)?L:Oe}var oh=eu?function(_){return null==_?[]:(_=Po(_),Nr(eu(_),function(E){return aa.call(_,E)}))}:Jp,ul=eu?function(_){for(var E=[];_;)Ls(E,oh(_)),_=Ca(_);return E}:Jp,Gn=Rt;function $v(_,E,L){for(var $=-1,te=(E=Vp(E,_)).length,fe=!1;++$<te;){var Pe=rd(E[$]);if(!(fe=null!=_&&L(_,Pe)))break;_=_[Pe]}return fe||++$!=te?fe:!!(te=null==_?0:_.length)&&jm(te)&&Lc(Pe,te)&&(Pn(_)||ad(_))}function lu(_){return"function"!=typeof _.constructor||Gg(_)?{}:Np(Ca(_))}function gx(_){return Pn(_)||ad(_)||!!(Vo&&_&&_[Vo])}function Lc(_,E){var L=typeof _;return!!(E=E??Bo)&&("number"==L||"symbol"!=L&&Ql.test(_))&&_>-1&&_%1==0&&_<E}function Xs(_,E,L){if(!ks(L))return!1;var $=typeof E;return!!("number"==$?Vl(L)&&Lc(E,L.length):"string"==$&&E in L)&&Ul(L[E],_)}function _x(_,E){if(Pn(_))return!1;var L=typeof _;return!("number"!=L&&"symbol"!=L&&"boolean"!=L&&null!=_&&!cd(_))||On.test(_)||!Kt.test(_)||null!=E&&_ in Po(E)}function cu(_){var E=Hg(_),L=ue[E];if("function"!=typeof L||!(E in Dr.prototype))return!1;if(_===L)return!0;var $=Vg(L);return!!$&&_===$[0]}(Op&&Gn(new Op(new ArrayBuffer(1)))!=$c||Ll&&Gn(new Ll)!=Tl||Hh&&Gn(Hh.resolve())!=Ep||Ba&&Gn(new Ba)!=wa||Qc&&Gn(new Qc)!=Al)&&(Gn=function(_){var E=Rt(_),L=E==bc?_.constructor:Oe,$=L?pa(L):"";if($)switch($){case ca:return $c;case Gh:return Tl;case tu:return Ep;case Tf:return wa;case ic:return Al}return E});var X1=vo?np:Qp;function Gg(_){var E=_&&_.constructor;return _===("function"==typeof E&&E.prototype||vr)}function Z1(_){return _==_&&!ks(_)}function fy(_,E){return function(L){return null!=L&&L[_]===E&&(E!==Oe||_ in Po(L))}}function $g(_,E,L){return E=bo(E===Oe?_.length-1:E,0),function(){for(var $=arguments,te=-1,fe=bo($.length-E,0),Pe=wt(fe);++te<fe;)Pe[te]=$[E+te];te=-1;for(var je=wt(E+1);++te<E;)je[te]=$[te];return je[E]=L(Pe),ol(_,this,je)}}function Ff(_,E){return E.length<2?_:vt(_,ha(E,0,-1))}function zl(_,E){if(("constructor"!==E||"function"!=typeof _[E])&&"__proto__"!=E)return _[E]}var Of=Xv(oy),du=Qd||function(_,E){return is.setTimeout(_,E)},Nf=Xv(zp);function jp(_,E,L){var $=E+"";return Nf(_,function pl(_,E){var L=E.length;if(!L)return _;var $=L-1;return E[$]=(L>1?"& ":"")+E[$],E=E.join(L>2?", ":" "),_.replace(Tr,"{\n/* [wrapped with "+E+"] */\n")}($,function ah(_,E){return Uo(ws,function(L){var $="_."+L[0];E&L[1]&&!$u(_,$)&&_.push($)}),_.sort()}(function sh(_){var E=_.match(Pa);return E?E[1].split(Ps):[]}($),L)))}function Xv(_){var E=0,L=0;return function(){var $=Vh(),te=16-($-L);if(L=$,te>0){if(++E>=800)return arguments[0]}else E=0;return _.apply(Oe,arguments)}}function Zv(_,E){var L=-1,$=_.length,te=$-1;for(E=E===Oe?$:E;++L<E;){var fe=ru(L,te),Pe=_[fe];_[fe]=_[L],_[L]=Pe}return _.length=E,_}var yx=function Lf(_){var E=Vf(_,function($){return 500===L.size&&L.clear(),$}),L=E.cache;return E}(function(_){var E=[];return 46===_.charCodeAt(0)&&E.push(""),_.replace(or,function(L,$,te,fe){E.push(te?fe.replace(La,"$1"):$||L)}),E});function rd(_){if("string"==typeof _||cd(_))return _;var E=_+"";return"0"==E&&1/_==-Cn?"-0":E}function pa(_){if(null!=_){try{return Cs.call(_)}catch{}try{return _+""}catch{}}return""}function kr(_){if(_ instanceof Dr)return _.clone();var E=new nc(_.__wrapped__,_.__chain__);return E.__actions__=Va(_.__actions__),E.__index__=_.__index__,E.__values__=_.__values__,E}var hu=Cr(function(_,E){return Us(_)?me(_,ke(E,1,Us,!0)):[]}),od=Cr(function(_,E){var L=kd(E);return Us(L)&&(L=Oe),Us(_)?me(_,ke(E,1,Us,!0),wn(L,2)):[]}),Ha=Cr(function(_,E){var L=kd(E);return Us(L)&&(L=Oe),Us(_)?me(_,ke(E,1,Us,!0),Oe,L):[]});function Id(_,E,L){var $=null==_?0:_.length;if(!$)return-1;var te=null==L?0:ar(L);return te<0&&(te=bo($+te,0)),Ph(_,wn(E,3),te)}function gy(_,E,L){var $=null==_?0:_.length;if(!$)return-1;var te=$-1;return L!==Oe&&(te=ar(L),te=L<0?bo($+te,0):Ss(te,$-1)),Ph(_,wn(E,3),te,!0)}function Qh(_){return null!=_&&_.length?ke(_,1):[]}function sd(_){return _&&_.length?_[0]:Oe}var yy=Cr(function(_){var E=Ro(_,Qu);return E.length&&E[0]===_[0]?Zt(E):[]}),$p=Cr(function(_){var E=kd(_),L=Ro(_,Qu);return E===kd(L)?E=Oe:L.pop(),L.length&&L[0]===_[0]?Zt(L,wn(E,2)):[]}),Om=Cr(function(_){var E=kd(_),L=Ro(_,Qu);return(E="function"==typeof E?E:Oe)&&L.pop(),L.length&&L[0]===_[0]?Zt(L,Oe,E):[]});function kd(_){var E=null==_?0:_.length;return E?_[E-1]:Oe}var YC=Cr(vy);function vy(_,E){return _&&_.length&&E&&E.length?sc(_,E):_}var ch=nh(function(_,E){var L=null==_?0:_.length,$=W(_,E);return Fl(_,Ro(E,function(te){return Lc(te,L)?+te:te}).sort(eh)),$});function ib(_){return null==_?_:Zu.call(_)}var Ex=Cr(function(_){return Td(ke(_,1,Us,!0))}),ep=Cr(function(_){var E=kd(_);return Us(E)&&(E=Oe),Td(ke(_,1,Us,!0),wn(E,2))}),fl=Cr(function(_){var E=kd(_);return E="function"==typeof E?E:Oe,Td(ke(_,1,Us,!0),Oe,E)});function wy(_){if(!_||!_.length)return[];var E=0;return _=Nr(_,function(L){if(Us(L))return E=bo(L.length,E),!0}),Tg(E,function(L){return Ro(_,mi(L))})}function zf(_,E){if(!_||!_.length)return[];var L=wy(_);return null==E?L:Ro(L,function($){return ol(E,Oe,$)})}var My=Cr(function(_,E){return Us(_)?me(_,E):[]}),Xg=Cr(function(_){return ou(Nr(_,Us))}),Zg=Cr(function(_){var E=kd(_);return Us(E)&&(E=Oe),ou(Nr(_,Us),wn(E,2))}),dh=Cr(function(_){var E=kd(_);return E="function"==typeof E?E:Oe,ou(Nr(_,Us),Oe,E)}),ja=Cr(wy),sM=Cr(function(_){var E=_.length,L=E>1?_[E-1]:Oe;return L="function"==typeof L?(_.pop(),L):Oe,zf(_,L)});function ab(_){var E=ue(_);return E.__chain__=!0,E}function Ey(_,E){return E(_)}var aM=nh(function(_){var E=_.length,L=E?_[0]:0,$=this.__wrapped__,te=function(fe){return W(fe,_)};return!(E>1||this.__actions__.length)&&$ instanceof Dr&&Lc(L)?(($=$.slice(L,+L+(E?1:0))).__actions__.push({func:Ey,args:[te],thisArg:Oe}),new nc($,this.__chain__).thru(function(fe){return E&&!fe.length&&fe.push(Oe),fe})):this.thru(te)}),zm=Zh(function(_,E,L){Br.call(_,L)?++_[L]:j(_,L,1)}),ub=km(Id),hb=km(gy);function Kg(_,E){return(Pn(_)?Uo:J)(_,wn(E,3))}function Tx(_,E){return(Pn(_)?bm:de)(_,wn(E,3))}var fb=Zh(function(_,E,L){Br.call(_,L)?_[L].push(E):j(_,L,[E])}),cM=Cr(function(_,E,L){var $=-1,te="function"==typeof E,fe=Vl(_)?wt(_.length):[];return J(_,function(Pe){fe[++$]=te?ol(E,Pe,L):Qi(Pe,E,L)}),fe}),Qg=Zh(function(_,E,L){j(_,L,E)});function Um(_,E){return(Pn(_)?Ro:Ir)(_,wn(E,3))}var Uf=Zh(function(_,E,L){_[L?0:1].push(E)},function(){return[[],[]]}),gb=Cr(function(_,E){if(null==_)return[];var L=E.length;return L>1&&Xs(_,E[0],E[1])?E=[]:L>2&&Xs(E[0],E[1],E[2])&&(E=[E[0]]),$r(_,ke(E,1),[])}),qp=Cf||function(){return is.Date.now()};function kx(_,E,L){return E=L?Oe:E,zs(_,128,Oe,Oe,Oe,Oe,E=_&&null==E?_.length:E)}function Rx(_,E){var L;if("function"!=typeof E)throw new kl(xs);return _=ar(_),function(){return--_>0&&(L=E.apply(this,arguments)),_<=1&&(E=Oe),L}}var _b=Cr(function(_,E,L){var $=1;if(L.length){var te=tc(L,Lm(_b));$|=32}return zs(_,$,E,L,te)}),yb=Cr(function(_,E,L){var $=3;if(L.length){var te=tc(L,Lm(yb));$|=32}return zs(E,$,_,L,te)});function Ay(_,E,L){var $,te,fe,Pe,je,Qe,$t=0,qt=!1,ci=!1,Li=!0;if("function"!=typeof _)throw new kl(xs);function an(_a){var yl=$,Fd=te;return $=te=Oe,$t=_a,Pe=_.apply(Fd,yl)}function bn(_a){var yl=_a-Qe;return Qe===Oe||yl>=E||yl<0||ci&&_a-$t>=fe}function Ln(){var _a=qp();if(bn(_a))return zr(_a);je=du(Ln,function yr(_a){var Zb=E-(_a-Qe);return ci?Ss(Zb,fe-(_a-$t)):Zb}(_a))}function zr(_a){return je=Oe,Li&&$?an(_a):($=te=Oe,Pe)}function uc(){var _a=qp(),yl=bn(_a);if($=arguments,te=this,Qe=_a,yl){if(je===Oe)return function zn(_a){return $t=_a,je=du(Ln,E),qt?an(_a):Pe}(Qe);if(ci)return qh(je),je=du(Ln,E),an(Qe)}return je===Oe&&(je=du(Ln,E)),Pe}return E=ac(E)||0,ks(L)&&(qt=!!L.leading,fe=(ci="maxWait"in L)?bo(ac(L.maxWait)||0,E):fe,Li="trailing"in L?!!L.trailing:Li),uc.cancel=function Ld(){je!==Oe&&qh(je),$t=0,$=Qe=te=je=Oe},uc.flush=function dc(){return je===Oe?Pe:zr(qp())},uc}var Px=Cr(function(_,E){return le(_,1,E)}),t_=Cr(function(_,E,L){return le(_,ac(E)||0,L)});function Vf(_,E){if("function"!=typeof _||null!=E&&"function"!=typeof E)throw new kl(xs);var L=function(){var $=arguments,te=E?E.apply(this,$):$[0],fe=L.cache;if(fe.has(te))return fe.get(te);var Pe=_.apply(this,$);return L.cache=fe.set(te,Pe)||fe,Pe};return L.cache=new(Vf.Cache||Sa),L}function Gm(_){if("function"!=typeof _)throw new kl(xs);return function(){var E=arguments;switch(E.length){case 0:return!_.call(this);case 1:return!_.call(this,E[0]);case 2:return!_.call(this,E[0],E[1]);case 3:return!_.call(this,E[0],E[1],E[2])}return!_.apply(this,E)}}Vf.Cache=Sa;var pu=W1(function(_,E){var L=(E=1==E.length&&Pn(E[0])?Ro(E[0],ns(wn())):Ro(ke(E,1),ns(wn()))).length;return Cr(function($){for(var te=-1,fe=Ss($.length,L);++te<fe;)$[te]=E[te].call(this,$[te]);return ol(_,this,$)})}),Xp=Cr(function(_,E){var L=tc(E,Lm(Xp));return zs(_,32,Oe,E,L)}),Iy=Cr(function(_,E){var L=tc(E,Lm(Iy));return zs(_,64,Oe,E,L)}),i_=nh(function(_,E){return zs(_,256,Oe,Oe,Oe,E)});function Ul(_,E){return _===E||_!=_&&E!=E}var r_=Bs(tt),ml=Bs(function(_,E){return _>=E}),ad=Ai(function(){return arguments}())?Ai:function(_){return rs(_)&&Br.call(_,"callee")&&!aa.call(_,"callee")},Pn=wt.isArray,o_=ym?ns(ym):function nn(_){return rs(_)&&Rt(_)==Wc};function Vl(_){return null!=_&&jm(_.length)&&!np(_)}function Us(_){return rs(_)&&Vl(_)}var Zp=Pl||Qp,Ox=Wu?ns(Wu):function sr(_){return rs(_)&&Rt(_)==vn};function Tb(_){if(!rs(_))return!1;var E=Rt(_);return E==Bu||"[object DOMException]"==E||"string"==typeof _.message&&"string"==typeof _.name&&!uh(_)}function np(_){if(!ks(_))return!1;var E=Rt(_);return E==_o||E==Kl||"[object AsyncFunction]"==E||"[object Proxy]"==E}function Ab(_){return"number"==typeof _&&_==ar(_)}function jm(_){return"number"==typeof _&&_>-1&&_%1==0&&_<=Bo}function ks(_){var E=typeof _;return null!=_&&("object"==E||"function"==E)}function rs(_){return null!=_&&"object"==typeof _}var s_=Ip?ns(Ip):function Jr(_){return rs(_)&&Gn(_)==Tl};function a_(_){return"number"==typeof _||rs(_)&&Rt(_)==Jl}function uh(_){if(!rs(_)||Rt(_)!=bc)return!1;var E=Ca(_);if(null===E)return!0;var L=Br.call(E,"constructor")&&E.constructor;return"function"==typeof L&&L instanceof L&&Cs.call(L)==Uh}var Rb=vf?ns(vf):function To(_){return rs(_)&&Rt(_)==xc},Wa=kh?ns(kh):function za(_){return rs(_)&&Gn(_)==wa};function ld(_){return"string"==typeof _||!Pn(_)&&rs(_)&&Rt(_)==zu}function cd(_){return"symbol"==typeof _||rs(_)&&Rt(_)==Wd}var Hf=xi?ns(xi):function ua(_){return rs(_)&&jm(_.length)&&!!Oo[Rt(_)]},Pb=Bs(ro),Lb=Bs(function(_,E){return _<=E});function Fb(_){if(!_)return[];if(Vl(_))return ld(_)?Tc(_):Va(_);if(al&&_[al])return function Rp(Xe){for(var kt,wt=[];!(kt=Xe.next()).done;)wt.push(kt.value);return wt}(_[al]());var E=Gn(_);return(E==Tl?Pp:E==wa?Bh:rp)(_)}function _l(_){return _?(_=ac(_))===Cn||_===-Cn?17976931348623157e292*(_<0?-1:1):_==_?_:0:0===_?_:0}function ar(_){var E=_l(_),L=E%1;return E==E?L?E-L:E:0}function Ob(_){return _?K(ar(_),0,xa):0}function ac(_){if("number"==typeof _)return _;if(cd(_))return NaN;if(ks(_)){var E="function"==typeof _.valueOf?_.valueOf():_;_=ks(E)?E+"":E}if("string"!=typeof _)return 0===_?_:+_;_=Sc(_);var L=Gr.test(_);return L||yd.test(_)?Xd(_.slice(2),L?2:8):_d.test(_)?NaN:+_}function hh(_){return Ds(_,qa(_))}function Do(_){return null==_?"":Rc(_)}var Hx=nd(function(_,E){if(Gg(E)||Vl(E))Ds(E,Zs(E),_);else for(var L in E)Br.call(E,L)&&C(_,L,E[L])}),Nb=nd(function(_,E){Ds(E,qa(E),_)}),Bb=nd(function(_,E,L,$){Ds(E,qa(E),_,$)}),QC=nd(function(_,E,L,$){Ds(E,Zs(E),_,$)}),eS=nh(W),Yp=Cr(function(_,E){_=Po(_);var L=-1,$=E.length,te=$>2?E[2]:Oe;for(te&&Xs(E[0],E[1],te)&&($=1);++L<$;)for(var fe=E[L],Pe=qa(fe),je=-1,Qe=Pe.length;++je<Qe;){var $t=Pe[je],qt=_[$t];(qt===Oe||Ul(qt,vr[$t])&&!Br.call(_,$t))&&(_[$t]=fe[$t])}return _}),fM=Cr(function(_){return _.push(Oe,Bg),ol($x,Oe,_)});function $m(_,E,L){var $=null==_?Oe:vt(_,E);return $===Oe?L:$}function lc(_,E){return null!=_&&$v(_,E,Nt)}var wo=Gv(function(_,E,L){null!=E&&"function"!=typeof E.toString&&(E=Xu.call(E)),_[E]=L},gu(ga)),c_=Gv(function(_,E,L){null!=E&&"function"!=typeof E.toString&&(E=Xu.call(E)),Br.call(_,E)?_[E].push(L):_[E]=[L]},wn),qm=Cr(Qi);function Zs(_){return Vl(_)?iu(_):oc(_)}function qa(_){return Vl(_)?iu(_,!0):function ao(_){if(!ks(_))return function Wg(_){var E=[];if(null!=_)for(var L in Po(_))E.push(L);return E}(_);var E=Gg(_),L=[];for(var $ in _)"constructor"==$&&(E||!Br.call(_,$))||L.push($);return L}(_)}var Wx=nd(function(_,E,L){xo(_,E,L)}),$x=nd(function(_,E,L,$){xo(_,E,L,$)}),Ub=nh(function(_,E){var L={};if(null==_)return L;var $=!1;E=Ro(E,function(fe){return fe=Vp(fe,_),$||($=fe.length>1),fe}),Ds(_,Ug(_),L),$&&(L=ne(L,7,Wv));for(var te=E.length;te--;)If(L,E[te]);return L}),qx=nh(function(_,E){return null==_?{}:function lo(_,E){return Ho(_,E,function(L,$){return lc(_,$)})}(_,E)});function Gf(_,E){if(null==_)return{};var L=Ro(Ug(_),function($){return[$]});return E=wn(E),Ho(_,L,function($,te){return E($,te[0])})}var By=jv(Zs),zy=jv(qa);function rp(_){return null==_?[]:sa(_,Zs(_))}var Rd=Ng(function(_,E,L){return E=E.toLowerCase(),_+(L?d_(E):E)});function d_(_){return ew(Do(_).toLowerCase())}function dd(_){return(_=Do(_))&&_.replace(xg,Oh).replace(gf,"")}var Jx=Ng(function(_,E,L){return _+(L?"-":"")+E.toLowerCase()}),Ym=Ng(function(_,E,L){return _+(L?" ":"")+E.toLowerCase()}),$f=Hv("toLowerCase"),fu=Ng(function(_,E,L){return _+(L?"_":"")+E.toLowerCase()}),MM=Ng(function(_,E,L){return _+(L?" ":"")+ew(E)}),Wb=Ng(function(_,E,L){return _+(L?" ":"")+E.toUpperCase()}),ew=Hv("toUpperCase");function tw(_,E,L){return _=Do(_),(E=L?Oe:E)===Oe?function Jc(Xe){return Dp.test(Xe)}(_)?function Mf(Xe){return Xe.match(Ec)||[]}(_):function wm(Xe){return Xe.match(gd)||[]}(_):_.match(E)||[]}var mu=Cr(function(_,E){try{return ol(_,Oe,E)}catch(L){return Tb(L)?L:new ui(L)}}),SM=nh(function(_,E){return Uo(E,function(L){L=rd(L),j(_,L,_b(_[L],_))}),_});function gu(_){return function(){return _}}var Zf=Rf(),op=Rf(!0);function ga(_){return _}function Yf(_){return rc("function"==typeof _?_:ne(_,1))}var Kf=Cr(function(_,E){return function(L){return Qi(L,_,E)}}),tS=Cr(function(_,E){return function(L){return Qi(_,L,E)}});function eg(_,E,L){var $=Zs(E),te=Je(E,$);null==L&&(!ks(E)||!te.length&&$.length)&&(L=E,E=_,_=this,te=Je(E,Zs(E)));var fe=!(ks(L)&&"chain"in L&&!L.chain),Pe=np(_);return Uo(te,function(je){var Qe=E[je];_[je]=Qe,Pe&&(_.prototype[je]=function(){var $t=this.__chain__;if(fe||$t){var qt=_(this.__wrapped__);return(qt.__actions__=Va(this.__actions__)).push({func:Qe,args:arguments,thisArg:_}),qt.__chain__=$t,qt}return Qe.apply(_,Ls([this.value()],arguments))})}),_}function jy(){}var TM=ih(Ro),qb=ih(J_),rw=ih(xm);function Xb(_){return _x(_)?mi(rd(_)):function nu(_){return function(E){return vt(E,_)}}(_)}var iS=Gp(),Wy=Gp(!0);function Jp(){return[]}function Qp(){return!1}var ow=Rm(function(_,E){return _+E},0),h_=Pm("ceil"),nS=Rm(function(_,E){return _/E},1),kM=Pm("floor"),sp=Rm(function(_,E){return _*E},1),sw=Pm("round"),PM=Rm(function(_,E){return _-E},0);return ue.after=function Hm(_,E){if("function"!=typeof E)throw new kl(xs);return _=ar(_),function(){if(--_<1)return E.apply(this,arguments)}},ue.ary=kx,ue.assign=Hx,ue.assignIn=Nb,ue.assignInWith=Bb,ue.assignWith=QC,ue.at=eS,ue.before=Rx,ue.bind=_b,ue.bindAll=SM,ue.bindKey=yb,ue.castArray=function Mb(){if(!arguments.length)return[];var _=arguments[0];return Pn(_)?_:[_]},ue.chain=ab,ue.chunk=function vx(_,E,L){E=(L?Xs(_,E,L):E===Oe)?1:bo(ar(E),0);var $=null==_?0:_.length;if(!$||E<1)return[];for(var te=0,fe=0,Pe=wt(ii($/E));te<$;)Pe[fe++]=ha(_,te,te+=E);return Pe},ue.compact=function uu(_){for(var E=-1,L=null==_?0:_.length,$=0,te=[];++E<L;){var fe=_[E];fe&&(te[$++]=fe)}return te},ue.concat=function lh(){var _=arguments.length;if(!_)return[];for(var E=wt(_-1),L=arguments[0],$=_;$--;)E[$-1]=arguments[$];return Ls(Pn(L)?Va(L):[L],ke(E,1))},ue.cond=function mh(_){var E=null==_?0:_.length,L=wn();return _=E?Ro(_,function($){if("function"!=typeof $[1])throw new kl(xs);return[L($[0]),$[1]]}):[],Cr(function($){for(var te=-1;++te<E;){var fe=_[te];if(ol(fe[0],this,$))return ol(fe[1],this,$)}})},ue.conforms=function $b(_){return function he(_){var E=Zs(_);return function(L){return pe(L,_,E)}}(ne(_,1))},ue.constant=gu,ue.countBy=zm,ue.create=function Wm(_,E){var L=Np(_);return null==E?L:F(L,E)},ue.curry=function vb(_,E,L){var $=zs(_,8,Oe,Oe,Oe,Oe,Oe,E=L?Oe:E);return $.placeholder=vb.placeholder,$},ue.curryRight=function bb(_,E,L){var $=zs(_,16,Oe,Oe,Oe,Oe,Oe,E=L?Oe:E);return $.placeholder=bb.placeholder,$},ue.debounce=Ay,ue.defaults=Yp,ue.defaultsDeep=fM,ue.defer=Px,ue.delay=t_,ue.difference=hu,ue.differenceBy=od,ue.differenceWith=Ha,ue.drop=function bx(_,E,L){var $=null==_?0:_.length;return $?ha(_,(E=L||E===Oe?1:ar(E))<0?0:E,$):[]},ue.dropRight=function Ga(_,E,L){var $=null==_?0:_.length;return $?ha(_,0,(E=$-(E=L||E===Oe?1:ar(E)))<0?0:E):[]},ue.dropRightWhile=function my(_,E){return _&&_.length?Pc(_,wn(E,3),!0,!0):[]},ue.dropWhile=function Jh(_,E){return _&&_.length?Pc(_,wn(E,3),!0):[]},ue.fill=function Yv(_,E,L,$){var te=null==_?0:_.length;return te?(L&&"number"!=typeof L&&Xs(_,E,L)&&(L=0,$=te),function Ne(_,E,L,$){var te=_.length;for((L=ar(L))<0&&(L=-L>te?0:te+L),($=$===Oe||$>te?te:ar($))<0&&($+=te),$=L>$?0:Ob($);L<$;)_[L++]=E;return _}(_,E,L,$)):[]},ue.filter=function tp(_,E){return(Pn(_)?Nr:Be)(_,wn(E,3))},ue.flatMap=function Yg(_,E){return ke(Um(_,E),1)},ue.flatMapDeep=function Cy(_,E){return ke(Um(_,E),Cn)},ue.flatMapDepth=function pb(_,E,L){return L=L===Oe?1:ar(L),ke(Um(_,E),L)},ue.flatten=Qh,ue.flattenDeep=function Kv(_){return null!=_&&_.length?ke(_,Cn):[]},ue.flattenDepth=function Jv(_,E){return null!=_&&_.length?ke(_,E=E===Oe?1:ar(E)):[]},ue.flip=function Dy(_){return zs(_,512)},ue.flow=Zf,ue.flowRight=op,ue.fromPairs=function Qv(_){for(var E=-1,L=null==_?0:_.length,$={};++E<L;){var te=_[E];$[te[0]]=te[1]}return $},ue.functions=function Oy(_){return null==_?[]:Je(_,Zs(_))},ue.functionsIn=function $a(_){return null==_?[]:Je(_,qa(_))},ue.groupBy=fb,ue.initial=function _y(_){return null!=_&&_.length?ha(_,0,-1):[]},ue.intersection=yy,ue.intersectionBy=$p,ue.intersectionWith=Om,ue.invert=wo,ue.invertBy=c_,ue.invokeMap=cM,ue.iteratee=Yf,ue.keyBy=Qg,ue.keys=Zs,ue.keysIn=qa,ue.map=Um,ue.mapKeys=function yM(_,E){var L={};return E=wn(E,3),Ye(_,function($,te,fe){j(L,E($,te,fe),$)}),L},ue.mapValues=function jx(_,E){var L={};return E=wn(E,3),Ye(_,function($,te,fe){j(L,te,E($,te,fe))}),L},ue.matches=function iw(_){return gs(ne(_,1))},ue.matchesProperty=function Kp(_,E){return Ua(_,ne(E,1))},ue.memoize=Vf,ue.merge=Wx,ue.mergeWith=$x,ue.method=Kf,ue.methodOf=tS,ue.mixin=eg,ue.negate=Gm,ue.nthArg=function nw(_){return _=ar(_),Cr(function(E){return xr(E,_)})},ue.omit=Ub,ue.omitBy=function vM(_,E){return Gf(_,Gm(wn(E)))},ue.once=function Lx(_){return Rx(2,_)},ue.orderBy=function mb(_,E,L,$){return null==_?[]:(Pn(E)||(E=null==E?[]:[E]),Pn(L=$?Oe:L)||(L=null==L?[]:[L]),$r(_,E,L))},ue.over=TM,ue.overArgs=pu,ue.overEvery=qb,ue.overSome=rw,ue.partial=Xp,ue.partialRight=Iy,ue.partition=Uf,ue.pick=qx,ue.pickBy=Gf,ue.property=Xb,ue.propertyOf=function AM(_){return function(E){return null==_?Oe:vt(_,E)}},ue.pull=YC,ue.pullAll=vy,ue.pullAllBy=function wx(_,E,L){return _&&_.length&&E&&E.length?sc(_,E,wn(L,2)):_},ue.pullAllWith=function Mx(_,E,L){return _&&_.length&&E&&E.length?sc(_,E,Oe,L):_},ue.pullAt=ch,ue.range=iS,ue.rangeRight=Wy,ue.rearg=i_,ue.reject=function Ax(_,E){return(Pn(_)?Nr:Be)(_,Gm(wn(E,3)))},ue.remove=function tb(_,E){var L=[];if(!_||!_.length)return L;var $=-1,te=[],fe=_.length;for(E=wn(E,3);++$<fe;){var Pe=_[$];E(Pe,$,_)&&(L.push(Pe),te.push($))}return Fl(_,te),L},ue.rest=function uM(_,E){if("function"!=typeof _)throw new kl(xs);return Cr(_,E=E===Oe?E:ar(E))},ue.reverse=ib,ue.sampleSize=function Ix(_,E,L){return E=(L?Xs(_,E,L):E===Oe)?1:ar(E),(Pn(_)?d:dl)(_,E)},ue.set=function Xm(_,E,L){return null==_?_:Ol(_,E,L)},ue.setWith=function ph(_,E,L,$){return $="function"==typeof $?$:Oe,null==_?_:Ol(_,E,L,$)},ue.shuffle=function Vm(_){return(Pn(_)?p:Sd)(_)},ue.slice=function Bf(_,E,L){var $=null==_?0:_.length;return $?(L&&"number"!=typeof L&&Xs(_,E,L)?(E=0,L=$):(E=null==E?0:ar(E),L=L===Oe?$:ar(L)),ha(_,E,L)):[]},ue.sortBy=gb,ue.sortedUniq=function KC(_){return _&&_.length?ay(_):[]},ue.sortedUniqBy=function eM(_,E){return _&&_.length?ay(_,wn(E,2)):[]},ue.split=function Gb(_,E,L){return L&&"number"!=typeof L&&Xs(_,E,L)&&(E=L=Oe),(L=L===Oe?xa:L>>>0)?(_=Do(_))&&("string"==typeof E||null!=E&&!Rb(E))&&!(E=Rc(E))&&Kd(_)?Os(Tc(_),0,L):_.split(E,L):[]},ue.spread=function ky(_,E){if("function"!=typeof _)throw new kl(xs);return E=null==E?0:bo(ar(E),0),Cr(function(L){var $=L[E],te=Os(L,0,E);return $&&Ls(te,$),ol(_,this,te)})},ue.tail=function ob(_){var E=null==_?0:_.length;return E?ha(_,1,E):[]},ue.take=function JC(_,E,L){return _&&_.length?ha(_,0,(E=L||E===Oe?1:ar(E))<0?0:E):[]},ue.takeRight=function tM(_,E,L){var $=null==_?0:_.length;return $?ha(_,(E=$-(E=L||E===Oe?1:ar(E)))<0?0:E,$):[]},ue.takeRightWhile=function iM(_,E){return _&&_.length?Pc(_,wn(E,3),!1,!0):[]},ue.takeWhile=function nM(_,E){return _&&_.length?Pc(_,wn(E,3)):[]},ue.tap=function lb(_,E){return E(_),_},ue.throttle=function Fx(_,E,L){var $=!0,te=!0;if("function"!=typeof _)throw new kl(xs);return ks(L)&&($="leading"in L?!!L.leading:$,te="trailing"in L?!!L.trailing:te),Ay(_,E,{leading:$,maxWait:E,trailing:te})},ue.thru=Ey,ue.toArray=Fb,ue.toPairs=By,ue.toPairsIn=zy,ue.toPath=function IM(_){return Pn(_)?Ro(_,rd):cd(_)?[_]:Va(yx(Do(_)))},ue.toPlainObject=hh,ue.transform=function Uy(_,E,L){var $=Pn(_),te=$||Zp(_)||Hf(_);if(E=wn(E,4),null==L){var fe=_&&_.constructor;L=te?$?new fe:[]:ks(_)&&np(fe)?Np(Ca(_)):{}}return(te?Uo:Ye)(_,function(Pe,je,Qe){return E(L,Pe,je,Qe)}),L},ue.unary=function xb(_){return kx(_,1)},ue.union=Ex,ue.unionBy=ep,ue.unionWith=fl,ue.uniq=function sb(_){return _&&_.length?Td(_):[]},ue.uniqBy=function xy(_,E){return _&&_.length?Td(_,wn(E,2)):[]},ue.uniqWith=function Cx(_,E){return E="function"==typeof E?E:Oe,_&&_.length?Td(_,Oe,E):[]},ue.unset=function Xx(_,E){return null==_||If(_,E)},ue.unzip=wy,ue.unzipWith=zf,ue.update=function Zx(_,E,L){return null==_?_:Up(_,E,Fg(L))},ue.updateWith=function Yx(_,E,L,$){return $="function"==typeof $?$:Oe,null==_?_:Up(_,E,Fg(L),$)},ue.values=rp,ue.valuesIn=function bM(_){return null==_?[]:sa(_,qa(_))},ue.without=My,ue.words=tw,ue.wrap=function wb(_,E){return Xp(Fg(E),_)},ue.xor=Xg,ue.xorBy=Zg,ue.xorWith=dh,ue.zip=ja,ue.zipObject=function rM(_,E){return Ju(_||[],E||[],C)},ue.zipObjectDeep=function oM(_,E){return Ju(_||[],E||[],Ol)},ue.zipWith=sM,ue.entries=By,ue.entriesIn=zy,ue.extend=Nb,ue.extendWith=Bb,eg(ue,ue),ue.add=ow,ue.attempt=mu,ue.camelCase=Rd,ue.capitalize=d_,ue.ceil=h_,ue.clamp=function jf(_,E,L){return L===Oe&&(L=E,E=Oe),L!==Oe&&(L=(L=ac(L))==L?L:0),E!==Oe&&(E=(E=ac(E))==E?E:0),K(ac(_),E,L)},ue.clone=function Ry(_){return ne(_,4)},ue.cloneDeep=function Py(_){return ne(_,5)},ue.cloneDeepWith=function n_(_,E){return ne(_,5,E="function"==typeof E?E:Oe)},ue.cloneWith=function Eb(_,E){return ne(_,4,E="function"==typeof E?E:Oe)},ue.conformsTo=function Cb(_,E){return null==E||pe(_,E,Zs(E))},ue.deburr=dd,ue.defaultTo=function Xf(_,E){return null==_||_!=_?E:_},ue.divide=nS,ue.endsWith=function Zm(_,E,L){_=Do(_),E=Rc(E);var $=_.length,te=L=L===Oe?$:K(ar(L),0,$);return(L-=E.length)>=0&&_.slice(L,te)==E},ue.eq=Ul,ue.escape=function Hy(_){return(_=Do(_))&&Ge.test(_)?_.replace(Ke,Nh):_},ue.escapeRegExp=function Wf(_){return(_=Do(_))&&tr.test(_)?_.replace(An,"\\$&"):_},ue.every=function Ta(_,E,L){var $=Pn(_)?J_:be;return L&&Xs(_,E,L)&&(E=Oe),$(_,wn(E,3))},ue.find=ub,ue.findIndex=Id,ue.findKey=function zb(_,E){return xd(_,wn(E,3),Ye)},ue.findLast=hb,ue.findLastIndex=gy,ue.findLastKey=function Fy(_,E){return xd(_,wn(E,3),St)},ue.floor=kM,ue.forEach=Kg,ue.forEachRight=Tx,ue.forIn=function mM(_,E){return null==_?_:We(_,wn(E,3),qa)},ue.forInRight=function gM(_,E){return null==_?_:$e(_,wn(E,3),qa)},ue.forOwn=function _M(_,E){return _&&Ye(_,wn(E,3))},ue.forOwnRight=function Gx(_,E){return _&&St(_,wn(E,3))},ue.get=$m,ue.gt=r_,ue.gte=ml,ue.has=function Ny(_,E){return null!=_&&$v(_,E,Mt)},ue.hasIn=lc,ue.head=sd,ue.identity=ga,ue.includes=function Jg(_,E,L,$){_=Vl(_)?_:rp(_),L=L&&!$?ar(L):0;var te=_.length;return L<0&&(L=bo(te+L,0)),ld(_)?L<=te&&_.indexOf(E,L)>-1:!!te&&sl(_,E,L)>-1},ue.indexOf=function Wp(_,E,L){var $=null==_?0:_.length;if(!$)return-1;var te=null==L?0:ar(L);return te<0&&(te=bo($+te,0)),sl(_,E,te)},ue.inRange=function Kx(_,E,L){return E=_l(E),L===Oe?(L=E,E=0):L=_l(L),function Bt(_,E,L){return _>=Ss(E,L)&&_<bo(E,L)}(_=ac(_),E,L)},ue.invoke=qm,ue.isArguments=ad,ue.isArray=Pn,ue.isArrayBuffer=o_,ue.isArrayLike=Vl,ue.isArrayLikeObject=Us,ue.isBoolean=function hM(_){return!0===_||!1===_||rs(_)&&Rt(_)==rr},ue.isBuffer=Zp,ue.isDate=Ox,ue.isElement=function Nx(_){return rs(_)&&1===_.nodeType&&!uh(_)},ue.isEmpty=function Ly(_){if(null==_)return!0;if(Vl(_)&&(Pn(_)||"string"==typeof _||"function"==typeof _.splice||Zp(_)||Hf(_)||ad(_)))return!_.length;var E=Gn(_);if(E==Tl||E==wa)return!_.size;if(Gg(_))return!oc(_).length;for(var L in _)if(Br.call(_,L))return!1;return!0},ue.isEqual=function Sb(_,E){return Bn(_,E)},ue.isEqualWith=function ip(_,E,L){var $=(L="function"==typeof L?L:Oe)?L(_,E):Oe;return $===Oe?Bn(_,E,Oe,L):!!$},ue.isError=Tb,ue.isFinite=function Bx(_){return"number"==typeof _&&Ed(_)},ue.isFunction=np,ue.isInteger=Ab,ue.isLength=jm,ue.isMap=s_,ue.isMatch=function Db(_,E){return _===E||Di(_,E,Pf(E))},ue.isMatchWith=function Ib(_,E,L){return L="function"==typeof L?L:Oe,Di(_,E,Pf(E),L)},ue.isNaN=function zx(_){return a_(_)&&_!=+_},ue.isNative=function fa(_){if(X1(_))throw new ui("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return no(_)},ue.isNil=function kb(_){return null==_},ue.isNull=function gl(_){return null===_},ue.isNumber=a_,ue.isObject=ks,ue.isObjectLike=rs,ue.isPlainObject=uh,ue.isRegExp=Rb,ue.isSafeInteger=function pM(_){return Ab(_)&&_>=-Bo&&_<=Bo},ue.isSet=Wa,ue.isString=ld,ue.isSymbol=cd,ue.isTypedArray=Hf,ue.isUndefined=function Ux(_){return _===Oe},ue.isWeakMap=function Vx(_){return rs(_)&&Gn(_)==Al},ue.isWeakSet=function Ao(_){return rs(_)&&"[object WeakSet]"==Rt(_)},ue.join=function Y1(_,E){return null==_?"":$s.call(_,E)},ue.kebabCase=Jx,ue.last=kd,ue.lastIndexOf=function xx(_,E,L){var $=null==_?0:_.length;if(!$)return-1;var te=$;return L!==Oe&&(te=(te=ar(L))<0?bo($+te,0):Ss(te,$-1)),E==E?function wf(Xe,kt,wt){for(var Gi=wt+1;Gi--;)if(Xe[Gi]===kt)return Gi;return Gi}(_,E,te):Ph(_,it,te,!0)},ue.lowerCase=Ym,ue.lowerFirst=$f,ue.lt=Pb,ue.lte=Lb,ue.max=function tg(_){return _&&_.length?xe(_,ga,tt):Oe},ue.maxBy=function RM(_,E){return _&&_.length?xe(_,wn(E,2),tt):Oe},ue.mean=function ef(_){return Mm(_,ga)},ue.meanBy=function tn(_,E){return Mm(_,wn(E,2))},ue.min=function p_(_){return _&&_.length?xe(_,ga,ro):Oe},ue.minBy=function f_(_,E){return _&&_.length?xe(_,wn(E,2),ro):Oe},ue.stubArray=Jp,ue.stubFalse=Qp,ue.stubObject=function DM(){return{}},ue.stubString=function $y(){return""},ue.stubTrue=function u_(){return!0},ue.multiply=sp,ue.nth=function eb(_,E){return _&&_.length?xr(_,ar(E)):Oe},ue.noConflict=function Gy(){return is._===this&&(is._=Ar),this},ue.noop=jy,ue.now=qp,ue.pad=function fh(_,E,L){_=Do(_);var $=(E=ar(E))?Md(_):0;if(!E||$>=E)return _;var te=(E-$)/2;return Hp(la(te),L)+_+Hp(ii(te),L)},ue.padEnd=function Vb(_,E,L){_=Do(_);var $=(E=ar(E))?Md(_):0;return E&&$<E?_+Hp(E-$,L):_},ue.padStart=function Hb(_,E,L){_=Do(_);var $=(E=ar(E))?Md(_):0;return E&&$<E?Hp(E-$,L)+_:_},ue.parseInt=function xM(_,E,L){return L||null==E?E=0:E&&(E=+E),Er(Do(_).replace(dr,""),E||0)},ue.random=function Vy(_,E,L){if(L&&"boolean"!=typeof L&&Xs(_,E,L)&&(E=L=Oe),L===Oe&&("boolean"==typeof E?(L=E,E=Oe):"boolean"==typeof _&&(L=_,_=Oe)),_===Oe&&E===Oe?(_=0,E=1):(_=_l(_),E===Oe?(E=_,_=0):E=_l(E)),_>E){var $=_;_=E,E=$}if(L||_%1||E%1){var te=Cm();return Ss(_+te*(E-_+_f("1e-"+((te+"").length-1))),E)}return ru(_,E)},ue.reduce=function Sy(_,E,L){var $=Pn(_)?Yc:wd,te=arguments.length<3;return $(_,wn(E,4),L,te,J)},ue.reduceRight=function dM(_,E,L){var $=Pn(_)?Rh:wd,te=arguments.length<3;return $(_,wn(E,4),L,te,de)},ue.repeat=function wM(_,E,L){return E=(L?Xs(_,E,L):E===Oe)?1:ar(E),ry(Do(_),E)},ue.replace=function qf(){var _=arguments,E=Do(_[0]);return _.length<3?E:E.replace(_[1],_[2])},ue.result=function Ot(_,E,L){var $=-1,te=(E=Vp(E,_)).length;for(te||(te=1,_=Oe);++$<te;){var fe=null==_?Oe:_[rd(E[$])];fe===Oe&&($=te,fe=L),_=np(fe)?fe.call(_):fe}return _},ue.round=sw,ue.runInContext=Xe,ue.sample=function Dx(_){return(Pn(_)?v:mx)(_)},ue.size=function Ty(_){if(null==_)return 0;if(Vl(_))return ld(_)?Md(_):_.length;var E=Gn(_);return E==Tl||E==wa?_.size:oc(_).length},ue.snakeCase=fu,ue.some=function e_(_,E,L){var $=Pn(_)?xm:Pg;return L&&Xs(_,E,L)&&(E=Oe),$(_,wn(E,3))},ue.sortedIndex=function nb(_,E){return Lg(_,E)},ue.sortedIndexBy=function rb(_,E,L){return sy(_,E,wn(L,2))},ue.sortedIndexOf=function K1(_,E){var L=null==_?0:_.length;if(L){var $=Lg(_,E);if($<L&&Ul(_[$],E))return $}return-1},ue.sortedLastIndex=function J1(_,E){return Lg(_,E,!0)},ue.sortedLastIndexBy=function Q1(_,E,L){return sy(_,E,wn(L,2),!0)},ue.sortedLastIndexOf=function by(_,E){if(null!=_&&_.length){var $=Lg(_,E,!0)-1;if(Ul(_[$],E))return $}return-1},ue.startCase=MM,ue.startsWith=function Qx(_,E,L){return _=Do(_),L=null==L?0:K(ar(L),0,_.length),E=Rc(E),_.slice(L,L+E.length)==E},ue.subtract=PM,ue.sum=function tf(_){return _&&_.length?Sg(_,ga):0},ue.sumBy=function Pd(_,E){return _&&_.length?Sg(_,wn(E,2)):0},ue.template=function jb(_,E,L){var $=ue.templateSettings;L&&Xs(_,E,L)&&(E=Oe),_=Do(_),E=Bb({},E,$,Dd);var je,Qe,te=Bb({},E.imports,$.imports,Dd),fe=Zs(te),Pe=sa(te,fe),$t=0,qt=E.interpolate||ec,ci="__p += '",Li=Nn((E.escape||ec).source+"|"+qt.source+"|"+(qt===fi?Tp:ec).source+"|"+(E.evaluate||ec).source+"|$","g"),an="//# sourceURL="+(Br.call(E,"sourceURL")?(E.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++K_+"]")+"\n";_.replace(Li,function(bn,Ln,zr,Ld,dc,uc){return zr||(zr=Ld),ci+=_.slice($t,uc).replace(vd,Kc),Ln&&(je=!0,ci+="' +\n__e("+Ln+") +\n'"),dc&&(Qe=!0,ci+="';\n"+dc+";\n__p += '"),zr&&(ci+="' +\n((__t = ("+zr+")) == null ? '' : __t) +\n'"),$t=uc+bn.length,bn}),ci+="';\n";var zn=Br.call(E,"variable")&&E.variable;if(zn){if(na.test(zn))throw new ui("Invalid `variable` option passed into `_.template`")}else ci="with (obj) {\n"+ci+"\n}\n";ci=(Qe?ci.replace(re,""):ci).replace(Me,"$1").replace(Fe,"$1;"),ci="function("+(zn||"obj")+") {\n"+(zn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(je?", __e = _.escape":"")+(Qe?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+ci+"return __p\n}";var yr=mu(function(){return so(fe,an+"return "+ci).apply(Oe,Pe)});if(yr.source=ci,Tb(yr))throw yr;return yr},ue.times=function _u(_,E){if((_=ar(_))<1||_>Bo)return[];var L=xa,$=Ss(_,xa);E=wn(E),_-=xa;for(var te=Tg($,E);++L<_;)E(L);return te},ue.toFinite=_l,ue.toInteger=ar,ue.toLength=Ob,ue.toLower=function Km(_){return Do(_).toLowerCase()},ue.toNumber=ac,ue.toSafeInteger=function l_(_){return _?K(ar(_),-Bo,Bo):0===_?_:0},ue.toString=Do,ue.toUpper=function EM(_){return Do(_).toUpperCase()},ue.trim=function Jm(_,E,L){if((_=Do(_))&&(L||E===Oe))return Sc(_);if(!_||!(E=Rc(E)))return _;var $=Tc(_),te=Tc(E);return Os($,Wr($,te),kp($,te)+1).join("")},ue.trimEnd=function cc(_,E,L){if((_=Do(_))&&(L||E===Oe))return _.slice(0,Il(_)+1);if(!_||!(E=Rc(E)))return _;var $=Tc(_);return Os($,0,kp($,Tc(E))+1).join("")},ue.trimStart=function CM(_,E,L){if((_=Do(_))&&(L||E===Oe))return _.replace(dr,"");if(!_||!(E=Rc(E)))return _;var $=Tc(_);return Os($,Wr($,Tc(E))).join("")},ue.truncate=function ma(_,E){var L=30,$="...";if(ks(E)){var te="separator"in E?E.separator:te;L="length"in E?ar(E.length):L,$="omission"in E?Rc(E.omission):$}var fe=(_=Do(_)).length;if(Kd(_)){var Pe=Tc(_);fe=Pe.length}if(L>=fe)return _;var je=L-Md($);if(je<1)return $;var Qe=Pe?Os(Pe,0,je).join(""):_.slice(0,je);if(te===Oe)return Qe+$;if(Pe&&(je+=Qe.length-je),Rb(te)){if(_.slice(je).search(te)){var $t,qt=Qe;for(te.global||(te=Nn(te.source,Do(q_.exec(te))+"g")),te.lastIndex=0;$t=te.exec(qt);)var ci=$t.index;Qe=Qe.slice(0,ci===Oe?je:ci)}}else if(_.indexOf(Rc(te),je)!=je){var Li=Qe.lastIndexOf(te);Li>-1&&(Qe=Qe.slice(0,Li))}return Qe+$},ue.unescape=function Qm(_){return(_=Do(_))&&Ze.test(_)?_.replace(He,Ov):_},ue.uniqueId=function qy(_){var E=++Ws;return Do(_)+E},ue.upperCase=Wb,ue.upperFirst=ew,ue.each=Kg,ue.eachRight=Tx,ue.first=sd,eg(ue,function(){var _={};return Ye(ue,function(E,L){Br.call(ue.prototype,L)||(_[L]=E)}),_}(),{chain:!1}),ue.VERSION="4.17.21",Uo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(_){ue[_].placeholder=ue}),Uo(["drop","take"],function(_,E){Dr.prototype[_]=function(L){L=L===Oe?1:bo(ar(L),0);var $=this.__filtered__&&!E?new Dr(this):this.clone();return $.__filtered__?$.__takeCount__=Ss(L,$.__takeCount__):$.__views__.push({size:Ss(L,xa),type:_+($.__dir__<0?"Right":"")}),$},Dr.prototype[_+"Right"]=function(L){return this.reverse()[_](L).reverse()}}),Uo(["filter","map","takeWhile"],function(_,E){var L=E+1,$=1==L||3==L;Dr.prototype[_]=function(te){var fe=this.clone();return fe.__iteratees__.push({iteratee:wn(te,3),type:L}),fe.__filtered__=fe.__filtered__||$,fe}}),Uo(["head","last"],function(_,E){var L="take"+(E?"Right":"");Dr.prototype[_]=function(){return this[L](1).value()[0]}}),Uo(["initial","tail"],function(_,E){var L="drop"+(E?"":"Right");Dr.prototype[_]=function(){return this.__filtered__?new Dr(this):this[L](1)}}),Dr.prototype.compact=function(){return this.filter(ga)},Dr.prototype.find=function(_){return this.filter(_).head()},Dr.prototype.findLast=function(_){return this.reverse().find(_)},Dr.prototype.invokeMap=Cr(function(_,E){return"function"==typeof _?new Dr(this):this.map(function(L){return Qi(L,_,E)})}),Dr.prototype.reject=function(_){return this.filter(Gm(wn(_)))},Dr.prototype.slice=function(_,E){_=ar(_);var L=this;return L.__filtered__&&(_>0||E<0)?new Dr(L):(_<0?L=L.takeRight(-_):_&&(L=L.drop(_)),E!==Oe&&(L=(E=ar(E))<0?L.dropRight(-E):L.take(E-_)),L)},Dr.prototype.takeRightWhile=function(_){return this.reverse().takeWhile(_).reverse()},Dr.prototype.toArray=function(){return this.take(xa)},Ye(Dr.prototype,function(_,E){var L=/^(?:filter|find|map|reject)|While$/.test(E),$=/^(?:head|last)$/.test(E),te=ue[$?"take"+("last"==E?"Right":""):E],fe=$||/^find/.test(E);te&&(ue.prototype[E]=function(){var Pe=this.__wrapped__,je=$?[1]:arguments,Qe=Pe instanceof Dr,$t=je[0],qt=Qe||Pn(Pe),ci=function(Ln){var zr=te.apply(ue,Ls([Ln],je));return $&&Li?zr[0]:zr};qt&&L&&"function"==typeof $t&&1!=$t.length&&(Qe=qt=!1);var Li=this.__chain__,zn=fe&&!Li,yr=Qe&&!this.__actions__.length;if(!fe&&qt){Pe=yr?Pe:new Dr(this);var bn=_.apply(Pe,je);return bn.__actions__.push({func:Ey,args:[ci],thisArg:Oe}),new nc(bn,Li)}return zn&&yr?_.apply(this,je):(bn=this.thru(ci),zn?$?bn.value()[0]:bn.value():bn)})}),Uo(["pop","push","shift","sort","splice","unshift"],function(_){var E=si[_],L=/^(?:push|sort|unshift)$/.test(_)?"tap":"thru",$=/^(?:pop|shift)$/.test(_);ue.prototype[_]=function(){var te=arguments;if($&&!this.__chain__){var fe=this.value();return E.apply(Pn(fe)?fe:[],te)}return this[L](function(Pe){return E.apply(Pn(Pe)?Pe:[],te)})}}),Ye(Dr.prototype,function(_,E){var L=ue[E];if(L){var $=L.name+"";Br.call(Ts,$)||(Ts[$]=[]),Ts[$].push({name:E,func:L})}}),Ts[su(Oe,2).name]=[{name:"wrapper",func:Oe}],Dr.prototype.clone=function Nv(){var _=new Dr(this.__wrapped__);return _.__actions__=Va(this.__actions__),_.__dir__=this.__dir__,_.__filtered__=this.__filtered__,_.__iteratees__=Va(this.__iteratees__),_.__takeCount__=this.__takeCount__,_.__views__=Va(this.__views__),_},Dr.prototype.reverse=function cl(){if(this.__filtered__){var _=new Dr(this);_.__dir__=-1,_.__filtered__=!0}else(_=this.clone()).__dir__*=-1;return _},Dr.prototype.value=function ux(){var _=this.__wrapped__.value(),E=this.__dir__,L=Pn(_),$=E<0,te=L?_.length:0,fe=function py(_,E,L){for(var $=-1,te=L.length;++$<te;){var fe=L[$],Pe=fe.size;switch(fe.type){case"drop":_+=Pe;break;case"dropRight":E-=Pe;break;case"take":E=Ss(E,_+Pe);break;case"takeRight":_=bo(_,E-Pe)}}return{start:_,end:E}}(0,te,this.__views__),Pe=fe.start,je=fe.end,Qe=je-Pe,$t=$?je:Pe-1,qt=this.__iteratees__,ci=qt.length,Li=0,an=Ss(Qe,this.__takeCount__);if(!L||!$&&te==Qe&&an==Qe)return id(_,this.__actions__);var zn=[];e:for(;Qe--&&Li<an;){for(var yr=-1,bn=_[$t+=E];++yr<ci;){var Ln=qt[yr],Ld=Ln.type,dc=(0,Ln.iteratee)(bn);if(2==Ld)bn=dc;else if(!dc){if(1==Ld)continue e;break e}}zn[Li++]=bn}return zn},ue.prototype.at=aM,ue.prototype.chain=function cb(){return ab(this)},ue.prototype.commit=function Sx(){return new nc(this.value(),this.__chain__)},ue.prototype.next=function Nm(){this.__values__===Oe&&(this.__values__=Fb(this.value()));var _=this.__index__>=this.__values__.length;return{done:_,value:_?Oe:this.__values__[this.__index__++]}},ue.prototype.plant=function qr(_){for(var E,L=this;L instanceof Af;){var $=kr(L);$.__index__=0,$.__values__=Oe,E?te.__wrapped__=$:E=$;var te=$;L=L.__wrapped__}return te.__wrapped__=_,E},ue.prototype.reverse=function Bm(){var _=this.__wrapped__;if(_ instanceof Dr){var E=_;return this.__actions__.length&&(E=new Dr(this)),(E=E.reverse()).__actions__.push({func:Ey,args:[ib],thisArg:Oe}),new nc(E,this.__chain__)}return this.thru(ib)},ue.prototype.toJSON=ue.prototype.valueOf=ue.prototype.value=function db(){return id(this.__wrapped__,this.__actions__)},ue.prototype.first=ue.prototype.head,al&&(ue.prototype[al]=function lM(){return this}),ue}();is._=zh,(Sr=function(){return zh}.call(Ou,Mp,Ou,Ch))!==Oe&&(Ch.exports=Sr)}.call(this)},574:function(Ch){Ch.exports=function(){"use strict";var Ou,Mp,Sr;function Oe(g,gt){if(Ou)if(Mp){var xs="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Ou+")(sharedChunk); ("+Mp+")(sharedChunk); self.onerror = null;",_c={};Ou(_c),Sr=gt(_c),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(Sr.workerUrl=window.URL.createObjectURL(new Blob([xs],{type:"text/javascript"})))}else Mp=gt;else Ou=gt}return Oe(0,function(g){var gt=typeof self<"u"?self:{},xs="2.15.0";let _c;const Hn={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==_c){const l=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_c=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):l}catch{_c=l}}return _c},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Hn.API_URL)return null;try{const l=new URL(Hn.API_URL);return"api.mapbox.cn"===l.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===l.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},jn={supported:!1,testSupport:function(l){!Yl&&ps&&(Cl?pd(l):hs=l)}};let hs,ps,Yl=!1,Cl=!1;function pd(l){const s=l.createTexture();l.bindTexture(l.TEXTURE_2D,s);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,ps),l.isContextLost())return;jn.supported=!0}catch{}l.deleteTexture(s),Yl=!0}gt.document&&(ps=gt.document.createElement("img"),ps.onload=function(){hs&&pd(hs),hs=null,Cl=!0},ps.onerror=function(){Yl=!0,hs=null},ps.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Gd="01";function Jo(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var ta=nl;function nl(l,s,c,h){this.cx=3*l,this.bx=3*(c-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(h-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=s,this.p2x=c,this.p2y=h}nl.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,s){if(void 0===s&&(s=1e-6),l<0)return 0;if(l>1)return 1;for(var c=l,h=0;h<8;h++){var m=this.sampleCurveX(c)-l;if(Math.abs(m)<s)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=m/b}var w=0,S=1;for(c=l,h=0;h<20&&(m=this.sampleCurveX(c),!(Math.abs(m-l)<s));h++)l>m?w=c:S=c,c=.5*(S-w)+w;return c},solve:function(l,s){return this.sampleCurveY(this.solveCurveX(l,s))}};var ka=Jo(ta),Sl=Rs;function Rs(l,s){this.x=l,this.y=s}Rs.prototype={clone:function(){return new Rs(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,s){return this.clone()._rotateAround(l,s)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var s=l.x-this.x,c=l.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,s){return Math.atan2(this.x*s-this.y*l,this.x*l+this.y*s)},_matMult:function(l){var s=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=s,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var s=Math.cos(l),c=Math.sin(l),h=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=h,this},_rotateAround:function(l,s){var c=Math.cos(l),h=Math.sin(l),m=s.y+h*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-h*(this.y-s.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Rs.convert=function(l){return l instanceof Rs?l:Array.isArray(l)?new Rs(l[0],l[1]):l};var pi=Jo(Sl);const Gc=Math.PI/180,jc=180/Math.PI;function er(l){return l*Gc}function ia(l){return l*jc}const mf=[[0,0],[1,0],[1,1],[0,1]];function hm(l){if(l<=0)return 0;if(l>=1)return 1;const s=l*l,c=s*l;return 4*(l<.5?c:3*(l-s)+c-.75)}function Sh(l,s,c,h){const m=new ka(l,s,c,h);return function(b){return m.solve(b)}}const yc=Sh(.25,.1,.25,1);function pr(l,s,c){return Math.min(c,Math.max(s,l))}function Th(l,s,c){return(c=pr((c-l)/(s-l),0,1))*c*(3-2*c)}function Cn(l,s,c){const h=c-s,m=((l-s)%h+h)%h+s;return m===s?c:m}function Bo(l,s,c){if(!l.length)return c(null,[]);let h=l.length;const m=new Array(l.length);let b=null;l.forEach((w,S)=>{s(w,(D,k)=>{D&&(b=D),m[S]=k,0==--h&&c(b,m)})})}function Nu(l){const s=[];for(const c in l)s.push(l[c]);return s}function Qo(l,...s){for(const c of s)for(const h in c)l[h]=c[h];return l}let xa=1;function Fi(){return xa++}function jd(){return function l(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()}function ws(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function fd(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)}function to(l,s){l.forEach(c=>{s[c]&&(s[c]=s[c].bind(s))})}function go(l,s){return-1!==l.indexOf(s,l.length-s.length)}function rr(l,s,c){const h={};for(const m in l)h[m]=s.call(c||this,l[m],m,l);return h}function vn(l,s,c){const h={};for(const m in l)s.call(c||this,l[m],m,l)&&(h[m]=l[m]);return h}function rl(l){return Array.isArray(l)?l.map(rl):"object"==typeof l&&l?rr(l,rl):l}const Bu={};function _o(l){Bu[l]||(typeof console<"u"&&console.warn(l),Bu[l]=!0)}function Kl(l,s,c){return(c.y-l.y)*(s.x-l.x)>(s.y-l.y)*(c.x-l.x)}function Tl(l){let s=0;for(let c,h,m=0,b=l.length,w=b-1;m<b;w=m++)c=l[m],h=l[w],s+=(h.x-c.x)*(c.y+h.y);return s}function Jl(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function vc(l){const s={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,h,m,b)=>{const w=m||b;return s[h]=!w||w.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s}let bc=null;function Ep(l){if(null==bc){const s=l.navigator?l.navigator.userAgent:null;bc=!!l.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return bc}function pm(l){try{const s=gt[l];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function xc(l,s){return[l[4*s],l[4*s+1],l[4*s+2],l[4*s+3]]}const wa="mapbox-tiles";let wc,Al,zu=500,Wd=50;function Cp(){try{return gt.caches}catch{}}function Wc(){Cp()&&!wc&&(wc=gt.caches.open(wa))}function $c(l){const s=l.indexOf("?");if(s<0)return l;const h=function(m){const b=m.indexOf("?");return b>0?m.slice(b+1).split("&"):[]}(l).filter(m=>{const b=m.split("=");return"language"===b[0]||"worldview"===b[0]});return h.length?`${l.slice(0,s)}?${h.join("&")}`:l.slice(0,s)}let Ah=1/0;const Ra={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Ra);class qc extends Error{constructor(s,c,h){401===c&&Ke(h)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=c,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const $d=Jl()?()=>self.worker&&self.worker.referrer:()=>("blob:"===gt.location.protocol?gt.parent:gt).location.href,md=function(l,s){if(!(/^file:/.test(c=l.url)||/^file:/.test($d())&&!/^\w+:/.test(c))){if(gt.fetch&&gt.Request&&gt.AbortController&&gt.Request.prototype.hasOwnProperty("signal"))return function(h,m){const b=new gt.AbortController,w=new gt.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:$d(),referrerPolicy:h.referrerPolicy,signal:b.signal});let S=!1,D=!1;const k=(N=w.url).indexOf("sku=")>0&&Ke(N);var N;"json"===h.type&&w.headers.set("Accept","application/json");const V=(q,Y,Q)=>{if(D)return;if(q&&"SecurityError"!==q.message&&_o(q.toString()),Y&&Q)return G(Y);const ae=Date.now();gt.fetch(w).then(ge=>{if(ge.ok){const De=k?ge.clone():null;return G(ge,De,ae)}return m(new qc(ge.statusText,ge.status,h.url))}).catch(ge=>{"AbortError"!==ge.name&&m(new Error(`${ge.message} ${h.url}`))})},G=(q,Y,Q)=>{("arrayBuffer"===h.type?q.arrayBuffer():"json"===h.type?q.json():q.text()).then(ae=>{D||(Y&&Q&&function(ge,De,_e){if(Wc(),!wc)return;const Ae={status:De.status,statusText:De.statusText,headers:new gt.Headers};De.headers.forEach((st,nt)=>Ae.headers.set(nt,st));const Ie=vc(De.headers.get("Cache-Control")||"");if(Ie["no-store"])return;Ie["max-age"]&&Ae.headers.set("Expires",new Date(_e+1e3*Ie["max-age"]).toUTCString());const Le=Ae.headers.get("Expires");Le&&(new Date(Le).getTime()-_e<42e4||function(st,nt){if(void 0===Al)try{new Response(new ReadableStream),Al=!0}catch{Al=!1}Al?nt(st.body):st.blob().then(nt)}(De,st=>{const nt=new gt.Response(st,Ae);Wc(),wc&&wc.then(Et=>Et.put($c(ge.url),nt)).catch(Et=>_o(Et.message))}))}(w,Y,Q),S=!0,m(null,ae,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(ae=>{D||m(new Error(ae.message))})};return k?function(q,Y){if(Wc(),!wc)return Y(null);const Q=$c(q.url);wc.then(ae=>{ae.match(Q).then(ge=>{const De=function(_e){if(!_e)return!1;const Ae=new Date(_e.headers.get("Expires")||0),Ie=vc(_e.headers.get("Cache-Control")||"");return Ae>Date.now()&&!Ie["no-cache"]}(ge);ae.delete(Q),De&&ae.put(Q,ge.clone()),Y(null,ge,De)}).catch(Y)}).catch(Y)}(w,V):V(null,null),{cancel:()=>{D=!0,S||b.abort()}}}(l,s);if(Jl()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,s,void 0,!0)}var c;return function(h,m){const b=new gt.XMLHttpRequest;b.open(h.method||"GET",h.url,!0),"arrayBuffer"===h.type&&(b.responseType="arraybuffer");for(const w in h.headers)b.setRequestHeader(w,h.headers[w]);return"json"===h.type&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials="include"===h.credentials,b.onerror=()=>{m(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||0===b.status)&&null!==b.response){let w=b.response;if("json"===h.type)try{w=JSON.parse(b.response)}catch(S){return m(S)}m(null,w,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else m(new qc(b.statusText,b.status,h.url))},b.send(h.body),{cancel:()=>b.abort()}}(l,s)},Uu=function(l,s){return md(Qo(l,{type:"arrayBuffer"}),s)};function Sp(l){const s=gt.document.createElement("a");return s.href=l,s.protocol===gt.document.location.protocol&&s.host===gt.document.location.host}const Te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ie,re;ie=[],re=0;const Me=function(l,s){if(jn.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),re>=Hn.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:l,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return ie.push(b),b}re++;let c=!1;const h=()=>{if(!c)for(c=!0,re--;ie.length&&re<Hn.MAX_PARALLEL_IMAGE_REQUESTS;){const b=ie.shift(),{requestParameters:w,callback:S,cancelled:D}=b;D||(b.cancel=Me(w,S).cancel)}},m=Uu(l,(b,w,S,D)=>{h(),b?s(b):w&&(gt.createImageBitmap?function(k,N){const V=new gt.Blob([new Uint8Array(k)],{type:"image/png"});gt.createImageBitmap(V).then(G=>{N(null,G)}).catch(G=>{N(new Error(`Could not load image because of ${G.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(w,(k,N)=>s(k,N,S,D)):function(k,N){const V=new gt.Image,G=gt.URL;V.onload=()=>{N(null,V),G.revokeObjectURL(V.src),V.onload=null,gt.requestAnimationFrame(()=>{V.src=Te})},V.onerror=()=>N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new gt.Blob([new Uint8Array(k)],{type:"image/png"});V.src=k.byteLength?G.createObjectURL(q):Te}(w,(k,N)=>s(k,N,S,D)))});return{cancel:()=>{m.cancel(),h()}}},Fe="NO_ACCESS_TOKEN";function He(l){return 0===l.indexOf("mapbox:")}function Ke(l){return Hn.API_URL_REGEX.test(l)}function Ze(l){return Hn.API_CDN_URL_REGEX.test(l)}function Ge(l){return Hn.API_STYLE_REGEX.test(l)&&!lt(l)}function lt(l){return Hn.API_SPRITE_REGEX.test(l)}const ri=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function fi(l){const s=l.match(ri);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function Kt(l){const s=l.params.length?`?${l.params.join("&")}`:"";return`${l.protocol}://${l.authority}${l.path}${s}`}const On="mapbox.eventData";function or(l){if(!l)return null;const s=l.split(".");if(!s||3!==s.length)return null;try{return JSON.parse(decodeURIComponent(gt.atob(s[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class An{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const c=or(Hn.ACCESS_TOKEN);let h="";return h=c&&c.u?gt.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(m,b)=>String.fromCharCode(+("0x"+b)))):Hn.ACCESS_TOKEN||"",s?`${On}.${s}:${h}`:`${On}:${h}`}fetchEventData(){const s=pm("localStorage"),c=this.getStorageKey(),h=this.getStorageKey("uuid");if(s)try{const m=gt.localStorage.getItem(c);m&&(this.eventData=JSON.parse(m));const b=gt.localStorage.getItem(h);b&&(this.anonId=b)}catch{_o("Unable to read from LocalStorage")}}saveEventData(){const s=pm("localStorage"),c=this.getStorageKey(),h=this.getStorageKey("uuid");if(s)try{gt.localStorage.setItem(h,this.anonId),Object.keys(this.eventData).length>=1&&gt.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{_o("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,c,h,m){if(!Hn.EVENTS_URL)return;const b=fi(Hn.EVENTS_URL);b.params.push(`access_token=${m||Hn.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(s).toISOString()},S=c?Qo(w,c):w,D={url:Kt(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};var N;this.pendingRequest=(N=k=>{this.pendingRequest=null,h(k),this.saveEventData(),this.processRequests(m)},md(Qo(D,{method:"POST"}),N))}queueRequest(s,c){this.queue.push(s),this.processRequests(c)}}const tr=new class extends An{constructor(l){super("appUserTurnstile"),this._customAccessToken=l}postTurnstileEvent(l,s){Hn.EVENTS_URL&&Hn.ACCESS_TOKEN&&Array.isArray(l)&&l.some(c=>He(c)||Ke(c))&&this.queueRequest(Date.now(),s)}processRequests(l){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=or(Hn.ACCESS_TOKEN),c=s?s.u:Hn.ACCESS_TOKEN;let h=c!==this.eventData.tokenU;fd(this.anonId)||(this.anonId=jd(),h=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),w=new Date(m),S=(m-this.eventData.lastSuccess)/864e5;h=h||S>=1||S<-1||b.getDate()!==w.getDate()}else h=!0;h?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:xs,skuId:Gd,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=m,this.eventData.tokenU=c)},l):this.processRequests()}},dr=tr.postTurnstileEvent.bind(tr),zo=new class extends An{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(l,s,c,h){this.skuToken=s,this.errorCb=h,Hn.EVENTS_URL&&(c||Hn.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},c):this.errorCb(new Error(Fe)))}processRequests(l){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),fd(this.anonId)||(this.anonId=jd()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:xs,skuId:Gd,skuToken:this.skuToken,userId:this.anonId},h=>{h?this.errorCb(h):s&&(this.success[s]=!0)},l))}},Tr=zo.postMapLoadEvent.bind(zo),Pa=new class extends An{constructor(){super("gljs.performance")}postPerformanceEvent(l,s){Hn.EVENTS_URL&&(l||Hn.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},l)}processRequests(l){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:s,performanceData:c}=this.queue.shift(),h=function(m){const b=gt.performance.getEntriesByType("resource"),w=gt.performance.getEntriesByType("mark"),S=function(G){const q={};if(G)for(const Y in G)if("other"!==Y)for(const Q of G[Y]){const ae=`${Y}ResolveRangeMin`,ge=`${Y}ResolveRangeMax`,De=`${Y}RequestCount`,_e=`${Y}RequestCachedCount`;q[ae]=Math.min(q[ae]||1/0,Q.startTime),q[ge]=Math.max(q[ge]||-1/0,Q.responseEnd);const Ae=Ie=>{void 0===q[Ie]&&(q[Ie]=0),++q[Ie]};void 0!==Q.transferSize&&0===Q.transferSize&&Ae(_e),Ae(De)}return q}(function(G,q){const Y={};if(G)for(const Q of G){const ae=q(Q);void 0===Y[ae]&&(Y[ae]=[]),Y[ae].push(Q)}return Y}(b,_d)),D=gt.devicePixelRatio,k=gt.navigator.connection||gt.navigator.mozConnection||gt.navigator.webkitConnection,N={counters:[],metadata:[],attributes:[]},V=(G,q,Y)=>{null!=Y&&G.push({name:q,value:Y.toString()})};for(const G in S)V(N.counters,G,S[G]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&(V(N.counters,"interactionRangeMin",m.interactionRange[0]),V(N.counters,"interactionRangeMax",m.interactionRange[1])),w)for(const G of Object.keys(Tp)){const q=Tp[G],Y=w.find(Q=>Q.name===q);Y&&V(N.counters,q,Y.startTime)}return V(N.counters,"visibilityHidden",m.visibilityHidden),V(N.attributes,"style",function(G){if(G)for(const q of G){const Y=q.name.split("?")[0];if(Ge(Y)){const Q=Y.split("/").slice(-2);if(2===Q.length)return`mapbox://styles/${Q[0]}/${Q[1]}`}}}(b)),V(N.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),V(N.attributes,"fogEnabled",m.fogEnabled?"true":"false"),V(N.attributes,"projection",m.projection),V(N.attributes,"zoom",m.zoom),V(N.metadata,"devicePixelRatio",D),V(N.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),V(N.metadata,"navigatorUserAgent",gt.navigator.userAgent),V(N.metadata,"screenWidth",gt.screen.width),V(N.metadata,"screenHeight",gt.screen.height),V(N.metadata,"windowWidth",gt.innerWidth),V(N.metadata,"windowHeight",gt.innerHeight),V(N.metadata,"mapWidth",m.width/D),V(N.metadata,"mapHeight",m.height/D),V(N.metadata,"webglRenderer",m.renderer),V(N.metadata,"webglVendor",m.vendor),V(N.metadata,"sdkVersion",xs),V(N.metadata,"sdkIdentifier","mapbox-gl-js"),N}(c);for(const m of h.metadata);for(const m of h.counters);for(const m of h.attributes);this.postEvent(s,h,()=>{},l)}},Ps=Pa.postPerformanceEvent.bind(Pa),gd=new class extends An{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(l,s,c,h){if(!Hn.API_URL||!Hn.SESSION_PATH)return;const m=fi(Hn.API_URL+Hn.SESSION_PATH);m.params.push(`sku=${s||""}`),m.params.push(`access_token=${h||Hn.ACCESS_TOKEN||""}`);const b={url:Kt(m),headers:{"Content-Type":"text/plain"}};var S;this.pendingRequest=(S=w=>{this.pendingRequest=null,c(w),this.saveEventData(),this.processRequests(h)},md(Qo(b,{method:"GET"}),S))}getSessionAPI(l,s,c,h){this.skuToken=s,this.errorCb=h,Hn.SESSION_PATH&&Hn.API_URL&&(c||Hn.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},c):this.errorCb(new Error(Fe)))}processRequests(l){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||this.getSession(c,this.skuToken,h=>{h?this.errorCb(h):s&&(this.success[s]=!0)},l)}},na=gd.getSessionAPI.bind(gd),La=new Set,Tp={create:"create",load:"load",fullLoad:"fullLoad"},q_={mark(l){gt.performance.mark(l)},measure(l,s,c){gt.performance.measure(l,s,c)}};function _d(l){const s=l.name.split("?")[0];return Ze(s)&&s.includes("mapbox-gl.js")?"javascript":Ze(s)&&s.includes("mapbox-gl.css")?"css":Hn.API_FONTS_REGEX.test(s)?"fontRange":lt(s)?"sprite":Ge(s)?"style":Hn.API_TILEJSON_REGEX.test(s)?"tilejson":"other"}const Gr=gt.performance;function Ms(l){const s=l?l.url.toString():void 0;return Gr.getEntriesByName(s)}let yd,Ql,xg,ec;const vd={now:()=>void 0!==xg?xg:gt.performance.now(),setNow(l){xg=l},restoreNow(){xg=void 0},frame(l){const s=gt.requestAnimationFrame(l);return{cancel:()=>gt.cancelAnimationFrame(s)}},getImageData(l,s=0){const{width:c,height:h}=l;ec||(ec=gt.document.createElement("canvas"));const m=ec.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(c>ec.width||h>ec.height)&&(ec.width=c,ec.height=h),m.clearRect(-s,-s,c+2*s,h+2*s),m.drawImage(l,0,0,c,h),m.getImageData(-s,-s,c+2*s,h+2*s)},resolveURL:l=>(yd||(yd=gt.document.createElement("a")),yd.href=l,yd.href),get devicePixelRatio(){return gt.devicePixelRatio},get prefersReducedMotion(){return!!gt.matchMedia&&(null==Ql&&(Ql=gt.matchMedia("(prefers-reduced-motion: reduce)")),Ql.matches)}};function Vu(l,s,c){c[l]&&-1!==c[l].indexOf(s)||(c[l]=c[l]||[],c[l].push(s))}function fm(l,s,c){if(c&&c[l]){const h=c[l].indexOf(s);-1!==h&&c[l].splice(h,1)}}class Xc{constructor(s,c={}){Qo(this,c),this.type=s}}class qd extends Xc{constructor(s,c={}){super("error",Qo({error:s},c))}}class Dh{on(s,c){return this._listeners=this._listeners||{},Vu(s,c,this._listeners),this}off(s,c){return fm(s,c,this._listeners),fm(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Vu(s,c,this._oneTimeListeners),this):new Promise(h=>this.once(s,h))}fire(s,c){"string"==typeof s&&(s=new Xc(s,c||{}));const h=s.type;if(this.listens(h)){s.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const S of m)S.call(this,s);const b=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const S of b)fm(h,S,this._oneTimeListeners),S.call(this,s);const w=this._eventedParent;w&&(Qo(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),w.fire(s))}else s instanceof qd&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}var yt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function bd(l,...s){for(const c of s)for(const h in c)l[h]=c[h];return l}function Es(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function ra(l){if(Array.isArray(l))return l.map(ra);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const s={};for(const c in l)s[c]=ra(l[c]);return s}return Es(l)}class X_ extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}var Zc=X_;class mm{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[h,m]of c)this.bindings[h]=m}concat(s){return new mm(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var wg=mm;const Zo={kind:"null"},oi={kind:"number"},Jt={kind:"string"},Wn={kind:"boolean"},oa={kind:"color"},Co={kind:"object"},Jn={kind:"value"},Dl={kind:"collator"},jr={kind:"formatted"},Mc={kind:"resolvedImage"};function yo(l,s){return{kind:"array",itemType:l,N:s}}function So(l){if("array"===l.kind){const s=So(l.itemType);return"number"==typeof l.N?`array<${s}, ${l.N}>`:"value"===l.itemType.kind?"array":`array<${s}>`}return l.kind}const gm=[Zo,oi,Jt,Wn,oa,jr,Co,yo(Jn),Mc];function ir(l,s){if("error"===s.kind)return null;if("array"===l.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!ir(l.itemType,s.itemType))&&("number"!=typeof l.N||l.N===s.N))return null}else{if(l.kind===s.kind)return null;if("value"===l.kind)for(const c of gm)if(!ir(c,s))return null}return`Expected ${So(l)} but found ${So(s)} instead.`}function _n(l,s){return s.some(c=>c.kind===l.kind)}function Hu(l,s){return s.some(c=>"null"===c?null===l:"array"===c?Array.isArray(l):"object"===c?l&&!Array.isArray(l)&&"object"==typeof l:c===typeof l)}var Ap,Pv={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ih(l){return(l=Math.round(l))<0?0:l>255?255:l}function Ct(l){return Ih("%"===l[l.length-1]?parseFloat(l)/100*255:parseInt(l))}function Gu(l){return(s="%"===l[l.length-1]?parseFloat(l)/100:parseFloat(l))<0?0:s>1?1:s;var s}function Dn(l,s,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?l+(s-l)*c*6:2*c<1?s:3*c<2?l+(s-l)*(2/3-c)*6:l}try{Ap={}.parseCSSColor=function(l){var s,c=l.replace(/ /g,"").toLowerCase();if(c in Pv)return Pv[c].slice();if("#"===c[0])return 4===c.length?(s=parseInt(c.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:7===c.length&&(s=parseInt(c.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var h=c.indexOf("("),m=c.indexOf(")");if(-1!==h&&m+1===c.length){var b=c.substr(0,h),w=c.substr(h+1,m-(h+1)).split(","),S=1;switch(b){case"rgba":if(4!==w.length)return null;S=Gu(w.pop());case"rgb":return 3!==w.length?null:[Ct(w[0]),Ct(w[1]),Ct(w[2]),S];case"hsla":if(4!==w.length)return null;S=Gu(w.pop());case"hsl":if(3!==w.length)return null;var D=(parseFloat(w[0])%360+360)%360/360,k=Gu(w[1]),N=Gu(w[2]),V=N<=.5?N*(k+1):N+k-N*k,G=2*N-V;return[Ih(255*Dn(G,V,D+1/3)),Ih(255*Dn(G,V,D)),Ih(255*Dn(G,V,D-1/3)),S];default:return null}}return null}}catch{}class ur{constructor(s,c,h,m=1){this.r=s,this.g=c,this.b=h,this.a=m}static parse(s){if(!s)return;if(s instanceof ur)return s;if("string"!=typeof s)return;const c=Ap(s);return c?new ur(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[s,c,h,m]=this.toArray();return`rgba(${Math.round(s)},${Math.round(c)},${Math.round(h)},${m})`}toArray(){const{r:s,g:c,b:h,a:m}=this;return 0===m?[0,0,0,0]:[255*s/m,255*c/m,255*h/m,m]}toArray01(){const{r:s,g:c,b:h,a:m}=this;return 0===m?[0,0,0,0]:[s/m,c/m,h/m,m]}toArray01PremultipliedAlpha(){const{r:s,g:c,b:h,a:m}=this;return[s,c,h,m]}}ur.black=new ur(0,0,0,1),ur.white=new ur(1,1,1,1),ur.transparent=new ur(0,0,0,0),ur.red=new ur(1,0,0,1),ur.blue=new ur(0,0,1,1);var fs=ur;class Z_{constructor(s,c,h){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class _m{constructor(s,c,h,m,b){this.text=s.normalize?s.normalize():s,this.image=c,this.scale=h,this.fontStack=m,this.textColor=b}}class Ma{constructor(s){this.sections=s}static fromString(s){return new Ma([new _m(s,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(s=>0!==s.text.length||s.image&&0!==s.image.name.length)}static factory(s){return s instanceof Ma?s:Ma.fromString(s)}toString(){return 0===this.sections.length?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const c of this.sections){if(c.image){s.push(["image",c.image.name]);continue}s.push(c.text);const h={};c.fontStack&&(h["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(h["font-scale"]=c.scale),c.textColor&&(h["text-color"]=["rgba"].concat(c.textColor.toArray())),s.push(h)}return s}}class es{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new es({name:s,available:!1}):null}serialize(){return["image",this.name]}}function Lv(l,s,c,h){return"number"==typeof l&&l>=0&&l<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===h||"number"==typeof h&&h>=0&&h<=1?null:`Invalid rgba value [${[l,s,c,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof h?[l,s,c,h]:[l,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function gf(l){if(null===l||"string"==typeof l||"boolean"==typeof l||"number"==typeof l||l instanceof fs||l instanceof Z_||l instanceof Ma||l instanceof es)return!0;if(Array.isArray(l)){for(const s of l)if(!gf(s))return!1;return!0}if("object"==typeof l){for(const s in l)if(!gf(l[s]))return!1;return!0}return!1}function ts(l){if(null===l)return Zo;if("string"==typeof l)return Jt;if("boolean"==typeof l)return Wn;if("number"==typeof l)return oi;if(l instanceof fs)return oa;if(l instanceof Z_)return Dl;if(l instanceof Ma)return jr;if(l instanceof es)return Mc;if(Array.isArray(l)){const s=l.length;let c;for(const h of l){const m=ts(h);if(c){if(c===m)continue;c=Jn;break}c=m}return yo(c||Jn,s)}return Co}function Ec(l){const s=typeof l;return null===l?"":"string"===s||"number"===s||"boolean"===s?String(l):l instanceof fs||l instanceof Ma||l instanceof es?l.toString():JSON.stringify(l)}class Y_{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(2!==s.length)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!gf(s[1]))return c.error("invalid value");const h=s[1];let m=ts(h);const b=c.expectedType;return"array"!==m.kind||0!==m.N||!b||"array"!==b.kind||"number"==typeof b.N&&0!==b.N||(m=b),new Y_(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof fs?["rgba"].concat(this.value.toArray()):this.value instanceof Ma?this.value.serialize():this.value}}var Dp=Y_,Fa=class{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}};const K_={string:Jt,number:oi,boolean:Wn,object:Co};class Oo{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let h,m=1;const b=s[0];if("array"===b){let S,D;if(s.length>2){const k=s[1];if("string"!=typeof k||!(k in K_)||"object"===k)return c.error('The item type argument of "array" must be one of string, number, boolean',1);S=K_[k],m++}else S=Jn;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);D=s[2],m++}h=yo(S,D)}else h=K_[b];const w=[];for(;m<s.length;m++){const S=c.parse(s[m],m,Jn);if(!S)return null;w.push(S)}return new Oo(h,w)}evaluate(s){for(let c=0;c<this.args.length;c++){const h=this.args[c].evaluate(s);if(!ir(this.type,ts(h)))return h;if(c===this.args.length-1)throw new Fa(`Expected value to be of type ${So(this.type)}, but found ${So(ts(h))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,c=[s.kind];if("array"===s.kind){const h=s.itemType;if("string"===h.kind||"number"===h.kind||"boolean"===h.kind){c.push(h.kind);const m=s.N;("number"==typeof m||this.args.length>1)&&c.push(m)}}return c.concat(this.args.map(h=>h.serialize()))}}var Kr=Oo;class ju{constructor(s){this.type=jr,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const h=s[1];if(!Array.isArray(h)&&"object"==typeof h)return c.error("First argument must be an image or text section.");const m=[];let b=!1;for(let w=1;w<=s.length-1;++w){const S=s[w];if(b&&"object"==typeof S&&!Array.isArray(S)){b=!1;let D=null;if(S["font-scale"]&&(D=c.parse(S["font-scale"],1,oi),!D))return null;let k=null;if(S["text-font"]&&(k=c.parse(S["text-font"],1,yo(Jt)),!k))return null;let N=null;if(S["text-color"]&&(N=c.parse(S["text-color"],1,oa),!N))return null;const V=m[m.length-1];V.scale=D,V.font=k,V.textColor=N}else{const D=c.parse(s[w],1,Jn);if(!D)return null;const k=D.type.kind;if("string"!==k&&"value"!==k&&"null"!==k&&"resolvedImage"!==k)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,m.push({content:D,scale:null,font:null,textColor:null})}}return new ju(m)}evaluate(s){return new Ma(this.sections.map(c=>{const h=c.content.evaluate(s);return ts(h)===Mc?new _m("",h,null,null,null):new _m(Ec(h),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const c of this.sections){s.push(c.content.serialize());const h={};c.scale&&(h["font-scale"]=c.scale.serialize()),c.font&&(h["text-font"]=c.font.serialize()),c.textColor&&(h["text-color"]=c.textColor.serialize()),s.push(h)}return s}}class Mg{constructor(s){this.type=Mc,this.input=s}static parse(s,c){if(2!==s.length)return c.error("Expected two arguments.");const h=c.parse(s[1],1,Jt);return h?new Mg(h):c.error("No image name provided.")}evaluate(s){const c=this.input.evaluate(s),h=es.fromString(c);return h&&s.availableImages&&(h.available=s.availableImages.indexOf(c)>-1),h}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Cc={"to-boolean":Wn,"to-color":oa,"to-number":oi,"to-string":Jt};class io{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const h=s[0];if(("to-boolean"===h||"to-string"===h)&&2!==s.length)return c.error("Expected one argument.");const m=Cc[h],b=[];for(let w=1;w<s.length;w++){const S=c.parse(s[w],w,Jn);if(!S)return null;b.push(S)}return new io(m,b)}evaluate(s){if("boolean"===this.type.kind)return!!this.args[0].evaluate(s);if("color"===this.type.kind){let c,h;for(const m of this.args){if(c=m.evaluate(s),h=null,c instanceof fs)return c;if("string"==typeof c){const b=s.parseColor(c);if(b)return b}else if(Array.isArray(c)&&(h=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Lv(c[0],c[1],c[2],c[3]),!h))return new fs(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new Fa(h||`Could not parse color from value '${"string"==typeof c?c:String(JSON.stringify(c))}'`)}if("number"===this.type.kind){let c=null;for(const h of this.args){if(c=h.evaluate(s),null===c)return 0;const m=Number(c);if(!isNaN(m))return m}throw new Fa(`Could not convert ${JSON.stringify(c)} to number.`)}return"formatted"===this.type.kind?Ma.fromString(Ec(this.args[0].evaluate(s))):"resolvedImage"===this.type.kind?es.fromString(Ec(this.args[0].evaluate(s))):Ec(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if("formatted"===this.type.kind)return new ju([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Mg(this.args[0]).serialize();const s=[`to-${this.type.kind}`];return this.eachChild(c=>{s.push(c.serialize())}),s}}var _f=io;const Xd=["Unknown","Point","LineString","Polygon"];var Eg=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Xd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const l=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-l[0])+this.featureDistanceData.bearing[1]*(h*s-l[1])}return 0}parseColor(l){let s=this._parseColorCache[l];return s||(s=this._parseColorCache[l]=fs.parse(l)),s}};class Qt{constructor(s,c,h,m){this.name=s,this.type=c,this._evaluate=h,this.args=m}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,c){const h=s[0],m=Qt.definitions[h];if(!m)return c.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(m)?m[0]:m.type,w=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,S=w.filter(([k])=>!Array.isArray(k)||k.length===s.length-1);let D=null;for(const[k,N]of S){D=new Cg(c.registry,c.path,null,c.scope);const V=[];let G=!1;for(let q=1;q<s.length;q++){const Y=s[q],Q=Array.isArray(k)?k[q-1]:k.type,ae=D.parse(Y,1+V.length,Q);if(!ae){G=!0;break}V.push(ae)}if(!G)if(Array.isArray(k)&&k.length!==V.length)D.error(`Expected ${k.length} arguments, but found ${V.length} instead.`);else{for(let q=0;q<V.length;q++){const Y=Array.isArray(k)?k[q]:k.type,Q=V[q];D.concat(q+1).checkSubtype(Y,Q.type)}if(0===D.errors.length)return new Qt(h,b,N,V)}}if(1===S.length)c.errors.push(...D.errors);else{const k=(S.length?S:w).map(([V])=>{return G=V,Array.isArray(G)?`(${G.map(So).join(", ")})`:`(${So(G.type)}...)`;var G}).join(" | "),N=[];for(let V=1;V<s.length;V++){const G=c.parse(s[V],1+N.length);if(!G)return null;N.push(So(G.type))}c.error(`Expected arguments of type ${k}, but found (${N.join(", ")}) instead.`)}return null}static register(s,c){Qt.definitions=c;for(const h in c)s[h]=Qt}}var is=Qt;class Rn{constructor(s,c,h){this.type=Dl,this.locale=h,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(2!==s.length)return c.error("Expected one argument.");const h=s[1];if("object"!=typeof h||Array.isArray(h))return c.error("Collator options argument must be an object.");const m=c.parse(void 0!==h["case-sensitive"]&&h["case-sensitive"],1,Wn);if(!m)return null;const b=c.parse(void 0!==h["diacritic-sensitive"]&&h["diacritic-sensitive"],1,Wn);if(!b)return null;let w=null;return h.locale&&(w=c.parse(h.locale,1,Jt),!w)?null:new Rn(m,b,w)}evaluate(s){return new Z_(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}const Oa=8192;function yf(l,s){l[0]=Math.min(l[0],s[0]),l[1]=Math.min(l[1],s[1]),l[2]=Math.max(l[2],s[0]),l[3]=Math.max(l[3],s[1])}function Zd(l,s){return!(l[0]<=s[0]||l[2]>=s[2]||l[1]<=s[1]||l[3]>=s[3])}function Na(l,s){const c=(180+l[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(c*m*Oa),Math.round(h*m*Oa)]}function ym(l,s,c){const h=l[0]-s[0],m=l[1]-s[1],b=l[0]-c[0],w=l[1]-c[1];return h*w-b*m==0&&h*b<=0&&m*w<=0}function Wu(l,s){let c=!1;for(let w=0,S=s.length;w<S;w++){const D=s[w];for(let k=0,N=D.length;k<N-1;k++){if(ym(l,D[k],D[k+1]))return!1;(m=D[k])[1]>(h=l)[1]!=(b=D[k+1])[1]>h[1]&&h[0]<(b[0]-m[0])*(h[1]-m[1])/(b[1]-m[1])+m[0]&&(c=!c)}}var h,m,b;return c}function Ip(l,s){for(let c=0;c<s.length;c++)if(Wu(l,s[c]))return!0;return!1}function vf(l,s,c,h){const m=h[0]-c[0],b=h[1]-c[1],w=(l[0]-c[0])*b-m*(l[1]-c[1]),S=(s[0]-c[0])*b-m*(s[1]-c[1]);return w>0&&S<0||w<0&&S>0}function kh(l,s,c){for(const k of c)for(let N=0;N<k.length-1;++N)if((S=[(w=k[N+1])[0]-(b=k[N])[0],w[1]-b[1]])[0]*(D=[(m=s)[0]-(h=l)[0],m[1]-h[1]])[1]-S[1]*D[0]!=0&&vf(h,m,b,w)&&vf(b,w,h,m))return!0;var h,m,b,w,S,D;return!1}function xi(l,s){for(let c=0;c<l.length;++c)if(!Wu(l[c],s))return!1;for(let c=0;c<l.length-1;++c)if(kh(l[c],l[c+1],s))return!1;return!0}function ol(l,s){for(let c=0;c<s.length;c++)if(xi(l,s[c]))return!0;return!1}function vm(l,s,c){const h=[];for(let m=0;m<l.length;m++){const b=[];for(let w=0;w<l[m].length;w++){const S=Na(l[m][w],c);yf(s,S),b.push(S)}h.push(b)}return h}function Uo(l,s,c){const h=[];for(let m=0;m<l.length;m++){const b=vm(l[m],s,c);h.push(b)}return h}function bm(l,s,c,h){if(l[0]<c[0]||l[0]>c[2]){const m=.5*h;let b=l[0]-c[0]>m?-h:c[0]-l[0]>m?h:0;0===b&&(b=l[0]-c[2]>m?-h:c[2]-l[0]>m?h:0),l[0]+=b}yf(s,l)}function J_(l,s,c,h){const m=Math.pow(2,h.z)*Oa,b=[h.x*Oa,h.y*Oa],w=[];if(!l)return w;for(const S of l)for(const D of S){const k=[D.x+b[0],D.y+b[1]];bm(k,s,c,m),w.push(k)}return w}function Nr(l,s,c,h){const m=Math.pow(2,h.z)*Oa,b=[h.x*Oa,h.y*Oa],w=[];if(!l)return w;for(const D of l){const k=[];for(const N of D){const V=[N.x+b[0],N.y+b[1]];yf(s,V),k.push(V)}w.push(k)}if(s[2]-s[0]<=m/2){(S=s)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const D of w)for(const k of D)bm(k,s,c,m)}var S;return w}class $u{constructor(s,c){this.type=Wn,this.geojson=s,this.geometries=c}static parse(s,c){if(2!==s.length)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(gf(s[1])){const h=s[1];if("FeatureCollection"===h.type)for(let m=0;m<h.features.length;++m){const b=h.features[m].geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new $u(h,h.features[m].geometry)}else if("Feature"===h.type){const m=h.geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new $u(h,h.geometry)}else if("Polygon"===h.type||"MultiPolygon"===h.type)return new $u(h,h)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(c,h){const m=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if(!w)return!1;if("Polygon"===h.type){const S=vm(h.coordinates,b,w),D=J_(c.geometry(),m,b,w);if(!Zd(m,b))return!1;for(const k of D)if(!Wu(k,S))return!1}if("MultiPolygon"===h.type){const S=Uo(h.coordinates,b,w),D=J_(c.geometry(),m,b,w);if(!Zd(m,b))return!1;for(const k of D)if(!Ip(k,S))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(c,h){const m=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if(!w)return!1;if("Polygon"===h.type){const S=vm(h.coordinates,b,w),D=Nr(c.geometry(),m,b,w);if(!Zd(m,b))return!1;for(const k of D)if(!xi(k,S))return!1}if("MultiPolygon"===h.type){const S=Uo(h.coordinates,b,w),D=Nr(c.geometry(),m,b,w);if(!Zd(m,b))return!1;for(const k of D)if(!ol(k,S))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var bf=$u;function Ro(l){if(l instanceof is&&("get"===l.name&&1===l.args.length||"feature-state"===l.name||"has"===l.name&&1===l.args.length||"properties"===l.name||"geometry-type"===l.name||"id"===l.name||/^filter-/.test(l.name))||l instanceof bf)return!1;let s=!0;return l.eachChild(c=>{s&&!Ro(c)&&(s=!1)}),s}function Ls(l){if(l instanceof is&&"feature-state"===l.name)return!1;let s=!0;return l.eachChild(c=>{s&&!Ls(c)&&(s=!1)}),s}function Yc(l,s){if(l instanceof is&&s.indexOf(l.name)>=0)return!1;let c=!0;return l.eachChild(h=>{c&&!Yc(h,s)&&(c=!1)}),c}class Rh{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(2!==s.length||"string"!=typeof s[1])return c.error("'var' expression requires exactly one string literal argument.");const h=s[1];return c.scope.has(h)?new Rh(h,c.scope.get(h)):c.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var xm=Rh;class xf{constructor(s,c=[],h,m=new wg,b=[]){this.registry=s,this.path=c,this.key=c.map(w=>`[${w}]`).join(""),this.scope=m,this.errors=b,this.expectedType=h}parse(s,c,h,m,b={}){return c?this.concat(c,h,m)._parse(s,b):this._parse(s,b)}_parse(s,c){function h(m,b,w){return"assert"===w?new Kr(b,[m]):"coerce"===w?new _f(b,[m]):m}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=s[0];if("string"!=typeof m)return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[m];if(b){let w=b.parse(s,this);if(!w)return null;if(this.expectedType){const S=this.expectedType,D=w.type;if("string"!==S.kind&&"number"!==S.kind&&"boolean"!==S.kind&&"object"!==S.kind&&"array"!==S.kind||"value"!==D.kind)if("color"!==S.kind&&"formatted"!==S.kind&&"resolvedImage"!==S.kind||"value"!==D.kind&&"string"!==D.kind){if(this.checkSubtype(S,D))return null}else w=h(w,S,c.typeAnnotation||"coerce");else w=h(w,S,c.typeAnnotation||"assert")}if(!(w instanceof Dp)&&"resolvedImage"!==w.type.kind&&wm(w)){const S=new Eg;try{w=new Dp(w.type,w.evaluate(S))}catch(D){return this.error(D.message),null}}return w}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,h){const m="number"==typeof s?this.path.concat(s):this.path,b=h?this.scope.concat(h):this.scope;return new xf(this.registry,m,c||null,b,this.errors)}error(s,...c){const h=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new Zc(h,s))}checkSubtype(s,c){const h=ir(s,c);return h&&this.error(h),h}}var Cg=xf;function wm(l){if(l instanceof xm)return wm(l.boundExpression);if(l instanceof is&&"error"===l.name||l instanceof Rn||l instanceof bf)return!1;const s=l instanceof _f||l instanceof Kr;let c=!0;return l.eachChild(h=>{c=s?c&&wm(h):c&&h instanceof Dp}),!!c&&Ro(l)&&Yc(l,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function xd(l,s){const c=l.length-1;let h,m,b=0,w=c,S=0;for(;b<=w;)if(S=Math.floor((b+w)/2),h=l[S],m=l[S+1],h<=s){if(S===c||s<m)return S;b=S+1}else{if(!(h>s))throw new Fa("Input is not a number.");w=S-1}return 0}class Ph{constructor(s,c,h){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[m,b]of h)this.labels.push(m),this.outputs.push(b)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const h=c.parse(s[1],1,oi);if(!h)return null;const m=[];let b=null;c.expectedType&&"value"!==c.expectedType.kind&&(b=c.expectedType);for(let w=1;w<s.length;w+=2){const S=1===w?-1/0:s[w],D=s[w+1],k=w,N=w+1;if("number"!=typeof S)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(m.length&&m[m.length-1][0]>=S)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const V=c.parse(D,N,b);if(!V)return null;b=b||V.type,m.push([S,V])}return new Ph(b,h,m)}evaluate(s){const c=this.labels,h=this.outputs;if(1===c.length)return h[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return h[0].evaluate(s);const b=c.length;return m>=c[b-1]?h[b-1].evaluate(s):h[xd(c,m)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&s.push(this.labels[c]),s.push(this.outputs[c].serialize());return s}}var sl=Ph;function Mr(l,s,c){return l*(1-c)+s*c}var it=Object.freeze({__proto__:null,array:function(l,s,c){return l.map((h,m)=>Mr(h,s[m],c))},color:function(l,s,c){return new fs(Mr(l.r,s.r,c),Mr(l.g,s.g,c),Mr(l.b,s.b,c),Mr(l.a,s.a,c))},number:Mr});const Lh=4/29,wd=6/29,Fh=3*wd*wd,Sg=wd*wd*wd,Tg=Math.PI/180,Fv=180/Math.PI;function Sc(l){return l>Sg?Math.pow(l,1/3):l/Fh+Lh}function ns(l){return l>wd?l*l*l:Fh*(l-Lh)}function sa(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Ea(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Wr(l){const s=Ea(l.r),c=Ea(l.g),h=Ea(l.b),m=Sc((.4124564*s+.3575761*c+.1804375*h)/.95047),b=Sc((.2126729*s+.7151522*c+.072175*h)/1);return{l:116*b-16,a:500*(m-b),b:200*(b-Sc((.0193339*s+.119192*c+.9503041*h)/1.08883)),alpha:l.a}}function kp(l){let s=(l.l+16)/116,c=isNaN(l.a)?s:s+l.a/500,h=isNaN(l.b)?s:s-l.b/200;return s=1*ns(s),c=.95047*ns(c),h=1.08883*ns(h),new fs(sa(3.2404542*c-1.5371385*s-.4985314*h),sa(-.969266*c+1.8760108*s+.041556*h),sa(.0556434*c-.2040259*s+1.0572252*h),l.alpha)}function Ag(l,s,c){const h=s-l;return l+c*(h>180||h<-180?h-360*Math.round(h/360):h)}const Oh={forward:Wr,reverse:kp,interpolate:function(l,s,c){return{l:Mr(l.l,s.l,c),a:Mr(l.a,s.a,c),b:Mr(l.b,s.b,c),alpha:Mr(l.alpha,s.alpha,c)}}},Nh={forward:function(l){const{l:s,a:c,b:h}=Wr(l),m=Math.atan2(h,c)*Fv;return{h:m<0?m+360:m,c:Math.sqrt(c*c+h*h),l:s,alpha:l.a}},reverse:function(l){const s=l.h*Tg,c=l.c;return kp({l:l.l,a:Math.cos(s)*c,b:Math.sin(s)*c,alpha:l.alpha})},interpolate:function(l,s,c){return{h:Ag(l.h,s.h,c),c:Mr(l.c,s.c,c),l:Mr(l.l,s.l,c),alpha:Mr(l.alpha,s.alpha,c)}}};var Kc=Object.freeze({__proto__:null,hcl:Nh,lab:Oh});class Yd{constructor(s,c,h,m,b){this.type=s,this.operator=c,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[w,S]of b)this.labels.push(w),this.outputs.push(S)}static interpolationFactor(s,c,h,m){let b=0;if("exponential"===s.name)b=Kd(c,s.base,h,m);else if("linear"===s.name)b=Kd(c,1,h,m);else if("cubic-bezier"===s.name){const w=s.controlPoints;b=new ka(w[0],w[1],w[2],w[3]).solve(Kd(c,1,h,m))}return b}static parse(s,c){let[h,m,b,...w]=s;if(!Array.isArray(m)||0===m.length)return c.error("Expected an interpolation type expression.",1);if("linear"===m[0])m={name:"linear"};else if("exponential"===m[0]){const k=m[1];if("number"!=typeof k)return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:k}}else{if("cubic-bezier"!==m[0])return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const k=m.slice(1);if(4!==k.length||k.some(N=>"number"!=typeof N||N<0||N>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:k}}}if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(b=c.parse(b,2,oi),!b)return null;const S=[];let D=null;"interpolate-hcl"===h||"interpolate-lab"===h?D=oa:c.expectedType&&"value"!==c.expectedType.kind&&(D=c.expectedType);for(let k=0;k<w.length;k+=2){const N=w[k],V=w[k+1],G=k+3,q=k+4;if("number"!=typeof N)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(S.length&&S[S.length-1][0]>=N)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const Y=c.parse(V,q,D);if(!Y)return null;D=D||Y.type,S.push([N,Y])}return"number"===D.kind||"color"===D.kind||"array"===D.kind&&"number"===D.itemType.kind&&"number"==typeof D.N?new Yd(D,h,m,b,S):c.error(`Type ${So(D)} is not interpolatable.`)}evaluate(s){const c=this.labels,h=this.outputs;if(1===c.length)return h[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return h[0].evaluate(s);const b=c.length;if(m>=c[b-1])return h[b-1].evaluate(s);const w=xd(c,m),S=Yd.interpolationFactor(this.interpolation,m,c[w],c[w+1]),D=h[w].evaluate(s),k=h[w+1].evaluate(s);return"interpolate"===this.operator?it[this.type.kind.toLowerCase()](D,k,S):"interpolate-hcl"===this.operator?Nh.reverse(Nh.interpolate(Nh.forward(D),Nh.forward(k),S)):Oh.reverse(Oh.interpolate(Oh.forward(D),Oh.forward(k),S))}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,s,this.input.serialize()];for(let h=0;h<this.labels.length;h++)c.push(this.labels[h],this.outputs[h].serialize());return c}}function Kd(l,s,c,h){const m=h-c,b=l-c;return 0===m?0:1===s?b/m:(Math.pow(s,b)-1)/(Math.pow(s,m)-1)}var Jc=Yd;class Rp{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let h=null;const m=c.expectedType;m&&"value"!==m.kind&&(h=m);const b=[];for(const S of s.slice(1)){const D=c.parse(S,1+b.length,h,void 0,{typeAnnotation:"omit"});if(!D)return null;h=h||D.type,b.push(D)}const w=m&&b.some(S=>ir(m,S.type));return new Rp(w?Jn:h,b)}evaluate(s){let c,h=null,m=0;for(const b of this.args){if(m++,h=b.evaluate(s),h&&h instanceof es&&!h.available&&(c||(c=h),h=null,m===this.args.length))return c;if(null!==h)break}return h}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var Pp=Rp;class Lp{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const h=[];for(let b=1;b<s.length-1;b+=2){const w=s[b];if("string"!=typeof w)return c.error(`Expected string, but found ${typeof w} instead.`,b);if(/[^a-zA-Z0-9_]/.test(w))return c.error("Variable names must contain only alphanumeric characters or '_'.",b);const S=c.parse(s[b+1],b+1);if(!S)return null;h.push([w,S])}const m=c.parse(s[s.length-1],s.length-1,c.expectedType,h);return m?new Lp(h,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[c,h]of this.bindings)s.push(c,h.serialize());return s.push(this.result.serialize()),s}}var tc=Lp;class Bh{constructor(s,c,h){this.type=s,this.index=c,this.input=h}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const h=c.parse(s[1],1,oi),m=c.parse(s[2],2,yo(c.expectedType||Jn));return h&&m?new Bh(m.type.itemType,h,m):null}evaluate(s){const c=this.index.evaluate(s),h=this.input.evaluate(s);if(c<0)throw new Fa(`Array index out of bounds: ${c} < 0.`);if(c>=h.length)throw new Fa(`Array index out of bounds: ${c} > ${h.length-1}.`);if(c!==Math.floor(c))throw new Fa(`Array index must be an integer, but found ${c} instead.`);return h[c]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Q_=Bh;class Dg{constructor(s,c){this.type=Wn,this.needle=s,this.haystack=c}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const h=c.parse(s[1],1,Jn),m=c.parse(s[2],2,Jn);return h&&m?_n(h.type,[Wn,Jt,oi,Zo,Jn])?new Dg(h,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${So(h.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),h=this.haystack.evaluate(s);if(null==h)return!1;if(!Hu(c,["boolean","string","number","null"]))throw new Fa(`Expected first argument to be of type boolean, string, number or null, but found ${So(ts(c))} instead.`);if(!Hu(h,["string","array"]))throw new Fa(`Expected second argument to be of type array or string, but found ${So(ts(h))} instead.`);return h.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var wf=Dg;class Md{constructor(s,c,h){this.type=oi,this.needle=s,this.haystack=c,this.fromIndex=h}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const h=c.parse(s[1],1,Jn),m=c.parse(s[2],2,Jn);if(!h||!m)return null;if(!_n(h.type,[Wn,Jt,oi,Zo,Jn]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${So(h.type)} instead`);if(4===s.length){const b=c.parse(s[3],3,oi);return b?new Md(h,m,b):null}return new Md(h,m)}evaluate(s){const c=this.needle.evaluate(s),h=this.haystack.evaluate(s);if(!Hu(c,["boolean","string","number","null"]))throw new Fa(`Expected first argument to be of type boolean, string, number or null, but found ${So(ts(c))} instead.`);if(!Hu(h,["string","array"]))throw new Fa(`Expected second argument to be of type array or string, but found ${So(ts(h))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(s);return h.indexOf(c,m)}return h.indexOf(c)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Tc=Md;class Il{constructor(s,c,h,m,b,w){this.inputType=s,this.type=c,this.input=h,this.cases=m,this.outputs=b,this.otherwise=w}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let h,m;c.expectedType&&"value"!==c.expectedType.kind&&(m=c.expectedType);const b={},w=[];for(let k=2;k<s.length-1;k+=2){let N=s[k];const V=s[k+1];Array.isArray(N)||(N=[N]);const G=c.concat(k);if(0===N.length)return G.error("Expected at least one branch label.");for(const Y of N){if("number"!=typeof Y&&"string"!=typeof Y)return G.error("Branch labels must be numbers or strings.");if("number"==typeof Y&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Y&&Math.floor(Y)!==Y)return G.error("Numeric branch labels must be integer values.");if(h){if(G.checkSubtype(h,ts(Y)))return null}else h=ts(Y);if(void 0!==b[String(Y)])return G.error("Branch labels must be unique.");b[String(Y)]=w.length}const q=c.parse(V,k,m);if(!q)return null;m=m||q.type,w.push(q)}const S=c.parse(s[1],1,Jn);if(!S)return null;const D=c.parse(s[s.length-1],s.length-1,m);return D?"value"!==S.type.kind&&c.concat(1).checkSubtype(h,S.type)?null:new Il(h,m,S,b,w,D):null}evaluate(s){const c=this.input.evaluate(s);return(ts(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),h=[],m={};for(const w of c){const S=m[this.cases[w]];void 0===S?(m[this.cases[w]]=h.length,h.push([this.cases[w],[w]])):h[S][1].push(w)}const b=w=>"number"===this.inputType.kind?Number(w):w;for(const[w,S]of h)s.push(1===S.length?b(S[0]):S.map(b)),s.push(this.outputs[w].serialize());return s.push(this.otherwise.serialize()),s}}var Ov=Il;class Em{constructor(s,c,h){this.type=s,this.branches=c,this.otherwise=h}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let h;c.expectedType&&"value"!==c.expectedType.kind&&(h=c.expectedType);const m=[];for(let w=1;w<s.length-1;w+=2){const S=c.parse(s[w],w,Wn);if(!S)return null;const D=c.parse(s[w+1],w+1,h);if(!D)return null;m.push([S,D]),h=h||D.type}const b=c.parse(s[s.length-1],s.length-1,h);return b?new Em(h,m,b):null}evaluate(s){for(const[c,h]of this.branches)if(c.evaluate(s))return h.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,h]of this.branches)s(c),s(h);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var ey=Em;class Mf{constructor(s,c,h,m){this.type=s,this.input=c,this.beginIndex=h,this.endIndex=m}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const h=c.parse(s[1],1,Jn),m=c.parse(s[2],2,oi);if(!h||!m)return null;if(!_n(h.type,[yo(Jn),Jt,Jn]))return c.error(`Expected first argument to be of type array or string, but found ${So(h.type)} instead`);if(4===s.length){const b=c.parse(s[3],3,oi);return b?new Mf(h.type,h,m,b):null}return new Mf(h.type,h,m)}evaluate(s){const c=this.input.evaluate(s),h=this.beginIndex.evaluate(s);if(!Hu(c,["string","array"]))throw new Fa(`Expected first argument to be of type array or string, but found ${So(ts(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(s);return c.slice(h,m)}return c.slice(h)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var ty=Mf;function zh(l,s){return"=="===l||"!="===l?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function Xe(l,s,c,h){return 0===h.compare(s,c)}function kt(l,s,c){const h="=="!==l&&"!="!==l;return class OG{constructor(b,w,S){this.type=Wn,this.lhs=b,this.rhs=w,this.collator=S,this.hasUntypedArgument="value"===b.type.kind||"value"===w.type.kind}static parse(b,w){if(3!==b.length&&4!==b.length)return w.error("Expected two or three arguments.");const S=b[0];let D=w.parse(b[1],1,Jn);if(!D)return null;if(!zh(S,D.type))return w.concat(1).error(`"${S}" comparisons are not supported for type '${So(D.type)}'.`);let k=w.parse(b[2],2,Jn);if(!k)return null;if(!zh(S,k.type))return w.concat(2).error(`"${S}" comparisons are not supported for type '${So(k.type)}'.`);if(D.type.kind!==k.type.kind&&"value"!==D.type.kind&&"value"!==k.type.kind)return w.error(`Cannot compare types '${So(D.type)}' and '${So(k.type)}'.`);h&&("value"===D.type.kind&&"value"!==k.type.kind?D=new Kr(k.type,[D]):"value"!==D.type.kind&&"value"===k.type.kind&&(k=new Kr(D.type,[k])));let N=null;if(4===b.length){if("string"!==D.type.kind&&"string"!==k.type.kind&&"value"!==D.type.kind&&"value"!==k.type.kind)return w.error("Cannot use collator to compare non-string types.");if(N=w.parse(b[3],3,Dl),!N)return null}return new OG(D,k,N)}evaluate(b){const w=this.lhs.evaluate(b),S=this.rhs.evaluate(b);if(h&&this.hasUntypedArgument){const D=ts(w),k=ts(S);if(D.kind!==k.kind||"string"!==D.kind&&"number"!==D.kind)throw new Fa(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${D.kind}, ${k.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const D=ts(w),k=ts(S);if("string"!==D.kind||"string"!==k.kind)return s(b,w,S)}return this.collator?c(b,w,S,this.collator.evaluate(b)):s(b,w,S)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[l];return this.eachChild(w=>{b.push(w.serialize())}),b}}}const wt=kt("==",function(l,s,c){return s===c},Xe),Gi=kt("!=",function(l,s,c){return s!==c},function(l,s,c,h){return!Xe(0,s,c,h)}),ui=kt("<",function(l,s,c){return s<c},function(l,s,c,h){return h.compare(s,c)<0}),so=kt(">",function(l,s,c){return s>c},function(l,s,c,h){return h.compare(s,c)>0}),js=kt("<=",function(l,s,c){return s<=c},function(l,s,c,h){return h.compare(s,c)<=0}),Po=kt(">=",function(l,s,c){return s>=c},function(l,s,c,h){return h.compare(s,c)>=0});class Nn{constructor(s,c,h,m,b,w){this.type=Jt,this.number=s,this.locale=c,this.currency=h,this.unit=m,this.minFractionDigits=b,this.maxFractionDigits=w}static parse(s,c){if(3!==s.length)return c.error("Expected two arguments.");const h=c.parse(s[1],1,oi);if(!h)return null;const m=s[2];if("object"!=typeof m||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let b=null;if(m.locale&&(b=c.parse(m.locale,1,Jt),!b))return null;let w=null;if(m.currency&&(w=c.parse(m.currency,1,Jt),!w))return null;let S=null;if(m.unit&&(S=c.parse(m.unit,1,Jt),!S))return null;let D=null;if(m["min-fraction-digits"]&&(D=c.parse(m["min-fraction-digits"],1,oi),!D))return null;let k=null;return m["max-fraction-digits"]&&(k=c.parse(m["max-fraction-digits"],1,oi),!k)?null:new Nn(h,b,w,S,D,k)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class Fp{constructor(s){this.type=oi,this.input=s}static parse(s,c){if(2!==s.length)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const h=c.parse(s[1],1);return h?"array"!==h.type.kind&&"string"!==h.type.kind&&"value"!==h.type.kind?c.error(`Expected argument of type string or array, but found ${So(h.type)} instead.`):new Fp(h):null}evaluate(s){const c=this.input.evaluate(s);if("string"==typeof c||Array.isArray(c))return c.length;throw new Fa(`Expected value to be of type string or array, but found ${So(ts(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(c=>{s.push(c.serialize())}),s}}const kl={"==":wt,"!=":Gi,">":so,"<":ui,">=":Po,"<=":js,array:Kr,at:Q_,boolean:Kr,case:ey,coalesce:Pp,collator:Rn,format:ju,image:Mg,in:wf,"index-of":Tc,interpolate:Jc,"interpolate-hcl":Jc,"interpolate-lab":Jc,length:Fp,let:tc,literal:Dp,match:Ov,number:Kr,"number-format":Nn,object:Kr,slice:ty,step:sl,string:Kr,"to-boolean":_f,"to-color":_f,"to-number":_f,"to-string":_f,var:xm,within:bf};function si(l,[s,c,h,m]){s=s.evaluate(l),c=c.evaluate(l),h=h.evaluate(l);const b=m?m.evaluate(l):1,w=Lv(s,c,h,b);if(w)throw new Fa(w);return new fs(s/255*b,c/255*b,h/255*b,b)}function as(l,s){return l in s}function vr(l,s){const c=s[l];return void 0===c?null:c}function vo(l){return{type:l}}is.register(kl,{error:[{kind:"error"},[Jt],(l,[s])=>{throw new Fa(s.evaluate(l))}],typeof:[Jt,[Jn],(l,[s])=>So(ts(s.evaluate(l)))],"to-rgba":[yo(oi,4),[oa],(l,[s])=>s.evaluate(l).toArray()],rgb:[oa,[oi,oi,oi],si],rgba:[oa,[oi,oi,oi,oi],si],has:{type:Wn,overloads:[[[Jt],(l,[s])=>as(s.evaluate(l),l.properties())],[[Jt,Co],(l,[s,c])=>as(s.evaluate(l),c.evaluate(l))]]},get:{type:Jn,overloads:[[[Jt],(l,[s])=>vr(s.evaluate(l),l.properties())],[[Jt,Co],(l,[s,c])=>vr(s.evaluate(l),c.evaluate(l))]]},"feature-state":[Jn,[Jt],(l,[s])=>vr(s.evaluate(l),l.featureState||{})],properties:[Co,[],l=>l.properties()],"geometry-type":[Jt,[],l=>l.geometryType()],id:[Jn,[],l=>l.id()],zoom:[oi,[],l=>l.globals.zoom],pitch:[oi,[],l=>l.globals.pitch||0],"distance-from-center":[oi,[],l=>l.distanceFromCenter()],"heatmap-density":[oi,[],l=>l.globals.heatmapDensity||0],"line-progress":[oi,[],l=>l.globals.lineProgress||0],"sky-radial-progress":[oi,[],l=>l.globals.skyRadialProgress||0],accumulated:[Jn,[],l=>void 0===l.globals.accumulated?null:l.globals.accumulated],"+":[oi,vo(oi),(l,s)=>{let c=0;for(const h of s)c+=h.evaluate(l);return c}],"*":[oi,vo(oi),(l,s)=>{let c=1;for(const h of s)c*=h.evaluate(l);return c}],"-":{type:oi,overloads:[[[oi,oi],(l,[s,c])=>s.evaluate(l)-c.evaluate(l)],[[oi],(l,[s])=>-s.evaluate(l)]]},"/":[oi,[oi,oi],(l,[s,c])=>s.evaluate(l)/c.evaluate(l)],"%":[oi,[oi,oi],(l,[s,c])=>s.evaluate(l)%c.evaluate(l)],ln2:[oi,[],()=>Math.LN2],pi:[oi,[],()=>Math.PI],e:[oi,[],()=>Math.E],"^":[oi,[oi,oi],(l,[s,c])=>Math.pow(s.evaluate(l),c.evaluate(l))],sqrt:[oi,[oi],(l,[s])=>Math.sqrt(s.evaluate(l))],log10:[oi,[oi],(l,[s])=>Math.log(s.evaluate(l))/Math.LN10],ln:[oi,[oi],(l,[s])=>Math.log(s.evaluate(l))],log2:[oi,[oi],(l,[s])=>Math.log(s.evaluate(l))/Math.LN2],sin:[oi,[oi],(l,[s])=>Math.sin(s.evaluate(l))],cos:[oi,[oi],(l,[s])=>Math.cos(s.evaluate(l))],tan:[oi,[oi],(l,[s])=>Math.tan(s.evaluate(l))],asin:[oi,[oi],(l,[s])=>Math.asin(s.evaluate(l))],acos:[oi,[oi],(l,[s])=>Math.acos(s.evaluate(l))],atan:[oi,[oi],(l,[s])=>Math.atan(s.evaluate(l))],min:[oi,vo(oi),(l,s)=>Math.min(...s.map(c=>c.evaluate(l)))],max:[oi,vo(oi),(l,s)=>Math.max(...s.map(c=>c.evaluate(l)))],abs:[oi,[oi],(l,[s])=>Math.abs(s.evaluate(l))],round:[oi,[oi],(l,[s])=>{const c=s.evaluate(l);return c<0?-Math.round(-c):Math.round(c)}],floor:[oi,[oi],(l,[s])=>Math.floor(s.evaluate(l))],ceil:[oi,[oi],(l,[s])=>Math.ceil(s.evaluate(l))],"filter-==":[Wn,[Jt,Jn],(l,[s,c])=>l.properties()[s.value]===c.value],"filter-id-==":[Wn,[Jn],(l,[s])=>l.id()===s.value],"filter-type-==":[Wn,[Jt],(l,[s])=>l.geometryType()===s.value],"filter-<":[Wn,[Jt,Jn],(l,[s,c])=>{const h=l.properties()[s.value],m=c.value;return typeof h==typeof m&&h<m}],"filter-id-<":[Wn,[Jn],(l,[s])=>{const c=l.id(),h=s.value;return typeof c==typeof h&&c<h}],"filter->":[Wn,[Jt,Jn],(l,[s,c])=>{const h=l.properties()[s.value],m=c.value;return typeof h==typeof m&&h>m}],"filter-id->":[Wn,[Jn],(l,[s])=>{const c=l.id(),h=s.value;return typeof c==typeof h&&c>h}],"filter-<=":[Wn,[Jt,Jn],(l,[s,c])=>{const h=l.properties()[s.value],m=c.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[Wn,[Jn],(l,[s])=>{const c=l.id(),h=s.value;return typeof c==typeof h&&c<=h}],"filter->=":[Wn,[Jt,Jn],(l,[s,c])=>{const h=l.properties()[s.value],m=c.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[Wn,[Jn],(l,[s])=>{const c=l.id(),h=s.value;return typeof c==typeof h&&c>=h}],"filter-has":[Wn,[Jn],(l,[s])=>s.value in l.properties()],"filter-has-id":[Wn,[],l=>null!==l.id()&&void 0!==l.id()],"filter-type-in":[Wn,[yo(Jt)],(l,[s])=>s.value.indexOf(l.geometryType())>=0],"filter-id-in":[Wn,[yo(Jn)],(l,[s])=>s.value.indexOf(l.id())>=0],"filter-in-small":[Wn,[Jt,yo(Jn)],(l,[s,c])=>c.value.indexOf(l.properties()[s.value])>=0],"filter-in-large":[Wn,[Jt,yo(Jn)],(l,[s,c])=>function(h,m,b,w){for(;b<=w;){const S=b+w>>1;if(m[S]===h)return!0;m[S]>h?w=S-1:b=S+1}return!1}(l.properties()[s.value],c.value,0,c.value.length-1)],all:{type:Wn,overloads:[[[Wn,Wn],(l,[s,c])=>s.evaluate(l)&&c.evaluate(l)],[vo(Wn),(l,s)=>{for(const c of s)if(!c.evaluate(l))return!1;return!0}]]},any:{type:Wn,overloads:[[[Wn,Wn],(l,[s,c])=>s.evaluate(l)||c.evaluate(l)],[vo(Wn),(l,s)=>{for(const c of s)if(c.evaluate(l))return!0;return!1}]]},"!":[Wn,[Wn],(l,[s])=>!s.evaluate(l)],"is-supported-script":[Wn,[Jt],(l,[s])=>{const c=l.globals&&l.globals.isSupportedScript;return!c||c(s.evaluate(l))}],upcase:[Jt,[Jt],(l,[s])=>s.evaluate(l).toUpperCase()],downcase:[Jt,[Jt],(l,[s])=>s.evaluate(l).toLowerCase()],concat:[Jt,vo(Jn),(l,s)=>s.map(c=>Ec(c.evaluate(l))).join("")],"resolved-locale":[Jt,[Dl],(l,[s])=>s.evaluate(l).resolvedLocale()]});var Cs=kl;function Br(l){return{result:"success",value:l}}function Ws(l){return{result:"error",value:l}}function qu(l){return"data-driven"===l["property-type"]}function Xu(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function Uh(l){return!!l.expression&&l.expression.interpolated}function Ar(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":null===l?"null":typeof l}function Ef(l){return"object"==typeof l&&null!==l&&!Array.isArray(l)}function ls(l){return l}function Si(l,s){const c="color"===s.type,h=l.stops&&"object"==typeof l.stops[0][0],m=h||!(h||void 0!==l.property),b=l.type||(Uh(s)?"exponential":"interval");if(c&&((l=bd({},l)).stops&&(l.stops=l.stops.map(k=>[k[0],fs.parse(k[1])])),l.default=fs.parse(l.default?l.default:s.default)),l.colorSpace&&"rgb"!==l.colorSpace&&!Kc[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let w,S,D;if("exponential"===b)w=Rl;else if("interval"===b)w=Ca;else if("categorical"===b){w=Yo,S=Object.create(null);for(const k of l.stops)S[k[0]]=k[1];D=typeof l.stops[0][0]}else{if("identity"!==b)throw new Error(`Unknown function type "${b}"`);w=aa}if(h){const k={},N=[];for(let q=0;q<l.stops.length;q++){const Y=l.stops[q],Q=Y[0].zoom;void 0===k[Q]&&(k[Q]={zoom:Q,type:l.type,property:l.property,default:l.default,stops:[]},N.push(Q)),k[Q].stops.push([Y[0].value,Y[1]])}const V=[];for(const q of N)V.push([k[q].zoom,Si(k[q],s)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:Jc.interpolationFactor.bind(void 0,G),zoomStops:V.map(q=>q[0]),evaluate:({zoom:q},Y)=>Rl({stops:V,base:l.base},s,q).evaluate(q,Y)}}if(m){const k="exponential"===b?{name:"exponential",base:void 0!==l.base?l.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Jc.interpolationFactor.bind(void 0,k),zoomStops:l.stops.map(N=>N[0]),evaluate:({zoom:N})=>w(l,s,N,S,D)}}return{kind:"source",evaluate(k,N){const V=N&&N.properties?N.properties[l.property]:void 0;return void 0===V?Sn(l.default,s.default):w(l,s,V,S,D)}}}function Sn(l,s,c){return void 0!==l?l:void 0!==s?s:void 0!==c?c:void 0}function Yo(l,s,c,h,m){return Sn(typeof c===m?h[c]:void 0,l.default,s.default)}function Ca(l,s,c){if("number"!==Ar(c))return Sn(l.default,s.default);const h=l.stops.length;if(1===h||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[h-1][0])return l.stops[h-1][1];const m=xd(l.stops.map(b=>b[0]),c);return l.stops[m][1]}function Rl(l,s,c){const h=void 0!==l.base?l.base:1;if("number"!==Ar(c))return Sn(l.default,s.default);const m=l.stops.length;if(1===m||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[m-1][0])return l.stops[m-1][1];const b=xd(l.stops.map(N=>N[0]),c),w=function(N,V,G,q){const Y=q-G,Q=N-G;return 0===Y?0:1===V?Q/Y:(Math.pow(V,Q)-1)/(Math.pow(V,Y)-1)}(c,h,l.stops[b][0],l.stops[b+1][0]),S=l.stops[b][1],D=l.stops[b+1][1];let k=it[s.type]||ls;if(l.colorSpace&&"rgb"!==l.colorSpace){const N=Kc[l.colorSpace];k=(V,G)=>N.reverse(N.interpolate(N.forward(V),N.forward(G),w))}return"function"==typeof S.evaluate?{evaluate(...N){const V=S.evaluate.apply(void 0,N),G=D.evaluate.apply(void 0,N);if(void 0!==V&&void 0!==G)return k(V,G,w)}}:k(S,D,w)}function aa(l,s,c){return"color"===s.type?c=fs.parse(c):"formatted"===s.type?c=Ma.fromString(c.toString()):"resolvedImage"===s.type?c=es.fromString(c.toString()):Ar(c)===s.type||"enum"===s.type&&s.values[c]||(c=void 0),Sn(c,l.default,s.default)}class Ac{constructor(s,c){var h;this.expression=s,this._warningHistory={},this._evaluator=new Eg,this._defaultValue=c?"color"===(h=c).type&&(Ef(h.default)||Array.isArray(h.default))?new fs(0,0,0,0):"color"===h.type?fs.parse(h.default)||null:void 0===h.default?null:h.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(s,c,h,m,b,w,S,D){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=h,this._evaluator.canonical=m||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=D||null,this.expression.evaluate(this._evaluator)}evaluate(s,c,h,m,b,w,S,D){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=D||null;try{const k=this.expression.evaluate(this._evaluator);if(null==k||"number"==typeof k&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new Fa(`Expected value to be one of ${Object.keys(this._enumValues).map(N=>JSON.stringify(N)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function Vo(l){return Array.isArray(l)&&l.length>0&&"string"==typeof l[0]&&l[0]in Cs}function al(l,s){const c=new Cg(Cs,[],s?function(m){const b={color:oa,string:Jt,number:oi,enum:Jt,boolean:Wn,formatted:jr,resolvedImage:Mc};return"array"===m.type?yo(b[m.value]||Jn,m.length):b[m.type]}(s):void 0),h=c.parse(l,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return h?Br(new Ac(h,s)):Ws(c.errors)}class ll{constructor(s,c){this.kind=s,this._styleExpression=c,this.isStateDependent="constant"!==s&&!Ls(c.expression)}evaluateWithoutErrorHandling(s,c,h,m,b,w){return this._styleExpression.evaluateWithoutErrorHandling(s,c,h,m,b,w)}evaluate(s,c,h,m,b,w){return this._styleExpression.evaluate(s,c,h,m,b,w)}}class In{constructor(s,c,h,m){this.kind=s,this.zoomStops=h,this._styleExpression=c,this.isStateDependent="camera"!==s&&!Ls(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(s,c,h,m,b,w){return this._styleExpression.evaluateWithoutErrorHandling(s,c,h,m,b,w)}evaluate(s,c,h,m,b,w){return this._styleExpression.evaluate(s,c,h,m,b,w)}interpolationFactor(s,c,h){return this.interpolationType?Jc.interpolationFactor(this.interpolationType,s,c,h):0}}function Jd(l,s){if("error"===(l=al(l,s)).result)return l;const c=l.value.expression,h=Ro(c);if(!h&&!qu(s))return Ws([new Zc("","data expressions not supported")]);const m=Yc(c,["zoom","pitch","distance-from-center"]);if(!m&&!Xu(s))return Ws([new Zc("","zoom expressions not supported")]);const b=Qd(c);return b||m?b instanceof Zc?Ws([b]):b instanceof Jc&&!Uh(s)?Ws([new Zc("",'"interpolate" expressions cannot be used with this property')]):Br(b?new In(h?"camera":"composite",l.value,b.labels,b instanceof Jc?b.interpolation:void 0):new ll(h?"constant":"source",l.value)):Ws([new Zc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Cf{constructor(s,c){this._parameters=s,this._specification=c,bd(this,Si(this._parameters,this._specification))}static deserialize(s){return new Cf(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Qd(l){let s=null;if(l instanceof tc)s=Qd(l.result);else if(l instanceof Pp){for(const c of l.args)if(s=Qd(c),s)break}else(l instanceof sl||l instanceof Jc)&&l.input instanceof is&&"zoom"===l.input.name&&(s=l);return s instanceof Zc||l.eachChild(c=>{const h=Qd(c);h instanceof Zc?s=h:!s&&h?s=new Zc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&h&&s!==h&&(s=new Zc("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}class ii{constructor(s,c,h,m){this.message=(s?`${s}: `:"")+h,m&&(this.identifier=m),null!=c&&c.__line__&&(this.line=c.__line__)}}function la(l){const s=l.key,c=l.value,h=l.valueSpec||{},m=l.objectElementValidators||{},b=l.style,w=l.styleSpec;let S=[];const D=Ar(c);if("object"!==D)return[new ii(s,c,`object expected, ${D} found`)];for(const k in c){const N=k.split(".")[0];let V;m[N]?V=m[N]:h[N]?V=cl:m["*"]?V=m["*"]:h["*"]&&(V=cl),V?S=S.concat(V({key:(s&&`${s}.`)+k,value:c[k],valueSpec:h[N]||h["*"],style:b,styleSpec:w,object:c,objectKey:k},c)):S.push(new ii(s,c[k],`unknown property "${k}"`))}for(const k in h)m[k]||h[k].required&&void 0===h[k].default&&void 0===c[k]&&S.push(new ii(s,c,`missing required property "${k}"`));return S}function eu(l){const s=l.value,c=l.valueSpec,h=l.style,m=l.styleSpec,b=l.key,w=l.arrayElementValidator||cl;if("array"!==Ar(s))return[new ii(b,s,`array expected, ${Ar(s)} found`)];if(c.length&&s.length!==c.length)return[new ii(b,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new ii(b,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let S={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};m.$version<7&&(S.function=c.function),"object"===Ar(c.value)&&(S=c.value);let D=[];for(let k=0;k<s.length;k++)D=D.concat(w({array:s,arrayIndex:k,value:s[k],valueSpec:S,style:h,styleSpec:m,key:`${b}[${k}]`}));return D}function Pl(l){const s=l.key,c=l.value,h=l.valueSpec;let m=Ar(c);if("number"===m&&c!=c&&(m="NaN"),"number"!==m)return[new ii(s,c,`number expected, ${m} found`)];if("minimum"in h){let b=h.minimum;if("array"===Ar(h.minimum)&&(b=h.minimum[l.arrayIndex]),c<b)return[new ii(s,c,`${c} is less than the minimum value ${b}`)]}if("maximum"in h){let b=h.maximum;if("array"===Ar(h.maximum)&&(b=h.maximum[l.arrayIndex]),c>b)return[new ii(s,c,`${c} is greater than the maximum value ${b}`)]}return[]}function Ed(l){const s=l.valueSpec,c=Es(l.value.type);let h,m,b,w={};const S="categorical"!==c&&void 0===l.value.property,D=!S,k="array"===Ar(l.value.stops)&&"array"===Ar(l.value.stops[0])&&"object"===Ar(l.value.stops[0][0]),N=la({key:l.key,value:l.value,valueSpec:l.styleSpec.function,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(q){if("identity"===c)return[new ii(q.key,q.value,'identity function may not have a "stops" property')];let Y=[];const Q=q.value;return Y=Y.concat(eu({key:q.key,value:Q,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:V})),"array"===Ar(Q)&&0===Q.length&&Y.push(new ii(q.key,Q,"array must have at least one stop")),Y},default:function(q){return cl({key:q.key,value:q.value,valueSpec:s,style:q.style,styleSpec:q.styleSpec})}}});return"identity"===c&&S&&N.push(new ii(l.key,l.value,'missing required property "property"')),"identity"===c||l.value.stops||N.push(new ii(l.key,l.value,'missing required property "stops"')),"exponential"===c&&l.valueSpec.expression&&!Uh(l.valueSpec)&&N.push(new ii(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(D&&!qu(l.valueSpec)?N.push(new ii(l.key,l.value,"property functions not supported")):S&&!Xu(l.valueSpec)&&N.push(new ii(l.key,l.value,"zoom functions not supported"))),"categorical"!==c&&!k||void 0!==l.value.property||N.push(new ii(l.key,l.value,'"property" property is required')),N;function V(q){let Y=[];const Q=q.value,ae=q.key;if("array"!==Ar(Q))return[new ii(ae,Q,`array expected, ${Ar(Q)} found`)];if(2!==Q.length)return[new ii(ae,Q,`array length 2 expected, length ${Q.length} found`)];if(k){if("object"!==Ar(Q[0]))return[new ii(ae,Q,`object expected, ${Ar(Q[0])} found`)];if(void 0===Q[0].zoom)return[new ii(ae,Q,"object stop key must have zoom")];if(void 0===Q[0].value)return[new ii(ae,Q,"object stop key must have value")];const ge=Es(Q[0].zoom);if("number"!=typeof ge)return[new ii(ae,Q[0].zoom,"stop zoom values must be numbers")];if(b&&b>ge)return[new ii(ae,Q[0].zoom,"stop zoom values must appear in ascending order")];ge!==b&&(b=ge,m=void 0,w={}),Y=Y.concat(la({key:`${ae}[0]`,value:Q[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:Pl,value:G}}))}else Y=Y.concat(G({key:`${ae}[0]`,value:Q[0],valueSpec:{},style:q.style,styleSpec:q.styleSpec},Q));return Vo(ra(Q[1]))?Y.concat([new ii(`${ae}[1]`,Q[1],"expressions are not allowed in function stops.")]):Y.concat(cl({key:`${ae}[1]`,value:Q[1],valueSpec:s,style:q.style,styleSpec:q.styleSpec}))}function G(q,Y){const Q=Ar(q.value),ae=Es(q.value),ge=null!==q.value?q.value:Y;if(h){if(Q!==h)return[new ii(q.key,ge,`${Q} stop domain type must match previous stop domain type ${h}`)]}else h=Q;if("number"!==Q&&"string"!==Q&&"boolean"!==Q&&"number"!=typeof ae&&"string"!=typeof ae&&"boolean"!=typeof ae)return[new ii(q.key,ge,"stop domain value must be a number, string, or boolean")];if("number"!==Q&&"categorical"!==c){let De=`number expected, ${Q} found`;return qu(s)&&void 0===c&&(De+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ii(q.key,ge,De)]}return"categorical"!==c||"number"!==Q||"number"==typeof ae&&isFinite(ae)&&Math.floor(ae)===ae?"categorical"!==c&&"number"===Q&&"number"==typeof ae&&"number"==typeof m&&void 0!==m&&ae<m?[new ii(q.key,ge,"stop domain values must appear in ascending order")]:(m=ae,"categorical"===c&&ae in w?[new ii(q.key,ge,"stop domain values must be unique")]:(w[ae]=!0,[])):[new ii(q.key,ge,`integer expected, found ${String(ae)}`)]}}function $s(l){const s=("property"===l.expressionContext?Jd:al)(ra(l.value),l.valueSpec);if("error"===s.result)return s.value.map(h=>new ii(`${l.key}${h.key}`,l.value,h.message));const c=s.value.expression||s.value._styleExpression.expression;if("property"===l.expressionContext&&"text-font"===l.propertyKey&&!c.outputDefined())return[new ii(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===l.expressionContext&&"layout"===l.propertyType&&!Ls(c))return[new ii(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===l.expressionContext)return Dc(c,l);if(l.expressionContext&&0===l.expressionContext.indexOf("cluster")){if(!Yc(c,["zoom","feature-state"]))return[new ii(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===l.expressionContext&&!Ro(c))return[new ii(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Dc(l,s){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const m of s.valueSpec.expression.parameters)c.delete(m);if(0===c.size)return[];const h=[];return l instanceof is&&c.has(l.name)?[new ii(s.key,s.value,`["${l.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(l.eachChild(m=>{h.push(...Dc(m,s))}),h)}function bo(l){const s=l.key,c=l.value,h=l.valueSpec,m=[];return Array.isArray(h.values)?-1===h.values.indexOf(Es(c))&&m.push(new ii(s,c,`expected one of [${h.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(h.values).indexOf(Es(c))&&m.push(new ii(s,c,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function Ss(l){if(!0===l||!1===l)return!0;if(!Array.isArray(l)||0===l.length)return!1;switch(l[0]){case"has":return l.length>=2&&"$id"!==l[1]&&"$type"!==l[1];case"in":return l.length>=3&&("string"!=typeof l[1]||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==l.length||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const s of l.slice(1))if(!Ss(s)&&"boolean"!=typeof s)return!1;return!0;default:return!0}}function Vh(l,s="fill"){if(null==l)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ss(l)||(l=Ba(l));const c=l;let h=!0;try{h=function(k){if(!Zu(k))return k;let N=ra(k);return Cm(N),N=Er(N),N}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(c,null,2)}\n        `)}const m=yt[`filter_${s}`],b=al(h,m);let w=null;if("error"===b.result)throw new Error(b.value.map(k=>`${k.key}: ${k.message}`).join(", "));w=(k,N,V)=>b.value.evaluate(k,N,{},V);let S=null,D=null;if(h!==c){const k=al(c,m);if("error"===k.result)throw new Error(k.value.map(N=>`${N.key}: ${N.message}`).join(", "));S=(N,V,G,q,Y)=>k.value.evaluate(N,V,{},G,void 0,void 0,q,Y),D=!Ro(k.value.expression)}return{filter:w,dynamicFilter:S||void 0,needGeometry:Hh(h),needFeature:!!D}}function Er(l){if(!Array.isArray(l))return l;const s=function(c){if(Op.has(c[0]))for(let h=1;h<c.length;h++)if(Zu(c[h]))return!0;return c}(l);return!0===s?s:s.map(c=>Er(c))}function Cm(l){let s=!1;const c=[];if("case"===l[0]){for(let h=1;h<l.length-1;h+=2)s=s||Zu(l[h]),c.push(l[h+1]);c.push(l[l.length-1])}else if("match"===l[0]){s=s||Zu(l[1]);for(let h=2;h<l.length-1;h+=2)c.push(l[h+1]);c.push(l[l.length-1])}else if("step"===l[0]){s=s||Zu(l[1]);for(let h=1;h<l.length-1;h+=2)c.push(l[h+1])}s&&(l.length=0,l.push("any",...c));for(let h=1;h<l.length;h++)Cm(l[h])}function Zu(l){if(!Array.isArray(l))return!1;if("pitch"===(s=l[0])||"distance-from-center"===s)return!0;var s;for(let c=1;c<l.length;c++)if(Zu(l[c]))return!0;return!1}const Op=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ll(l,s){return l<s?-1:l>s?1:0}function Hh(l){if(!Array.isArray(l))return!1;if("within"===l[0])return!0;for(let s=1;s<l.length;s++)if(Hh(l[s]))return!0;return!1}function Ba(l){if(!l)return!0;const s=l[0];return l.length<=1?"any"!==s:"=="===s?Qc(l[1],l[2],"=="):"!="===s?Ts(Qc(l[1],l[2],"==")):"<"===s||">"===s||"<="===s||">="===s?Qc(l[1],l[2],s):"any"===s?(c=l.slice(1),["any"].concat(c.map(Ba))):"all"===s?["all"].concat(l.slice(1).map(Ba)):"none"===s?["all"].concat(l.slice(1).map(Ba).map(Ts)):"in"===s?ms(l[1],l.slice(2)):"!in"===s?Ts(ms(l[1],l.slice(2))):"has"===s?Sf(l[1]):"!has"===s?Ts(Sf(l[1])):"within"!==s||l;var c}function Qc(l,s,c){switch(l){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,l,s]}}function ms(l,s){if(0===s.length)return!1;switch(l){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",l,["literal",s.sort(Ll)]]:["filter-in-small",l,["literal",s]]}}function Sf(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Ts(l){return["!",l]}function ca(l){return Ss(ra(l.value))?$s(bd({},l,{expressionContext:"filter",valueSpec:l.styleSpec[`filter_${l.layerType||"fill"}`]})):Gh(l)}function Gh(l){const s=l.value,c=l.key;if("array"!==Ar(s))return[new ii(c,s,`array expected, ${Ar(s)} found`)];const h=l.styleSpec;let m,b=[];if(s.length<1)return[new ii(c,s,"filter array must have at least 1 element")];switch(b=b.concat(bo({key:`${c}[0]`,value:s[0],valueSpec:h.filter_operator,style:l.style,styleSpec:l.styleSpec})),Es(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===Es(s[1])&&b.push(new ii(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":3!==s.length&&b.push(new ii(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(m=Ar(s[1]),"string"!==m&&b.push(new ii(`${c}[1]`,s[1],`string expected, ${m} found`)));for(let w=2;w<s.length;w++)m=Ar(s[w]),"$type"===Es(s[1])?b=b.concat(bo({key:`${c}[${w}]`,value:s[w],valueSpec:h.geometry_type,style:l.style,styleSpec:l.styleSpec})):"string"!==m&&"number"!==m&&"boolean"!==m&&b.push(new ii(`${c}[${w}]`,s[w],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let w=1;w<s.length;w++)b=b.concat(Gh({key:`${c}[${w}]`,value:s[w],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":m=Ar(s[1]),2!==s.length?b.push(new ii(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"string"!==m&&b.push(new ii(`${c}[1]`,s[1],`string expected, ${m} found`));break;case"within":m=Ar(s[1]),2!==s.length?b.push(new ii(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"object"!==m&&b.push(new ii(`${c}[1]`,s[1],`object expected, ${m} found`))}return b}function tu(l,s){const c=l.key,h=l.style,m=l.styleSpec,b=l.value,w=l.objectKey,S=m[`${s}_${l.layerType}`];if(!S)return[];const D=w.match(/^(.*)-transition$/);if("paint"===s&&D&&S[D[1]]&&S[D[1]].transition)return cl({key:c,value:b,valueSpec:m.transition,style:h,styleSpec:m});const k=l.valueSpec||S[w];if(!k)return[new ii(c,b,`unknown property "${w}"`)];let N;if("string"===Ar(b)&&qu(k)&&!k.tokens&&(N=/^{([^}]+)}$/.exec(b))){const G=`\`{ "type": "identity", "property": ${N?JSON.stringify(N[1]):'"_"'} }\``;return[new ii(c,b,`"${w}" does not support interpolation syntax\nUse an identity property function instead: ${G}.`)]}const V=[];return"symbol"===l.layerType&&("text-field"===w&&h&&!h.glyphs&&V.push(new ii(c,b,'use of "text-field" requires a style "glyphs" property')),"text-font"===w&&Ef(ra(b))&&"identity"===Es(b.type)&&V.push(new ii(c,b,'"text-font" does not support identity functions'))),V.concat(cl({key:l.key,value:b,valueSpec:k,style:h,styleSpec:m,expressionContext:"property",propertyType:s,propertyKey:w}))}function Tf(l){return tu(l,"paint")}function ic(l){return tu(l,"layout")}function jh(l){let s=[];const c=l.value,h=l.key,m=l.style,b=l.styleSpec;c.type||c.ref||s.push(new ii(h,c,'either "type" or "ref" is required'));let w=Es(c.type);const S=Es(c.ref);if(c.id){const D=Es(c.id);for(let k=0;k<l.arrayIndex;k++){const N=m.layers[k];Es(N.id)===D&&s.push(new ii(h,c.id,`duplicate layer id "${c.id}", previously used at line ${N.id.__line__}`))}}if("ref"in c){let D;["type","source","source-layer","filter","layout"].forEach(k=>{k in c&&s.push(new ii(h,c[k],`"${k}" is prohibited for ref layers`))}),m.layers.forEach(k=>{Es(k.id)===S&&(D=k)}),D?D.ref?s.push(new ii(h,c.ref,"ref cannot reference another ref layer")):w=Es(D.type):"string"==typeof S&&s.push(new ii(h,c.ref,`ref layer "${S}" not found`))}else if("background"!==w&&"sky"!==w)if(c.source){const D=m.sources&&m.sources[c.source],k=D&&Es(D.type);D?"vector"===k&&"raster"===w?s.push(new ii(h,c.source,`layer "${c.id}" requires a raster source`)):"raster"===k&&"raster"!==w?s.push(new ii(h,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==k||c["source-layer"]?"raster-dem"===k&&"hillshade"!==w?s.push(new ii(h,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==w||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||"geojson"===k&&D.lineMetrics||s.push(new ii(h,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new ii(h,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new ii(h,c.source,`source "${c.source}" not found`))}else s.push(new ii(h,c,'missing required property "source"'));return s=s.concat(la({key:h,value:c,valueSpec:b.layer,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{"*":()=>[],type:()=>cl({key:`${h}.type`,value:c.type,valueSpec:b.layer.type,style:l.style,styleSpec:l.styleSpec,object:c,objectKey:"type"}),filter:D=>ca(bd({layerType:w},D)),layout:D=>la({layer:c,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":k=>ic(bd({layerType:w},k))}}),paint:D=>la({layer:c,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":k=>Tf(bd({layerType:w},k))}})}})),s}function Ic(l){const s=l.value,c=l.key,h=Ar(s);return"string"!==h?[new ii(c,s,`string expected, ${h} found`)]:[]}const Ig={promoteId:function({key:l,value:s}){if("string"===Ar(s))return Ic({key:l,value:s});{const c=[];for(const h in s)c.push(...Ic({key:`${l}.${h}`,value:s[h]}));return c}}};function ue(l){const s=l.value,c=l.key,h=l.styleSpec,m=l.style;if(!s.type)return[new ii(c,s,'"type" is required')];const b=Es(s.type);let w;switch(b){case"vector":case"raster":case"raster-dem":return w=la({key:c,value:s,valueSpec:h[`source_${b.replace("-","_")}`],style:l.style,styleSpec:h,objectElementValidators:Ig}),w;case"geojson":if(w=la({key:c,value:s,valueSpec:h.source_geojson,style:m,styleSpec:h,objectElementValidators:Ig}),s.cluster)for(const S in s.clusterProperties){const[D,k]=s.clusterProperties[S],N="string"==typeof D?[D,["accumulated"],["get",S]]:D;w.push(...$s({key:`${c}.${S}.map`,value:k,expressionContext:"cluster-map"})),w.push(...$s({key:`${c}.${S}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return w;case"video":return la({key:c,value:s,valueSpec:h.source_video,style:m,styleSpec:h});case"image":return la({key:c,value:s,valueSpec:h.source_image,style:m,styleSpec:h});case"canvas":return[new ii(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return bo({key:`${c}.type`,value:s.type,valueSpec:{values:Np(h)},style:m,styleSpec:h})}}function Np(l){return l.source.reduce((s,c)=>{const h=l[c];return"enum"===h.type.type&&(s=s.concat(Object.keys(h.type.values))),s},[])}function Af(l){const s=l.value,c=l.styleSpec,h=c.light,m=l.style;let b=[];const w=Ar(s);if(void 0===s)return b;if("object"!==w)return b=b.concat([new ii("light",s,`object expected, ${w} found`)]),b;for(const S in s){const D=S.match(/^(.*)-transition$/);b=b.concat(D&&h[D[1]]&&h[D[1]].transition?cl({key:S,value:s[S],valueSpec:c.transition,style:m,styleSpec:c}):h[S]?cl({key:S,value:s[S],valueSpec:h[S],style:m,styleSpec:c}):[new ii(S,s[S],`unknown property "${S}"`)])}return b}function nc(l){const s=l.value,c=l.key,h=l.style,m=l.styleSpec,b=m.terrain;let w=[];const S=Ar(s);if(void 0===s)return w;if("object"!==S)return w=w.concat([new ii("terrain",s,`object expected, ${S} found`)]),w;for(const D in s){const k=D.match(/^(.*)-transition$/);w=w.concat(k&&b[k[1]]&&b[k[1]].transition?cl({key:D,value:s[D],valueSpec:m.transition,style:h,styleSpec:m}):b[D]?cl({key:D,value:s[D],valueSpec:b[D],style:h,styleSpec:m}):[new ii(D,s[D],`unknown property "${D}"`)])}if(s.source){const D=h.sources&&h.sources[s.source],k=D&&Es(D.type);D?"raster-dem"!==k&&w.push(new ii(c,s.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):w.push(new ii(c,s.source,`source "${s.source}" not found`))}else w.push(new ii(c,s,'terrain is missing required property "source"'));return w}function Dr(l){const s=l.value,c=l.style,h=l.styleSpec,m=h.fog;let b=[];const w=Ar(s);if(void 0===s)return b;if("object"!==w)return b=b.concat([new ii("fog",s,`object expected, ${w} found`)]),b;for(const S in s){const D=S.match(/^(.*)-transition$/);b=b.concat(D&&m[D[1]]&&m[D[1]].transition?cl({key:S,value:s[S],valueSpec:h.transition,style:c,styleSpec:h}):m[S]?cl({key:S,value:s[S],valueSpec:m[S],style:c,styleSpec:h}):[new ii(S,s[S],`unknown property "${S}"`)])}return b}const Nv={"*":()=>[],array:eu,boolean:function(l){const s=l.value,c=l.key,h=Ar(s);return"boolean"!==h?[new ii(c,s,`boolean expected, ${h} found`)]:[]},number:Pl,color:function(l){const s=l.key,c=l.value,h=Ar(c);return"string"!==h?[new ii(s,c,`color expected, ${h} found`)]:null===Ap(c)?[new ii(s,c,`color expected, "${c}" found`)]:[]},enum:bo,filter:ca,function:Ed,layer:jh,object:la,source:ue,light:Af,terrain:nc,fog:Dr,string:Ic,formatted:function(l){return 0===Ic(l).length?[]:$s(l)},resolvedImage:function(l){return 0===Ic(l).length?[]:$s(l)},projection:function(l){const s=l.value,c=l.styleSpec,h=c.projection,m=l.style;let b=[];const w=Ar(s);if("object"===w)for(const S in s)b=b.concat(cl({key:S,value:s[S],valueSpec:h[S],style:m,styleSpec:c}));else"string"!==w&&(b=b.concat([new ii("projection",s,`object or string expected, ${w} found`)]));return b}};function cl(l){const s=l.value,c=l.valueSpec,h=l.styleSpec;return c.expression&&Ef(Es(s))?Ed(l):c.expression&&Vo(ra(s))?$s(l):c.type&&Nv[c.type]?Nv[c.type](l):la(bd({},l,{valueSpec:c.type?h[c.type]:c}))}function ux(l){const s=l.value,c=l.key,h=Ic(l);return h.length||(-1===s.indexOf("{fontstack}")&&h.push(new ii(c,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&h.push(new ii(c,s,'"glyphs" url must include a "{range}" token'))),h}function Wh(l,s=yt){return ed(cl({key:"",value:l,valueSpec:s.$root,styleSpec:s,style:l,objectElementValidators:{glyphs:ux,"*":()=>[]}}))}const hx=l=>ed(Tf(l)),px=l=>ed(ic(l));function ed(l){return l.slice().sort((s,c)=>s.line&&c.line?s.line-c.line:0)}function Bv(l,s){let c=!1;if(s&&s.length)for(const h of s)l.fire(new qd(new Error(h.message))),c=!0;return c}var fx=td,da=3;function td(l,s,c){var h=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var m=new Int32Array(this.arrayBuffer);l=m[0],this.d=(s=m[1])+2*(c=m[2]);for(var b=0;b<this.d*this.d;b++){var w=m[da+b],S=m[da+b+1];h.push(w===S?null:m.subarray(w,S))}var D=m[da+h.length+1];this.keys=m.subarray(m[da+h.length],D),this.bboxes=m.subarray(D),this.insert=this._insertReadonly}else{this.d=s+2*c;for(var k=0;k<this.d*this.d;k++)h.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=l,this.padding=c,this.scale=s/l,this.uid=0;var N=c/s*l;this.min=-N,this.max=l+N}td.prototype.insert=function(l,s,c,h,m){this._forEachCell(s,c,h,m,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(h),this.bboxes.push(m)},td.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},td.prototype._insertCell=function(l,s,c,h,m,b){this.cells[m].push(b)},td.prototype.query=function(l,s,c,h,m){var b=this.min,w=this.max;if(l<=b&&s<=b&&w<=c&&w<=h&&!m)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(l,s,c,h,this._queryCell,S,{},m),S},td.prototype._queryCell=function(l,s,c,h,m,b,w,S){var D=this.cells[m];if(null!==D)for(var k=this.keys,N=this.bboxes,V=0;V<D.length;V++){var G=D[V];if(void 0===w[G]){var q=4*G;(S?S(N[q+0],N[q+1],N[q+2],N[q+3]):l<=N[q+2]&&s<=N[q+3]&&c>=N[q+0]&&h>=N[q+1])?(w[G]=!0,b.push(k[G])):w[G]=!1}}},td.prototype._forEachCell=function(l,s,c,h,m,b,w,S){for(var D=this._convertToCellCoord(l),k=this._convertToCellCoord(s),N=this._convertToCellCoord(c),V=this._convertToCellCoord(h),G=D;G<=N;G++)for(var q=k;q<=V;q++){var Y=this.d*q+G;if((!S||S(this._convertFromCellCoord(G),this._convertFromCellCoord(q),this._convertFromCellCoord(G+1),this._convertFromCellCoord(q+1)))&&m.call(this,l,s,c,h,Y,b,w,S))return}},td.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},td.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},td.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,s=da+this.cells.length+1+1,c=0,h=0;h<this.cells.length;h++)c+=this.cells[h].length;var m=new Int32Array(s+c+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var b=s,w=0;w<l.length;w++){var S=l[w];m[da+w]=b,m.set(S,b),b+=S.length}return m[da+l.length]=b,m.set(this.keys,b),m[da+l.length+1]=b+=this.keys.length,m.set(this.bboxes,b),b+=this.bboxes.length,m.buffer};var Yu=Jo(fx);const kg={};function Ii(l,s,c={}){Object.defineProperty(l,"_classRegistryKey",{value:s,writeable:!1}),kg[s]={klass:l,omit:c.omit||[]}}Ii(Object,"Object"),Yu.serialize=function(l,s){const c=l.toArrayBuffer();return s&&s.push(c),{buffer:c}},Yu.deserialize=function(l){return new Yu(l.buffer)},Object.defineProperty(Yu,"name",{value:"Grid"}),Ii(Yu,"Grid"),Ii(fs,"Color"),Ii(Error,"Error"),Ii(qc,"AJAXError"),Ii(es,"ResolvedImage"),Ii(Cf,"StylePropertyFunction"),Ii(Ac,"StyleExpression",{omit:["_evaluator"]}),Ii(In,"ZoomDependentExpression"),Ii(ll,"ZoomConstantExpression"),Ii(is,"CompoundExpression",{omit:["_evaluate"]});for(const l in Cs)kg[Cs[l]._classRegistryKey]||Ii(Cs[l],`Expression${l}`);function iy(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&"ArrayBuffer"===l.constructor.name)}function Sa(l){return gt.ImageBitmap&&l instanceof gt.ImageBitmap}function $h(l,s){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(iy(l)||Sa(l))return s&&s.push(l),l;if(ArrayBuffer.isView(l)){const c=l;return s&&s.push(c.buffer),c}if(l instanceof gt.ImageData)return s&&s.push(l.data.buffer),l;if(Array.isArray(l)){const c=[];for(const h of l)c.push($h(h,s));return c}if("object"==typeof l){const c=l.constructor,h=c._classRegistryKey;if(!h)throw new Error(`can't serialize object of unregistered class ${h}`);const m=c.serialize?c.serialize(l,s):{};if(!c.serialize){for(const b in l)l.hasOwnProperty(b)&&(kg[h].omit.indexOf(b)>=0||(m[b]=$h(l[b],s)));l instanceof Error&&(m.message=l.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==h&&(m.$name=h),m}throw new Error("can't serialize object of type "+typeof l)}function Bp(l){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||iy(l)||Sa(l)||ArrayBuffer.isView(l)||l instanceof gt.ImageData)return l;if(Array.isArray(l))return l.map(Bp);if("object"==typeof l){const s=l.$name||"Object",{klass:c}=kg[s];if(!c)throw new Error(`can't deserialize unregistered class ${s}`);if(c.deserialize)return c.deserialize(l);const h=Object.create(c.prototype);for(const m of Object.keys(l))"$name"!==m&&(h[m]=Bp(l[m]));return h}throw new Error("can't deserialize object of type "+typeof l)}const yi={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function Sm(l){for(const s of l)if(Rg(s.charCodeAt(0)))return!0;return!1}function zv(l){for(const s of l)if(!Ku(s.charCodeAt(0)))return!1;return!0}function Ku(l){return!(yi.Arabic(l)||yi["Arabic Supplement"](l)||yi["Arabic Extended-A"](l)||yi["Arabic Presentation Forms-A"](l)||yi["Arabic Presentation Forms-B"](l))}function Rg(l){return!(746!==l&&747!==l&&(l<4352||!(yi["Bopomofo Extended"](l)||yi.Bopomofo(l)||yi["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||yi["CJK Compatibility Ideographs"](l)||yi["CJK Compatibility"](l)||yi["CJK Radicals Supplement"](l)||yi["CJK Strokes"](l)||!(!yi["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||12336===l)||yi["CJK Unified Ideographs Extension A"](l)||yi["CJK Unified Ideographs"](l)||yi["Enclosed CJK Letters and Months"](l)||yi["Hangul Compatibility Jamo"](l)||yi["Hangul Jamo Extended-A"](l)||yi["Hangul Jamo Extended-B"](l)||yi["Hangul Jamo"](l)||yi["Hangul Syllables"](l)||yi.Hiragana(l)||yi["Ideographic Description Characters"](l)||yi.Kanbun(l)||yi["Kangxi Radicals"](l)||yi["Katakana Phonetic Extensions"](l)||yi.Katakana(l)&&12540!==l||!(!yi["Halfwidth and Fullwidth Forms"](l)||65288===l||65289===l||65293===l||l>=65306&&l<=65310||65339===l||65341===l||65343===l||l>=65371&&l<=65503||65507===l||l>=65512&&l<=65519)||!(!yi["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||yi["Unified Canadian Aboriginal Syllabics"](l)||yi["Unified Canadian Aboriginal Syllabics Extended"](l)||yi["Vertical Forms"](l)||yi["Yijing Hexagram Symbols"](l)||yi["Yi Syllables"](l)||yi["Yi Radicals"](l))))}function Uv(l){return!(Rg(l)||(s=l,yi["Latin-1 Supplement"](s)&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||yi["General Punctuation"](s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||yi["Letterlike Symbols"](s)||yi["Number Forms"](s)||yi["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||yi["Control Pictures"](s)&&9251!==s||yi["Optical Character Recognition"](s)||yi["Enclosed Alphanumerics"](s)||yi["Geometric Shapes"](s)||yi["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||yi["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||yi["CJK Symbols and Punctuation"](s)||yi.Katakana(s)||yi["Private Use Area"](s)||yi["CJK Compatibility Forms"](s)||yi["Small Form Variants"](s)||yi["Halfwidth and Fullwidth Forms"](s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s}function kc(l){return l>=1424&&l<=2303||yi["Arabic Presentation Forms-A"](l)||yi["Arabic Presentation Forms-B"](l)}function Cd(l,s){return!(!s&&kc(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||yi.Khmer(l))}function Tm(l){for(const s of l)if(kc(s.charCodeAt(0)))return!0;return!1}const Fs="deferred",Am="loading",ny="loaded";let iu=null,v="unavailable",d=null;const p=function(l){l&&"string"==typeof l&&l.indexOf("NetworkError")>-1&&(v="error"),iu&&iu(l)};function x(){C.fire(new Xc("pluginStateChange",{pluginStatus:v,pluginURL:d}))}const C=new Dh,T=function(){return v},P=function(){if(v!==Fs||!d)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");v=Am,x(),d&&Uu({url:d},l=>{l?p(l):(v=ny,x())})},F={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>v===ny||null!=F.applyArabicShaping,isLoading:()=>v===Am,setState(l){v=l.pluginStatus,d=l.pluginURL},isParsed:()=>null!=F.applyArabicShaping&&null!=F.processBidirectionalText&&null!=F.processStyledBidirectionalText,getPluginURL:()=>d};class z{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(s){return function(c,h){for(const m of c)if(!Cd(m.charCodeAt(0),h))return!1;return!0}(s,F.isLoaded())}}class j{constructor(s,c){this.property=s,this.value=c,this.expression=function(h,m){if(Ef(h))return new Cf(h,m);if(Vo(h)){const b=Jd(h,m);if("error"===b.result)throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));return b.value}{let b=h;return"string"==typeof h&&"color"===m.type&&(b=fs.parse(h)),{kind:"constant",evaluate:()=>b}}}(void 0===c?s.specification.default:c,s.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(s,c,h){return this.property.possiblyEvaluate(this,s,c,h)}}class W{constructor(s){this.property=s,this.value=new j(s,void 0)}transitioned(s,c){return new ne(this.property,this.value,c,Qo({},s.transition,this.transition),s.now)}untransitioned(){return new ne(this.property,this.value,null,{},0)}}class K{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return rl(this._values[s].value.value)}setValue(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new W(this._values[s].property)),this._values[s].value=new j(this._values[s].property,null===c?void 0:rl(c))}getTransition(s){return rl(this._values[s].transition)}setTransition(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new W(this._values[s].property)),this._values[s].transition=rl(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const h=this.getValue(c);void 0!==h&&(s[c]=h);const m=this.getTransition(c);void 0!==m&&(s[`${c}-transition`]=m)}return s}transitioned(s,c){const h=new he(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(s,c._values[m]);return h}untransitioned(){const s=new he(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class ne{constructor(s,c,h,m,b){const w=m.delay||0,S=m.duration||0;b=b||0,this.property=s,this.value=c,this.begin=b+w,this.end=this.begin+S,s.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(s,c,h){const m=s.now||0,b=this.value.possiblyEvaluate(s,c,h),w=this.prior;if(w){if(m>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(m<this.begin)return w.possiblyEvaluate(s,c,h);{const S=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(s,c,h),b,hm(S))}}return b}}class he{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,h){const m=new me(this._properties);for(const b of Object.keys(this._values))m._values[b]=this._values[b].possiblyEvaluate(s,c,h);return m}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class pe{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return rl(this._values[s].value)}setValue(s,c){this._values[s]=new j(this._values[s].property,null===c?void 0:rl(c))}serialize(){const s={};for(const c of Object.keys(this._values)){const h=this.getValue(c);void 0!==h&&(s[c]=h)}return s}possiblyEvaluate(s,c,h){const m=new me(this._properties);for(const b of Object.keys(this._values))m._values[b]=this._values[b].possiblyEvaluate(s,c,h);return m}}class le{constructor(s,c,h){this.property=s,this.value=c,this.parameters=h}isConstant(){return"constant"===this.value.kind}constantOr(s){return"constant"===this.value.kind?this.value.value:s}evaluate(s,c,h,m){return this.property.evaluate(this.value,this.parameters,s,c,h,m)}}class me{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class J{constructor(s){this.specification=s}possiblyEvaluate(s,c){return s.expression.evaluate(c)}interpolate(s,c,h){const m=it[this.specification.type];return m?m(s,c,h):s}}class de{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,h,m){return new le(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(c,null,{},h,m)}:s.expression,c)}interpolate(s,c,h){if("constant"!==s.value.kind||"constant"!==c.value.kind)return s;if(void 0===s.value.value||void 0===c.value.value)return new le(this,{kind:"constant",value:void 0},s.parameters);const m=it[this.specification.type];return m?new le(this,{kind:"constant",value:m(s.value.value,c.value.value,h)},s.parameters):s}evaluate(s,c,h,m,b,w){return"constant"===s.kind?s.value:s.evaluate(c,h,m,b,w)}}class be{constructor(s){this.specification=s}possiblyEvaluate(s,c,h,m){return!!s.expression.evaluate(c,null,{},h,m)}interpolate(){return!1}}class xe{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new z(0,{});for(const h in s){const m=s[h];m.specification.overridable&&this.overridableProperties.push(h);const b=this.defaultPropertyValues[h]=new j(m,void 0),w=this.defaultTransitionablePropertyValues[h]=new W(m);this.defaultTransitioningPropertyValues[h]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=b.possiblyEvaluate(c)}}}function Ne(l,s){return 256*(l=pr(Math.floor(l),0,255))+pr(Math.floor(s),0,255)}Ii(de,"DataDrivenProperty"),Ii(J,"DataConstantProperty"),Ii(be,"ColorRampProperty");const Be={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ke{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class We{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&(s.isTransferred=!0,c.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function $e(l,s=1){let c=0,h=0;return{members:l.map(m=>{const b=Be[m.type].BYTES_PER_ELEMENT,w=c=Ye(c,Math.max(s,b)),S=m.components||1;return h=Math.max(h,b),c+=b*S,{name:m.name,type:m.type,components:S,offset:w}}),size:Ye(c,Math.max(h,s)),alignment:s}}function Ye(l,s){return Math.ceil(l/s)*s}class St extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const h=this.length;return this.resize(h+1),this.emplace(h,s,c)}emplace(s,c,h){const m=2*s;return this.int16[m+0]=c,this.int16[m+1]=h,s}}St.prototype.bytesPerElement=4,Ii(St,"StructArrayLayout2i4");class Je extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,h)}emplace(s,c,h,m){const b=3*s;return this.int16[b+0]=c,this.int16[b+1]=h,this.int16[b+2]=m,s}}Je.prototype.bytesPerElement=6,Ii(Je,"StructArrayLayout3i6");class vt extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,h,m)}emplace(s,c,h,m,b){const w=4*s;return this.int16[w+0]=c,this.int16[w+1]=h,this.int16[w+2]=m,this.int16[w+3]=b,s}}vt.prototype.bytesPerElement=8,Ii(vt,"StructArrayLayout4i8");class et extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b,w,S){const D=this.length;return this.resize(D+1),this.emplace(D,s,c,h,m,b,w,S)}emplace(s,c,h,m,b,w,S,D){const k=6*s,N=12*s,V=3*s;return this.int16[k+0]=c,this.int16[k+1]=h,this.uint8[N+4]=m,this.uint8[N+5]=b,this.uint8[N+6]=w,this.uint8[N+7]=S,this.float32[V+2]=D,s}}et.prototype.bytesPerElement=12,Ii(et,"StructArrayLayout2i4ub1f12");class Rt extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,h,m)}emplace(s,c,h,m,b){const w=4*s;return this.float32[w+0]=c,this.float32[w+1]=h,this.float32[w+2]=m,this.float32[w+3]=b,s}}Rt.prototype.bytesPerElement=16,Ii(Rt,"StructArrayLayout4f16");class tt extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b){const w=this.length;return this.resize(w+1),this.emplace(w,s,c,h,m,b)}emplace(s,c,h,m,b,w){const S=6*s,D=3*s;return this.uint16[S+0]=c,this.uint16[S+1]=h,this.uint16[S+2]=m,this.uint16[S+3]=b,this.float32[D+2]=w,s}}tt.prototype.bytesPerElement=12,Ii(tt,"StructArrayLayout4ui1f12");class Mt extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,h,m)}emplace(s,c,h,m,b){const w=4*s;return this.uint16[w+0]=c,this.uint16[w+1]=h,this.uint16[w+2]=m,this.uint16[w+3]=b,s}}Mt.prototype.bytesPerElement=8,Ii(Mt,"StructArrayLayout4ui8");class Nt extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b,w){const S=this.length;return this.resize(S+1),this.emplace(S,s,c,h,m,b,w)}emplace(s,c,h,m,b,w,S){const D=6*s;return this.int16[D+0]=c,this.int16[D+1]=h,this.int16[D+2]=m,this.int16[D+3]=b,this.int16[D+4]=w,this.int16[D+5]=S,s}}Nt.prototype.bytesPerElement=12,Ii(Nt,"StructArrayLayout6i12");class Bt extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b,w,S,D,k,N,V,G){const q=this.length;return this.resize(q+1),this.emplace(q,s,c,h,m,b,w,S,D,k,N,V,G)}emplace(s,c,h,m,b,w,S,D,k,N,V,G,q){const Y=12*s;return this.int16[Y+0]=c,this.int16[Y+1]=h,this.int16[Y+2]=m,this.int16[Y+3]=b,this.uint16[Y+4]=w,this.uint16[Y+5]=S,this.uint16[Y+6]=D,this.uint16[Y+7]=k,this.int16[Y+8]=N,this.int16[Y+9]=V,this.int16[Y+10]=G,this.int16[Y+11]=q,s}}Bt.prototype.bytesPerElement=24,Ii(Bt,"StructArrayLayout4i4ui4i24");class Zt extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b,w){const S=this.length;return this.resize(S+1),this.emplace(S,s,c,h,m,b,w)}emplace(s,c,h,m,b,w,S){const D=10*s,k=5*s;return this.int16[D+0]=c,this.int16[D+1]=h,this.int16[D+2]=m,this.float32[k+2]=b,this.float32[k+3]=w,this.float32[k+4]=S,s}}Zt.prototype.bytesPerElement=20,Ii(Zt,"StructArrayLayout3i3f20");class $i extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}$i.prototype.bytesPerElement=4,Ii($i,"StructArrayLayout1ul4");class Qi extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b,w,S,D,k,N,V,G,q){const Y=this.length;return this.resize(Y+1),this.emplace(Y,s,c,h,m,b,w,S,D,k,N,V,G,q)}emplace(s,c,h,m,b,w,S,D,k,N,V,G,q,Y){const Q=20*s,ae=10*s;return this.int16[Q+0]=c,this.int16[Q+1]=h,this.int16[Q+2]=m,this.int16[Q+3]=b,this.int16[Q+4]=w,this.float32[ae+3]=S,this.float32[ae+4]=D,this.float32[ae+5]=k,this.float32[ae+6]=N,this.int16[Q+14]=V,this.uint32[ae+8]=G,this.uint16[Q+18]=q,this.uint16[Q+19]=Y,s}}Qi.prototype.bytesPerElement=40,Ii(Qi,"StructArrayLayout5i4f1i1ul2ui40");class Ai extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b,w,S){const D=this.length;return this.resize(D+1),this.emplace(D,s,c,h,m,b,w,S)}emplace(s,c,h,m,b,w,S,D){const k=8*s;return this.int16[k+0]=c,this.int16[k+1]=h,this.int16[k+2]=m,this.int16[k+4]=b,this.int16[k+5]=w,this.int16[k+6]=S,this.int16[k+7]=D,s}}Ai.prototype.bytesPerElement=16,Ii(Ai,"StructArrayLayout3i2i2i16");class nn extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b){const w=this.length;return this.resize(w+1),this.emplace(w,s,c,h,m,b)}emplace(s,c,h,m,b,w){const S=4*s,D=8*s;return this.float32[S+0]=c,this.float32[S+1]=h,this.float32[S+2]=m,this.int16[D+6]=b,this.int16[D+7]=w,s}}nn.prototype.bytesPerElement=16,Ii(nn,"StructArrayLayout2f1f2i16");class sr extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,h,m)}emplace(s,c,h,m,b){const w=12*s,S=3*s;return this.uint8[w+0]=c,this.uint8[w+1]=h,this.float32[S+1]=m,this.float32[S+2]=b,s}}sr.prototype.bytesPerElement=12,Ii(sr,"StructArrayLayout2ub2f12");class Bn extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,h)}emplace(s,c,h,m){const b=3*s;return this.float32[b+0]=c,this.float32[b+1]=h,this.float32[b+2]=m,s}}Bn.prototype.bytesPerElement=12,Ii(Bn,"StructArrayLayout3f12");class Bi extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,h)}emplace(s,c,h,m){const b=3*s;return this.uint16[b+0]=c,this.uint16[b+1]=h,this.uint16[b+2]=m,s}}Bi.prototype.bytesPerElement=6,Ii(Bi,"StructArrayLayout3ui6");class Jr extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b,w,S,D,k,N,V,G,q,Y,Q,ae,ge,De,_e,Ae,Ie){const Le=this.length;return this.resize(Le+1),this.emplace(Le,s,c,h,m,b,w,S,D,k,N,V,G,q,Y,Q,ae,ge,De,_e,Ae,Ie)}emplace(s,c,h,m,b,w,S,D,k,N,V,G,q,Y,Q,ae,ge,De,_e,Ae,Ie,Le){const st=30*s,nt=15*s,Et=60*s;return this.int16[st+0]=c,this.int16[st+1]=h,this.int16[st+2]=m,this.float32[nt+2]=b,this.float32[nt+3]=w,this.uint16[st+8]=S,this.uint16[st+9]=D,this.uint32[nt+5]=k,this.uint32[nt+6]=N,this.uint32[nt+7]=V,this.uint16[st+16]=G,this.uint16[st+17]=q,this.uint16[st+18]=Y,this.float32[nt+10]=Q,this.float32[nt+11]=ae,this.uint8[Et+48]=ge,this.uint8[Et+49]=De,this.uint8[Et+50]=_e,this.uint32[nt+13]=Ae,this.int16[st+28]=Ie,this.uint8[Et+58]=Le,s}}Jr.prototype.bytesPerElement=60,Ii(Jr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Di extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b,w,S,D,k,N,V,G,q,Y,Q,ae,ge,De,_e,Ae,Ie,Le,st,nt,Et,Yt,ct,Pt,Lt,Gt){const ai=this.length;return this.resize(ai+1),this.emplace(ai,s,c,h,m,b,w,S,D,k,N,V,G,q,Y,Q,ae,ge,De,_e,Ae,Ie,Le,st,nt,Et,Yt,ct,Pt,Lt,Gt)}emplace(s,c,h,m,b,w,S,D,k,N,V,G,q,Y,Q,ae,ge,De,_e,Ae,Ie,Le,st,nt,Et,Yt,ct,Pt,Lt,Gt,ai){const bt=38*s,_i=19*s;return this.int16[bt+0]=c,this.int16[bt+1]=h,this.int16[bt+2]=m,this.float32[_i+2]=b,this.float32[_i+3]=w,this.int16[bt+8]=S,this.int16[bt+9]=D,this.int16[bt+10]=k,this.int16[bt+11]=N,this.int16[bt+12]=V,this.int16[bt+13]=G,this.uint16[bt+14]=q,this.uint16[bt+15]=Y,this.uint16[bt+16]=Q,this.uint16[bt+17]=ae,this.uint16[bt+18]=ge,this.uint16[bt+19]=De,this.uint16[bt+20]=_e,this.uint16[bt+21]=Ae,this.uint16[bt+22]=Ie,this.uint16[bt+23]=Le,this.uint16[bt+24]=st,this.uint16[bt+25]=nt,this.uint16[bt+26]=Et,this.uint16[bt+27]=Yt,this.uint16[bt+28]=ct,this.uint32[_i+15]=Pt,this.float32[_i+16]=Lt,this.float32[_i+17]=Gt,this.float32[_i+18]=ai,s}}Di.prototype.bytesPerElement=76,Ii(Di,"StructArrayLayout3i2f6i15ui1ul3f76");class no extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}no.prototype.bytesPerElement=4,Ii(no,"StructArrayLayout1f4");class To extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,b){const w=this.length;return this.resize(w+1),this.emplace(w,s,c,h,m,b)}emplace(s,c,h,m,b,w){const S=5*s;return this.float32[S+0]=c,this.float32[S+1]=h,this.float32[S+2]=m,this.float32[S+3]=b,this.float32[S+4]=w,s}}To.prototype.bytesPerElement=20,Ii(To,"StructArrayLayout5f20");class za extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,h,m)}emplace(s,c,h,m,b){const w=6*s;return this.uint32[3*s+0]=c,this.uint16[w+2]=h,this.uint16[w+3]=m,this.uint16[w+4]=b,s}}za.prototype.bytesPerElement=12,Ii(za,"StructArrayLayout1ul3ui12");class ua extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const h=this.length;return this.resize(h+1),this.emplace(h,s,c)}emplace(s,c,h){const m=2*s;return this.uint16[m+0]=c,this.uint16[m+1]=h,s}}ua.prototype.bytesPerElement=4,Ii(ua,"StructArrayLayout2ui4");class rc extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}rc.prototype.bytesPerElement=2,Ii(rc,"StructArrayLayout1ui2");class oc extends We{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const h=this.length;return this.resize(h+1),this.emplace(h,s,c)}emplace(s,c,h){const m=2*s;return this.float32[m+0]=c,this.float32[m+1]=h,s}}oc.prototype.bytesPerElement=8,Ii(oc,"StructArrayLayout2f8");class ao extends ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ao.prototype.size=40;class ro extends Qi{get(s){return new ao(this,s)}}Ii(ro,"CollisionBoxArray");class Ir extends ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}Ir.prototype.size=60;class gs extends Jr{get(s){return new Ir(this,s)}}Ii(gs,"PlacedSymbolArray");class Ua extends ke{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(s){this._structArray.uint32[this._pos4+15]=s}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ua.prototype.size=76;class xo extends Di{get(s){return new Ua(this,s)}}Ii(xo,"SymbolInstanceArray");class Ut extends no{getoffsetX(s){return this.float32[1*s+0]}}Ii(Ut,"GlyphOffsetArray");class xr extends St{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}Ii(xr,"SymbolLineVertexArray");class $r extends ke{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}$r.prototype.size=12;class lo extends za{get(s){return new $r(this,s)}}Ii(lo,"FeatureIndexArray");class Ho extends ua{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}Ii(Ho,"FillExtrusionCentroidArray");const nu=$e([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),sc=$e([{name:"a_dash",components:4,type:"Uint16"}]);var Fl={exports:{}},Cr=function(l,s){var c,h,m,b,w,S,D,k;for(h=l.length-(c=3&l.length),m=s,w=3432918353,S=461845907,k=0;k<h;)D=255&l.charCodeAt(k)|(255&l.charCodeAt(++k))<<8|(255&l.charCodeAt(++k))<<16|(255&l.charCodeAt(++k))<<24,++k,m=27492+(65535&(b=5*(65535&(m=(m^=D=(65535&(D=(D=(65535&D)*w+(((D>>>16)*w&65535)<<16)&4294967295)<<15|D>>>17))*S+(((D>>>16)*S&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(D=0,c){case 3:D^=(255&l.charCodeAt(k+2))<<16;case 2:D^=(255&l.charCodeAt(k+1))<<8;case 1:m^=D=(65535&(D=(D=(65535&(D^=255&l.charCodeAt(k)))*w+(((D>>>16)*w&65535)<<16)&4294967295)<<15|D>>>17))*S+(((D>>>16)*S&65535)<<16)&4294967295}return m^=l.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0},mx=function(l,s){for(var c,h=l.length,m=s^h,b=0;h>=4;)c=1540483477*(65535&(c=255&l.charCodeAt(b)|(255&l.charCodeAt(++b))<<8|(255&l.charCodeAt(++b))<<16|(255&l.charCodeAt(++b))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),h-=4,++b;switch(h){case 3:m^=(255&l.charCodeAt(b+2))<<16;case 2:m^=(255&l.charCodeAt(b+1))<<8;case 1:m=1540483477*(65535&(m^=255&l.charCodeAt(b)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};Fl.exports=Cr,Fl.exports.murmur3=Cr,Fl.exports.murmur2=mx;var dl=Jo(Fl.exports);class Ol{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,c,h,m){this.ids.push(oy(s)),this.positions.push(c,h,m)}getPositions(s){const c=oy(s);let h=0,m=this.ids.length-1;for(;h<m;){const w=h+m>>1;this.ids[w]>=c?m=w:h=w+1}const b=[];for(;this.ids[h]===c;)b.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return b}static serialize(s,c){const h=new Float64Array(s.ids),m=new Uint32Array(s.positions);return zp(h,m,0,h.length-1),c&&c.push(h.buffer,m.buffer),{ids:h,positions:m}}static deserialize(s){const c=new Ol;return c.ids=s.ids,c.positions=s.positions,c.indexed=!0,c}}function oy(l){const s=+l;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:dl(String(l))}function zp(l,s,c,h){for(;c<h;){const m=l[c+h>>1];let b=c-1,w=h+1;for(;;){do{b++}while(l[b]<m);do{w--}while(l[w]>m);if(b>=w)break;Sd(l,b,w),Sd(s,3*b,3*w),Sd(s,3*b+1,3*w+1),Sd(s,3*b+2,3*w+2)}w-c<h-w?(zp(l,s,c,w),c=w+1):(zp(l,s,w+1,h),h=w)}}function Sd(l,s,c){const h=l[s];l[s]=l[c],l[c]=h}Ii(Ol,"FeaturePositionMap");class ha{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,c),this.initialized=!0),!!this.location}}class Pg extends ha{constructor(s){super(s),this.current=0}set(s,c,h){this.fetchUniformLocation(s,c)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Lg extends ha{constructor(s){super(s),this.current=[0,0,0,0]}set(s,c,h){this.fetchUniformLocation(s,c)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class sy extends ha{constructor(s){super(s),this.current=fs.transparent}set(s,c,h){this.fetchUniformLocation(s,c)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const ay=new Float32Array(16),ly=new Float32Array(9),Rc=new Float32Array(4);function Td(l){return[Ne(255*l.r,255*l.g),Ne(255*l.b,255*l.a)]}class If{constructor(s,c,h){this.value=s,this.uniformNames=c.map(m=>`u_${m}`),this.type=h}setUniform(s,c,h,m,b){c.set(s,b,m.constantOr(this.value))}getBinding(s,c){return"color"===this.type?new sy(s):new Pg(s)}}class Up{constructor(s,c){this.uniformNames=c.map(h=>`u_${h}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,c,h,m,b){const w="u_pattern"===b||"u_dash"===b?this.pattern:"u_pixel_ratio"===b?this.pixelRatio:null;w&&c.set(s,b,w)}getBinding(s,c){return"u_pattern"===c||"u_dash"===c?new Lg(s):new Pg(s)}}class Pc{constructor(s,c,h,m){this.expression=s,this.type=h,this.maxValue=0,this.paintVertexAttributes=c.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===h?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(s,c,h,m,b,w){const S=this.paintVertexArray.length,D=this.expression.evaluate(new z(0),c,{},b,m,w);this.paintVertexArray.resize(s),this._setPaintValue(S,s,D)}updatePaintArray(s,c,h,m,b){const w=this.expression.evaluate({zoom:0},h,m,void 0,b);this._setPaintValue(s,c,w)}_setPaintValue(s,c,h){if("color"===this.type){const m=Td(h);for(let b=s;b<c;b++)this.paintVertexArray.emplace(b,m[0],m[1])}else{for(let m=s;m<c;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class id{constructor(s,c,h,m,b,w){this.expression=s,this.uniformNames=c.map(S=>`u_${S}_t`),this.type=h,this.useIntegerZoom=m,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=c.map(S=>({name:`a_${S}`,type:"Float32",components:"color"===h?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(s,c,h,m,b,w){const S=this.expression.evaluate(new z(this.zoom),c,{},b,m,w),D=this.expression.evaluate(new z(this.zoom+1),c,{},b,m,w),k=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(k,s,S,D)}updatePaintArray(s,c,h,m,b){const w=this.expression.evaluate({zoom:this.zoom},h,m,void 0,b),S=this.expression.evaluate({zoom:this.zoom+1},h,m,void 0,b);this._setPaintValue(s,c,w,S)}_setPaintValue(s,c,h,m){if("color"===this.type){const b=Td(h),w=Td(m);for(let S=s;S<c;S++)this.paintVertexArray.emplace(S,b[0],b[1],w[0],w[1])}else{for(let b=s;b<c;b++)this.paintVertexArray.emplace(b,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c,h,m,b){const w=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,S=pr(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);c.set(s,b,S)}getBinding(s,c){return new Pg(s)}}class ou{constructor(s,c,h,m,b){this.expression=s,this.layerId=b,this.paintVertexAttributes=("array"===h?sc:nu).members;for(let w=0;w<c.length;++w);this.paintVertexArray=new m}populatePaintArray(s,c,h){const m=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(m,s,c.patterns&&c.patterns[this.layerId],h)}updatePaintArray(s,c,h,m,b,w){this._setPaintValues(s,c,h.patterns&&h.patterns[this.layerId],w)}_setPaintValues(s,c,h,m){if(!m||!h)return;const b=m[h];if(!b)return;const{tl:w,br:S,pixelRatio:D}=b;for(let k=s;k<c;k++)this.paintVertexArray.emplace(k,w[0],w[1],S[0],S[1],D)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ju{constructor(s,c,h=(()=>!0)){this.binders={},this._buffers=[];const m=[];for(const b in s.paint._values){if(!h(b))continue;const w=s.paint.get(b);if(!(w instanceof le&&qu(w.property.specification)))continue;const S=Vp(b,s.type),D=w.value,k=w.property.specification.type,N=!!w.property.useIntegerZoom,V="line-dasharray"===b||b.endsWith("pattern"),G="line-dasharray"===b&&"constant"!==s.layout.get("line-cap").value.kind;if("constant"!==D.kind||G)if("source"===D.kind||G||V){const q=qh(b,k,"source");this.binders[b]=V?new ou(D,S,k,q,s.id):new Pc(D,S,k,q),m.push(`/a_${b}`)}else{const q=qh(b,k,"composite");this.binders[b]=new id(D,S,k,N,c,q),m.push(`/z_${b}`)}else this.binders[b]=V?new Up(D.value,S):new If(D.value,S,k),m.push(`/u_${b}`)}this.cacheKey=m.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof Pc||c instanceof id?c.maxValue:0}populatePaintArrays(s,c,h,m,b,w){for(const S in this.binders){const D=this.binders[S];(D instanceof Pc||D instanceof id||D instanceof ou)&&D.populatePaintArray(s,c,h,m,b,w)}}setConstantPatternPositions(s){for(const c in this.binders){const h=this.binders[c];h instanceof Up&&h.setConstantPatternPositions(s)}}updatePaintArrays(s,c,h,m,b,w){let S=!1;for(const D in s){const k=c.getPositions(D);for(const N of k){const V=h.feature(N.index);for(const G in this.binders){const q=this.binders[G];if((q instanceof Pc||q instanceof id||q instanceof ou)&&!0===q.expression.isStateDependent){const Y=m.paint.get(G);q.expression=Y.value,q.updatePaintArray(N.start,N.end,V,s[D],b,w),S=!0}}}}return S}defines(){const s=[];for(const c in this.binders){const h=this.binders[c];(h instanceof If||h instanceof Up)&&s.push(...h.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return s}getBinderAttributes(){const s=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof Pc||h instanceof id||h instanceof ou)for(let m=0;m<h.paintVertexAttributes.length;m++)s.push(h.paintVertexAttributes[m].name)}return s}getBinderUniforms(){const s=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof If||h instanceof Up||h instanceof id)for(const m of h.uniformNames)s.push(m)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const c=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof If||m instanceof Up||m instanceof id)for(const b of m.uniformNames)c.push({name:b,property:h,binding:m.getBinding(s,b)})}return c}setUniforms(s,c,h,m,b){for(const{name:w,property:S,binding:D}of h)this.binders[S].setUniform(s,D,b,m.get(S),w)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const c=this.binders[s];(c instanceof Pc||c instanceof id||c instanceof ou)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(s){for(const c in this.binders){const h=this.binders[c];(h instanceof Pc||h instanceof id||h instanceof ou)&&h.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof Pc||c instanceof id||c instanceof ou)&&c.destroy()}}}class Qu{constructor(s,c,h=(()=>!0)){this.programConfigurations={};for(const m of s)this.programConfigurations[m.id]=new Ju(m,c,h);this.needsUpload=!1,this._featureMap=new Ol,this._bufferOffset=0}populatePaintArrays(s,c,h,m,b,w,S){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(s,c,m,b,w,S);void 0!==c.id&&this._featureMap.add(c.id,h,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,h,m,b){for(const w of h)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(s,this._featureMap,c,w,m,b)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const Fg={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Vp(l,s){return Fg[l]||[l.replace(`${s}-`,"").replace(/-/g,"_")]}const W1={"line-pattern":{source:tt,composite:tt},"fill-pattern":{source:tt,composite:tt},"fill-extrusion-pattern":{source:tt,composite:tt},"line-dasharray":{source:Mt,composite:Mt}},Os={color:{source:oc,composite:Rt},number:{source:no,composite:oc}};function qh(l,s,c){const h=W1[l];return h&&h[c]||Os[s][c]}Ii(If,"ConstantBinder"),Ii(Up,"PatternConstantBinder"),Ii(Pc,"SourceExpressionBinder"),Ii(ou,"PatternCompositeBinder"),Ii(id,"CompositeExpressionBinder"),Ii(Ju,"ProgramConfiguration",{omit:["_buffers"]}),Ii(Qu,"ProgramConfigurationSet");const cs="-transition";class qs extends Dh{constructor(s,c){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==s.type&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&"sky"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),c.layout&&(this._unevaluatedLayout=new pe(c.layout)),c.paint)){this._transitionablePaint=new K(c.paint);for(const h in s.paint)this.setPaintProperty(h,s.paint[h],{validate:!1});for(const h in s.layout)this.setLayoutProperty(h,s.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new me(c.paint)}}getLayoutProperty(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c,h={}){null!=c&&this._validate(px,`layers.${this.id}.layout.${s}`,s,c,h)||("visibility"!==s?this._unevaluatedLayout.setValue(s,c):this.visibility=c)}getPaintProperty(s){return go(s,cs)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c,h={}){if(null!=c&&this._validate(hx,`layers.${this.id}.paint.${s}`,s,c,h))return!1;if(go(s,cs))return this._transitionablePaint.setTransition(s.slice(0,-11),c||void 0),!1;{const m=this._transitionablePaint._values[s],b=m.value.isDataDriven(),w=m.value;this._transitionablePaint.setValue(s,c),this._handleSpecialPaintPropertyUpdate(s);const S=this._transitionablePaint._values[s].value,D=S.isDataDriven(),k=go(s,"pattern")||"line-dasharray"===s;return D||b||k||this._handleOverridablePaintPropertyUpdate(s,w,S)}}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getProgramConfiguration(s){return null}_handleOverridablePaintPropertyUpdate(s,c,h){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),vn(s,(c,h)=>!(void 0===c||"layout"===h&&!Object.keys(c).length||"paint"===h&&!Object.keys(c).length))}_validate(s,c,h,m,b={}){return(!b||!1!==b.validate)&&Bv(this,s.call(Wh,{key:c,layerType:this.type,objectKey:h,value:m,styleSpec:yt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof le&&qu(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Vh(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const $1=$e([{name:"a_pos",components:2,type:"Int16"}],4),Og=$e([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class As{constructor(s=[]){this.segments=s}prepareSegment(s,c,h,m){let b=this.segments[this.segments.length-1];return s>As.MAX_VERTEX_ARRAY_LENGTH&&_o(`Max vertices per segment is ${As.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!b||b.vertexLength+s>As.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==m)&&(b={vertexOffset:c.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},void 0!==m&&(b.sortKey=m),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,h,m){return new As([{vertexOffset:s,primitiveOffset:c,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}As.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ii(As,"SegmentVector");var Xi=8192;class eh{constructor(s,c){s&&(c?this.setSouthWest(s).setNorthEast(c):4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof kr?new kr(s.lng,s.lat):kr.convert(s),this}setSouthWest(s){return this._sw=s instanceof kr?new kr(s.lng,s.lat):kr.convert(s),this}extend(s){const c=this._sw,h=this._ne;let m,b;if(s instanceof kr)m=s,b=s;else{if(!(s instanceof eh))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(eh.convert(s)):this.extend(kr.convert(s)):"object"==typeof s&&null!==s&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(kr.convert(s)):this;if(m=s._sw,b=s._ne,!m||!b)return this}return c||h?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),h.lng=Math.max(b.lng,h.lng),h.lat=Math.max(b.lat,h.lat)):(this._sw=new kr(m.lng,m.lat),this._ne=new kr(b.lng,b.lat)),this}getCenter(){return new kr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new kr(this.getWest(),this.getNorth())}getSouthEast(){return new kr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:c,lat:h}=kr.convert(s);let m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&m}static convert(s){return!s||s instanceof eh?s:new eh(s)}}var kf=1e-6,Ns=typeof Float32Array<"u"?Float32Array:Array;function Vv(){var l=new Ns(9);return Ns!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function Va(l,s,c){var h=s[0],m=s[1],b=s[2],w=s[3],S=s[4],D=s[5],k=s[6],N=s[7],V=s[8],G=c[0],q=c[1],Y=c[2],Q=c[3],ae=c[4],ge=c[5],De=c[6],_e=c[7],Ae=c[8];return l[0]=G*h+q*w+Y*k,l[1]=G*m+q*S+Y*N,l[2]=G*b+q*D+Y*V,l[3]=Q*h+ae*w+ge*k,l[4]=Q*m+ae*S+ge*N,l[5]=Q*b+ae*D+ge*V,l[6]=De*h+_e*w+Ae*k,l[7]=De*m+_e*S+Ae*N,l[8]=De*b+_e*D+Ae*V,l}function Ds(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Dm(l,s){var c=s[0],h=s[1],m=s[2],b=s[3],w=s[4],S=s[5],D=s[6],k=s[7],N=s[8],V=s[9],G=s[10],q=s[11],Y=s[12],Q=s[13],ae=s[14],ge=s[15],De=c*S-h*w,_e=c*D-m*w,Ae=c*k-b*w,Ie=h*D-m*S,Le=h*k-b*S,st=m*k-b*D,nt=N*Q-V*Y,Et=N*ae-G*Y,Yt=N*ge-q*Y,ct=V*ae-G*Q,Pt=V*ge-q*Q,Lt=G*ge-q*ae,Gt=De*Lt-_e*Pt+Ae*ct+Ie*Yt-Le*Et+st*nt;return Gt?(l[0]=(S*Lt-D*Pt+k*ct)*(Gt=1/Gt),l[1]=(m*Pt-h*Lt-b*ct)*Gt,l[2]=(Q*st-ae*Le+ge*Ie)*Gt,l[3]=(G*Le-V*st-q*Ie)*Gt,l[4]=(D*Yt-w*Lt-k*Et)*Gt,l[5]=(c*Lt-m*Yt+b*Et)*Gt,l[6]=(ae*Ae-Y*st-ge*_e)*Gt,l[7]=(N*st-G*Ae+q*_e)*Gt,l[8]=(w*Pt-S*Yt+k*nt)*Gt,l[9]=(h*Yt-c*Pt-b*nt)*Gt,l[10]=(Y*Le-Q*Ae+ge*De)*Gt,l[11]=(V*Ae-N*Le-q*De)*Gt,l[12]=(S*Et-w*ct-D*nt)*Gt,l[13]=(c*ct-h*Et+m*nt)*Gt,l[14]=(Q*_e-Y*Ie-ae*De)*Gt,l[15]=(N*Ie-V*_e+G*De)*Gt,l):null}function Xh(l,s,c){var h=s[0],m=s[1],b=s[2],w=s[3],S=s[4],D=s[5],k=s[6],N=s[7],V=s[8],G=s[9],q=s[10],Y=s[11],Q=s[12],ae=s[13],ge=s[14],De=s[15],_e=c[0],Ae=c[1],Ie=c[2],Le=c[3];return l[0]=_e*h+Ae*S+Ie*V+Le*Q,l[1]=_e*m+Ae*D+Ie*G+Le*ae,l[2]=_e*b+Ae*k+Ie*q+Le*ge,l[3]=_e*w+Ae*N+Ie*Y+Le*De,l[4]=(_e=c[4])*h+(Ae=c[5])*S+(Ie=c[6])*V+(Le=c[7])*Q,l[5]=_e*m+Ae*D+Ie*G+Le*ae,l[6]=_e*b+Ae*k+Ie*q+Le*ge,l[7]=_e*w+Ae*N+Ie*Y+Le*De,l[8]=(_e=c[8])*h+(Ae=c[9])*S+(Ie=c[10])*V+(Le=c[11])*Q,l[9]=_e*m+Ae*D+Ie*G+Le*ae,l[10]=_e*b+Ae*k+Ie*q+Le*ge,l[11]=_e*w+Ae*N+Ie*Y+Le*De,l[12]=(_e=c[12])*h+(Ae=c[13])*S+(Ie=c[14])*V+(Le=c[15])*Q,l[13]=_e*m+Ae*D+Ie*G+Le*ae,l[14]=_e*b+Ae*k+Ie*q+Le*ge,l[15]=_e*w+Ae*N+Ie*Y+Le*De,l}function Zh(l,s,c){var h,m,b,w,S,D,k,N,V,G,q,Y,Q=c[0],ae=c[1],ge=c[2];return s===l?(l[12]=s[0]*Q+s[4]*ae+s[8]*ge+s[12],l[13]=s[1]*Q+s[5]*ae+s[9]*ge+s[13],l[14]=s[2]*Q+s[6]*ae+s[10]*ge+s[14],l[15]=s[3]*Q+s[7]*ae+s[11]*ge+s[15]):(m=s[1],b=s[2],w=s[3],S=s[4],D=s[5],k=s[6],N=s[7],V=s[8],G=s[9],q=s[10],Y=s[11],l[0]=h=s[0],l[1]=m,l[2]=b,l[3]=w,l[4]=S,l[5]=D,l[6]=k,l[7]=N,l[8]=V,l[9]=G,l[10]=q,l[11]=Y,l[12]=h*Q+S*ae+V*ge+s[12],l[13]=m*Q+D*ae+G*ge+s[13],l[14]=b*Q+k*ae+q*ge+s[14],l[15]=w*Q+N*ae+Y*ge+s[15]),l}function nd(l,s,c){var h=c[0],m=c[1],b=c[2];return l[0]=s[0]*h,l[1]=s[1]*h,l[2]=s[2]*h,l[3]=s[3]*h,l[4]=s[4]*m,l[5]=s[5]*m,l[6]=s[6]*m,l[7]=s[7]*m,l[8]=s[8]*b,l[9]=s[9]*b,l[10]=s[10]*b,l[11]=s[11]*b,l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15],l}function cy(l,s,c){var h=Math.sin(c),m=Math.cos(c),b=s[4],w=s[5],S=s[6],D=s[7],k=s[8],N=s[9],V=s[10],G=s[11];return s!==l&&(l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[3],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[4]=b*m+k*h,l[5]=w*m+N*h,l[6]=S*m+V*h,l[7]=D*m+G*h,l[8]=k*m-b*h,l[9]=N*m-w*h,l[10]=V*m-S*h,l[11]=G*m-D*h,l}function th(l,s,c){var h=Math.sin(c),m=Math.cos(c),b=s[0],w=s[1],S=s[2],D=s[3],k=s[8],N=s[9],V=s[10],G=s[11];return s!==l&&(l[4]=s[4],l[5]=s[5],l[6]=s[6],l[7]=s[7],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[0]=b*m-k*h,l[1]=w*m-N*h,l[2]=S*m-V*h,l[3]=D*m-G*h,l[8]=b*h+k*m,l[9]=w*h+N*m,l[10]=S*h+V*m,l[11]=D*h+G*m,l}function Im(l,s){return l[0]=s[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=s[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=s[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Hv(l,s,c){var h,m,b,w=c[0],S=c[1],D=c[2],k=Math.hypot(w,S,D);return k<kf?null:(w*=k=1/k,S*=k,D*=k,h=Math.sin(s),m=Math.cos(s),l[0]=w*w*(b=1-m)+m,l[1]=S*w*b+D*h,l[2]=D*w*b-S*h,l[3]=0,l[4]=w*S*b-D*h,l[5]=S*S*b+m,l[6]=D*S*b+w*h,l[7]=0,l[8]=w*D*b+S*h,l[9]=S*D*b-w*h,l[10]=D*D*b+m,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}Math.hypot||(Math.hypot=function(){for(var l=0,s=arguments.length;s--;)l+=arguments[s]*arguments[s];return Math.sqrt(l)});var Ng=Xh;function Yh(){var l=new Ns(3);return Ns!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function q1(l){var s=new Ns(3);return s[0]=l[0],s[1]=l[1],s[2]=l[2],s}function km(l){return Math.hypot(l[0],l[1],l[2])}function Rf(l,s,c){var h=new Ns(3);return h[0]=l,h[1]=s,h[2]=c,h}function su(l,s,c){return l[0]=s[0]+c[0],l[1]=s[1]+c[1],l[2]=s[2]+c[2],l}function Gv(l,s,c){return l[0]=s[0]-c[0],l[1]=s[1]-c[1],l[2]=s[2]-c[2],l}function Rm(l,s,c){return l[0]=s[0]*c[0],l[1]=s[1]*c[1],l[2]=s[2]*c[2],l}function ih(l,s,c){return l[0]=Math.min(s[0],c[0]),l[1]=Math.min(s[1],c[1]),l[2]=Math.min(s[2],c[2]),l}function Hp(l,s,c){return l[0]=Math.max(s[0],c[0]),l[1]=Math.max(s[1],c[1]),l[2]=Math.max(s[2],c[2]),l}function Nl(l,s,c){return l[0]=s[0]*c,l[1]=s[1]*c,l[2]=s[2]*c,l}function Gp(l,s,c,h){return l[0]=s[0]+c[0]*h,l[1]=s[1]+c[1]*h,l[2]=s[2]+c[2]*h,l}function Bs(l,s){var c=s[0],h=s[1],m=s[2],b=c*c+h*h+m*m;return b>0&&(b=1/Math.sqrt(b)),l[0]=s[0]*b,l[1]=s[1]*b,l[2]=s[2]*b,l}function Ad(l,s){return l[0]*s[0]+l[1]*s[1]+l[2]*s[2]}function Pm(l,s,c){var h=s[0],m=s[1],b=s[2],w=c[0],S=c[1],D=c[2];return l[0]=m*D-b*S,l[1]=b*w-h*D,l[2]=h*S-m*w,l}function ds(l,s,c){var h=s[0],m=s[1],b=s[2],w=c[3]*h+c[7]*m+c[11]*b+c[15];return l[0]=(c[0]*h+c[4]*m+c[8]*b+c[12])/(w=w||1),l[1]=(c[1]*h+c[5]*m+c[9]*b+c[13])/w,l[2]=(c[2]*h+c[6]*m+c[10]*b+c[14])/w,l}function jv(l,s,c){var h=c[0],m=c[1],b=c[2],w=s[0],S=s[1],D=s[2],k=m*D-b*S,N=b*w-h*D,V=h*S-m*w,G=m*V-b*N,q=b*k-h*V,Y=h*N-m*k,Q=2*c[3];return N*=Q,V*=Q,q*=2,Y*=2,l[0]=w+(k*=Q)+(G*=2),l[1]=S+N+q,l[2]=D+V+Y,l}var zs,Dd=Gv,Bg=Rm,Wv=km;function dy(l,s,c){return l[0]=s[0]*c,l[1]=s[1]*c,l[2]=s[2]*c,l[3]=s[3]*c,l}function uy(l,s){var c=s[0],h=s[1],m=s[2],b=s[3],w=c*c+h*h+m*m+b*b;return w>0&&(w=1/Math.sqrt(w)),l[0]=c*w,l[1]=h*w,l[2]=m*w,l[3]=b*w,l}function Kh(l,s,c){var h=s[0],m=s[1],b=s[2],w=s[3];return l[0]=c[0]*h+c[4]*m+c[8]*b+c[12]*w,l[1]=c[1]*h+c[5]*m+c[9]*b+c[13]*w,l[2]=c[2]*h+c[6]*m+c[10]*b+c[14]*w,l[3]=c[3]*h+c[7]*m+c[11]*b+c[15]*w,l}function nh(){var l=new Ns(4);return Ns!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function zg(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function Ug(l,s,c){c*=.5;var h=s[0],m=s[1],b=s[2],w=s[3],S=Math.sin(c),D=Math.cos(c);return l[0]=h*D+w*S,l[1]=m*D+b*S,l[2]=b*D-m*S,l[3]=w*D-h*S,l}function Vg(l,s,c){c*=.5;var h=s[0],m=s[1],b=s[2],w=s[3],S=Math.sin(c),D=Math.cos(c);return l[0]=h*D-b*S,l[1]=m*D+w*S,l[2]=b*D+h*S,l[3]=w*D-m*S,l}Yh(),zs=new Ns(4),Ns!=Float32Array&&(zs[0]=0,zs[1]=0,zs[2]=0,zs[3]=0);var Hg=uy;Yh(),Rf(1,0,0),Rf(0,1,0),nh(),nh(),Vv();const Lm=$e([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:wn}=Lm,au=$e([{name:"a_pos_3",components:3,type:"Int16"}]);var Pf=$e([{name:"a_pos",type:"Int16",components:2}]);class rh{constructor(s,c){this.pos=s,this.dir=c}intersectsPlane(s,c,h){const m=Ad(c,this.dir);if(Math.abs(m)<1e-6)return!1;const b=((s[0]-this.pos[0])*c[0]+(s[1]-this.pos[1])*c[1]+(s[2]-this.pos[2])*c[2])/m;return h[0]=this.pos[0]+this.dir[0]*b,h[1]=this.pos[1]+this.dir[1]*b,h[2]=this.pos[2]+this.dir[2]*b,!0}closestPointOnSphere(s,c,h){if(Q=(q=this.pos)[0],ae=q[1],ge=q[2],De=(Y=s)[0],_e=Y[1],Ae=Y[2],Math.abs(Q-De)<=kf*Math.max(1,Math.abs(Q),Math.abs(De))&&Math.abs(ae-_e)<=kf*Math.max(1,Math.abs(ae),Math.abs(_e))&&Math.abs(ge-Ae)<=kf*Math.max(1,Math.abs(ge),Math.abs(Ae))||0===c)return h[0]=h[1]=h[2]=0,!1;var q,Y,Q,ae,ge,De,_e,Ae;const[m,b,w]=this.dir,S=this.pos[0]-s[0],D=this.pos[1]-s[1],k=this.pos[2]-s[2],N=m*m+b*b+w*w,V=2*(S*m+D*b+k*w),G=V*V-4*N*(S*S+D*D+k*k-c*c);if(G<0){const q=Math.max(-V/2,0),Y=S+m*q,Q=D+b*q,ae=k+w*q,ge=Math.hypot(Y,Q,ae);return h[0]=Y*c/ge,h[1]=Q*c/ge,h[2]=ae*c/ge,!1}{const q=(-V-Math.sqrt(G))/(2*N);if(q<0){const Y=Math.hypot(S,D,k);return h[0]=S*c/Y,h[1]=D*c/Y,h[2]=k*c/Y,!1}return h[0]=S+m*q,h[1]=D+b*q,h[2]=k+w*q,!0}}}class hy{constructor(s,c,h,m,b){this.TL=s,this.TR=c,this.BR=h,this.BL=m,this.horizon=b}static fromInvProjectionMatrix(s,c,h){const m=[-1,1,1],b=[1,1,1],w=[1,-1,1],S=[-1,-1,1],D=ds(m,m,s),k=ds(b,b,s),N=ds(w,w,s),V=ds(S,S,s);return new hy(D,k,N,V,c/h)}}class oh{constructor(s,c){this.points=s,this.planes=c}static fromInvProjectionMatrix(s,c,h,m){const b=Math.pow(2,h),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const k=Kh([],D,s),N=1/k[3]/c*b;return(V=k)[0]=(G=k)[0]*(q=[N,N,m?1/k[3]:N,N])[0],V[1]=G[1]*q[1],V[2]=G[2]*q[2],V[3]=G[3]*q[3],V;var V,G,q}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const k=Bs([],Pm([],Dd([],w[D[0]],w[D[1]]),Dd([],w[D[2]],w[D[1]]))),N=-Ad(k,w[D[1]]);return k.concat(N)});return new oh(w,S)}}class ul{static fromPoints(s){const c=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const m of s)ih(c,c,m),Hp(h,h,m);return new ul(c,h)}static applyTransform(s,c){const h=s.getCorners();for(let m=0;m<h.length;++m)ds(h[m],h[m],c);return ul.fromPoints(h)}constructor(s,c){this.min=s,this.max=c,this.center=Nl([],su([],this.min,this.max),.5)}quadrant(s){const c=[s%2==0,s<2],h=q1(this.min),m=q1(this.max);for(let b=0;b<c.length;b++)h[b]=c[b]?this.min[b]:this.center[b],m[b]=c[b]?this.center[b]:this.max[b];return m[2]=this.max[2],new ul(h,m)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,c=this.max;return[[s[0],s[1],s[2]],[c[0],s[1],s[2]],[c[0],c[1],s[2]],[s[0],c[1],s[2]],[s[0],s[1],c[2]],[c[0],s[1],c[2]],[c[0],c[1],c[2]],[s[0],c[1],c[2]]]}intersects(s){const c=this.getCorners();let h=!0;for(let m=0;m<s.planes.length;m++){const b=s.planes[m];let w=0;for(let S=0;S<c.length;S++)w+=Ad(b,c[S])+b[3]>=0;if(0===w)return 0;w!==c.length&&(h=!1)}if(h)return 2;for(let m=0;m<3;m++){let b=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let S=0;S<s.points.length;S++){const D=s.points[S][m]-this.min[m];b=Math.min(b,D),w=Math.max(w,D)}if(w<0||b>this.max[m]-this.min[m])return 0}return 1}}const Gn=5,py=6,sh=Xi/Math.PI/2,$v=16383,lu=[64,32,16],hl=-sh,pl=sh,gx=[new ul([hl,hl,hl],[pl,pl,pl]),new ul([hl,hl,hl],[0,0,pl]),new ul([0,hl,hl],[pl,0,pl]),new ul([hl,0,hl],[0,pl,pl]),new ul([0,0,hl],[pl,pl,pl])];function Lc(l){return l*sh/rd}function Xs(l,s,c,h=!0){const m=Nl([],l._camera.position,l.worldSize),b=[s,c,1,1];Kh(b,b,l.pixelMatrixInverse),dy(b,b,1/b[3]);const w=Bs([],Dd([],b,m)),S=l.globeMatrix,D=[S[12],S[13],S[14]],k=Dd([],D,m),N=km(k),V=Bs([],k),G=l.worldSize/(2*Math.PI),q=Ad(V,w),Y=Math.asin(G/N);if(Y<Math.acos(q)){if(!h)return null;const Yt=[],ct=[];Nl(Yt,w,N/q),Bs(ct,Dd(ct,Yt,k)),Bs(w,su(w,k,Nl(w,ct,Math.tan(Y)*N)))}const Q=[];new rh(m,w).closestPointOnSphere(D,G,Q);const ae=Bs([],xc(S,0)),ge=Bs([],xc(S,1)),De=Bs([],xc(S,2)),_e=Ad(ae,Q),Ae=Ad(ge,Q),Ie=Ad(De,Q),Le=ia(Math.asin(-Ae/G));let st=ia(Math.atan2(_e,Ie));st=l.center.lng+function(Yt,ct){const Pt=(ct-Yt+180)%360-180;return Pt<-180?Pt+360:Pt}(l.center.lng,st);const nt=uu(st),Et=pr(lh(Le),0,1);return new Jh(nt,Et)}class _x{constructor(s,c,h){this.a=Dd([],s,h),this.b=Dd([],c,h),this.center=h;const m=Bs([],this.a),b=Bs([],this.b);this.angle=Math.acos(Ad(m,b))}}function qv(l,s){if(0===l.angle)return null;let c;return c=0===l.a[s]?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[s]/l.a[s]/Math.sin(l.angle)-1/Math.tan(l.angle)),c<0||c>1?null:function(h,m,b,w){const S=Math.sin(b);return h*(Math.sin((1-w)*b)/S)+m*(Math.sin(w*b)/S)}(l.a[s],l.b[s],l.angle,pr(c,0,1))+l.center[s]}function cu(l){if(l.z<=1)return gx[l.z+2*l.y+l.x];const s=Lf(fy(l));return ul.fromPoints(s)}function Fm(l,s,c){return Nl(l,l,1-c),Gp(l,l,s,c)}function X1(l,s){const c=du(s.zoom);if(0===c)return cu(l);const h=fy(l),m=Lf(h),b=uu(h.getWest())*s.worldSize,w=uu(h.getEast())*s.worldSize,S=lh(h.getNorth())*s.worldSize,D=lh(h.getSouth())*s.worldSize,k=[b,S,0],N=[w,S,0],V=[b,D,0],G=[w,D,0],q=Dm([],s.globeMatrix);return ds(k,k,q),ds(N,N,q),ds(V,V,q),ds(G,G,q),m[0]=Fm(m[0],V,c),m[1]=Fm(m[1],G,c),m[2]=Fm(m[2],N,c),m[3]=Fm(m[3],k,c),ul.fromPoints(m)}function Gg(l,s,c){for(const h of l)ds(h,h,s),Nl(h,h,c)}function fy({x:l,y:s,z:c}){const h=1/(1<<c),m=new kr(od(l*h),Ha((s+1)*h)),b=new kr(od((l+1)*h),Ha(s*h));return new eh(m,b)}function Lf(l){const s=er(l.getNorth()),c=er(l.getSouth()),h=Math.cos(s),m=Math.cos(c),b=Math.sin(s),w=Math.sin(c),S=l.getWest(),D=l.getEast();return[jg(m,w,S),jg(m,w,D),jg(h,b,D),jg(h,b,S)]}function jg(l,s,c,h=sh){return c=er(c),[l*Math.sin(c)*h,-s*h,l*Math.cos(c)*h]}function Wg(l,s,c){return jg(Math.cos(er(l)),Math.sin(er(l)),s,c)}function Is(l,s,c,h){const m=1<<c.z,b=(l/Xi+c.x)/m;return Wg(Ha((s/Xi+c.y)/m),od(b),h)}function $g({min:l,max:s}){return $v/Math.max(s[0]-l[0],s[1]-l[1],s[2]-l[2])}const Ff=new Float64Array(16);function qg(l){const s=$g(l),c=Im(Ff,[s,s,s]);return Zh(c,c,((h=[])[0]=-(m=l.min)[0],h[1]=-m[1],h[2]=-m[2],h));var h,m}function zl(l){const s=(h=l.min,(c=Ff)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=h[0],c[13]=h[1],c[14]=h[2],c[15]=1,c);var c,h;const m=1/$g(l);return nd(s,s,[m,m,m])}function Of(l,s,c,h,m){const b=function(D){const k=Xi/(2*Math.PI);return D/(2*Math.PI)/k}(c),w=[l,s,-c/(2*Math.PI)],S=Ds(new Float64Array(16));return Zh(S,S,w),nd(S,S,[b,b,b]),cy(S,S,er(-m)),th(S,S,er(-h)),S}function du(l){return Th(Gn,py,l)}function Nf(l,s){const c=Wg(s.lat,s.lng);return w=(m=Gv([],function(Y){const Q=Wg(Y._center.lat,Y._center.lng);let ae=Pm([],Rf(0,1,0),Q);const ge=Hv([],-Y.angle,Q);ae=ds(ae,ae,ge),Hv(ge,-Y._pitch,ae);const De=Bs([],Q);return Nl(De,De,Lc(Y.cameraToCenterDistance/Y.pixelsPerMeter)),ds(De,De,ge),su([],Q,De)}(l),c))[0],S=m[1],D=m[2],k=(b=c)[0],N=b[1],V=b[2],q=(G=Math.sqrt(w*w+S*S+D*D)*Math.sqrt(k*k+N*N+V*V))&&Ad(m,b)/G,Math.acos(Math.min(Math.max(q,-1),1));var m,b,w,S,D,k,N,V,G,q}function jp(l,s){return Nf(l,s)>Math.PI/2*1.01}const Xv=er(85),Zv=Math.cos(Xv),yx=Math.sin(Xv),rd=6371008.8,pa=2*Math.PI*rd;class ah{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ah(Cn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,h=this.lat*c,m=s.lat*c,b=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((s.lng-this.lng)*c);return rd*Math.acos(Math.min(b,1))}toBounds(s=0){const c=360*s/40075017,h=c/Math.cos(Math.PI/180*this.lat);return new eh(new ah(this.lng-h,this.lat-c),new ah(this.lng+h,this.lat+c))}toEcef(s){const c=Lc(s);return Wg(this.lat,this.lng,sh+c)}static convert(s){if(s instanceof ah)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new ah(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new ah(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var kr=ah;function vx(l){return pa*Math.cos(l*Math.PI/180)}function uu(l){return(180+l)/360}function lh(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function hu(l,s){return l/vx(s)}function od(l){return 360*l-180}function Ha(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function bx(l,s){return l*vx(Ha(s))}const Ga=85.051129;function my(l){return 1/Math.cos(l*Math.PI/180)}class Jh{constructor(s,c,h=0){this.x=+s,this.y=+c,this.z=+h}static fromLngLat(s,c=0){const h=kr.convert(s);return new Jh(uu(h.lng),lh(h.lat),hu(c,h.lat))}toLngLat(){return new kr(od(this.x),Ha(this.y))}toAltitude(){return bx(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/pa*my(Ha(this.y))}}function Yv(l,s,c,h,m,b,w,S,D){const k=(s+h)/2,N=(c+m)/2,V=new pi(k,N);S(V),function(G,q,Y,Q,ae,ge){const De=Y-ae,_e=Q-ge;return Math.abs((Q-q)*De-(Y-G)*_e)/Math.hypot(De,_e)}(V.x,V.y,b.x,b.y,w.x,w.y)>=D?(Yv(l,s,c,k,N,b,V,S,D),Yv(l,k,N,h,m,V,w,S,D)):l.push(w)}function Id(l,s,c){let h=l[0],m=h.x,b=h.y;s(h);const w=[h];for(let S=1;S<l.length;S++){const D=l[S],{x:k,y:N}=D;s(D),Yv(w,m,b,k,N,h,D,s,c),m=k,b=N,h=D}return w}function gy(l,s,c,h){if(h(s,c)){const m=s.add(c)._mult(.5);gy(l,s,m,h),gy(l,m,c,h)}else l.push(c)}function Qh(l,s){let c=l[0];const h=[c];for(let m=1;m<l.length;m++){const b=l[m];gy(h,c,b,s),c=b}return h}const Kv=Math.pow(2,14)-1,Jv=-Kv-1;function Qv(l,s){const c=Math.round(l.x*s),h=Math.round(l.y*s);return l.x=pr(c,Jv,Kv),l.y=pr(h,Jv,Kv),(c<l.x||c>l.x+1||h<l.y||h>l.y+1)&&_o("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function sd(l,s,c){const h=l.loadGeometry(),m=l.extent,b=Xi/m;if(s&&c&&c.projection.isReprojectedInTileSpace){const w=1<<s.z,{scale:S,x:D,y:k,projection:N}=c,V=G=>{const q=od((s.x+G.x/m)/w),Y=Ha((s.y+G.y/m)/w),Q=N.project(q,Y);G.x=(Q.x*S-D)*m,G.y=(Q.y*S-k)*m};for(let G=0;G<h.length;G++)if(1!==l.type)h[G]=Id(h[G],V,1);else{const q=[];for(const Y of h[G])Y.x<0||Y.x>=m||Y.y<0||Y.y>=m||(V(Y),q.push(Y));h[G]=q}}for(const w of h)for(const S of w)Qv(S,b);return h}function Wp(l,s){return{type:l.type,id:l.id,properties:l.properties,geometry:s?sd(l):[]}}function _y(l,s,c,h,m){l.emplaceBack(2*s+(h+1)/2,2*c+(m+1)/2)}function yy(l,s,c){l.emplaceBack(s.x,s.y,s.z,16384*c[0],16384*c[1],16384*c[2])}class $p{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new St,this.indexArray=new Bi,this.segments=new As,this.programConfigurations=new Qu(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,h,m){const b=this.layers[0],w=[];let S=null;"circle"===b.type&&(S=b.layout.get("circle-sort-key"));for(const{feature:k,id:N,index:V,sourceLayerIndex:G}of s){const q=this.layers[0]._featureFilter.needGeometry,Y=Wp(k,q);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),Y,h))continue;const Q=S?S.evaluate(Y,{},h):void 0,ae={id:N,properties:k.properties,type:k.type,sourceLayerIndex:G,index:V,geometry:q?Y.geometry:sd(k,h,m),patterns:{},sortKey:Q};w.push(ae)}S&&w.sort((k,N)=>k.sortKey-N.sortKey);let D=null;"globe"===m.projection.name&&(this.globeExtVertexArray=new Nt,D=m.projection);for(const k of w){const{geometry:N,index:V,sourceLayerIndex:G}=k,q=s[V].feature;this.addFeature(k,N,V,c.availableImages,h,D),c.featureIndex.insert(q,N,V,G,this.index)}}update(s,c,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,h,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,$1.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Og.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,c,h,m,b,w){for(const S of c)for(const D of S){const k=D.x,N=D.y;if(k<0||k>=Xi||N<0||N>=Xi)continue;if(w){const q=w.projectTilePoint(k,N,b),Y=w.upVector(b,k,N),Q=this.globeExtVertexArray;yy(Q,q,Y),yy(Q,q,Y),yy(Q,q,Y),yy(Q,q,Y)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),G=V.vertexLength;_y(this.layoutVertexArray,k,N,-1,-1),_y(this.layoutVertexArray,k,N,1,-1),_y(this.layoutVertexArray,k,N,1,1),_y(this.layoutVertexArray,k,N,-1,1),this.indexArray.emplaceBack(G,G+1,G+2),this.indexArray.emplaceBack(G,G+2,G+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,h,{},m,b)}}function Om(l,s){for(let c=0;c<l.length;c++)if(ch(s,l[c]))return!0;for(let c=0;c<s.length;c++)if(ch(l,s[c]))return!0;return!!eb(l,s)}function Y1(l,s,c){return!!ch(l,s)||!!vy(s,l,c)}function kd(l,s){if(1===l.length)return Mx(s,l[0]);for(let c=0;c<s.length;c++){const h=s[c];for(let m=0;m<h.length;m++)if(ch(l,h[m]))return!0}for(let c=0;c<l.length;c++)if(Mx(s,l[c]))return!0;for(let c=0;c<s.length;c++)if(eb(l,s[c]))return!0;return!1}function xx(l,s,c){if(l.length>1){if(eb(l,s))return!0;for(let h=0;h<s.length;h++)if(vy(s[h],l,c))return!0}for(let h=0;h<l.length;h++)if(vy(l[h],s,c))return!0;return!1}function eb(l,s){if(0===l.length||0===s.length)return!1;for(let c=0;c<l.length-1;c++){const h=l[c],m=l[c+1];for(let b=0;b<s.length-1;b++)if(YC(h,m,s[b],s[b+1]))return!0}return!1}function YC(l,s,c,h){return Kl(l,c,h)!==Kl(s,c,h)&&Kl(l,s,c)!==Kl(l,s,h)}function vy(l,s,c){const h=c*c;if(1===s.length)return l.distSqr(s[0])<h;for(let m=1;m<s.length;m++)if(wx(l,s[m-1],s[m])<h)return!0;return!1}function wx(l,s,c){const h=s.distSqr(c);if(0===h)return l.distSqr(s);const m=((l.x-s.x)*(c.x-s.x)+(l.y-s.y)*(c.y-s.y))/h;return l.distSqr(m<0?s:m>1?c:c.sub(s)._mult(m)._add(s))}function Mx(l,s){let c,h,m,b=!1;for(let w=0;w<l.length;w++){c=l[w];for(let S=0,D=c.length-1;S<c.length;D=S++)h=c[S],m=c[D],h.y>s.y!=m.y>s.y&&s.x<(m.x-h.x)*(s.y-h.y)/(m.y-h.y)+h.x&&(b=!b)}return b}function ch(l,s){let c=!1;for(let h=0,m=l.length-1;h<l.length;m=h++){const b=l[h],w=l[m];b.y>s.y!=w.y>s.y&&s.x<(w.x-b.x)*(s.y-b.y)/(w.y-b.y)+b.x&&(c=!c)}return c}function tb(l,s,c,h,m){for(const w of l)if(s<=w.x&&c<=w.y&&h>=w.x&&m>=w.y)return!0;const b=[new pi(s,c),new pi(s,m),new pi(h,m),new pi(h,c)];if(l.length>2)for(const w of b)if(ch(l,w))return!0;for(let w=0;w<l.length-1;w++)if(ib(l[w],l[w+1],b))return!0;return!1}function ib(l,s,c){const h=c[0],m=c[2];if(l.x<h.x&&s.x<h.x||l.x>m.x&&s.x>m.x||l.y<h.y&&s.y<h.y||l.y>m.y&&s.y>m.y)return!1;const b=Kl(l,s,c[0]);return b!==Kl(l,s,c[1])||b!==Kl(l,s,c[2])||b!==Kl(l,s,c[3])}function Bf(l,s,c){const h=s.paint.get(l).value;return"constant"===h.kind?h.value:c.programConfigurations.get(s.id).getMaxValue(l)}function nb(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function rb(l,s,c,h,m){if(!s[0]&&!s[1])return l;const b=pi.convert(s)._mult(m);"viewport"===c&&b._rotate(-h);const w=[];for(let S=0;S<l.length;S++)w.push(l[S].sub(b));return w}function K1(l,s,c,h){const m=pi.convert(l)._mult(h);return"viewport"===s&&m._rotate(-c),m}Ii($p,"CircleBucket",{omit:["layers"]});const J1=new xe({"circle-sort-key":new de(yt.layout_circle["circle-sort-key"])});var Q1={paint:new xe({"circle-radius":new de(yt.paint_circle["circle-radius"]),"circle-color":new de(yt.paint_circle["circle-color"]),"circle-blur":new de(yt.paint_circle["circle-blur"]),"circle-opacity":new de(yt.paint_circle["circle-opacity"]),"circle-translate":new J(yt.paint_circle["circle-translate"]),"circle-translate-anchor":new J(yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new J(yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new J(yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new de(yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new de(yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new de(yt.paint_circle["circle-stroke-opacity"])}),layout:J1};function by(l,s,c,h,m,b,w,S,D){if(b&&l.queryGeometry.isAboveHorizon)return!1;b&&(D*=l.pixelToTileUnitsFactor);const k=l.tileID.canonical,N=c.projection.upVectorScale(k,c.center.lat,c.worldSize).metersToTile;for(const V of s)for(const G of V){const q=G.add(S),Y=m&&c.elevation?c.elevation.exaggeration()*m.getElevationAt(q.x,q.y,!0):0,Q=c.projection.projectTilePoint(q.x,q.y,k);if(Y>0){const _e=c.projection.upVector(k,q.x,q.y);Q.x+=_e[0]*N*Y,Q.y+=_e[1]*N*Y,Q.z+=_e[2]*N*Y}const ae=b?q:KC(Q.x,Q.y,Q.z,h),ge=b?l.tilespaceRays.map(_e=>JC(_e,Y)):l.queryGeometry.screenGeometry,De=Kh([],[Q.x,Q.y,Q.z,1],h);if(!w&&b?D*=De[3]/c.cameraToCenterDistance:w&&!b&&(D*=c.cameraToCenterDistance/De[3]),b){const _e=Ha((G.y/Xi+k.y)/(1<<k.z));D/=c.projection.pixelsPerMeter(_e,1)/hu(1,_e)}if(Y1(ge,ae,D))return!0}return!1}function KC(l,s,c,h){const m=Kh([],[l,s,c,1],h);return new pi(m[0]/m[3],m[1]/m[3])}const eM=Rf(0,0,0),ob=Rf(0,0,1);function JC(l,s){const c=Yh();return eM[2]=s,l.intersectsPlane(eM,ob,c),new pi(c[0],c[1])}class tM extends $p{}function iM(l,{width:s,height:c},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==s*c*h)throw new RangeError("mismatched image size")}else m=new Uint8Array(s*c*h);return l.width=s,l.height=c,l.data=m,l}function nM(l,s,c){const{width:h,height:m}=s;h===l.width&&m===l.height||(Ex(l,s,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,h),height:Math.min(l.height,m)},c),l.width=h,l.height=m,l.data=s.data)}function Ex(l,s,c,h,m,b){if(0===m.width||0===m.height)return s;if(m.width>l.width||m.height>l.height||c.x>l.width-m.width||c.y>l.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||h.x>s.width-m.width||h.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const w=l.data,S=s.data;for(let D=0;D<m.height;D++){const k=((c.y+D)*l.width+c.x)*b,N=((h.y+D)*s.width+h.x)*b;for(let V=0;V<m.width*b;V++)S[N+V]=w[k+V]}return s}Ii(tM,"HeatmapBucket",{omit:["layers"]});class ep{constructor(s,c){iM(this,s,1,c)}resize(s){nM(this,new ep(s),1)}clone(){return new ep({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,h,m,b){Ex(s,c,h,m,b,1)}}class fl{constructor(s,c){iM(this,s,4,c)}resize(s){nM(this,new fl(s),4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new fl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,h,m,b){Ex(s,c,h,m,b,4)}}Ii(ep,"AlphaImage"),Ii(fl,"RGBAImage");var sb={paint:new xe({"heatmap-radius":new de(yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new de(yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new J(yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new be(yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new J(yt.paint_heatmap["heatmap-opacity"])})};function xy(l){const s={},c=l.resolution||256,h=l.clips?l.clips.length:1,m=l.image||new fl({width:c,height:h}),b=(w,S,D)=>{s[l.evaluationKey]=D;const k=l.expression.evaluate(s);m.data[w+S+0]=Math.floor(255*k.r/k.a),m.data[w+S+1]=Math.floor(255*k.g/k.a),m.data[w+S+2]=Math.floor(255*k.b/k.a),m.data[w+S+3]=Math.floor(255*k.a)};if(l.clips)for(let w=0,S=0;w<h;++w,S+=4*c)for(let D=0,k=0;D<c;D++,k+=4){const N=D/(c-1),{start:V,end:G}=l.clips[w];b(S,k,V*(1-N)+G*N)}else for(let w=0,S=0;w<c;w++,S+=4)b(0,S,w/(c-1));return m}var Cx={paint:new xe({"hillshade-illumination-direction":new J(yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new J(yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new J(yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new J(yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new J(yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new J(yt.paint_hillshade["hillshade-accent-color"])})};const wy=$e([{name:"a_pos",components:2,type:"Int16"}],4),{members:zf}=wy;var My={exports:{}};function Xg(l,s,c){c=c||2;var h,m,b,w,S,D,k,N=s&&s.length,V=N?s[0]*c:l.length,G=Zg(l,0,V,c,!0),q=[];if(!G||G.next===G.prev)return q;if(N&&(G=function(Q,ae,ge,De){var _e,Ae,Ie,Le=[];for(_e=0,Ae=ae.length;_e<Ae;_e++)(Ie=Zg(Q,ae[_e]*De,_e<Ae-1?ae[_e+1]*De:Q.length,De,!1))===Ie.next&&(Ie.steiner=!0),Le.push(Sx(Ie));for(Le.sort(lb),_e=0;_e<Le.length;_e++)ge=Ey(Le[_e],ge);return ge}(l,s,G,c)),l.length>80*c){h=b=l[0],m=w=l[1];for(var Y=c;Y<V;Y+=c)(S=l[Y])<h&&(h=S),(D=l[Y+1])<m&&(m=D),S>b&&(b=S),D>w&&(w=D);k=0!==(k=Math.max(b-h,w-m))?32767/k:0}return ja(G,q,c,h,m,k,0),q}function Zg(l,s,c,h,m){var b,w;if(m===pb(l,s,c,h)>0)for(b=s;b<c;b+=h)w=hb(b,l[b],l[b+1],w);else for(b=c-h;b>=s;b-=h)w=hb(b,l[b],l[b+1],w);return w&&Bm(w,w.next)&&(Yg(w),w=w.next),w}function dh(l,s){if(!l)return l;s||(s=l);var c,h=l;do{if(c=!1,h.steiner||!Bm(h,h.next)&&0!==qr(h.prev,h,h.next))h=h.next;else{if(Yg(h),(h=s=h.prev)===h.next)break;c=!0}}while(c||h!==s);return s}function ja(l,s,c,h,m,b,w){if(l){!w&&b&&function(N,V,G,q){var Y=N;do{0===Y.z&&(Y.z=cb(Y.x,Y.y,V,G,q)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next}while(Y!==N);Y.prevZ.nextZ=null,Y.prevZ=null,function(Q){var ae,ge,De,_e,Ae,Ie,Le,st,nt=1;do{for(ge=Q,Q=null,Ae=null,Ie=0;ge;){for(Ie++,De=ge,Le=0,ae=0;ae<nt&&(Le++,De=De.nextZ);ae++);for(st=nt;Le>0||st>0&&De;)0!==Le&&(0===st||!De||ge.z<=De.z)?(_e=ge,ge=ge.nextZ,Le--):(_e=De,De=De.nextZ,st--),Ae?Ae.nextZ=_e:Q=_e,_e.prevZ=Ae,Ae=_e;ge=De}Ae.nextZ=null,nt*=2}while(Ie>1)}(Y)}(l,h,m,b);for(var S,D,k=l;l.prev!==l.next;)if(S=l.prev,D=l.next,b?oM(l,h,m,b):rM(l))s.push(S.i/c|0),s.push(l.i/c|0),s.push(D.i/c|0),Yg(l),l=D.next,k=D.next;else if((l=D)===k){w?1===w?ja(l=sM(dh(l),s,c),s,c,h,m,b,2):2===w&&ab(l,s,c,h,m,b):ja(dh(l),s,c,h,m,b,1);break}}}function rM(l){var s=l.prev,c=l,h=l.next;if(qr(s,c,h)>=0)return!1;for(var m=s.x,b=c.x,w=h.x,S=s.y,D=c.y,k=h.y,N=m<b?m<w?m:w:b<w?b:w,V=S<D?S<k?S:k:D<k?D:k,G=m>b?m>w?m:w:b>w?b:w,q=S>D?S>k?S:k:D>k?D:k,Y=h.next;Y!==s;){if(Y.x>=N&&Y.x<=G&&Y.y>=V&&Y.y<=q&&Nm(m,S,b,D,w,k,Y.x,Y.y)&&qr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function oM(l,s,c,h){var m=l.prev,b=l,w=l.next;if(qr(m,b,w)>=0)return!1;for(var S=m.x,D=b.x,k=w.x,N=m.y,V=b.y,G=w.y,q=S<D?S<k?S:k:D<k?D:k,Y=N<V?N<G?N:G:V<G?V:G,Q=S>D?S>k?S:k:D>k?D:k,ae=N>V?N>G?N:G:V>G?V:G,ge=cb(q,Y,s,c,h),De=cb(Q,ae,s,c,h),_e=l.prevZ,Ae=l.nextZ;_e&&_e.z>=ge&&Ae&&Ae.z<=De;){if(_e.x>=q&&_e.x<=Q&&_e.y>=Y&&_e.y<=ae&&_e!==m&&_e!==w&&Nm(S,N,D,V,k,G,_e.x,_e.y)&&qr(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,Ae.x>=q&&Ae.x<=Q&&Ae.y>=Y&&Ae.y<=ae&&Ae!==m&&Ae!==w&&Nm(S,N,D,V,k,G,Ae.x,Ae.y)&&qr(Ae.prev,Ae,Ae.next)>=0))return!1;Ae=Ae.nextZ}for(;_e&&_e.z>=ge;){if(_e.x>=q&&_e.x<=Q&&_e.y>=Y&&_e.y<=ae&&_e!==m&&_e!==w&&Nm(S,N,D,V,k,G,_e.x,_e.y)&&qr(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Ae&&Ae.z<=De;){if(Ae.x>=q&&Ae.x<=Q&&Ae.y>=Y&&Ae.y<=ae&&Ae!==m&&Ae!==w&&Nm(S,N,D,V,k,G,Ae.x,Ae.y)&&qr(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.nextZ}return!0}function sM(l,s,c){var h=l;do{var m=h.prev,b=h.next.next;!Bm(m,b)&&db(m,h,h.next,b)&&tp(m,b)&&tp(b,m)&&(s.push(m.i/c|0),s.push(h.i/c|0),s.push(b.i/c|0),Yg(h),Yg(h.next),h=l=b),h=h.next}while(h!==l);return dh(h)}function ab(l,s,c,h,m,b){var w=l;do{for(var S=w.next.next;S!==w.prev;){if(w.i!==S.i&&lM(w,S)){var D=ub(w,S);return w=dh(w,w.next),D=dh(D,D.next),ja(w,s,c,h,m,b,0),void ja(D,s,c,h,m,b,0)}S=S.next}w=w.next}while(w!==l)}function lb(l,s){return l.x-s.x}function Ey(l,s){var c=function(m,b){var w,S=b,D=m.x,k=m.y,N=-1/0;do{if(k<=S.y&&k>=S.next.y&&S.next.y!==S.y){var V=S.x+(k-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(V<=D&&V>N&&(N=V,w=S.x<S.next.x?S:S.next,V===D))return w}S=S.next}while(S!==b);if(!w)return null;var G,q=w,Y=w.x,Q=w.y,ae=1/0;S=w;do{D>=S.x&&S.x>=Y&&D!==S.x&&Nm(k<Q?D:N,k,Y,Q,k<Q?N:D,k,S.x,S.y)&&(G=Math.abs(k-S.y)/(D-S.x),tp(S,m)&&(G<ae||G===ae&&(S.x>w.x||S.x===w.x&&aM(w,S)))&&(w=S,ae=G)),S=S.next}while(S!==q);return w}(l,s);if(!c)return s;var h=ub(c,l);return dh(h,h.next),dh(c,c.next)}function aM(l,s){return qr(l.prev,l,s.prev)<0&&qr(s.next,l,l.next)<0}function cb(l,s,c,h,m){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-c)*m|0)|l<<8))|l<<4))|l<<2))|l<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-h)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function Sx(l){var s=l,c=l;do{(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next}while(s!==l);return c}function Nm(l,s,c,h,m,b,w,S){return(m-w)*(s-S)>=(l-w)*(b-S)&&(l-w)*(h-S)>=(c-w)*(s-S)&&(c-w)*(b-S)>=(m-w)*(h-S)}function lM(l,s){return l.next.i!==s.i&&l.prev.i!==s.i&&!function(c,h){var m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==h.i&&m.next.i!==h.i&&db(m,m.next,c,h))return!0;m=m.next}while(m!==c);return!1}(l,s)&&(tp(l,s)&&tp(s,l)&&function(c,h){var m=c,b=!1,w=(c.x+h.x)/2,S=(c.y+h.y)/2;do{m.y>S!=m.next.y>S&&m.next.y!==m.y&&w<(m.next.x-m.x)*(S-m.y)/(m.next.y-m.y)+m.x&&(b=!b),m=m.next}while(m!==c);return b}(l,s)&&(qr(l.prev,l,s.prev)||qr(l,s.prev,s))||Bm(l,s)&&qr(l.prev,l,l.next)>0&&qr(s.prev,s,s.next)>0)}function qr(l,s,c){return(s.y-l.y)*(c.x-s.x)-(s.x-l.x)*(c.y-s.y)}function Bm(l,s){return l.x===s.x&&l.y===s.y}function db(l,s,c,h){var m=Ta(qr(l,s,c)),b=Ta(qr(l,s,h)),w=Ta(qr(c,h,l)),S=Ta(qr(c,h,s));return m!==b&&w!==S||!(0!==m||!zm(l,c,s))||!(0!==b||!zm(l,h,s))||!(0!==w||!zm(c,l,h))||!(0!==S||!zm(c,s,h))}function zm(l,s,c){return s.x<=Math.max(l.x,c.x)&&s.x>=Math.min(l.x,c.x)&&s.y<=Math.max(l.y,c.y)&&s.y>=Math.min(l.y,c.y)}function Ta(l){return l>0?1:l<0?-1:0}function tp(l,s){return qr(l.prev,l,l.next)<0?qr(l,s,l.next)>=0&&qr(l,l.prev,s)>=0:qr(l,s,l.prev)<0||qr(l,l.next,s)<0}function ub(l,s){var c=new Cy(l.i,l.x,l.y),h=new Cy(s.i,s.x,s.y),m=l.next,b=s.prev;return l.next=s,s.prev=l,c.next=m,m.prev=c,h.next=c,c.prev=h,b.next=h,h.prev=b,h}function hb(l,s,c,h){var m=new Cy(l,s,c);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function Yg(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Cy(l,s,c){this.i=l,this.x=s,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function pb(l,s,c,h){for(var m=0,b=s,w=c-h;b<c;b+=h)m+=(l[w]-l[b])*(l[b+1]+l[w+1]),w=b;return m}My.exports=Xg,My.exports.default=Xg,Xg.deviation=function(l,s,c,h){var m=s&&s.length,b=Math.abs(pb(l,0,m?s[0]*c:l.length,c));if(m)for(var w=0,S=s.length;w<S;w++)b-=Math.abs(pb(l,s[w]*c,w<S-1?s[w+1]*c:l.length,c));var D=0;for(w=0;w<h.length;w+=3){var k=h[w]*c,N=h[w+1]*c,V=h[w+2]*c;D+=Math.abs((l[k]-l[V])*(l[N+1]-l[k+1])-(l[k]-l[N])*(l[V+1]-l[k+1]))}return 0===b&&0===D?0:Math.abs((D-b)/b)},Xg.flatten=function(l){for(var s=l[0][0].length,c={vertices:[],holes:[],dimensions:s},h=0,m=0;m<l.length;m++){for(var b=0;b<l[m].length;b++)for(var w=0;w<s;w++)c.vertices.push(l[m][b][w]);m>0&&c.holes.push(h+=l[m-1].length)}return c};var Kg=Jo(My.exports);function Tx(l,s,c,h,m){fb(l,s,c||0,h||l.length-1,m||cM)}function fb(l,s,c,h,m){for(;h>c;){if(h-c>600){var b=h-c+1,w=s-c+1,S=Math.log(b),D=.5*Math.exp(2*S/3),k=.5*Math.sqrt(S*D*(b-D)/b)*(w-b/2<0?-1:1);fb(l,s,Math.max(c,Math.floor(s-w*D/b+k)),Math.min(h,Math.floor(s+(b-w)*D/b+k)),m)}var N=l[s],V=c,G=h;for(Jg(l,c,s),m(l[h],N)>0&&Jg(l,c,h);V<G;){for(Jg(l,V,G),V++,G--;m(l[V],N)<0;)V++;for(;m(l[G],N)>0;)G--}0===m(l[c],N)?Jg(l,c,G):Jg(l,++G,h),G<=s&&(c=G+1),s<=G&&(h=G-1)}}function Jg(l,s,c){var h=l[s];l[s]=l[c],l[c]=h}function cM(l,s){return l<s?-1:l>s?1:0}function Qg(l,s){const c=l.length;if(c<=1)return[l];const h=[];let m,b;for(let w=0;w<c;w++){const S=Tl(l[w]);0!==S&&(l[w].area=Math.abs(S),void 0===b&&(b=S<0),b===S<0?(m&&h.push(m),m=[l[w]]):m.push(l[w]))}if(m&&h.push(m),s>1)for(let w=0;w<h.length;w++)h[w].length<=s||(Tx(h[w],s,1,h[w].length-1,Um),h[w]=h[w].slice(0,s));return h}function Um(l,s){return s.area-l.area}function mb(l,s,c){const h=c.patternDependencies;let m=!1;for(const b of s){const w=b.paint.get(`${l}-pattern`);w.isConstant()||(m=!0);const S=w.constantOr(null);S&&(m=!0,h[S]=!0)}return m}function Uf(l,s,c,h,m){const b=m.patternDependencies;for(const w of s){const S=w.paint.get(`${l}-pattern`).value;if("constant"!==S.kind){let D=S.evaluate({zoom:h},c,{},m.availableImages);D=D&&D.name?D.name:D,b[D]=!0,c.patterns[w.id]=D}}return c}class Sy{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new St,this.indexArray=new Bi,this.indexArray2=new ua,this.programConfigurations=new Qu(s.layers,s.zoom),this.segments=new As,this.segments2=new As,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=s.projection}populate(s,c,h,m){this.hasPattern=mb("fill",this.layers,c);const b=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:S,id:D,index:k,sourceLayerIndex:N}of s){const V=this.layers[0]._featureFilter.needGeometry,G=Wp(S,V);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),G,h))continue;const q=b?b.evaluate(G,{},h,c.availableImages):void 0,Y={id:D,properties:S.properties,type:S.type,sourceLayerIndex:N,index:k,geometry:V?G.geometry:sd(S,h,m),patterns:{},sortKey:q};w.push(Y)}b&&w.sort((S,D)=>S.sortKey-D.sortKey);for(const S of w){const{geometry:D,index:k,sourceLayerIndex:N}=S;if(this.hasPattern){const V=Uf("fill",this.layers,S,this.zoom,c);this.patternFeatures.push(V)}else this.addFeature(S,D,k,h,{},c.availableImages);c.featureIndex.insert(s[k].feature,D,k,N,this.index)}}update(s,c,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,h,m)}addFeatures(s,c,h,m,b){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,c,h,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,zf),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,c,h,m,b,w=[]){for(const S of Qg(c,500)){let D=0;for(const Y of S)D+=Y.length;const k=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),N=k.vertexLength,V=[],G=[];for(const Y of S){if(0===Y.length)continue;Y!==S[0]&&G.push(V.length/2);const Q=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),ae=Q.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(ae+Y.length-1,ae),V.push(Y[0].x),V.push(Y[0].y);for(let ge=1;ge<Y.length;ge++)this.layoutVertexArray.emplaceBack(Y[ge].x,Y[ge].y),this.indexArray2.emplaceBack(ae+ge-1,ae+ge),V.push(Y[ge].x),V.push(Y[ge].y);Q.vertexLength+=Y.length,Q.primitiveLength+=Y.length}const q=Kg(V,G);for(let Y=0;Y<q.length;Y+=3)this.indexArray.emplaceBack(N+q[Y],N+q[Y+1],N+q[Y+2]);k.vertexLength+=D,k.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,h,b,w,m)}}Ii(Sy,"FillBucket",{omit:["layers","patternFeatures"]});const dM=new xe({"fill-sort-key":new de(yt.layout_fill["fill-sort-key"])});var Ax={paint:new xe({"fill-antialias":new J(yt.paint_fill["fill-antialias"]),"fill-opacity":new de(yt.paint_fill["fill-opacity"]),"fill-color":new de(yt.paint_fill["fill-color"]),"fill-outline-color":new de(yt.paint_fill["fill-outline-color"]),"fill-translate":new J(yt.paint_fill["fill-translate"]),"fill-translate-anchor":new J(yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new de(yt.paint_fill["fill-pattern"])}),layout:dM};const Dx=$e([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Ix=$e([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Vm=$e([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Ty}=Dx;var e_={},gb=Sl,qp=Hm;function Hm(l,s,c,h,m){this.properties={},this.extent=c,this.type=0,this._pbf=l,this._geometry=-1,this._keys=h,this._values=m,l.readFields(kx,this,s)}function kx(l,s,c){1==l?s.id=c.readVarint():2==l?function(h,m){for(var b=h.readVarint()+h.pos;h.pos<b;){var w=m._keys[h.readVarint()],S=m._values[h.readVarint()];m.properties[w]=S}}(c,s):3==l?s.type=c.readVarint():4==l&&(s._geometry=c.pos)}function Rx(l){for(var s,c,h=0,m=0,b=l.length,w=b-1;m<b;w=m++)h+=((c=l[w]).x-(s=l[m]).x)*(s.y+c.y);return h}Hm.types=["Unknown","Point","LineString","Polygon"],Hm.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var s,c=l.readVarint()+l.pos,h=1,m=0,b=0,w=0,S=[];l.pos<c;){if(m<=0){var D=l.readVarint();h=7&D,m=D>>3}if(m--,1===h||2===h)b+=l.readSVarint(),w+=l.readSVarint(),1===h&&(s&&S.push(s),s=[]),s.push(new gb(b,w));else{if(7!==h)throw new Error("unknown command "+h);s&&s.push(s[0].clone())}}return s&&S.push(s),S},Hm.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var s=l.readVarint()+l.pos,c=1,h=0,m=0,b=0,w=1/0,S=-1/0,D=1/0,k=-1/0;l.pos<s;){if(h<=0){var N=l.readVarint();c=7&N,h=N>>3}if(h--,1===c||2===c)(m+=l.readSVarint())<w&&(w=m),m>S&&(S=m),(b+=l.readSVarint())<D&&(D=b),b>k&&(k=b);else if(7!==c)throw new Error("unknown command "+c)}return[w,D,S,k]},Hm.prototype.toGeoJSON=function(l,s,c){var h,m,b=this.extent*Math.pow(2,c),w=this.extent*l,S=this.extent*s,D=this.loadGeometry(),k=Hm.types[this.type];function N(q){for(var Y=0;Y<q.length;Y++){var Q=q[Y];q[Y]=[360*(Q.x+w)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+S)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(h=0;h<D.length;h++)V[h]=D[h][0];N(D=V);break;case 2:for(h=0;h<D.length;h++)N(D[h]);break;case 3:for(D=function(q){var Y=q.length;if(Y<=1)return[q];for(var Q,ae,ge=[],De=0;De<Y;De++){var _e=Rx(q[De]);0!==_e&&(void 0===ae&&(ae=_e<0),ae===_e<0?(Q&&ge.push(Q),Q=[q[De]]):Q.push(q[De]))}return Q&&ge.push(Q),ge}(D),h=0;h<D.length;h++)for(m=0;m<D[h].length;m++)N(D[h][m])}1===D.length?D=D[0]:k="Multi"+k;var G={type:"Feature",geometry:{type:k,coordinates:D},properties:this.properties};return"id"in this&&(G.id=this.id),G};var _b=qp,yb=vb;function vb(l,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(bb,this,s),this.length=this._features.length}function bb(l,s,c){15===l?s.version=c.readVarint():1===l?s.name=c.readString():5===l?s.extent=c.readVarint():2===l?s._features.push(c.pos):3===l?s._keys.push(c.readString()):4===l&&s._values.push(function(h){for(var m=null,b=h.readVarint()+h.pos;h.pos<b;){var w=h.readVarint()>>3;m=1===w?h.readString():2===w?h.readFloat():3===w?h.readDouble():4===w?h.readVarint64():5===w?h.readVarint():6===w?h.readSVarint():7===w?h.readBoolean():null}return m}(c))}vb.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var s=this._pbf.readVarint()+this._pbf.pos;return new _b(this._pbf,s,this.extent,this._keys,this._values)};var Ay=yb;function Px(l,s,c){if(3===l){var h=new Ay(c,c.readVarint()+c.pos);h.length&&(s[h.name]=h)}}var t_=e_.VectorTile=function(l,s){this.layers=l.readFields(Px,{},s)},Dy=e_.VectorTileFeature=qp;function Vf(l,s,c,h){const m=[],b=0===h?(w,S,D,k,N,V)=>{w.push(new pi(V,D+(V-S)/(k-S)*(N-D)))}:(w,S,D,k,N,V)=>{w.push(new pi(S+(V-D)/(N-D)*(k-S),V))};for(const w of l){const S=[];for(const D of w){if(D.length<=2)continue;const k=[];for(let G=0;G<D.length-1;G++){const q=D[G].x,Y=D[G].y,Q=D[G+1].x,ae=D[G+1].y,ge=0===h?q:Y,De=0===h?Q:ae;ge<s?De>s&&b(k,q,Y,Q,ae,s):ge>c?De<c&&b(k,q,Y,Q,ae,c):k.push(D[G]),De<s&&ge>=s&&b(k,q,Y,Q,ae,s),De>c&&ge<=c&&b(k,q,Y,Q,ae,c)}let N=D[D.length-1];const V=0===h?N.x:N.y;V>=s&&V<=c&&k.push(N),k.length&&(N=k[k.length-1],k[0].x===N.x&&k[0].y===N.y||k.push(k[0]),S.push(k))}S.length&&m.push(S)}return m}e_.VectorTileLayer=yb;const Gm=Dy.types,Lx=Math.pow(2,13);function pu(l,s,c,h,m,b,w,S){l.emplaceBack((s<<1)+w,(c<<1)+b,(Math.floor(h*Lx)<<1)+m,Math.round(S))}function Xp(l,s,c){l.emplaceBack(s.x,s.y,s.z,16384*c[0],16384*c[1],16384*c[2])}class Iy{constructor(){this.acc=new pi(0,0),this.polyCount=[]}startRing(s){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new pi(s.x,s.y),this.max=new pi(s.x,s.y))}append(s,c){this.currentPolyCount.edges++,this.acc._add(s);const h=this.min,m=this.max;s.x<h.x?h.x=s.x:s.x>m.x&&(m.x=s.x),s.y<h.y?h.y=s.y:s.y>m.y&&(m.y=s.y),((0===s.x||s.x===Xi)&&s.x===c.x)!=((0===s.y||s.y===Xi)&&s.y===c.y)&&this.processBorderOverlap(s,c),c.x<0!=s.x<0&&this.addBorderIntersection(0,Mr(c.y,s.y,(0-c.x)/(s.x-c.x))),c.x>Xi!=s.x>Xi&&this.addBorderIntersection(1,Mr(c.y,s.y,(Xi-c.x)/(s.x-c.x))),c.y<0!=s.y<0&&this.addBorderIntersection(2,Mr(c.x,s.x,(0-c.y)/(s.y-c.y))),c.y>Xi!=s.y>Xi&&this.addBorderIntersection(3,Mr(c.x,s.x,(Xi-c.y)/(s.y-c.y)))}addBorderIntersection(s,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[s];c<h[0]&&(h[0]=c),c>h[1]&&(h[1]=c)}processBorderOverlap(s,c){if(s.x===c.x){if(s.y===c.y)return;const h=0===s.x?0:1;this.addBorderIntersection(h,c.y),this.addBorderIntersection(h,s.y)}else{const h=0===s.y?2:3;this.addBorderIntersection(h,c.x),this.addBorderIntersection(h,s.x)}}centroid(){const s=this.polyCount.reduce((c,h)=>c+h.edges,0);return 0!==s?this.acc.div(s)._round():new pi(0,0)}span(){return new pi(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((s,c)=>s+ +(c[0]!==Number.MAX_VALUE),0)}}class i_{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.layoutVertexArray=new vt,this.centroidVertexArray=new Ho,this.indexArray=new Bi,this.programConfigurations=new Qu(s.layers,s.zoom),this.segments=new As,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=s.enableTerrain}populate(s,c,h,m){this.features=[],this.hasPattern=mb("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(b){const w=Math.exp(Math.PI*(1-b.y/(1<<b.z)*2));return 80150034*w/(w*w+1)/Xi/(1<<b.z)}(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:b,id:w,index:S,sourceLayerIndex:D}of s){const k=this.layers[0]._featureFilter.needGeometry,N=Wp(b,k);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),N,h))continue;const V={id:w,sourceLayerIndex:D,index:S,geometry:k?N.geometry:sd(b,h,m),properties:b.properties,type:b.type,patterns:{}},G=this.layoutVertexArray.length;this.hasPattern?this.features.push(Uf("fill-extrusion",this.layers,V,this.zoom,c)):this.addFeature(V,V.geometry,S,h,{},c.availableImages,m),c.featureIndex.insert(b,V.geometry,S,D,this.index,G)}this.sortBorders()}addFeatures(s,c,h,m,b){for(const w of this.features){const{geometry:S}=w;this.addFeature(w,S,w.index,c,h,m,b)}this.sortBorders()}update(s,c,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,h,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Ty),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,Vm.members,!0))),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,Ix.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,h,m,b,w,S){const D=[new pi(0,0),new pi(Xi,Xi)],k=S.projection,N="globe"===k.name,V=this.enableTerrain&&!N?new Iy:null,G="Polygon"===Gm[s.type];N&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Nt);const q=Qg(c,500);for(let ge=q.length-1;ge>=0;ge--){const De=q[ge];(0===De.length||(Y=De[0]).every(_e=>_e.x<=0)||Y.every(_e=>_e.x>=Xi)||Y.every(_e=>_e.y<=0)||Y.every(_e=>_e.y>=Xi))&&q.splice(ge,1)}var Y;let Q;if(N)Q=Eb(q,D,m);else{Q=[];for(const ge of q)Q.push({polygon:ge,bounds:D})}const ae=G?this.edgeRadius:0;for(const{polygon:ge,bounds:De}of Q){let _e=0,Ae=0;for(const Le of ge)G&&!Le[0].equals(Le[Le.length-1])&&Le.push(Le[0]),Ae+=G?Le.length-1:Le.length;const Ie=this.segments.prepareSegment((G?5:4)*Ae,this.layoutVertexArray,this.indexArray);if(G){const Le=[],st=[];_e=Ie.vertexLength;for(const Et of ge){let Yt,ct;Et.length&&Et!==ge[0]&&st.push(Le.length/2),Yt=Et[1].sub(Et[0])._perp()._unit();for(let Pt=1;Pt<Et.length;Pt++){const Lt=Et[Pt],Gt=Et[Pt===Et.length-1?1:Pt+1];let{x:ai,y:bt}=Lt;if(ae){ct=Gt.sub(Lt)._perp()._unit();const _i=Yt.add(ct)._unit(),Ri=ae*Math.min(4,1/(Yt.x*_i.x+Yt.y*_i.y));ai+=Ri*_i.x,bt+=Ri*_i.y,Yt=ct}pu(this.layoutVertexArray,ai,bt,0,0,1,1,0),Ie.vertexLength++,Le.push(Lt.x,Lt.y),N&&Xp(this.layoutVertexExtArray,k.projectTilePoint(ai,bt,m),k.upVector(m,ai,bt))}}const nt=Kg(Le,st);for(let Et=0;Et<nt.length;Et+=3)this.indexArray.emplaceBack(_e+nt[Et],_e+nt[Et+2],_e+nt[Et+1]),Ie.primitiveLength++}for(const Le of ge){V&&Le.length&&V.startRing(Le[0]);let st,nt,Et,Yt=Le.length>4&&wb(Le[Le.length-2],Le[0],Le[1]),ct=ae?ky(Le[Le.length-2],Le[0],Le[1],ae):0;nt=Le[1].sub(Le[0])._perp()._unit();let Pt=!0;for(let Lt=1,Gt=0;Lt<Le.length;Lt++){let ai=Le[Lt-1],bt=Le[Lt];const _i=Le[Lt===Le.length-1?1:Lt+1];if(V&&G&&V.currentPolyCount.top++,xb(bt,ai,De)){ae&&(nt=_i.sub(bt)._perp()._unit(),Pt=!Pt);continue}V&&V.append(bt,ai);const Ri=bt.sub(ai)._perp(),bi=Ri.x/(Math.abs(Ri.x)+Math.abs(Ri.y)),$n=Ri.y>0?1:0,li=ai.dist(bt);if(Gt+li>32768&&(Gt=0),ae){Et=_i.sub(bt)._perp()._unit();let qn=Fx(ai,bt,_i,uM(nt,Et),ae);isNaN(qn)&&(qn=0);const cn=bt.sub(ai)._unit();ai=ai.add(cn.mult(ct))._round(),bt=bt.add(cn.mult(-qn))._round(),ct=qn,nt=Et}const en=Ie.vertexLength,fn=Le.length>4&&wb(ai,bt,_i);let Rr=Mb(Gt,Yt,Pt);if(pu(this.layoutVertexArray,ai.x,ai.y,bi,$n,0,0,Rr),pu(this.layoutVertexArray,ai.x,ai.y,bi,$n,0,1,Rr),Gt+=li,Rr=Mb(Gt,fn,!Pt),Yt=fn,pu(this.layoutVertexArray,bt.x,bt.y,bi,$n,0,0,Rr),pu(this.layoutVertexArray,bt.x,bt.y,bi,$n,0,1,Rr),Ie.vertexLength+=4,this.indexArray.emplaceBack(en+0,en+1,en+2),this.indexArray.emplaceBack(en+1,en+3,en+2),Ie.primitiveLength+=2,ae){const qn=_e+(1===Lt?Le.length-2:Lt-2),cn=1===Lt?_e:qn+1;if(this.indexArray.emplaceBack(en+1,qn,en+3),this.indexArray.emplaceBack(qn,cn,en+3),Ie.primitiveLength+=2,void 0===st&&(st=en),!xb(_i,Le[Lt],De)){const Go=Lt===Le.length-1?st:Ie.vertexLength;this.indexArray.emplaceBack(en+2,en+3,Go),this.indexArray.emplaceBack(en+3,Go+1,Go),this.indexArray.emplaceBack(en+3,cn,Go+1),Ie.primitiveLength+=3}Pt=!Pt}if(N){const qn=this.layoutVertexExtArray,cn=k.projectTilePoint(ai.x,ai.y,m),Go=k.projectTilePoint(bt.x,bt.y,m),Xn=k.upVector(m,ai.x,ai.y),Zn=k.upVector(m,bt.x,bt.y);Xp(qn,cn,Xn),Xp(qn,cn,Xn),Xp(qn,Go,Zn),Xp(qn,Go,Zn)}}G&&(_e+=Le.length-1)}}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;const ge=V.borders,De=this.featuresOnBorder.push(V)-1;for(let _e=0;_e<4;_e++)ge[_e][0]!==Number.MAX_VALUE&&this.borders[_e].push(De)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,h,b,w,m)}sortBorders(){for(let s=0;s<4;s++)this.borders[s].sort((c,h)=>this.featuresOnBorder[c].borders[s][0]-this.featuresOnBorder[h].borders[s][0])}encodeCentroid(s,c,h=!0){let m,b;if(s)if(0!==s.y){const S=c.span()._mult(this.tileToMeter);m=(Math.max(s.x,1)<<3)+Math.min(7,Math.round(S.x/10)),b=(Math.max(s.y,1)<<3)+Math.min(7,Math.round(S.y/10))}else m=Math.ceil(7*(s.x+450)),b=0;else m=0,b=+h;let w=h?this.centroidVertexArray.length:c.vertexArrayOffset;for(const S of c.polyCount){h&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*S.edges+S.top);for(let D=0;D<S.top;D++)this.centroidVertexArray.emplace(w++,m,b);for(let D=0;D<2*S.edges;D++)this.centroidVertexArray.emplace(w++,0,b),this.centroidVertexArray.emplace(w++,m,b)}}}function uM(l,s){const c=l.add(s)._unit();return l.x*c.x+l.y*c.y}function ky(l,s,c,h){const m=s.sub(l)._perp()._unit(),b=c.sub(s)._perp()._unit();return Fx(l,s,c,uM(m,b),h)}function Fx(l,s,c,h,m){const b=Math.sqrt(1-h*h);return Math.min(l.dist(s)/3,s.dist(c)/3,m*b/h)}function xb(l,s,c){return l.x<c[0].x&&s.x<c[0].x||l.x>c[1].x&&s.x>c[1].x||l.y<c[0].y&&s.y<c[0].y||l.y>c[1].y&&s.y>c[1].y}function wb(l,s,c){if(l.x<0||l.x>=Xi||s.x<0||s.x>=Xi||c.x<0||c.x>=Xi)return!1;const h=c.sub(s),m=h.perp(),b=l.sub(s);return(h.x*b.x+h.y*b.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(b.x*b.x+b.y*b.y))>-.866&&m.x*b.x+m.y*b.y<0}function Mb(l,s,c){const h=s?2|l:-3&l;return c?1|h:-2&h}function Ry(){const l=Math.PI/32,s=Math.tan(l),c=rd;return c*Math.sqrt(1+2*s*s)-c}function Eb(l,s,c){const h=1<<c.z,m=od(c.x/h),b=od((c.x+1)/h),w=Ha(c.y/h),S=Ha((c.y+1)/h);return function(D,k,N,V,G=0,q){const Y=[];if(!D.length||!N||!V)return Y;const Q=(Le,st)=>{for(const nt of Le)Y.push({polygon:nt,bounds:st})},ae=Math.ceil(Math.log2(N)),ge=Math.ceil(Math.log2(V)),De=ae-ge,_e=[];for(let Le=0;Le<Math.abs(De);Le++)_e.push(De>0?0:1);for(let Le=0;Le<Math.min(ae,ge);Le++)_e.push(0),_e.push(1);let Ae=D;if(Ae=Vf(Ae,k[0].y-G,k[1].y+G,1),Ae=Vf(Ae,k[0].x-G,k[1].x+G,0),!Ae.length)return Y;const Ie=[];for(_e.length?Ie.push({polygons:Ae,bounds:k,depth:0}):Q(Ae,k);Ie.length;){const Le=Ie.pop(),st=Le.depth,nt=_e[st],Et=Le.bounds[0],Yt=Le.bounds[1],ct=0===nt?Et.x:Et.y,Pt=0===nt?Yt.x:Yt.y,Lt=q?q(nt,ct,Pt):.5*(ct+Pt),Gt=Vf(Le.polygons,ct-G,Lt+G,nt),ai=Vf(Le.polygons,Lt-G,Pt+G,nt);if(Gt.length){const bt=[Et,new pi(0===nt?Lt:Yt.x,1===nt?Lt:Yt.y)];_e.length>st+1?Ie.push({polygons:Gt,bounds:bt,depth:st+1}):Q(Gt,bt)}if(ai.length){const bt=[new pi(0===nt?Lt:Et.x,1===nt?Lt:Et.y),Yt];_e.length>st+1?Ie.push({polygons:ai,bounds:bt,depth:st+1}):Q(ai,bt)}}return Y}(l,s,Math.ceil((b-m)/11.25),Math.ceil((w-S)/11.25),1,(D,k,N)=>{if(0===D)return.5*(k+N);{const V=Ha((c.y+k/Xi)/h);return(lh(.5*(Ha((c.y+N/Xi)/h)+V))*h-c.y)*Xi}})}Ii(i_,"FillExtrusionBucket",{omit:["layers","features"]}),Ii(Iy,"PartMetadata");const Py=new xe({"fill-extrusion-edge-radius":new J(yt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var n_={paint:new xe({"fill-extrusion-opacity":new J(yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new de(yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new J(yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new J(yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new de(yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new de(yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new de(yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new J(yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new J(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new J(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new J(yt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Py};function Cb(l,s,c){var h=2*Math.PI*6378137/256/Math.pow(2,c);return[l*h-2*Math.PI*6378137/2,s*h-2*Math.PI*6378137/2]}class Ul{constructor(s,c,h){this.z=s,this.x=c,this.y=h,this.key=ad(0,s,s,c,h)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,c){const h=(w=this.y,S=this.z,D=Cb(256*(b=this.x),256*(w=Math.pow(2,S)-w-1),S),k=Cb(256*(b+1),256*(w+1),S),D[0]+","+D[1]+","+k[0]+","+k[1]),m=function(b,w,S){let D,k="";for(let N=b;N>0;N--)D=1<<N-1,k+=(w&D?1:0)+(S&D?2:0);return k}(this.z,this.x,this.y);var b,w,S,D,k;return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===c?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class r_{constructor(s,c){this.wrap=s,this.canonical=c,this.key=ad(s,c.z,c.z,c.x,c.y)}}class ml{constructor(s,c,h,m,b){this.overscaledZ=s,this.wrap=c,this.canonical=new Ul(h,+m,+b),this.key=0===c&&s===h?this.canonical.key:ad(c,s,h,m,b)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const c=this.canonical.z-s;return s>this.canonical.z?new ml(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ml(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c=!0){if(this.overscaledZ===s&&c)return this.key;if(s>this.canonical.z)return ad(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-s;return ad(this.wrap*+c,s,s,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new ml(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new ml(c,this.wrap,c,h,m),new ml(c,this.wrap,c,h+1,m),new ml(c,this.wrap,c,h,m+1),new ml(c,this.wrap,c,h+1,m+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new ml(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new ml(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new r_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function ad(l,s,c,h,m){const b=1<<Math.min(c,22);let w=b*(m%b)+h%b;return l&&c<22&&(w+=b*b*((l<0?-2*l-1:2*l)%(1<<2*(22-c)))),16*(32*w+c)+(s-c)}Ii(Ul,"CanonicalTileID"),Ii(ml,"OverscaledTileID",{omit:["projMatrix"]});class Pn extends pi{constructor(s,c,h){super(s,c),this.z=h}}function o_(l,s){return l.x*s.x+l.y*s.y}function Vl(l,s){if(1===l.length){let c=0;const h=s[c++];let m;for(;!m||h.equals(m);)if(m=s[c++],!m)return 1/0;for(;c<s.length;c++){const b=s[c],w=l[0],S=m.sub(h),D=b.sub(h),k=w.sub(h),N=o_(S,S),V=o_(S,D),G=o_(D,D),q=o_(k,S),Y=o_(k,D),Q=N*G-V*V,ae=(G*q-V*Y)/Q,ge=(N*Y-V*q)/Q,De=h.z*(1-ae-ge)+m.z*ae+b.z*ge;if(isFinite(De))return De}return 1/0}{let c=1/0;for(const h of s)c=Math.min(c,h.z);return c}}function Us(l,s,c,h,m,b,w,S){const D=w*m.getElevationAt(l,s,!0,!0),k=0!==b[0],N=k?0===b[1]?w*(b[0]/7-450):w*function(V,G,q){const Y=Math.floor(G[0]/8),Q=Math.floor(G[1]/8),ae=10*(G[0]-8*Y),ge=10*(G[1]-8*Q),De=V.getElevationAt(Y,Q,!0,!0),_e=V.getMeterToDEM(q),Ae=Math.floor(.5*(ae*_e-1)),Ie=Math.floor(.5*(ge*_e-1)),Le=V.tileCoordToPixel(Y,Q),st=2*Ae+1,nt=2*Ie+1,Et=(Ri=st,bi=nt,[(ai=V).getElevationAtPixel(bt=Le.x-Ae,_i=Le.y-Ie,!0),ai.getElevationAtPixel(bt+bi,_i,!0),ai.getElevationAtPixel(bt,_i+bi,!0),ai.getElevationAtPixel(bt+Ri,_i+bi,!0)]),Yt=Math.abs(Et[0]-Et[1]),ct=Math.abs(Et[2]-Et[3]),Pt=Math.abs(Et[0]-Et[2])+Math.abs(Et[1]-Et[3]),Lt=Math.min(.25,.5*_e*(Yt+ct)/st),Gt=Math.min(.25,.5*_e*Pt/nt);var ai,bt,_i,Ri,bi;return De+Math.max(Lt*ae,Gt*ge)}(m,b,S):D;return{base:D+(0===c)?-1:c,top:k?Math.max(N+h,D+c+2):D+h}}const hM=$e([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Zp}=hM,Ox=$e([{name:"a_packed",components:4,type:"Float32"}]),{members:Nx}=Ox,Ly=Dy.types,Sb=Math.cos(Math.PI/180*37.5);class ip{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new et,this.layoutVertexArray2=new Rt,this.indexArray=new Bi,this.programConfigurations=new Qu(s.layers,s.zoom),this.segments=new As,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,h,m){this.hasPattern=mb("line",this.layers,c);const b=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:N,id:V,index:G,sourceLayerIndex:q}of s){const Y=this.layers[0]._featureFilter.needGeometry,Q=Wp(N,Y);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),Q,h))continue;const ae=b?b.evaluate(Q,{},h):void 0,ge={id:V,properties:N.properties,type:N.type,sourceLayerIndex:q,index:G,geometry:Y?Q.geometry:sd(N,h,m),patterns:{},sortKey:ae};w.push(ge)}b&&w.sort((N,V)=>N.sortKey-V.sortKey);const{lineAtlas:S,featureIndex:D}=c,k=this.addConstantDashes(S);for(const N of w){const{geometry:V,index:G,sourceLayerIndex:q}=N;if(k&&this.addFeatureDashes(N,S),this.hasPattern){const Y=Uf("line",this.layers,N,this.zoom,c);this.patternFeatures.push(Y)}else this.addFeature(N,V,G,h,S.positions,c.availableImages);D.insert(s[G].feature,V,G,q,this.index)}}addConstantDashes(s){let c=!1;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,b=h.layout.get("line-cap").value;if("constant"!==m.kind||"constant"!==b.kind)c=!0;else{const w=b.value,S=m.value;if(!S)continue;s.addDash(S,w)}}return c}addFeatureDashes(s,c){const h=this.zoom;for(const m of this.layers){const b=m.paint.get("line-dasharray").value,w=m.layout.get("line-cap").value;if("constant"===b.kind&&"constant"===w.kind)continue;let S,D;if("constant"===b.kind){if(S=b.value,!S)continue}else S=b.evaluate({zoom:h},s);D="constant"===w.kind?w.value:w.evaluate({zoom:h},s),c.addDash(S,D),s.patterns[m.id]=c.getKey(S,D)}}update(s,c,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,h,m)}addFeatures(s,c,h,m,b){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,c,h,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Nx)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Zp),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,c,h,m,b,w){const S=this.layers[0].layout,D=S.get("line-join").evaluate(s,{}),k=S.get("line-cap").evaluate(s,{}),N=S.get("line-miter-limit"),V=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const G of c)this.addLine(G,s,D,k,N,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,h,b,w,m)}addLine(s,c,h,m,b,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<s.length-1;ge++)this.totalDistance+=s[ge].dist(s[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S="Polygon"===Ly[c.type];let D=s.length;for(;D>=2&&s[D-1].equals(s[D-2]);)D--;let k=0;for(;k<D-1&&s[k].equals(s[k+1]);)k++;if(D<(S?3:2))return;"bevel"===h&&(b=1.05);const N=this.overscaling<=16?15*Xi/(512*this.overscaling):0,V=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let G,q,Y,Q,ae;this.e1=this.e2=-1,S&&(G=s[D-2],ae=s[k].sub(G)._unit()._perp());for(let ge=k;ge<D;ge++){if(Y=ge===D-1?S?s[k+1]:void 0:s[ge+1],Y&&s[ge].equals(Y))continue;ae&&(Q=ae),G&&(q=G),G=s[ge],ae=Y?Y.sub(G)._unit()._perp():Q,Q=Q||ae;let De=Q.add(ae);0===De.x&&0===De.y||De._unit();const _e=Q.x*ae.x+Q.y*ae.y,Ae=De.x*ae.x+De.y*ae.y,Ie=0!==Ae?1/Ae:1/0,Le=2*Math.sqrt(2-2*Ae),st=Ae<Sb&&q&&Y,nt=Q.x*ae.y-Q.y*ae.x>0;if(st&&ge>k){const ct=G.dist(q);if(ct>2*N){const Pt=G.sub(G.sub(q)._mult(N/ct)._round());this.updateDistance(q,Pt),this.addCurrentVertex(Pt,Q,0,0,V),q=Pt}}const Et=q&&Y;let Yt=Et?h:S?"butt":m;if(Et&&"round"===Yt&&(Ie<w?Yt="miter":Ie<=2&&(Yt="fakeround")),"miter"===Yt&&Ie>b&&(Yt="bevel"),"bevel"===Yt&&(Ie>2&&(Yt="flipbevel"),Ie<b&&(Yt="miter")),q&&this.updateDistance(q,G),"miter"===Yt)De._mult(Ie),this.addCurrentVertex(G,De,0,0,V);else if("flipbevel"===Yt){if(Ie>100)De=ae.mult(-1);else{const ct=Ie*Q.add(ae).mag()/Q.sub(ae).mag();De._perp()._mult(ct*(nt?-1:1))}this.addCurrentVertex(G,De,0,0,V),this.addCurrentVertex(G,De.mult(-1),0,0,V)}else if("bevel"===Yt||"fakeround"===Yt){const ct=-Math.sqrt(Ie*Ie-1),Pt=nt?ct:0,Lt=nt?0:ct;if(q&&this.addCurrentVertex(G,Q,Pt,Lt,V),"fakeround"===Yt){const Gt=Math.round(180*Le/Math.PI/20);for(let ai=1;ai<Gt;ai++){let bt=ai/Gt;if(.5!==bt){const Ri=bt-.5;bt+=bt*Ri*(bt-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*Ri*Ri+(.848013+_e*(.215638*_e-1.06021)))}const _i=ae.sub(Q)._mult(bt)._add(Q)._unit()._mult(nt?-1:1);this.addHalfVertex(G,_i.x,_i.y,!1,nt,0,V)}}Y&&this.addCurrentVertex(G,ae,-Pt,-Lt,V)}else if("butt"===Yt)this.addCurrentVertex(G,De,0,0,V);else if("square"===Yt){const ct=q?1:-1;q||this.addCurrentVertex(G,De,ct,ct,V),this.addCurrentVertex(G,De,0,0,V),q&&this.addCurrentVertex(G,De,ct,ct,V)}else"round"===Yt&&(q&&(this.addCurrentVertex(G,Q,0,0,V),this.addCurrentVertex(G,Q,1,1,V,!0)),Y&&(this.addCurrentVertex(G,ae,-1,-1,V,!0),this.addCurrentVertex(G,ae,0,0,V)));if(st&&ge<D-1){const ct=G.dist(Y);if(ct>2*N){const Pt=G.add(Y.sub(G)._mult(N/ct)._round());this.updateDistance(G,Pt),this.addCurrentVertex(Pt,ae,0,0,V),G=Pt}}}}addCurrentVertex(s,c,h,m,b,w=!1){const S=c.y*m-c.x,D=-c.y-c.x*m;this.addHalfVertex(s,c.x+c.y*h,c.y-c.x*h,w,!1,h,b),this.addHalfVertex(s,S,D,w,!0,-m,b)}addHalfVertex({x:s,y:c},h,m,b,w,S,D){this.layoutVertexArray.emplaceBack((s<<1)+(b?1:0),(c<<1)+(w?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(0===S?0:S<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),D.primitiveLength++),w?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,c){this.distance+=s.dist(c),this.updateScaledDistance()}}Ii(ip,"LineBucket",{omit:["layers","patternFeatures"]});const Tb=new xe({"line-cap":new de(yt.layout_line["line-cap"]),"line-join":new de(yt.layout_line["line-join"]),"line-miter-limit":new J(yt.layout_line["line-miter-limit"]),"line-round-limit":new J(yt.layout_line["line-round-limit"]),"line-sort-key":new de(yt.layout_line["line-sort-key"])});var Bx={paint:new xe({"line-opacity":new de(yt.paint_line["line-opacity"]),"line-color":new de(yt.paint_line["line-color"]),"line-translate":new J(yt.paint_line["line-translate"]),"line-translate-anchor":new J(yt.paint_line["line-translate-anchor"]),"line-width":new de(yt.paint_line["line-width"]),"line-gap-width":new de(yt.paint_line["line-gap-width"]),"line-offset":new de(yt.paint_line["line-offset"]),"line-blur":new de(yt.paint_line["line-blur"]),"line-dasharray":new de(yt.paint_line["line-dasharray"]),"line-pattern":new de(yt.paint_line["line-pattern"]),"line-gradient":new be(yt.paint_line["line-gradient"]),"line-trim-offset":new J(yt.paint_line["line-trim-offset"])}),layout:Tb};const np=new class extends de{possiblyEvaluate(l,s){return s=new z(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(l,s)}evaluate(l,s,c,h){return s=Qo({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(l,s,c,h)}}(Bx.paint.properties["line-width"].specification);function Ab(l,s){return s>0?s+2*l:l}np.useIntegerZoom=!0;const jm=$e([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ks=$e([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),rs=$e([{name:"a_projected_pos",components:4,type:"Float32"}],4);$e([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const s_=$e([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Db=$e([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);$e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ib=$e([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),zx=$e([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);$e([{name:"triangle",components:3,type:"Uint16"}]),$e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),$e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),$e([{type:"Float32",name:"offsetX"}]),$e([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var fa=24;const gl=128;function kb(l,s){const{expression:c}=s;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new z(l+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:h,interpolationType:m}=c;let b=0;for(;b<h.length&&h[b]<=l;)b++;b=Math.max(0,b-1);let w=b;for(;w<h.length&&h[w]<l+1;)w++;w=Math.min(h.length-1,w);const S=h[b],D=h[w];return"composite"===c.kind?{kind:"composite",minZoom:S,maxZoom:D,interpolationType:m}:{kind:"camera",minZoom:S,maxZoom:D,minSize:c.evaluate(new z(S)),maxSize:c.evaluate(new z(D)),interpolationType:m}}}function a_(l,{uSize:s,uSizeT:c},{lowerSize:h,upperSize:m}){return"source"===l.kind?h/gl:"composite"===l.kind?Mr(h/gl,m/gl,c):s}function uh(l,s){let c=0,h=0;if("constant"===l.kind)h=l.layoutSize;else if("source"!==l.kind){const{interpolationType:m,minZoom:b,maxZoom:w}=l,S=m?pr(Jc.interpolationFactor(m,s,b,w),0,1):0;"camera"===l.kind?h=Mr(l.minSize,l.maxSize,S):c=S}return{uSizeT:c,uSize:h}}var Rb=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:gl,evaluateSizeForFeature:a_,evaluateSizeForZoom:uh,getSizeData:kb});function pM(l,s,c){return l.sections.forEach(h=>{h.text=function(m,b,w){const S=b.layout.get("text-transform").evaluate(w,{});return"uppercase"===S?m=m.toLocaleUpperCase():"lowercase"===S&&(m=m.toLocaleLowerCase()),F.applyArabicShaping&&(m=F.applyArabicShaping(m)),m}(h.text,s,c)}),l}const Wa={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function ld(l){return"\ufe36"===l||"\ufe48"===l||"\ufe38"===l||"\ufe44"===l||"\ufe42"===l||"\ufe3e"===l||"\ufe3c"===l||"\ufe3a"===l||"\ufe18"===l||"\ufe40"===l||"\ufe10"===l||"\ufe13"===l||"\ufe14"===l||"\uff40"===l||"\uffe3"===l||"\ufe11"===l||"\ufe12"===l}function cd(l){return"\ufe35"===l||"\ufe47"===l||"\ufe37"===l||"\ufe43"===l||"\ufe41"===l||"\ufe3d"===l||"\ufe3b"===l||"\ufe39"===l||"\ufe17"===l||"\ufe3f"===l}var Hf=Ao,Ux=function(l,s,c,h,m){var b,w,S=8*m-h-1,D=(1<<S)-1,k=D>>1,N=-7,V=c?m-1:0,G=c?-1:1,q=l[s+V];for(V+=G,b=q&(1<<-N)-1,q>>=-N,N+=S;N>0;b=256*b+l[s+V],V+=G,N-=8);for(w=b&(1<<-N)-1,b>>=-N,N+=h;N>0;w=256*w+l[s+V],V+=G,N-=8);if(0===b)b=1-k;else{if(b===D)return w?NaN:1/0*(q?-1:1);w+=Math.pow(2,h),b-=k}return(q?-1:1)*w*Math.pow(2,b-h)},Vx=function(l,s,c,h,m,b){var w,S,D,k=8*b-m-1,N=(1<<k)-1,V=N>>1,G=23===m?Math.pow(2,-24)-Math.pow(2,-77):0,q=h?0:b-1,Y=h?1:-1,Q=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(S=isNaN(s)?1:0,w=N):(w=Math.floor(Math.log(s)/Math.LN2),s*(D=Math.pow(2,-w))<1&&(w--,D*=2),(s+=w+V>=1?G/D:G*Math.pow(2,1-V))*D>=2&&(w++,D/=2),w+V>=N?(S=0,w=N):w+V>=1?(S=(s*D-1)*Math.pow(2,m),w+=V):(S=s*Math.pow(2,V-1)*Math.pow(2,m),w=0));m>=8;l[c+q]=255&S,q+=Y,S/=256,m-=8);for(w=w<<m|S,k+=m;k>0;l[c+q]=255&w,q+=Y,w/=256,k-=8);l[c+q-Y]|=128*Q};function Ao(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}Ao.Varint=0,Ao.Fixed64=1,Ao.Bytes=2,Ao.Fixed32=5;var Pb=4294967296,Lb=1/Pb,Fb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function _l(l){return l.type===Ao.Bytes?l.readVarint()+l.pos:l.pos+1}function Ob(l,s,c){var h=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(h);for(var m=c.pos-1;m>=l;m--)c.buf[m+h]=c.buf[m]}function ac(l,s){for(var c=0;c<l.length;c++)s.writeVarint(l[c])}function hh(l,s){for(var c=0;c<l.length;c++)s.writeSVarint(l[c])}function l_(l,s){for(var c=0;c<l.length;c++)s.writeFloat(l[c])}function Do(l,s){for(var c=0;c<l.length;c++)s.writeDouble(l[c])}function Hx(l,s){for(var c=0;c<l.length;c++)s.writeBoolean(l[c])}function Nb(l,s){for(var c=0;c<l.length;c++)s.writeFixed32(l[c])}function Bb(l,s){for(var c=0;c<l.length;c++)s.writeSFixed32(l[c])}function QC(l,s){for(var c=0;c<l.length;c++)s.writeFixed64(l[c])}function eS(l,s){for(var c=0;c<l.length;c++)s.writeSFixed64(l[c])}function Wm(l,s){return(l[s]|l[s+1]<<8|l[s+2]<<16)+16777216*l[s+3]}function Yp(l,s,c){l[c]=s,l[c+1]=s>>>8,l[c+2]=s>>>16,l[c+3]=s>>>24}function fM(l,s){return(l[s]|l[s+1]<<8|l[s+2]<<16)+(l[s+3]<<24)}Ao.prototype={destroy:function(){this.buf=null},readFields:function(l,s,c){for(c=c||this.length;this.pos<c;){var h=this.readVarint(),m=h>>3,b=this.pos;this.type=7&h,l(m,s,this),this.pos===b&&this.skip(h)}return s},readMessage:function(l,s){return this.readFields(l,s,this.readVarint()+this.pos)},readFixed32:function(){var l=Wm(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=fM(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=Wm(this.buf,this.pos)+Wm(this.buf,this.pos+4)*Pb;return this.pos+=8,l},readSFixed64:function(){var l=Wm(this.buf,this.pos)+fM(this.buf,this.pos+4)*Pb;return this.pos+=8,l},readFloat:function(){var l=Ux(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=Ux(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var s,c,h=this.buf;return s=127&(c=h[this.pos++]),c<128?s:(s|=(127&(c=h[this.pos++]))<<7,c<128?s:(s|=(127&(c=h[this.pos++]))<<14,c<128?s:(s|=(127&(c=h[this.pos++]))<<21,c<128?s:function(m,b,w){var S,D,k=w.buf;if(S=(112&(D=k[w.pos++]))>>4,D<128||(S|=(127&(D=k[w.pos++]))<<3,D<128)||(S|=(127&(D=k[w.pos++]))<<10,D<128)||(S|=(127&(D=k[w.pos++]))<<17,D<128)||(S|=(127&(D=k[w.pos++]))<<24,D<128)||(S|=(1&(D=k[w.pos++]))<<31,D<128))return function ar(l,s,c){return c?4294967296*s+(l>>>0):4294967296*(s>>>0)+(l>>>0)}(m,S,b);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(c=h[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var l=this.readVarint()+this.pos,s=this.pos;return this.pos=l,l-s>=12&&Fb?Fb.decode(this.buf.subarray(s,l)):function(c,h,m){for(var b="",w=h;w<m;){var S,D,k,N=c[w],V=null,G=N>239?4:N>223?3:N>191?2:1;if(w+G>m)break;1===G?N<128&&(V=N):2===G?128==(192&(S=c[w+1]))&&(V=(31&N)<<6|63&S)<=127&&(V=null):3===G?(D=c[w+2],128==(192&(S=c[w+1]))&&128==(192&D)&&((V=(15&N)<<12|(63&S)<<6|63&D)<=2047||V>=55296&&V<=57343)&&(V=null)):4===G&&(D=c[w+2],k=c[w+3],128==(192&(S=c[w+1]))&&128==(192&D)&&128==(192&k)&&((V=(15&N)<<18|(63&S)<<12|(63&D)<<6|63&k)<=65535||V>=1114112)&&(V=null)),null===V?(V=65533,G=1):V>65535&&(V-=65536,b+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),b+=String.fromCharCode(V),w+=G}return b}(this.buf,s,l)},readBytes:function(){var l=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,l);return this.pos=l,s},readPackedVarint:function(l,s){if(this.type!==Ao.Bytes)return l.push(this.readVarint(s));var c=_l(this);for(l=l||[];this.pos<c;)l.push(this.readVarint(s));return l},readPackedSVarint:function(l){if(this.type!==Ao.Bytes)return l.push(this.readSVarint());var s=_l(this);for(l=l||[];this.pos<s;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==Ao.Bytes)return l.push(this.readBoolean());var s=_l(this);for(l=l||[];this.pos<s;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==Ao.Bytes)return l.push(this.readFloat());var s=_l(this);for(l=l||[];this.pos<s;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==Ao.Bytes)return l.push(this.readDouble());var s=_l(this);for(l=l||[];this.pos<s;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==Ao.Bytes)return l.push(this.readFixed32());var s=_l(this);for(l=l||[];this.pos<s;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==Ao.Bytes)return l.push(this.readSFixed32());var s=_l(this);for(l=l||[];this.pos<s;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==Ao.Bytes)return l.push(this.readFixed64());var s=_l(this);for(l=l||[];this.pos<s;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==Ao.Bytes)return l.push(this.readSFixed64());var s=_l(this);for(l=l||[];this.pos<s;)l.push(this.readSFixed64());return l},skip:function(l){var s=7&l;if(s===Ao.Varint)for(;this.buf[this.pos++]>127;);else if(s===Ao.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Ao.Fixed32)this.pos+=4;else{if(s!==Ao.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(l,s){this.writeVarint(l<<3|s)},realloc:function(l){for(var s=this.length||16;s<this.pos+l;)s*=2;if(s!==this.length){var c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),Yp(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),Yp(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),Yp(this.buf,-1&l,this.pos),Yp(this.buf,Math.floor(l*Lb),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),Yp(this.buf,-1&l,this.pos),Yp(this.buf,Math.floor(l*Lb),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(s,c){var h,m,b,S;if(s>=0?(h=s%4294967296|0,m=s/4294967296|0):(m=~(-s/4294967296),4294967295^(h=~(-s%4294967296))?h=h+1|0:(h=0,m=m+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),b=h,(S=c).buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,S.buf[S.pos]=127&(b>>>=7),function(b,w){var S=(7&b)<<4;w.buf[w.pos++]|=S|((b>>>=3)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b)))))}(m,c)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(!!l)},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var s=this.pos;this.pos=function(h,m,b){for(var w,S,D=0;D<m.length;D++){if((w=m.charCodeAt(D))>55295&&w<57344){if(!S){w>56319||D+1===m.length?(h[b++]=239,h[b++]=191,h[b++]=189):S=w;continue}if(w<56320){h[b++]=239,h[b++]=191,h[b++]=189,S=w;continue}w=S-55296<<10|w-56320|65536,S=null}else S&&(h[b++]=239,h[b++]=191,h[b++]=189,S=null);w<128?h[b++]=w:(w<2048?h[b++]=w>>6|192:(w<65536?h[b++]=w>>12|224:(h[b++]=w>>18|240,h[b++]=w>>12&63|128),h[b++]=w>>6&63|128),h[b++]=63&w|128)}return b}(this.buf,l,this.pos);var c=this.pos-s;c>=128&&Ob(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeFloat:function(l){this.realloc(4),Vx(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),Vx(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var s=l.length;this.writeVarint(s),this.realloc(s);for(var c=0;c<s;c++)this.buf[this.pos++]=l[c]},writeRawMessage:function(l,s){this.pos++;var c=this.pos;l(s,this);var h=this.pos-c;h>=128&&Ob(c,h,this),this.pos=c-1,this.writeVarint(h),this.pos+=h},writeMessage:function(l,s,c){this.writeTag(l,Ao.Bytes),this.writeRawMessage(s,c)},writePackedVarint:function(l,s){s.length&&this.writeMessage(l,ac,s)},writePackedSVarint:function(l,s){s.length&&this.writeMessage(l,hh,s)},writePackedBoolean:function(l,s){s.length&&this.writeMessage(l,Hx,s)},writePackedFloat:function(l,s){s.length&&this.writeMessage(l,l_,s)},writePackedDouble:function(l,s){s.length&&this.writeMessage(l,Do,s)},writePackedFixed32:function(l,s){s.length&&this.writeMessage(l,Nb,s)},writePackedSFixed32:function(l,s){s.length&&this.writeMessage(l,Bb,s)},writePackedFixed64:function(l,s){s.length&&this.writeMessage(l,QC,s)},writePackedSFixed64:function(l,s){s.length&&this.writeMessage(l,eS,s)},writeBytesField:function(l,s){this.writeTag(l,Ao.Bytes),this.writeBytes(s)},writeFixed32Field:function(l,s){this.writeTag(l,Ao.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(l,s){this.writeTag(l,Ao.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(l,s){this.writeTag(l,Ao.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(l,s){this.writeTag(l,Ao.Fixed64),this.writeSFixed64(s)},writeVarintField:function(l,s){this.writeTag(l,Ao.Varint),this.writeVarint(s)},writeSVarintField:function(l,s){this.writeTag(l,Ao.Varint),this.writeSVarint(s)},writeStringField:function(l,s){this.writeTag(l,Ao.Bytes),this.writeString(s)},writeFloatField:function(l,s){this.writeTag(l,Ao.Fixed32),this.writeFloat(s)},writeDoubleField:function(l,s){this.writeTag(l,Ao.Fixed64),this.writeDouble(s)},writeBooleanField:function(l,s){this.writeVarintField(l,!!s)}};var zb=Jo(Hf);const Fy=3;function mM(l,s,c){s.glyphs=[],1===l&&c.readMessage(gM,s)}function gM(l,s,c){if(3===l){const{id:h,bitmap:m,width:b,height:w,left:S,top:D,advance:k}=c.readMessage(_M,{});s.glyphs.push({id:h,bitmap:new ep({width:b+2*Fy,height:w+2*Fy},m),metrics:{width:b,height:w,left:S,top:D,advance:k}})}else 4===l?s.ascender=c.readSVarint():5===l&&(s.descender=c.readSVarint())}function _M(l,s,c){1===l?s.id=c.readVarint():2===l?s.bitmap=c.readBytes():3===l?s.width=c.readVarint():4===l?s.height=c.readVarint():5===l?s.left=c.readSVarint():6===l?s.top=c.readSVarint():7===l&&(s.advance=c.readVarint())}const Gx=Fy;function Oy(l){let s=0,c=0;for(const w of l)s+=w.w*w.h,c=Math.max(c,w.w);l.sort((w,S)=>S.h-w.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let m=0,b=0;for(const w of l)for(let S=h.length-1;S>=0;S--){const D=h[S];if(!(w.w>D.w||w.h>D.h)){if(w.x=D.x,w.y=D.y,b=Math.max(b,w.y+w.h),m=Math.max(m,w.x+w.w),w.w===D.w&&w.h===D.h){const k=h.pop();S<h.length&&(h[S]=k)}else w.h===D.h?(D.x+=w.w,D.w-=w.w):w.w===D.w?(D.y+=w.h,D.h-=w.h):(h.push({x:D.x+w.w,y:D.y,w:D.w-w.w,h:w.h}),D.y+=w.h,D.h-=w.h);break}}return{w:m,h:b,fill:s/(m*b)||0}}const $a=1;class $m{constructor(s,{pixelRatio:c,version:h,stretchX:m,stretchY:b,content:w}){this.paddedRect=s,this.pixelRatio=c,this.stretchX=m,this.stretchY=b,this.content=w,this.version=h}get tl(){return[this.paddedRect.x+$a,this.paddedRect.y+$a]}get br(){return[this.paddedRect.x+this.paddedRect.w-$a,this.paddedRect.y+this.paddedRect.h-$a]}get displaySize(){return[(this.paddedRect.w-2*$a)/this.pixelRatio,(this.paddedRect.h-2*$a)/this.pixelRatio]}}class Ny{constructor(s,c){const h={},m={};this.haveRenderCallbacks=[];const b=[];this.addImages(s,h,b),this.addImages(c,m,b);const{w,h:S}=Oy(b),D=new fl({width:w||1,height:S||1});for(const k in s){const N=s[k],V=h[k].paddedRect;fl.copy(N.data,D,{x:0,y:0},{x:V.x+$a,y:V.y+$a},N.data)}for(const k in c){const N=c[k],V=m[k].paddedRect,G=V.x+$a,q=V.y+$a,Y=N.data.width,Q=N.data.height;fl.copy(N.data,D,{x:0,y:0},{x:G,y:q},N.data),fl.copy(N.data,D,{x:0,y:Q-1},{x:G,y:q-1},{width:Y,height:1}),fl.copy(N.data,D,{x:0,y:0},{x:G,y:q+Q},{width:Y,height:1}),fl.copy(N.data,D,{x:Y-1,y:0},{x:G-1,y:q},{width:1,height:Q}),fl.copy(N.data,D,{x:0,y:0},{x:G+Y,y:q},{width:1,height:Q})}this.image=D,this.iconPositions=h,this.patternPositions=m}addImages(s,c,h){for(const m in s){const b=s[m],w={x:0,y:0,w:b.data.width+2*$a,h:b.data.height+2*$a};h.push(w),c[m]=new $m(w,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(h=>s.hasImage(h)),s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in s.updatedImages)this.patchUpdatedImage(this.iconPositions[h],s.getImage(h),c),this.patchUpdatedImage(this.patternPositions[h],s.getImage(h),c)}patchUpdatedImage(s,c,h){if(!s||!c||s.version===c.version)return;s.version=c.version;const[m,b]=s.tl;h.update(c.data,void 0,{x:m,y:b})}}Ii($m,"ImagePosition"),Ii(Ny,"ImageAtlas");const lc={horizontal:1,vertical:2,horizontalOnly:3},wo=-17;class c_{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,c){const h=new c_;return h.scale=s||1,h.fontStack=c,h}static forImage(s){const c=new c_;return c.imageName=s,c}}class qm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c){const h=new qm;for(let m=0;m<s.sections.length;m++){const b=s.sections[m];b.image?h.addImageSection(b):h.addTextSection(b,c)}return h}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(s){this.text=function(c,h){let m="";for(let b=0;b<c.length;b++){const w=c.charCodeAt(b+1)||null,S=c.charCodeAt(b-1)||null;m+=!h&&(w&&Uv(w)&&!Wa[c[b+1]]||S&&Uv(S)&&!Wa[c[b-1]])||!Wa[c[b]]?c[b]:Wa[c[b]]}return m}(this.text,s)}trim(){let s=0;for(let h=0;h<this.text.length&&qa[this.text.charCodeAt(h)];h++)s++;let c=this.text.length;for(let h=this.text.length-1;h>=0&&h>=s&&qa[this.text.charCodeAt(h)];h--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const h=new qm;return h.text=this.text.substring(s,c),h.sectionIndex=this.sectionIndex.slice(s,c),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(c_.forText(s.scale,s.fontStack||c));const h=this.sections.length-1;for(let m=0;m<s.text.length;++m)this.sectionIndex.push(h)}addImageSection(s){const c=s.image?s.image.name:"";if(0===c.length)return void _o("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(c_.forImage(c)),this.sectionIndex.push(this.sections.length-1)):_o("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zs(l,s,c,h,m,b,w,S,D,k,N,V,G,q,Y){const Q=qm.fromFeature(l,m);V===lc.vertical&&Q.verticalizePunctuation(G);let ae=[];const ge=function(Le,st,nt,Et,Yt,ct){if(!Le)return[];const Pt=[],Lt=function(_i,Ri,bi,$n,li,en){let fn=0;for(let Rr=0;Rr<_i.length();Rr++){const qn=_i.getSection(Rr);fn+=jx(_i.getCharCode(Rr),qn,$n,li,Ri,en)}return fn/Math.max(1,Math.ceil(fn/bi))}(Le,st,nt,Et,Yt,ct),Gt=Le.text.indexOf("\u200b")>=0;let ai=0;for(let _i=0;_i<Le.length();_i++){const Ri=Le.getSection(_i),bi=Le.getCharCode(_i);if(qa[bi]||(ai+=jx(bi,Ri,Et,Yt,st,ct)),_i<Le.length()-1){const $n=!((bt=bi)<11904||!(yi["Bopomofo Extended"](bt)||yi.Bopomofo(bt)||yi["CJK Compatibility Forms"](bt)||yi["CJK Compatibility Ideographs"](bt)||yi["CJK Compatibility"](bt)||yi["CJK Radicals Supplement"](bt)||yi["CJK Strokes"](bt)||yi["CJK Symbols and Punctuation"](bt)||yi["CJK Unified Ideographs Extension A"](bt)||yi["CJK Unified Ideographs"](bt)||yi["Enclosed CJK Letters and Months"](bt)||yi["Halfwidth and Fullwidth Forms"](bt)||yi.Hiragana(bt)||yi["Ideographic Description Characters"](bt)||yi["Kangxi Radicals"](bt)||yi["Katakana Phonetic Extensions"](bt)||yi.Katakana(bt)||yi["Vertical Forms"](bt)||yi["Yi Radicals"](bt)||yi["Yi Syllables"](bt)));(yM[bi]||$n||Ri.imageName)&&Pt.push(Ub(_i+1,ai,Lt,Pt,$x(bi,Le.getCharCode(_i+1),$n&&Gt),!1))}}var bt;return vM(Ub(Le.length(),ai,Lt,Pt,0,!0))}(Q,k,b,s,h,q),{processBidirectionalText:De,processStyledBidirectionalText:_e}=F;if(De&&1===Q.sections.length){const Le=De(Q.toString(),ge);for(const st of Le){const nt=new qm;nt.text=st,nt.sections=Q.sections;for(let Et=0;Et<st.length;Et++)nt.sectionIndex.push(0);ae.push(nt)}}else if(_e){const Le=_e(Q.text,Q.sectionIndex,ge);for(const st of Le){const nt=new qm;nt.text=st[0],nt.sectionIndex=st[1],nt.sections=Q.sections,ae.push(nt)}}else ae=function(Le,st){const nt=[],Et=Le.text;let Yt=0;for(const ct of st)nt.push(Le.substring(Yt,ct)),Yt=ct;return Yt<Et.length&&nt.push(Le.substring(Yt,Et.length)),nt}(Q,ge);const Ae=[],Ie={positionedLines:Ae,text:Q.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Le,st,nt,Et,Yt,ct,Pt,Lt,Gt,ai,bt,_i){let Ri=0,bi=0,$n=0;const li="right"===Lt?1:"left"===Lt?0:.5;let en=!1;for(const Xn of Yt){const Zn=Xn.getSections();for(const co of Zn){if(co.imageName)continue;const Io=st[co.fontStack];if(Io&&(en=void 0!==Io.ascender&&void 0!==Io.descender,!en))break}if(!en)break}let fn=0;for(const Xn of Yt){Xn.trim();const Zn=Xn.getMaxScale(),co=(Zn-1)*fa,Io={positionedGlyphs:[],lineOffset:0};Le.positionedLines[fn]=Io;const jo=Io.positionedGlyphs;let ko=0;if(!Xn.length()){bi+=ct,++fn;continue}let os=0,_s=0;for(let Mo=0;Mo<Xn.length();Mo++){const Wo=Xn.getSection(Mo),Ys=Xn.getSectionIndex(Mo),ys=Xn.getCharCode(Mo);let Ur=Wo.scale,Ks=null,No=null,Fc=null,ya=fa,Xa=0;const Za=!(Gt===lc.horizontal||!bt&&!Rg(ys)||bt&&(qa[ys]||(Rr=ys,yi.Arabic(Rr)||yi["Arabic Supplement"](Rr)||yi["Arabic Extended-A"](Rr)||yi["Arabic Presentation Forms-A"](Rr)||yi["Arabic Presentation Forms-B"](Rr))));if(Wo.imageName){const bl=Et[Wo.imageName];if(!bl)continue;Fc=Wo.imageName,Le.iconsInText=Le.iconsInText||!0,No=bl.paddedRect;const Hs=bl.displaySize;Ur=Ur*fa/_i,Ks={width:Hs[0],height:Hs[1],left:$a,top:-Gx,advance:Za?Hs[1]:Hs[0],localGlyph:!1},Xa=en?-Ks.height*Ur:wo+Zn*fa-Hs[1]*Ur,ya=Ks.advance;const Od=(Za?Hs[0]:Hs[1])*Ur-fa*Zn;Od>0&&Od>ko&&(ko=Od)}else{const bl=nt[Wo.fontStack];if(!bl)continue;bl[ys]&&(No=bl[ys]);const Hs=st[Wo.fontStack];if(!Hs)continue;const Od=Hs.glyphs[ys];if(!Od)continue;if(Ks=Od.metrics,ya=8203!==ys?fa:0,en){const Kb=void 0!==Hs.ascender?Math.abs(Hs.ascender):0,Jb=void 0!==Hs.descender?Math.abs(Hs.descender):0,Yy=(Kb+Jb)*Ur;os<Yy&&(os=Yy,_s=(Kb-Jb)/2*Ur),Xa=-Kb*Ur}else Xa=wo+(Zn-Ur)*fa}Za?(Le.verticalizable=!0,jo.push({glyph:ys,imageName:Fc,x:Ri,y:bi+Xa,vertical:Za,scale:Ur,localGlyph:Ks.localGlyph,fontStack:Wo.fontStack,sectionIndex:Ys,metrics:Ks,rect:No}),Ri+=ya*Ur+ai):(jo.push({glyph:ys,imageName:Fc,x:Ri,y:bi+Xa,vertical:Za,scale:Ur,localGlyph:Ks.localGlyph,fontStack:Wo.fontStack,sectionIndex:Ys,metrics:Ks,rect:No}),Ri+=Ks.advance*Ur+ai)}0!==jo.length&&($n=Math.max(Ri-ai,$n),en?Gf(jo,li,ko,_s,ct*Zn/2):Gf(jo,li,ko,0,ct/2)),Ri=0;const Vs=ct*Zn+ko;Io.lineOffset=Math.max(ko,co),bi+=Vs,++fn}var Rr;const qn=bi,{horizontalAlign:cn,verticalAlign:Go}=qx(Pt);(function(Xn,Zn,co,Io,jo,ko){const os=(Zn-co)*jo,_s=-ko*Io;for(const Vs of Xn)for(const Mo of Vs.positionedGlyphs)Mo.x+=os,Mo.y+=_s})(Le.positionedLines,li,cn,Go,$n,qn),Le.top+=-Go*qn,Le.bottom=Le.top+qn,Le.left+=-cn*$n,Le.right=Le.left+$n,Le.hasBaseline=en}(Ie,s,c,h,ae,w,S,D,V,k,G,Y),!function(Le){for(const st of Le)if(0!==st.positionedGlyphs.length)return!1;return!0}(Ae)&&Ie}const qa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yM={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function jx(l,s,c,h,m,b){if(s.imageName){const w=h[s.imageName];return w?w.displaySize[0]*s.scale*fa/b+m:0}{const w=c[s.fontStack],S=w&&w.glyphs[l];return S?S.metrics.advance*s.scale+m:0}}function Wx(l,s,c,h){const m=Math.pow(l-s,2);return h?l<s?m/2:2*m:m+Math.abs(c)*c}function $x(l,s,c){let h=0;return 10===l&&(h-=1e4),c&&(h+=150),40!==l&&65288!==l||(h+=50),41!==s&&65289!==s||(h+=50),h}function Ub(l,s,c,h,m,b){let w=null,S=Wx(s,c,m,b);for(const D of h){const k=Wx(s-D.x,c,m,b)+D.badness;k<=S&&(w=D,S=k)}return{index:l,x:s,priorBreak:w,badness:S}}function vM(l){return l?vM(l.priorBreak).concat(l.index):[]}function qx(l){let s=.5,c=.5;switch(l){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function Gf(l,s,c,h,m){if(!(s||c||h||m))return;const b=l.length-1,w=l[b],S=(w.x+w.metrics.advance*w.scale)*s;for(let D=0;D<=b;D++)l[D].x-=S,l[D].y+=c+h+m}function Ot(l,s,c){const{horizontalAlign:h,verticalAlign:m}=qx(c),b=s[0]-l.displaySize[0]*h,w=s[1]-l.displaySize[1]*m;return{image:l,top:w,bottom:w+l.displaySize[1],left:b,right:b+l.displaySize[0]}}function Xm(l,s,c,h,m,b){const w=l.image;let S;if(w.content){const ae=w.content,ge=w.pixelRatio||1;S=[ae[0]/ge,ae[1]/ge,w.displaySize[0]-ae[2]/ge,w.displaySize[1]-ae[3]/ge]}const D=s.left*b,k=s.right*b;let N,V,G,q;"width"===c||"both"===c?(q=m[0]+D-h[3],V=m[0]+k+h[1]):(q=m[0]+(D+k-w.displaySize[0])/2,V=q+w.displaySize[0]);const Y=s.top*b,Q=s.bottom*b;return"height"===c||"both"===c?(N=m[1]+Y-h[0],G=m[1]+Q+h[2]):(N=m[1]+(Y+Q-w.displaySize[1])/2,G=N+w.displaySize[1]),{image:w,top:N,right:V,bottom:G,left:q,collisionPadding:S}}class ph extends pi{constructor(s,c,h,m,b){super(s,c),this.angle=m,this.z=h,void 0!==b&&(this.segment=b)}clone(){return new ph(this.x,this.y,this.z,this.angle,this.segment)}}function By(l,s,c,h,m){if(void 0===s.segment)return!0;let b=s,w=s.segment+1,S=0;for(;S>-c/2;){if(w--,w<0)return!1;S-=l[w].dist(b),b=l[w]}S+=l[w].dist(l[w+1]),w++;const D=[];let k=0;for(;S<c/2;){const N=l[w],V=l[w+1];if(!V)return!1;let G=l[w-1].angleTo(N)-N.angleTo(V);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:S,angleDelta:G}),k+=G;S-D[0].distance>h;)k-=D.shift().angleDelta;if(k>m)return!1;w++,S+=N.dist(V)}return!0}function zy(l){let s=0;for(let c=0;c<l.length-1;c++)s+=l[c].dist(l[c+1]);return s}function Uy(l,s,c){return l?.6*s*c:0}function Xx(l,s){return Math.max(l?l.right-l.left:0,s?s.right-s.left:0)}function Zx(l,s,c,h,m,b){const w=Uy(c,m,b),S=Xx(c,h)*b;let D=0;const k=zy(l)/2;for(let N=0;N<l.length-1;N++){const V=l[N],G=l[N+1],q=V.dist(G);if(D+q>k){const Y=(k-D)/q,Q=Mr(V.x,G.x,Y),ae=Mr(V.y,G.y,Y),ge=new ph(Q,ae,0,G.angleTo(V),N);return!w||By(l,ge,S,w,s)?ge:void 0}D+=q}}function Yx(l,s,c,h,m,b,w,S,D){const k=Uy(h,b,w),N=Xx(h,m),V=N*w,G=0===l[0].x||l[0].x===D||0===l[0].y||l[0].y===D;return s-V<s/4&&(s=V+s/4),rp(l,G?s/2*S%s:(N/2+2*b)*w*S%s,s,k,c,V,G,!1,D)}function rp(l,s,c,h,m,b,w,S,D){const k=b/2,N=zy(l);let V=0,G=s-c,q=[];for(let Y=0;Y<l.length-1;Y++){const Q=l[Y],ae=l[Y+1],ge=Q.dist(ae),De=ae.angleTo(Q);for(;G+c<V+ge;){G+=c;const _e=(G-V)/ge,Ae=Mr(Q.x,ae.x,_e),Ie=Mr(Q.y,ae.y,_e);if(Ae>=0&&Ae<D&&Ie>=0&&Ie<D&&G-k>=0&&G+k<=N){const Le=new ph(Ae,Ie,0,De,Y);Le._round(),h&&!By(l,Le,b,h,m)||q.push(Le)}}V+=ge}return S||q.length||w||(q=rp(l,V/2,c,h,m,b,w,!0,D)),q}function bM(l,s,c,h,m){const b=[];for(let w=0;w<l.length;w++){const S=l[w];let D;for(let k=0;k<S.length-1;k++){let N=S[k],V=S[k+1];N.x<s&&V.x<s||(N.x<s?N=new pi(s,N.y+(s-N.x)/(V.x-N.x)*(V.y-N.y))._round():V.x<s&&(V=new pi(s,N.y+(s-N.x)/(V.x-N.x)*(V.y-N.y))._round()),N.y<c&&V.y<c||(N.y<c?N=new pi(N.x+(c-N.y)/(V.y-N.y)*(V.x-N.x),c)._round():V.y<c&&(V=new pi(N.x+(c-N.y)/(V.y-N.y)*(V.x-N.x),c)._round()),N.x>=h&&V.x>=h||(N.x>=h?N=new pi(h,N.y+(h-N.x)/(V.x-N.x)*(V.y-N.y))._round():V.x>=h&&(V=new pi(h,N.y+(h-N.x)/(V.x-N.x)*(V.y-N.y))._round()),N.y>=m&&V.y>=m||(N.y>=m?N=new pi(N.x+(m-N.y)/(V.y-N.y)*(V.x-N.x),m)._round():V.y>=m&&(V=new pi(N.x+(m-N.y)/(V.y-N.y)*(V.x-N.x),m)._round()),D&&N.equals(D[D.length-1])||(D=[N],b.push(D)),D.push(V)))))}}return b}Ii(ph,"Anchor");const jf=1e20;function Kx(l,s,c,h,m,b,w,S,D){for(let k=s;k<s+h;k++)Vy(l,c*b+k,b,m,w,S,D);for(let k=c;k<c+m;k++)Vy(l,k*b+s,1,h,w,S,D)}function Vy(l,s,c,h,m,b,w){b[0]=0,w[0]=-jf,w[1]=jf,m[0]=l[s];for(let S=1,D=0,k=0;S<h;S++){m[S]=l[s+S*c];const N=S*S;do{const V=b[D];k=(m[S]-m[V]+N-V*V)/(S-V)/2}while(k<=w[D]&&--D>-1);D++,b[D]=S,w[D]=k,w[D+1]=jf}for(let S=0,D=0;S<h;S++){for(;w[D+1]<S;)D++;const k=b[D],N=S-k;l[s+S*c]=m[k]+N*N}}const Rd=2,d_={none:0,ideographs:1,all:2};class dd{constructor(s,c,h){this.requestManager=s,this.localGlyphMode=c,this.localFontFamily=h,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,c){const h=[];for(const m in s)for(const b of s[m])h.push({stack:m,id:b});Bo(h,({stack:m,id:b},w)=>{let S=this.entries[m];S||(S=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let D=S.glyphs[b];if(void 0!==D)return void w(null,{stack:m,id:b,glyph:D});if(D=this._tinySDF(S,m,b),D)return S.glyphs[b]=D,void w(null,{stack:m,id:b,glyph:D});const k=Math.floor(b/256);if(256*k>65535)return void w(new Error("glyphs > 65535 not supported"));if(S.ranges[k])return void w(null,{stack:m,id:b,glyph:D});let N=S.requests[k];N||(N=S.requests[k]=[],dd.loadGlyphRange(m,k,this.url,this.requestManager,(V,G)=>{if(G){S.ascender=G.ascender,S.descender=G.descender;for(const q in G.glyphs)this._doesCharSupportLocalGlyph(+q)||(S.glyphs[+q]=G.glyphs[+q]);S.ranges[k]=!0}for(const q of N)q(V,G);delete S.requests[k]})),N.push((V,G)=>{V?w(V):G&&w(null,{stack:m,id:b,glyph:G.glyphs[b]||null})})},(m,b)=>{if(m)c(m);else if(b){const w={};for(const{stack:S,id:D,glyph:k}of b)void 0===w[S]&&(w[S]={}),void 0===w[S].glyphs&&(w[S].glyphs={}),w[S].glyphs[D]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},w[S].ascender=this.entries[S].ascender,w[S].descender=this.entries[S].descender;c(null,w)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==d_.none&&(this.localGlyphMode===d_.all?!!this.localFontFamily:!!this.localFontFamily&&(yi["CJK Unified Ideographs"](s)||yi["Hangul Syllables"](s)||yi.Hiragana(s)||yi.Katakana(s)||yi["CJK Symbols and Punctuation"](s)))}_tinySDF(s,c,h){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(h))return;let b=s.tinySDF;if(!b){let Q="400";/bold/i.test(c)?Q="900":/medium/i.test(c)?Q="500":/light/i.test(c)&&(Q="200"),b=s.tinySDF=new dd.TinySDF({fontFamily:m,fontWeight:Q,fontSize:24*Rd,buffer:3*Rd,radius:8*Rd}),b.fontWeight=Q}if(this.localGlyphs[b.fontWeight][h])return this.localGlyphs[b.fontWeight][h];const w=String.fromCharCode(h),{data:S,width:D,height:k,glyphWidth:N,glyphHeight:V,glyphLeft:G,glyphTop:q,glyphAdvance:Y}=b.draw(w);return this.localGlyphs[b.fontWeight][h]={id:h,bitmap:new ep({width:D,height:k},S),metrics:{width:N/Rd,height:V/Rd,left:G/Rd,top:q/Rd-27,advance:Y/Rd,localGlyph:!0}}}}dd.loadGlyphRange=function(l,s,c,h,m){const b=256*s,w=b+255,S=h.transformRequest(h.normalizeGlyphsURL(c).replace("{fontstack}",l).replace("{range}",`${b}-${w}`),Ra.Glyphs);Uu(S,(D,k)=>{if(D)m(D);else if(k){const N={},V=new zb(k).readFields(mM,{});for(const G of V.glyphs)N[G.id]=G;m(null,{glyphs:N,ascender:V.ascender,descender:V.descender})}})},dd.TinySDF=class{constructor({fontSize:l=24,buffer:s=3,radius:c=8,cutoff:h=.25,fontFamily:m="sans-serif",fontWeight:b="normal",fontStyle:w="normal"}={}){this.buffer=s,this.cutoff=h,this.radius=c;const S=this.size=l+4*s,D=this._createCanvas(S),k=this.ctx=D.getContext("2d",{willReadFrequently:!0});k.font=`${w} ${b} ${l}px ${m}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(l){const s=document.createElement("canvas");return s.width=s.height=l,s}draw(l){const{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:h,actualBoundingBoxLeft:m,actualBoundingBoxRight:b}=this.ctx.measureText(l),w=Math.ceil(c),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-m))),D=Math.min(this.size-this.buffer,w+Math.ceil(h)),k=S+2*this.buffer,N=D+2*this.buffer,V=Math.max(k*N,0),G=new Uint8ClampedArray(V),q={data:G,width:k,height:N,glyphWidth:S,glyphHeight:D,glyphTop:w,glyphLeft:0,glyphAdvance:s};if(0===S||0===D)return q;const{ctx:Y,buffer:Q,gridInner:ae,gridOuter:ge}=this;Y.clearRect(Q,Q,S,D),Y.fillText(l,Q,Q+w);const De=Y.getImageData(Q,Q,S,D);ge.fill(jf,0,V),ae.fill(0,0,V);for(let _e=0;_e<D;_e++)for(let Ae=0;Ae<S;Ae++){const Ie=De.data[4*(_e*S+Ae)+3]/255;if(0===Ie)continue;const Le=(_e+Q)*k+Ae+Q;if(1===Ie)ge[Le]=0,ae[Le]=jf;else{const st=.5-Ie;ge[Le]=st>0?st*st:0,ae[Le]=st<0?st*st:0}}Kx(ge,0,0,k,N,k,this.f,this.v,this.z),Kx(ae,Q,Q,S,D,k,this.f,this.v,this.z);for(let _e=0;_e<V;_e++){const Ae=Math.sqrt(ge[_e])-Math.sqrt(ae[_e]);G[_e]=Math.round(255-255*(Ae/this.radius+this.cutoff))}return q}};const Zm=$a;function Hy(l,s,c,h){const m=[],b=l.image,w=b.pixelRatio,S=b.paddedRect.w-2*Zm,D=b.paddedRect.h-2*Zm,k=l.right-l.left,N=l.bottom-l.top,V=b.stretchX||[[0,S]],G=b.stretchY||[[0,D]],q=(ct,Pt)=>ct+Pt[1]-Pt[0],Y=V.reduce(q,0),Q=G.reduce(q,0),ae=S-Y,ge=D-Q;let De=0,_e=Y,Ae=0,Ie=Q,Le=0,st=ae,nt=0,Et=ge;if(b.content&&h){const ct=b.content;De=Wf(V,0,ct[0]),Ae=Wf(G,0,ct[1]),_e=Wf(V,ct[0],ct[2]),Ie=Wf(G,ct[1],ct[3]),Le=ct[0]-De,nt=ct[1]-Ae,st=ct[2]-ct[0]-_e,Et=ct[3]-ct[1]-Ie}const Yt=(ct,Pt,Lt,Gt)=>{const ai=Ym(ct.stretch-De,_e,k,l.left),bt=$f(ct.fixed-Le,st,ct.stretch,Y),_i=Ym(Pt.stretch-Ae,Ie,N,l.top),Ri=$f(Pt.fixed-nt,Et,Pt.stretch,Q),bi=Ym(Lt.stretch-De,_e,k,l.left),$n=$f(Lt.fixed-Le,st,Lt.stretch,Y),li=Ym(Gt.stretch-Ae,Ie,N,l.top),en=$f(Gt.fixed-nt,Et,Gt.stretch,Q),fn=new pi(ai,_i),Rr=new pi(bi,_i),qn=new pi(bi,li),cn=new pi(ai,li),Go=new pi(bt/w,Ri/w),Xn=new pi($n/w,en/w),Zn=s*Math.PI/180;if(Zn){const jo=Math.sin(Zn),ko=Math.cos(Zn),os=[ko,-jo,jo,ko];fn._matMult(os),Rr._matMult(os),cn._matMult(os),qn._matMult(os)}const co=ct.stretch+ct.fixed,Io=Pt.stretch+Pt.fixed;return{tl:fn,tr:Rr,bl:cn,br:qn,tex:{x:b.paddedRect.x+Zm+co,y:b.paddedRect.y+Zm+Io,w:Lt.stretch+Lt.fixed-co,h:Gt.stretch+Gt.fixed-Io},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Go,pixelOffsetBR:Xn,minFontScaleX:st/w/k,minFontScaleY:Et/w/N,isSDF:c}};if(h&&(b.stretchX||b.stretchY)){const ct=Jx(V,ae,Y),Pt=Jx(G,ge,Q);for(let Lt=0;Lt<ct.length-1;Lt++){const Gt=ct[Lt],ai=ct[Lt+1];for(let bt=0;bt<Pt.length-1;bt++)m.push(Yt(Gt,Pt[bt],ai,Pt[bt+1]))}}else m.push(Yt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:D+1}));return m}function Wf(l,s,c){let h=0;for(const m of l)h+=Math.max(s,Math.min(c,m[1]))-Math.max(s,Math.min(c,m[0]));return h}function Jx(l,s,c){const h=[{fixed:-Zm,stretch:0}];for(const[m,b]of l){const w=h[h.length-1];h.push({fixed:m-w.stretch,stretch:w.stretch}),h.push({fixed:m-w.stretch,stretch:w.stretch+(b-m)})}return h.push({fixed:s+Zm,stretch:c}),h}function Ym(l,s,c,h){return l/s*c+h}function $f(l,s,c,h){return l-s*c/h}function fh(l,s,c,h){const m=s+l.positionedLines[h].lineOffset;return 0===h?c+m/2:c+(m+(s+l.positionedLines[h-1].lineOffset))/2}class Vb{constructor(s=[],c=Hb){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const s=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:h}=this,m=c[s];for(;s>0;){const b=s-1>>1,w=c[b];if(h(m,w)>=0)break;c[s]=w,s=b}c[s]=m}_down(s){const{data:c,compare:h}=this,m=this.length>>1,b=c[s];for(;s<m;){let w=1+(s<<1),S=c[w];const D=w+1;if(D<this.length&&h(c[D],S)<0&&(w=D,S=c[D]),h(S,b)>=0)break;c[s]=S,s=w}c[s]=b}}function Hb(l,s){return l<s?-1:l>s?1:0}function xM(l,s=1,c=!1){let h=1/0,m=1/0,b=-1/0,w=-1/0;const S=l[0];for(let q=0;q<S.length;q++){const Y=S[q];(!q||Y.x<h)&&(h=Y.x),(!q||Y.y<m)&&(m=Y.y),(!q||Y.x>b)&&(b=Y.x),(!q||Y.y>w)&&(w=Y.y)}const D=Math.min(b-h,w-m);let k=D/2;const N=new Vb([],wM);if(0===D)return new pi(h,m);for(let q=h;q<b;q+=D)for(let Y=m;Y<w;Y+=D)N.push(new qf(q+k,Y+k,k,l));let V=function(q){let Y=0,Q=0,ae=0;const ge=q[0];for(let De=0,_e=ge.length,Ae=_e-1;De<_e;Ae=De++){const Ie=ge[De],Le=ge[Ae],st=Ie.x*Le.y-Le.x*Ie.y;Q+=(Ie.x+Le.x)*st,ae+=(Ie.y+Le.y)*st,Y+=3*st}return new qf(Q/Y,ae/Y,0,q)}(l),G=N.length;for(;N.length;){const q=N.pop();(q.d>V.d||!V.d)&&(V=q,c&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,G)),q.max-V.d<=s||(k=q.h/2,N.push(new qf(q.p.x-k,q.p.y-k,k,l)),N.push(new qf(q.p.x+k,q.p.y-k,k,l)),N.push(new qf(q.p.x-k,q.p.y+k,k,l)),N.push(new qf(q.p.x+k,q.p.y+k,k,l)),G+=4)}return c&&(console.log(`num probes: ${G}`),console.log(`best distance: ${V.d}`)),V.p}function wM(l,s){return s.max-l.max}class qf{constructor(s,c,h,m){this.p=new pi(s,c),this.h=h,this.d=function(b,w){let S=!1,D=1/0;for(let k=0;k<w.length;k++){const N=w[k];for(let V=0,G=N.length,q=G-1;V<G;q=V++){const Y=N[V],Q=N[q];Y.y>b.y!=Q.y>b.y&&b.x<(Q.x-Y.x)*(b.y-Y.y)/(Q.y-Y.y)+Y.x&&(S=!S),D=Math.min(D,wx(b,Y,Q))}}return(S?1:-1)*Math.sqrt(D)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const fu=7,Gb=Number.POSITIVE_INFINITY,MM=Math.sqrt(2);function Qx(l,[s,c]){let h=0,m=0;if(c===Gb){s<0&&(s=0);const b=s/MM;switch(l){case"top-right":case"top-left":m=b-fu;break;case"bottom-right":case"bottom-left":m=-b+fu;break;case"bottom":m=-s+fu;break;case"top":m=s-fu}switch(l){case"top-right":case"bottom-right":h=-b;break;case"top-left":case"bottom-left":h=b;break;case"left":h=s;break;case"right":h=-s}}else{switch(s=Math.abs(s),c=Math.abs(c),l){case"top-right":case"top-left":case"top":m=c-fu;break;case"bottom-right":case"bottom-left":case"bottom":m=-c+fu}switch(l){case"top-right":case"bottom-right":case"right":h=-s;break;case"top-left":case"bottom-left":case"left":h=s}}return[h,m]}function jb(l,s,c,h,m,b,w,S,D,k){l.createArrays(),l.tilePixelRatio=Xi/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const N=l.layers[0].layout,V=l.layers[0]._unevaluatedLayout._values,G={};if("composite"===l.textSizeData.kind){const{minZoom:Q,maxZoom:ae}=l.textSizeData;G.compositeTextSizes=[V["text-size"].possiblyEvaluate(new z(Q),S),V["text-size"].possiblyEvaluate(new z(ae),S)]}if("composite"===l.iconSizeData.kind){const{minZoom:Q,maxZoom:ae}=l.iconSizeData;G.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new z(Q),S),V["icon-size"].possiblyEvaluate(new z(ae),S)]}G.layoutTextSize=V["text-size"].possiblyEvaluate(new z(D+1),S),G.layoutIconSize=V["icon-size"].possiblyEvaluate(new z(D+1),S),G.textMaxSize=V["text-size"].possiblyEvaluate(new z(18),S);const q="map"===N.get("text-rotation-alignment")&&"point"!==N.get("symbol-placement"),Y=N.get("text-size");for(const Q of l.features){const ae=N.get("text-font").evaluate(Q,{},S).join(","),ge=Y.evaluate(Q,{},S),De=G.layoutTextSize.evaluate(Q,{},S),_e=(G.layoutIconSize.evaluate(Q,{},S),{horizontal:{},vertical:void 0}),Ae=Q.text;let Ie,Le=[0,0];if(Ae){const Et=Ae.toString(),Yt=N.get("text-letter-spacing").evaluate(Q,{},S)*fa,ct=N.get("text-line-height").evaluate(Q,{},S)*fa,Pt=zv(Et)?Yt:0,Lt=N.get("text-anchor").evaluate(Q,{},S),Gt=N.get("text-variable-anchor");if(!Gt){const bi=N.get("text-radial-offset").evaluate(Q,{},S);Le=bi?Qx(Lt,[bi*fa,Gb]):N.get("text-offset").evaluate(Q,{},S).map($n=>$n*fa)}let ai=q?"center":N.get("text-justify").evaluate(Q,{},S);const bt="point"===N.get("symbol-placement"),_i=bt?N.get("text-max-width").evaluate(Q,{},S)*fa:1/0,Ri=bi=>{l.allowVerticalPlacement&&Sm(Et)&&(_e.vertical=Zs(Ae,s,c,m,ae,_i,ct,Lt,bi,Pt,Le,lc.vertical,!0,De,ge))};if(!q&&Gt){const bi="auto"===ai?Gt.map(li=>Km(li)):[ai];let $n=!1;for(let li=0;li<bi.length;li++){const en=bi[li];if(!_e.horizontal[en])if($n)_e.horizontal[en]=_e.horizontal[0];else{const fn=Zs(Ae,s,c,m,ae,_i,ct,"center",en,Pt,Le,lc.horizontal,!1,De,ge);fn&&(_e.horizontal[en]=fn,$n=1===fn.positionedLines.length)}}Ri("left")}else{if("auto"===ai&&(ai=Km(Lt)),bt||N.get("text-writing-mode").indexOf("horizontal")>=0||!Sm(Et)){const bi=Zs(Ae,s,c,m,ae,_i,ct,Lt,ai,Pt,Le,lc.horizontal,!1,De,ge);bi&&(_e.horizontal[ai]=bi)}Ri(bt?"left":ai)}}let st=!1;if(Q.icon&&Q.icon.name){const Et=h[Q.icon.name];Et&&(Ie=Ot(m[Q.icon.name],N.get("icon-offset").evaluate(Q,{},S),N.get("icon-anchor").evaluate(Q,{},S)),st=Et.sdf,void 0===l.sdfIcons?l.sdfIcons=Et.sdf:l.sdfIcons!==Et.sdf&&_o("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Et.pixelRatio!==l.pixelRatio||0!==N.get("icon-rotate").constantOr(1))&&(l.iconsNeedLinear=!0))}const nt=ma(_e.horizontal)||_e.vertical;l.iconsInText||(l.iconsInText=!!nt&&nt.iconsInText),(nt||Ie)&&EM(l,Q,_e,Ie,h,G,De,0,Le,st,w,S,k)}b&&l.generateCollisionDebugBuffers(D,l.collisionBoxArray)}function Km(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function EM(l,s,c,h,m,b,w,S,D,k,N,V,G){let q=b.textMaxSize.evaluate(s,{},V);void 0===q&&(q=w);const Y=l.layers[0].layout,Q=Y.get("icon-offset").evaluate(s,{},V),ae=ma(c.horizontal)||c.vertical,ge="globe"===G.name,De=fa,_e=w/De,Ae=l.tilePixelRatio*q/De,Ie=(Lt=l.overscaling,l.zoom>18&&Lt>2&&(Lt>>=1),Math.max(Xi/(512*Lt),1)*Y.get("symbol-spacing")),Le=Y.get("text-padding")*l.tilePixelRatio,st=Y.get("icon-padding")*l.tilePixelRatio,nt=er(Y.get("text-max-angle")),Et="map"===Y.get("text-rotation-alignment")&&"point"!==Y.get("symbol-placement"),Yt="map"===Y.get("icon-rotation-alignment")&&"point"!==Y.get("symbol-placement"),ct=Y.get("symbol-placement"),Pt=Ie/2;var Lt;const Gt=Y.get("icon-text-fit");let ai;h&&"none"!==Gt&&(l.allowVerticalPlacement&&c.vertical&&(ai=Xm(h,c.vertical,Gt,Y.get("icon-text-fit-padding"),Q,_e)),ae&&(h=Xm(h,ae,Gt,Y.get("icon-text-fit-padding"),Q,_e)));const bt=(_i,Ri,bi)=>{if(Ri.x<0||Ri.x>=Xi||Ri.y<0||Ri.y>=Xi)return;let $n=null;if(ge){const{x:li,y:en,z:fn}=G.projectTilePoint(Ri.x,Ri.y,bi);$n={anchor:new ph(li,en,fn,0,void 0),up:G.upVector(bi,Ri.x,Ri.y)}}!function(li,en,fn,Rr,qn,cn,Go,Xn,Zn,co,Io,jo,ko,os,_s,Vs,Mo,Wo,Ys,ys,Ur,Ks,No,Fc,ya){const Xa=li.addToLineVertexArray(en,Rr);let Za,bl,Hs,Od,Kb,Jb,Yy,UM=0,cS=0,dS=0,VM=0,cw=-1,m_=-1;const nf={};let HM=dl("");const ng=fn?fn.anchor:en;let GM=0,jM=0;if(void 0===Zn._unevaluatedLayout.getValue("text-radial-offset")?[GM,jM]=Zn.layout.get("text-offset").evaluate(Ur,{},ya).map(Nd=>Nd*fa):(GM=Zn.layout.get("text-radial-offset").evaluate(Ur,{},ya)*fa,jM=Gb),li.allowVerticalPlacement&&qn.vertical){const Nd=qn.vertical;if(_s)Jb=Wb(Nd),Xn&&(Yy=Wb(Xn));else{const Bd=Zn.layout.get("text-rotate").evaluate(Ur,{},ya)+90;Hs=Qm(co,ng,en,Io,jo,ko,Nd,os,Bd,Vs),Xn&&(Od=Qm(co,ng,en,Io,jo,ko,Xn,Wo,Bd))}}if(cn){const Nd=Zn.layout.get("icon-rotate").evaluate(Ur,{},ya),Bd="none"!==Zn.layout.get("icon-text-fit"),Qb=Hy(cn,Nd,No,Bd),$M=Xn?Hy(Xn,Nd,No,Bd):void 0;bl=Qm(co,ng,en,Io,jo,ko,cn,Wo,Nd),UM=4*Qb.length;const uS=li.iconSizeData;let g_=null;"source"===uS.kind?(g_=[gl*Zn.layout.get("icon-size").evaluate(Ur,{},ya)],g_[0]>cc&&_o(`${li.layerIds[0]}: Value for "icon-size" is >= ${Jm}. Reduce your "icon-size".`)):"composite"===uS.kind&&(g_=[gl*Ks.compositeIconSizes[0].evaluate(Ur,{},ya),gl*Ks.compositeIconSizes[1].evaluate(Ur,{},ya)],(g_[0]>cc||g_[1]>cc)&&_o(`${li.layerIds[0]}: Value for "icon-size" is >= ${Jm}. Reduce your "icon-size".`)),li.addSymbols(li.icon,Qb,g_,ys,Ys,Ur,!1,fn,en,Xa.lineStartIndex,Xa.lineLength,-1,Fc,ya),cw=li.icon.placedSymbolArray.length-1,$M&&(cS=4*$M.length,li.addSymbols(li.icon,$M,g_,ys,Ys,Ur,lc.vertical,fn,en,Xa.lineStartIndex,Xa.lineLength,-1,Fc,ya),m_=li.icon.placedSymbolArray.length-1)}for(const Nd in qn.horizontal){const Bd=qn.horizontal[Nd];Za||(HM=dl(Bd.text),_s?Kb=Wb(Bd):Za=Qm(co,ng,en,Io,jo,ko,Bd,os,Zn.layout.get("text-rotate").evaluate(Ur,{},ya),Vs));const Qb=1===Bd.positionedLines.length;if(dS+=CM(li,fn,en,Bd,Go,Zn,_s,Ur,Vs,Xa,qn.vertical?lc.horizontal:lc.horizontalOnly,Qb?Object.keys(qn.horizontal):[Nd],nf,cw,Ks,Fc,ya),Qb)break}qn.vertical&&(VM+=CM(li,fn,en,qn.vertical,Go,Zn,_s,Ur,Vs,Xa,lc.vertical,["vertical"],nf,m_,Ks,Fc,ya));let _h=-1;const WM=(Nd,Bd)=>Nd?Math.max(Nd,Bd):Bd;_h=WM(Kb,_h),_h=WM(Jb,_h),_h=WM(Yy,_h);const kL=_h>-1?1:0;li.glyphOffsetArray.length>=_u.MAX_GLYPHS&&_o("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ur.sortKey&&li.addToSortKeyRanges(li.symbolInstances.length,Ur.sortKey),li.symbolInstances.emplaceBack(ng.x,ng.y,ng.z,en.x,en.y,nf.right>=0?nf.right:-1,nf.center>=0?nf.center:-1,nf.left>=0?nf.left:-1,nf.vertical>=0?nf.vertical:-1,cw,m_,HM,void 0!==Za?Za:li.collisionBoxArray.length,void 0!==Za?Za+1:li.collisionBoxArray.length,void 0!==Hs?Hs:li.collisionBoxArray.length,void 0!==Hs?Hs+1:li.collisionBoxArray.length,void 0!==bl?bl:li.collisionBoxArray.length,void 0!==bl?bl+1:li.collisionBoxArray.length,Od||li.collisionBoxArray.length,Od?Od+1:li.collisionBoxArray.length,Io,dS,VM,UM,cS,kL,0,GM,jM,_h)}(l,Ri,$n,_i,c,h,m,ai,l.layers[0],l.collisionBoxArray,s.index,s.sourceLayerIndex,l.index,Le,Et,D,0,st,Yt,Q,s,b,k,N,V)};if("line"===ct)for(const _i of bM(s.geometry,0,0,Xi,Xi)){const Ri=Yx(_i,Ie,nt,c.vertical||ae,h,De,Ae,l.overscaling,Xi);for(const bi of Ri)ae&&ew(l,ae.text,Pt,bi)||bt(_i,bi,V)}else if("line-center"===ct){for(const _i of s.geometry)if(_i.length>1){const Ri=Zx(_i,nt,c.vertical||ae,h,De,Ae);Ri&&bt(_i,Ri,V)}}else if("Polygon"===s.type)for(const _i of Qg(s.geometry,0)){const Ri=xM(_i,16);bt(_i[0],new ph(Ri.x,Ri.y,0,0,void 0),V)}else if("LineString"===s.type)for(const _i of s.geometry)bt(_i,new ph(_i[0].x,_i[0].y,0,0,void 0),V);else if("Point"===s.type)for(const _i of s.geometry)for(const Ri of _i)bt([Ri],new ph(Ri.x,Ri.y,0,0,void 0),V)}const Jm=255,cc=Jm*gl;function CM(l,s,c,h,m,b,w,S,D,k,N,V,G,q,Y,Q,ae){const ge=function(Ae,Ie,Le,st,nt,Et,Yt,ct){const Pt=[];if(0===Ie.positionedLines.length)return Pt;const Lt=st.layout.get("text-rotate").evaluate(Et,{})*Math.PI/180,Gt=function(bi){const $n=bi[0],li=bi[1],en=$n*li;return en>0?[$n,-li]:en<0?[-$n,li]:0===$n?[li,$n]:[li,-$n]}(Le);let ai=Math.abs(Ie.top-Ie.bottom);for(const bi of Ie.positionedLines)ai-=bi.lineOffset;const bt=Ie.positionedLines.length,_i=ai/bt;let Ri=Ie.top-Le[1];for(let bi=0;bi<bt;++bi){const $n=Ie.positionedLines[bi];Ri=fh(Ie,_i,Ri,bi);for(const li of $n.positionedGlyphs){if(!li.rect)continue;const en=li.rect||{};let fn=Gx+1,Rr=!0,qn=1,cn=0;if(li.imageName){const No=Yt[li.imageName];if(!No)continue;if(No.sdf){_o("SDF images are not supported in formatted text and will be ignored.");continue}Rr=!1,qn=No.pixelRatio,fn=$a/qn}const Go=(nt||ct)&&li.vertical,Xn=li.metrics.advance*li.scale/2,Zn=li.metrics,co=li.rect;if(null===co)continue;ct&&Ie.verticalizable&&(cn=li.imageName?Xn-li.metrics.width*li.scale/2:0);const Io=nt?[li.x+Xn,li.y]:[0,0];let jo=[0,0],ko=[0,0],os=!1;nt||(Go?(ko=[li.x+Xn+Gt[0],li.y+Gt[1]-cn],os=!0):jo=[li.x+Xn+Le[0],li.y+Le[1]-cn]);const _s=co.w*li.scale/(qn*(li.localGlyph?Rd:1)),Vs=co.h*li.scale/(qn*(li.localGlyph?Rd:1));let Mo,Wo,Ys,ys;if(Go){const No=li.y-Ri,Fc=new pi(-Xn,Xn-No),ya=-Math.PI/2,Xa=new pi(...ko);Mo=new pi(-Xn+jo[0],jo[1]),Mo._rotateAround(ya,Fc)._add(Xa),Mo.x+=-No+Xn,Mo.y-=(Zn.left-fn)*li.scale;const Za=li.imageName?Zn.advance*li.scale:fa*li.scale,bl=String.fromCharCode(li.glyph);ld(bl)?Mo.x+=(1-fn)*li.scale:cd(bl)?Mo.x+=Za-Zn.height*li.scale+(-fn-1)*li.scale:Mo.x+=li.imageName||Zn.width+2*fn===co.w&&Zn.height+2*fn===co.h?(Za-Vs)/2:(Za-(Zn.height+2*fn)*li.scale)/2,Wo=new pi(Mo.x,Mo.y-_s),Ys=new pi(Mo.x+Vs,Mo.y),ys=new pi(Mo.x+Vs,Mo.y-_s)}else{const No=(Zn.left-fn)*li.scale-Xn+jo[0],Fc=(-Zn.top-fn)*li.scale+jo[1],ya=No+_s,Xa=Fc+Vs;Mo=new pi(No,Fc),Wo=new pi(ya,Fc),Ys=new pi(No,Xa),ys=new pi(ya,Xa)}if(Lt){let No;No=nt?new pi(0,0):os?new pi(Gt[0],Gt[1]):new pi(Le[0],Le[1]),Mo._rotateAround(Lt,No),Wo._rotateAround(Lt,No),Ys._rotateAround(Lt,No),ys._rotateAround(Lt,No)}const Ur=new pi(0,0),Ks=new pi(0,0);Pt.push({tl:Mo,tr:Wo,bl:Ys,br:ys,tex:en,writingMode:Ie.writingMode,glyphOffset:Io,sectionIndex:li.sectionIndex,isSDF:Rr,pixelOffsetTL:Ur,pixelOffsetBR:Ks,minFontScaleX:0,minFontScaleY:0})}}return Pt}(0,h,D,b,w,S,m,l.allowVerticalPlacement),De=l.textSizeData;let _e=null;"source"===De.kind?(_e=[gl*b.layout.get("text-size").evaluate(S,{},ae)],_e[0]>cc&&_o(`${l.layerIds[0]}: Value for "text-size" is >= ${Jm}. Reduce your "text-size".`)):"composite"===De.kind&&(_e=[gl*Y.compositeTextSizes[0].evaluate(S,{},ae),gl*Y.compositeTextSizes[1].evaluate(S,{},ae)],(_e[0]>cc||_e[1]>cc)&&_o(`${l.layerIds[0]}: Value for "text-size" is >= ${Jm}. Reduce your "text-size".`)),l.addSymbols(l.text,ge,_e,D,w,S,N,s,c,k.lineStartIndex,k.lineLength,q,Q,ae);for(const Ae of V)G[Ae]=l.text.placedSymbolArray.length-1;return 4*ge.length}function ma(l){for(const s in l)return l[s];return null}function Qm(l,s,c,h,m,b,w,S,D,k){let N=w.top,V=w.bottom,G=w.left,q=w.right;const Y=w.collisionPadding;if(Y&&(G-=Y[0],N-=Y[1],q+=Y[2],V+=Y[3]),D){const Q=new pi(G,N),ae=new pi(q,N),ge=new pi(G,V),De=new pi(q,V),_e=er(D);let Ae=new pi(0,0);k&&(Ae=new pi(k[0],k[1])),Q._rotateAround(_e,Ae),ae._rotateAround(_e,Ae),ge._rotateAround(_e,Ae),De._rotateAround(_e,Ae),G=Math.min(Q.x,ae.x,ge.x,De.x),q=Math.max(Q.x,ae.x,ge.x,De.x),N=Math.min(Q.y,ae.y,ge.y,De.y),V=Math.max(Q.y,ae.y,ge.y,De.y)}return l.emplaceBack(s.x,s.y,s.z,c.x,c.y,G,N,q,V,S,h,m,b),l.length-1}function Wb(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const s=l.bottom-l.top;return s>0?Math.max(10,s):null}function ew(l,s,c,h){const m=l.compareText;if(s in m){const b=m[s];for(let w=b.length-1;w>=0;w--)if(h.dist(b[w])<c)return!0}else m[s]=[];return m[s].push(h),!1}function tw(l,s){const c=l.fovAboveCenter,h=l.elevation?l.elevation.getMinElevationBelowMSL()*s:0,m=(l._camera.position[2]*l.worldSize-h)/Math.cos(l._pitch),b=Math.sin(c)*m/Math.sin(Math.max(Math.PI/2-l._pitch-c,.01)),w=Math.sin(l._pitch)*b+m;return Math.min(1.01*w,m*(1/l._horizonShift))}function mu(l,s){if(!s.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:s};const c=Math.pow(2,-l.z),h=l.x*c,m=(l.x+1)*c,b=l.y*c,w=(l.y+1)*c,S=od(h),D=od(m),k=Ha(b),N=Ha(w),V=s.project(S,k),G=s.project(D,k),q=s.project(D,N),Y=s.project(S,N);let Q=Math.min(V.x,G.x,q.x,Y.x),ae=Math.min(V.y,G.y,q.y,Y.y),ge=Math.max(V.x,G.x,q.x,Y.x),De=Math.max(V.y,G.y,q.y,Y.y);const _e=c/16;function Ae(Le,st,nt,Et,Yt,ct){const Pt=(nt+Yt)/2,Lt=(Et+ct)/2,Gt=s.project(od(Pt),Ha(Lt)),ai=Math.max(0,Q-Gt.x,ae-Gt.y,Gt.x-ge,Gt.y-De);Q=Math.min(Q,Gt.x),ge=Math.max(ge,Gt.x),ae=Math.min(ae,Gt.y),De=Math.max(De,Gt.y),ai>_e&&(Ae(Le,Gt,nt,Et,Pt,Lt),Ae(Gt,st,Pt,Lt,Yt,ct))}Ae(V,G,h,b,m,b),Ae(G,q,m,b,m,w),Ae(q,Y,m,w,h,w),Ae(Y,V,h,w,h,b),Q-=_e,ae-=_e,ge+=_e,De+=_e;const Ie=1/Math.max(ge-Q,De-ae);return{scale:Ie,x:Q*Ie,y:ae*Ie,x2:ge*Ie,y2:De*Ie,projection:s}}const SM=Ds(new Float32Array(16));class mh{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,c){return{x:0,y:0,z:0}}unproject(s,c){return new kr(0,0)}projectTilePoint(s,c,h){return{x:s,y:c,z:0}}locationPoint(s,c,h=!0){return s._coordinatePoint(s.locationCoordinate(c),h)}pixelsPerMeter(s,c){return hu(1,s)*c}pixelSpaceConversion(s,c,h){return 1}farthestPixelDistance(s){return tw(s,s.pixelsPerMeter)}pointCoordinate(s,c,h,m){const b=s.horizonLineFromTop(!1),w=new pi(c,Math.max(b,h));return s.rayIntersectionCoordinate(s.pointRayIntersection(w,m))}pointCoordinate3D(s,c,h){const m=new pi(c,h);if(s.elevation)return s.elevation.pointCoordinate(m);{const b=this.pointCoordinate(s,m.x,m.y,0);return[b.x,b.y,b.z]}}isPointAboveHorizon(s,c){if(s.elevation)return!this.pointCoordinate3D(s,c.x,c.y);const h=s.horizonLineFromTop();return c.y<h}createInversionMatrix(s,c){return SM}createTileMatrix(s,c,h){let m,b,w;const S=h.canonical,D=Ds(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=mu(S,this);m=1,b=k.x+h.wrap*k.scale,w=k.y,nd(D,D,[m/k.scale,m/k.scale,s.pixelsPerMeter/c])}else m=c/s.zoomScale(S.z),b=(S.x+Math.pow(2,S.z)*h.wrap)*m,w=S.y*m;return Zh(D,D,[b,w,0]),nd(D,D,[m/Xi,m/Xi,1]),D}upVector(s,c,h){return[0,0,1]}upVectorScale(s,c,h){return{metersToTile:1}}}class $b extends mh{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[c,h]=this.parallels=s.parallels||[29.5,45.5],m=Math.sin(er(c));this.n=(m+Math.sin(er(h)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(s,c){const{n:h,c:m,r0:b}=this,w=er(s-this.center[0]),S=er(c),D=Math.sqrt(m-2*h*Math.sin(S))/h;return{x:D*Math.sin(w*h),y:D*Math.cos(w*h)-b,z:0}}unproject(s,c){const{n:h,c:m,r0:b}=this,w=b+c;let S=Math.atan2(s,Math.abs(w))*Math.sign(w);w*h<0&&(S-=Math.PI*Math.sign(s)*Math.sign(w));const D=er(this.center[0])*h;S=Cn(S,-Math.PI-D,Math.PI-D);const k=pr(ia(S/h)+this.center[0],-180,180),N=Math.asin(pr((m-(s*s+w*w)*h*h)/(2*h),-1,1)),V=pr(ia(N),-Ga,Ga);return new kr(k,V)}}const gu=1.340264,Xf=-.081106,Zf=893e-6,op=.003796,ga=Math.sqrt(3)/2;class Yf extends mh{project(s,c){c=c/180*Math.PI,s=s/180*Math.PI;const h=Math.asin(ga*Math.sin(c)),m=h*h,b=m*m*m;return{x:.5*(s*Math.cos(h)/(ga*(gu+3*Xf*m+b*(7*Zf+9*op*m)))/Math.PI+.5),y:1-.5*(h*(gu+Xf*m+b*(Zf+op*m))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let h=c=(2*(1-c)-1)*Math.PI,m=h*h,b=m*m*m;for(let N,V,G,q=0;q<12&&(V=h*(gu+Xf*m+b*(Zf+op*m))-c,G=gu+3*Xf*m+b*(7*Zf+9*op*m),N=V/G,h=pr(h-N,-Math.PI/3,Math.PI/3),m=h*h,b=m*m*m,!(Math.abs(N)<1e-12));++q);const w=ga*s*(gu+3*Xf*m+b*(7*Zf+9*op*m))/Math.cos(h),S=Math.asin(Math.sin(h)/ga),D=pr(180*w/Math.PI,-180,180),k=pr(180*S/Math.PI,-Ga,Ga);return new kr(D,k)}}class iw extends mh{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){return{x:.5+s/360,y:.5-c/360,z:0}}unproject(s,c){const h=360*(s-.5),m=pr(360*(.5-c),-Ga,Ga);return new kr(h,m)}}const Kp=Math.PI/2;function Kf(l){return Math.tan((Kp+l)/2)}class tS extends mh{constructor(s){super(s),this.center=s.center||[0,30];const[c,h]=this.parallels=s.parallels||[30,30];let m=er(c),b=er(h);this.southernCenter=m+b<0,this.southernCenter&&(m=-m,b=-b);const w=Math.cos(m),S=Kf(m);this.n=m===b?Math.sin(m):Math.log(w/Math.cos(b))/Math.log(Kf(b)/S),this.f=w*Math.pow(Kf(m),this.n)/this.n}project(s,c){c=er(c),this.southernCenter&&(c=-c),s=er(s-this.center[0]);const h=1e-6,{n:m,f:b}=this;b>0?c<-Kp+h&&(c=-Kp+h):c>Kp-h&&(c=Kp-h);const w=b/Math.pow(Kf(c),m);let S=w*Math.sin(m*s),D=b-w*Math.cos(m*s);return S=.5*(S/Math.PI+.5),D=.5*(D/Math.PI+.5),{x:S,y:this.southernCenter?D:1-D,z:0}}unproject(s,c){s=(2*s-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:h,f:m}=this,b=m-c,w=Math.sign(b),S=Math.sign(h)*Math.sqrt(s*s+b*b);let D=Math.atan2(s,Math.abs(b))*w;b*h<0&&(D-=Math.PI*Math.sign(s)*w);const k=pr(ia(D/h)+this.center[0],-180,180),N=pr(ia(2*Math.atan(Math.pow(m/S,1/h))-Kp),-Ga,Ga);return new kr(k,this.southernCenter?-N:N)}}class eg extends mh{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,c){return{x:uu(s),y:lh(c),z:0}}unproject(s,c){const h=od(s),m=Ha(c);return new kr(h,m)}}const Gy=er(Ga);class jy extends mh{project(s,c){const h=(c=er(c))*c,m=h*h;return{x:.5*((s=er(s))*(.8707-.131979*h+m*(m*(.003971*h-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+h*(.015085+m*(.028874*h-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let h=c=(2*(1-c)-1)*Math.PI,m=25,b=0,w=h*h;do{w=h*h;const k=w*w;b=(h*(1.007226+w*(.015085+k*(.028874*w-.044475-.005916*k)))-c)/(1.007226+w*(.045255+k*(.259866*w-.311325-.005916*11*k))),h=pr(h-b,-Gy,Gy)}while(Math.abs(b)>1e-6&&--m>0);w=h*h;const S=pr(ia(s/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),D=ia(h);return new kr(S,D)}}const nw=er(Ga);class TM extends mh{project(s,c){c=er(c),s=er(s);const h=Math.cos(c),m=2/Math.PI,b=Math.acos(h*Math.cos(s/2)),w=Math.sin(b)/b,S=.5*(s*m+2*h*Math.sin(s/2)/w)||0,D=.5*(c+Math.sin(c)/w)||0;return{x:.5*(S/Math.PI+.5),y:1-.5*(D/Math.PI+1),z:0}}unproject(s,c){let h=s=(2*s-.5)*Math.PI,m=c=(2*(1-c)-1)*Math.PI,b=25;const w=1e-6;let S=0,D=0;do{const k=Math.cos(m),N=Math.sin(m),V=2*N*k,G=N*N,q=k*k,Y=Math.cos(h/2),Q=Math.sin(h/2),ae=2*Y*Q,ge=Q*Q,De=1-q*Y*Y,_e=De?1/De:0,Ae=De?Math.acos(k*Y)*Math.sqrt(1/De):0,Ie=.5*(2*Ae*k*Q+2*h/Math.PI)-s,Le=.5*(Ae*N+m)-c,st=.5*_e*(q*ge+Ae*k*Y*G)+1/Math.PI,nt=_e*(ae*V/4-Ae*N*Q),Et=.125*_e*(V*Q-Ae*N*q*ae),Yt=.5*_e*(G*Y+Ae*ge*k)+.5,ct=nt*Et-Yt*st;S=(Le*nt-Ie*Yt)/ct,D=(Ie*Et-Le*st)/ct,h=pr(h-S,-Math.PI,Math.PI),m=pr(m-D,-nw,nw)}while((Math.abs(S)>w||Math.abs(D)>w)&&--b>0);return new kr(ia(h),ia(m))}}class qb extends mh{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(er(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){const{scale:h,cosPhi:m}=this;return{x:er(s)*m*h+.5,y:-Math.sin(er(c))/m*h+.5,z:0}}unproject(s,c){const{scale:h,cosPhi:m}=this,b=-(c-.5)/h,w=pr(ia((s-.5)/h)/m,-180,180),S=Math.asin(pr(b*m,-1,1)),D=pr(ia(S),-Ga,Ga);return new kr(w,D)}}class rw extends eg{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,c,h){const m=Is(s,c,h);return ds(m,m,qg(cu(h))),{x:m[0],y:m[1],z:m[2]}}locationPoint(s,c){const h=Wg(c.lat,c.lng),m=Bs([],h),b=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(c),s._centerAltitude):s._centerAltitude;Gp(h,h,m,hu(1,0)*Xi*b);const w=Ds(new Float64Array(16));return Xh(w,s.pixelMatrix,s.globeMatrix),ds(h,h,w),new pi(h[0],h[1])}pixelsPerMeter(s,c){return hu(1,0)*c}pixelSpaceConversion(s,c,h){const m=hu(1,s)*c,b=Mr(hu(1,45)*c,m,h);return this.pixelsPerMeter(s,c)/b}createTileMatrix(s,c,h){const m=zl(cu(h.canonical));return Xh(new Float64Array(16),s.globeMatrix,m)}createInversionMatrix(s,c){const{center:h}=s,m=qg(cu(c));return th(m,m,er(h.lng)),cy(m,m,er(h.lat)),nd(m,m,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(s,c,h,m){return Xs(s,c,h,!0)||new Jh(0,0)}pointCoordinate3D(s,c,h){const m=this.pointCoordinate(s,c,h,0);return[m.x,m.y,m.z]}isPointAboveHorizon(s,c){return!Xs(s,c.x,c.y,!1)}farthestPixelDistance(s){const c=function(m,b){const w=m.cameraToCenterDistance,S=m._centerAltitude*b,D=m._camera,k=m._camera.forward(),N=su([],Nl([],k,-w),[0,0,S]),V=m.worldSize/(2*Math.PI),G=[0,0,-V],q=m.width/m.height,Y=Math.tan(m.fovAboveCenter),Q=Nl([],D.up(),Y),ae=Nl([],D.right(),Y*q),ge=Bs([],su([],su([],k,Q),ae)),De=[];let _e;if(new rh(N,ge).closestPointOnSphere(G,V,De)){const Ae=su([],De,G),Ie=Dd([],Ae,N);_e=Math.cos(m.fovAboveCenter)*km(Ie)}else{const Ae=Dd([],N,G),Ie=Dd([],G,N);Bs(Ie,Ie);const Le=km(Ae)-V;_e=Math.sqrt(Le*(Le+2*V));const st=Math.acos(_e/(V+Le))-Math.acos(Ad(k,Ie));_e*=Math.cos(st)}return 1.01*_e}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),h=du(s.zoom);if(h>0){const m=tw(s,hu(1,s.center.lat)*s.worldSize),b=s.worldSize/(2*Math.PI),w=Math.max(s.width,s.height)/s.worldSize*Math.PI;return Mr(c,m+b*(1-Math.cos(w)),Math.pow(h,10))}return c}upVector(s,c,h){return Is(c,h,s,1)}upVectorScale(s){return{metersToTile:Lc($g(cu(s)))}}}function Xb(l){const s=l.parallels,c=!!s&&Math.abs(s[0]+s[1])<.01;switch(l.name){case"mercator":return new eg(l);case"equirectangular":return new iw(l);case"naturalEarth":return new jy(l);case"equalEarth":return new Yf(l);case"winkelTripel":return new TM(l);case"albers":return c?new qb(l):new $b(l);case"lambertConformalConic":return c?new qb(l):new tS(l);case"globe":return new rw(l)}throw new Error(`Invalid projection name: ${l.name}`)}const AM=Dy.types,iS=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Wy(l,s,c,h,m,b,w,S,D,k,N,V,G){const q=S?Math.min(cc,Math.round(S[0])):0,Y=S?Math.min(cc,Math.round(S[1])):0;l.emplaceBack(s,c,Math.round(32*h),Math.round(32*m),b,w,(q<<1)+(D?1:0),Y,16*k,16*N,256*V,256*G)}function Jp(l,s,c,h,m,b,w){l.emplaceBack(s,c,h,m,b,w)}function Qp(l,s,c,h,m){l.emplaceBack(s,c,h,m),l.emplaceBack(s,c,h,m),l.emplaceBack(s,c,h,m),l.emplaceBack(s,c,h,m)}function DM(l){for(const s of l.sections)if(Tm(s.text))return!0;return!1}class $y{constructor(s){this.layoutVertexArray=new Bt,this.indexArray=new Bi,this.programConfigurations=s,this.segments=new As,this.dynamicLayoutVertexArray=new Rt,this.opacityVertexArray=new $i,this.placedSymbolArray=new gs,this.globeExtVertexArray=new Zt}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(s,c,h,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,jm.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,rs.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,iS,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,ks.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ii($y,"SymbolBuffers");class u_{constructor(s,c,h){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new h,this.segments=new As,this.collisionVertexArray=new sr,this.collisionVertexArrayExt=new Bn}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,s_.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,Db.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ii(u_,"CollisionBuffers");class _u{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(w=>w.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ds([]),this.placementViewportMatrix=Ds([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=kb(this.zoom,c["text-size"]),this.iconSizeData=kb(this.zoom,c["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),b=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==b&&void 0!==m.constantOr(1),this.sortFeaturesByY=("viewport-y"===b||"auto"===b&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(w=>lc[w]),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=s.sourceID,this.projection=s.projection}createArrays(){this.text=new $y(new Qu(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new $y(new Qu(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new Ut,this.lineVertexArray=new xr,this.symbolInstances=new xo}calculateGlyphDependencies(s,c,h,m,b){for(let w=0;w<s.length;w++)if(c[s.charCodeAt(w)]=!0,m&&b){const S=Wa[s.charAt(w)];S&&(c[S.charCodeAt(0)]=!0)}}populate(s,c,h,m){const b=this.layers[0],w=b.layout,S="globe"===this.projection.name,D=w.get("text-font"),k=w.get("text-field"),N=w.get("icon-image"),V=("constant"!==k.value.kind||k.value.value instanceof Ma&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&("constant"!==D.value.kind||D.value.value.length>0),G="constant"!==N.value.kind||!!N.value.value||Object.keys(N.parameters).length>0,q=w.get("symbol-sort-key");if(this.features=[],!V&&!G)return;const Y=c.iconDependencies,Q=c.glyphDependencies,ae=c.availableImages,ge=new z(this.zoom);for(const{feature:De,id:_e,index:Ae,sourceLayerIndex:Ie}of s){const Le=b._featureFilter.needGeometry,st=Wp(De,Le);if(!b._featureFilter.filter(ge,st,h))continue;if(Le||(st.geometry=sd(De,h,m)),S&&1!==De.type&&h.z<=5){const ct=st.geometry,Pt=.98078528056,Lt=(Gt,ai)=>Ad(Is(Gt.x,Gt.y,h,1),Is(ai.x,ai.y,h,1))<Pt;for(let Gt=0;Gt<ct.length;Gt++)ct[Gt]=Qh(ct[Gt],Lt)}let nt,Et;if(V){const ct=b.getValueAndResolveTokens("text-field",st,h,ae),Pt=Ma.factory(ct);DM(Pt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===T()||this.hasRTLText&&F.isParsed())&&(nt=pM(Pt,b,st))}if(G){const ct=b.getValueAndResolveTokens("icon-image",st,h,ae);Et=ct instanceof es?ct:es.fromString(ct)}if(!nt&&!Et)continue;const Yt=this.sortFeaturesByKey?q.evaluate(st,{},h):void 0;if(this.features.push({id:_e,text:nt,icon:Et,index:Ae,sourceLayerIndex:Ie,geometry:st.geometry,properties:De.properties,type:AM[De.type],sortKey:Yt}),Et&&(Y[Et.name]=!0),nt){const ct=D.evaluate(st,{},h).join(","),Pt="map"===w.get("text-rotation-alignment")&&"point"!==w.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(lc.vertical)>=0;for(const Lt of nt.sections)if(Lt.image)Y[Lt.image.name]=!0;else{const Gt=Sm(nt.toString()),ai=Lt.fontStack||ct,bt=Q[ai]=Q[ai]||{};this.calculateGlyphDependencies(Lt.text,bt,Pt,this.allowVerticalPlacement,Gt)}}}"line"===w.get("symbol-placement")&&(this.features=function(De){const _e={},Ae={},Ie=[];let Le=0;function st(ct){Ie.push(De[ct]),Le++}function nt(ct,Pt,Lt){const Gt=Ae[ct];return delete Ae[ct],Ae[Pt]=Gt,Ie[Gt].geometry[0].pop(),Ie[Gt].geometry[0]=Ie[Gt].geometry[0].concat(Lt[0]),Gt}function Et(ct,Pt,Lt){const Gt=_e[Pt];return delete _e[Pt],_e[ct]=Gt,Ie[Gt].geometry[0].shift(),Ie[Gt].geometry[0]=Lt[0].concat(Ie[Gt].geometry[0]),Gt}function Yt(ct,Pt,Lt){const Gt=Lt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${ct}:${Gt.x}:${Gt.y}`}for(let ct=0;ct<De.length;ct++){const Pt=De[ct],Lt=Pt.geometry,Gt=Pt.text?Pt.text.toString():null;if(!Gt){st(ct);continue}const ai=Yt(Gt,Lt),bt=Yt(Gt,Lt,!0);if(ai in Ae&&bt in _e&&Ae[ai]!==_e[bt]){const _i=Et(ai,bt,Lt),Ri=nt(ai,bt,Ie[_i].geometry);delete _e[ai],delete Ae[bt],Ae[Yt(Gt,Ie[Ri].geometry,!0)]=Ri,Ie[_i].geometry=null}else ai in Ae?nt(ai,bt,Lt):bt in _e?Et(ai,bt,Lt):(st(ct),_e[ai]=Le-1,Ae[bt]=Le-1)}return Ie.filter(ct=>ct.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((De,_e)=>De.sortKey-_e.sortKey)}update(s,c,h,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,c,this.layers,h,m),this.icon.programConfigurations.updatePaintArrays(s,c,this.layers,h,m))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Xb(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const h=this.lineVertexArray.length;if(void 0!==s.segment)for(const{x:m,y:b}of c)this.lineVertexArray.emplaceBack(m,b);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(s,c,h,m,b,w,S,D,k,N,V,G,q,Y){const Q=s.indexArray,ae=s.layoutVertexArray,ge=s.globeExtVertexArray,De=s.segments.prepareSegment(4*c.length,ae,Q,this.canOverlap?w.sortKey:void 0),_e=this.glyphOffsetArray.length,Ae=De.vertexLength,Ie=this.allowVerticalPlacement&&S===lc.vertical?Math.PI/2:0,Le=w.text&&w.text.sections;for(let nt=0;nt<c.length;nt++){const{tl:Et,tr:Yt,bl:ct,br:Pt,tex:Lt,pixelOffsetTL:Gt,pixelOffsetBR:ai,minFontScaleX:bt,minFontScaleY:_i,glyphOffset:Ri,isSDF:bi,sectionIndex:$n}=c[nt],li=De.vertexLength,en=Ri[1];if(Wy(ae,k.x,k.y,Et.x,en+Et.y,Lt.x,Lt.y,h,bi,Gt.x,Gt.y,bt,_i),Wy(ae,k.x,k.y,Yt.x,en+Yt.y,Lt.x+Lt.w,Lt.y,h,bi,ai.x,Gt.y,bt,_i),Wy(ae,k.x,k.y,ct.x,en+ct.y,Lt.x,Lt.y+Lt.h,h,bi,Gt.x,ai.y,bt,_i),Wy(ae,k.x,k.y,Pt.x,en+Pt.y,Lt.x+Lt.w,Lt.y+Lt.h,h,bi,ai.x,ai.y,bt,_i),D){const{x:fn,y:Rr,z:qn}=D.anchor,[cn,Go,Xn]=D.up;Jp(ge,fn,Rr,qn,cn,Go,Xn),Jp(ge,fn,Rr,qn,cn,Go,Xn),Jp(ge,fn,Rr,qn,cn,Go,Xn),Jp(ge,fn,Rr,qn,cn,Go,Xn),Qp(s.dynamicLayoutVertexArray,fn,Rr,qn,Ie)}else Qp(s.dynamicLayoutVertexArray,k.x,k.y,k.z,Ie);Q.emplaceBack(li,li+1,li+2),Q.emplaceBack(li+1,li+2,li+3),De.vertexLength+=4,De.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ri[0]),nt!==c.length-1&&$n===c[nt+1].sectionIndex||s.programConfigurations.populatePaintArrays(ae.length,w,w.index,{},q,Y,Le&&Le[$n])}const st=D?D.anchor:k;s.placedSymbolArray.emplaceBack(st.x,st.y,st.z,k.x,k.y,_e,this.glyphOffsetArray.length-_e,Ae,N,V,k.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],S,0,!1,0,G,0)}_commitLayoutVertex(s,c,h,m,b,w,S){s.emplaceBack(c,h,m,b,w,Math.round(S.x),Math.round(S.y))}_addCollisionDebugVertices(s,c,h,m,b,w,S){const D=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),k=D.vertexLength,N=S.tileAnchorX,V=S.tileAnchorY;for(let q=0;q<4;q++)h.collisionVertexArray.emplaceBack(0,0,0,0);h.collisionVertexArrayExt.emplaceBack(c,-s.padding,-s.padding),h.collisionVertexArrayExt.emplaceBack(c,s.padding,-s.padding),h.collisionVertexArrayExt.emplaceBack(c,s.padding,s.padding),h.collisionVertexArrayExt.emplaceBack(c,-s.padding,s.padding),this._commitLayoutVertex(h.layoutVertexArray,m,b,w,N,V,new pi(s.x1,s.y1)),this._commitLayoutVertex(h.layoutVertexArray,m,b,w,N,V,new pi(s.x2,s.y1)),this._commitLayoutVertex(h.layoutVertexArray,m,b,w,N,V,new pi(s.x2,s.y2)),this._commitLayoutVertex(h.layoutVertexArray,m,b,w,N,V,new pi(s.x1,s.y2)),D.vertexLength+=4;const G=h.indexArray;G.emplaceBack(k,k+1),G.emplaceBack(k+1,k+2),G.emplaceBack(k+2,k+3),G.emplaceBack(k+3,k),D.primitiveLength+=4}_addTextDebugCollisionBoxes(s,c,h,m,b,w){for(let S=m;S<b;S++){const D=h.get(S),k=this.getSymbolInstanceTextSize(s,w,c,S);this._addCollisionDebugVertices(D,k,this.textCollisionBox,D.projectedAnchorX,D.projectedAnchorY,D.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(s,c,h,m,b,w){for(let S=m;S<b;S++){const D=h.get(S),k=this.getSymbolInstanceIconSize(s,c,w.placedIconSymbolIndex);this._addCollisionDebugVertices(D,k,this.iconCollisionBox,D.projectedAnchorX,D.projectedAnchorY,D.projectedAnchorZ,w)}}generateCollisionDebugBuffers(s,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new u_(Ai,Ib.members,ua),this.iconCollisionBox=new u_(Ai,Ib.members,ua);const h=uh(this.iconSizeData,s),m=uh(this.textSizeData,s);for(let b=0;b<this.symbolInstances.length;b++){const w=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(m,s,c,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(m,s,c,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(h,s,c,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(h,s,c,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(s,c,h,m){const b=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:m),w=a_(this.textSizeData,s,b)/fa;return this.tilePixelRatio*w}getSymbolInstanceIconSize(s,c,h){const m=this.icon.placedSymbolArray.get(h),b=a_(this.iconSizeData,s,m);return this.tilePixelRatio*b}_commitDebugCollisionVertexUpdate(s,c,h){s.emplaceBack(c,-h,-h),s.emplaceBack(c,h,-h),s.emplaceBack(c,h,h),s.emplaceBack(c,-h,h)}_updateTextDebugCollisionBoxes(s,c,h,m,b,w){for(let S=m;S<b;S++){const D=h.get(S),k=this.getSymbolInstanceTextSize(s,w,c,S);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,D.padding)}}_updateIconDebugCollisionBoxes(s,c,h,m,b,w){for(let S=m;S<b;S++){const D=h.get(S),k=this.getSymbolInstanceIconSize(s,c,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,D.padding)}}updateCollisionDebugBuffers(s,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=uh(this.iconSizeData,s),m=uh(this.textSizeData,s);for(let b=0;b<this.symbolInstances.length;b++){const w=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(m,s,c,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(m,s,c,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(h,s,c,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(h,s,c,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,c,h,m,b,w,S,D,k){const N={};if(c<h){const{x1:V,y1:G,x2:q,y2:Y,padding:Q,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:De,tileAnchorX:_e,tileAnchorY:Ae,featureIndex:Ie}=s.get(c);N.textBox={x1:V,y1:G,x2:q,y2:Y,padding:Q,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:De,tileAnchorX:_e,tileAnchorY:Ae},N.textFeatureIndex=Ie}if(m<b){const{x1:V,y1:G,x2:q,y2:Y,padding:Q,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:De,tileAnchorX:_e,tileAnchorY:Ae,featureIndex:Ie}=s.get(m);N.verticalTextBox={x1:V,y1:G,x2:q,y2:Y,padding:Q,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:De,tileAnchorX:_e,tileAnchorY:Ae},N.verticalTextFeatureIndex=Ie}if(w<S){const{x1:V,y1:G,x2:q,y2:Y,padding:Q,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:De,tileAnchorX:_e,tileAnchorY:Ae,featureIndex:Ie}=s.get(w);N.iconBox={x1:V,y1:G,x2:q,y2:Y,padding:Q,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:De,tileAnchorX:_e,tileAnchorY:Ae},N.iconFeatureIndex=Ie}if(D<k){const{x1:V,y1:G,x2:q,y2:Y,padding:Q,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:De,tileAnchorX:_e,tileAnchorY:Ae,featureIndex:Ie}=s.get(D);N.verticalIconBox={x1:V,y1:G,x2:q,y2:Y,padding:Q,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:De,tileAnchorX:_e,tileAnchorY:Ae},N.verticalIconFeatureIndex=Ie}return N}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,c){const h=s.placedSymbolArray.get(c),m=h.vertexStartIndex+4*h.numGlyphs;for(let b=h.vertexStartIndex;b<m;b+=4)s.indexArray.emplaceBack(b,b+1,b+2),s.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(s),h=Math.cos(s),m=[],b=[],w=[];for(let S=0;S<this.symbolInstances.length;++S){w.push(S);const D=this.symbolInstances.get(S);m.push(0|Math.round(c*D.tileAnchorX+h*D.tileAnchorY)),b.push(D.featureIndex)}return w.sort((S,D)=>m[S]-m[D]||b[D]-b[S]),w}addToSortKeyRanges(s,c){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===c?h.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const h=this.symbolInstances.get(c);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:b,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:S,placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:k}=h;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),b>=0&&b!==m&&this.addIndicesForPlacedSymbol(this.text,b),w>=0&&w!==b&&w!==m&&this.addIndicesForPlacedSymbol(this.text,w),S>=0&&this.addIndicesForPlacedSymbol(this.text,S),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ii(_u,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),_u.MAX_GLYPHS=65535,_u.addDynamicAttributes=Qp;const IM=new xe({"symbol-placement":new J(yt.layout_symbol["symbol-placement"]),"symbol-spacing":new J(yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new J(yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new de(yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new J(yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new J(yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new J(yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new J(yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new J(yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new de(yt.layout_symbol["icon-size"]),"icon-text-fit":new J(yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new J(yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new de(yt.layout_symbol["icon-image"]),"icon-rotate":new de(yt.layout_symbol["icon-rotate"]),"icon-padding":new J(yt.layout_symbol["icon-padding"]),"icon-keep-upright":new J(yt.layout_symbol["icon-keep-upright"]),"icon-offset":new de(yt.layout_symbol["icon-offset"]),"icon-anchor":new de(yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new J(yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new J(yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new J(yt.layout_symbol["text-rotation-alignment"]),"text-field":new de(yt.layout_symbol["text-field"]),"text-font":new de(yt.layout_symbol["text-font"]),"text-size":new de(yt.layout_symbol["text-size"]),"text-max-width":new de(yt.layout_symbol["text-max-width"]),"text-line-height":new de(yt.layout_symbol["text-line-height"]),"text-letter-spacing":new de(yt.layout_symbol["text-letter-spacing"]),"text-justify":new de(yt.layout_symbol["text-justify"]),"text-radial-offset":new de(yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new J(yt.layout_symbol["text-variable-anchor"]),"text-anchor":new de(yt.layout_symbol["text-anchor"]),"text-max-angle":new J(yt.layout_symbol["text-max-angle"]),"text-writing-mode":new J(yt.layout_symbol["text-writing-mode"]),"text-rotate":new de(yt.layout_symbol["text-rotate"]),"text-padding":new J(yt.layout_symbol["text-padding"]),"text-keep-upright":new J(yt.layout_symbol["text-keep-upright"]),"text-transform":new de(yt.layout_symbol["text-transform"]),"text-offset":new de(yt.layout_symbol["text-offset"]),"text-allow-overlap":new J(yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new J(yt.layout_symbol["text-ignore-placement"]),"text-optional":new J(yt.layout_symbol["text-optional"])});var qy={paint:new xe({"icon-opacity":new de(yt.paint_symbol["icon-opacity"]),"icon-color":new de(yt.paint_symbol["icon-color"]),"icon-halo-color":new de(yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new de(yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new de(yt.paint_symbol["icon-halo-blur"]),"icon-translate":new J(yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new J(yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new de(yt.paint_symbol["text-opacity"]),"text-color":new de(yt.paint_symbol["text-color"],{runtimeType:oa,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new de(yt.paint_symbol["text-halo-color"]),"text-halo-width":new de(yt.paint_symbol["text-halo-width"]),"text-halo-blur":new de(yt.paint_symbol["text-halo-blur"]),"text-translate":new J(yt.paint_symbol["text-translate"]),"text-translate-anchor":new J(yt.paint_symbol["text-translate-anchor"])}),layout:IM};class ow{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Zo,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ii(ow,"FormatSectionOverride",{omit:["defaultValue"]});class h_ extends qs{constructor(s){super(s,qy)}recalculate(s,c){super.recalculate(s,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const b of h)m.indexOf(b)<0&&m.push(b);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,c,h,m){const b=this.layout.get(s).evaluate(c,{},h,m),w=this._unevaluatedLayout._values[s];return w.isDataDriven()||Vo(w.value)||!b?b:(S=c.properties,b.replace(/{([^{}]+)}/g,(k,N)=>N in S?String(S[N]):""));var S}createBucket(s){return new _u(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of qy.paint.overridableProperties){if(!h_.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),h=new ow(c),m=new Ac(h,c.property.specification);let b=null;b="constant"===c.value.kind||"source"===c.value.kind?new ll("source",m):new In("composite",m,c.value.zoomStops,c.value._interpolationType),this.paint._values[s]=new le(c.property,b,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,h){return!(!this.layout||c.isDataDriven()||h.isDataDriven())&&h_.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const h=s.get("text-field"),m=qy.paint.properties[c];let b=!1;const w=S=>{for(const D of S)if(m.overrides&&m.overrides.hasOverride(D))return void(b=!0)};if("constant"===h.value.kind&&h.value.value instanceof Ma)w(h.value.value.sections);else if("source"===h.value.kind){const S=k=>{b||(k instanceof Dp&&ts(k.value)===jr?w(k.value.sections):k instanceof ju?w(k.sections):k.eachChild(S))},D=h.value;D._styleExpression&&S(D._styleExpression.expression)}return b}getProgramConfiguration(s){return new Ju(this,s)}}var nS={paint:new xe({"background-color":new J(yt.paint_background["background-color"]),"background-pattern":new J(yt.paint_background["background-pattern"]),"background-opacity":new J(yt.paint_background["background-opacity"])})},kM={paint:new xe({"raster-opacity":new J(yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new J(yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new J(yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new J(yt.paint_raster["raster-brightness-max"]),"raster-saturation":new J(yt.paint_raster["raster-saturation"]),"raster-contrast":new J(yt.paint_raster["raster-contrast"]),"raster-resampling":new J(yt.paint_raster["raster-resampling"]),"raster-fade-duration":new J(yt.paint_raster["raster-fade-duration"])})};class tg extends qs{constructor(s){super(s,{}),this.implementation=s}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}var RM={paint:new xe({"sky-type":new J(yt.paint_sky["sky-type"]),"sky-atmosphere-sun":new J(yt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new J(yt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new J(yt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new J(yt.paint_sky["sky-gradient-radius"]),"sky-gradient":new be(yt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new J(yt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new J(yt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new J(yt.paint_sky["sky-opacity"])})};function ef(l,s,c){const h=[0,0,1],m=zg([]);return Vg(m,m,c?-er(l)+Math.PI:er(l)),Ug(m,m,-er(s)),jv(h,h,m),Bs(h,h)}const tn={circle:class extends qs{constructor(l){super(l,Q1)}createBucket(l){return new $p(l)}queryRadius(l){const s=l;return Bf("circle-radius",this,s)+Bf("circle-stroke-width",this,s)+nb(this.paint.get("circle-translate"))}queryIntersectsFeature(l,s,c,h,m,b,w,S){const D=K1(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,l.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c);return by(l,h,b,w,S,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),D,k)}getProgramIds(){return["circle"]}getProgramConfiguration(l){return new Ju(this,l)}},heatmap:class extends qs{createBucket(l){return new tM(l)}constructor(l){super(l,sb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){"heatmap-color"===l&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return Bf("heatmap-radius",this,l)}queryIntersectsFeature(l,s,c,h,m,b,w,S){const D=this.paint.get("heatmap-radius").evaluate(s,c);return by(l,h,b,w,S,!0,!0,new pi(0,0),D)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(l){return new Ju(this,l)}},hillshade:class extends qs{constructor(l){super(l,Cx)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends qs{constructor(l){super(l,Ax)}getProgramIds(){const l=this.paint.get("fill-pattern"),s=l&&l.constantOr(1),c=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(l){return new Ju(this,l)}recalculate(l,s){super.recalculate(l,s);const c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new Sy(l)}queryRadius(){return nb(this.paint.get("fill-translate"))}queryIntersectsFeature(l,s,c,h,m,b){return!l.queryGeometry.isAboveHorizon&&kd(rb(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,l.pixelToTileUnitsFactor),h)}isTileClipped(){return!0}},"fill-extrusion":class extends qs{constructor(l){super(l,n_)}createBucket(l){return new i_(l)}queryRadius(){return nb(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(l){return new Ju(this,l)}queryIntersectsFeature(l,s,c,h,m,b,w,S,D){const k=K1(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,l.pixelToTileUnitsFactor),N=this.paint.get("fill-extrusion-height").evaluate(s,c),V=this.paint.get("fill-extrusion-base").evaluate(s,c),G=[0,0],q=S&&b.elevation,Y=b.elevation?b.elevation.exaggeration():1,Q=l.tile.getBucket(this);if(q&&Q instanceof i_){const Ae=Q.centroidVertexArray,Ie=D+1;Ie<Ae.length&&(G[0]=Ae.geta_centroid_pos0(Ie),G[1]=Ae.geta_centroid_pos1(Ie))}if(0===G[0]&&1===G[1])return!1;"globe"===b.projection.name&&(h=Eb([h],[new pi(0,0),new pi(Xi,Xi)],l.tileID.canonical).map(Ae=>Ae.polygon).flat());const ae=q?S:null,[ge,De]=(Ie=h,Le=V,st=N,nt=k,Et=w,Yt=ae,ct=G,Pt=Y,Lt=b.center.lat,"globe"===(Ae=b).projection.name?function(ai,bt,_i,Ri,bi,$n,li,en,fn,Rr,qn){const cn=[],Go=[],Xn=ai.projection.upVectorScale(qn,ai.center.lat,ai.worldSize).metersToTile,Zn=[0,0,0,1],co=[0,0,0,1],Io=(ko,os,_s,Vs)=>{ko[0]=os,ko[1]=_s,ko[2]=Vs,ko[3]=1},jo=Ry();_i>0&&(_i+=jo),Ri+=jo;for(const ko of bt){const os=[],_s=[];for(const Vs of ko){const Mo=Vs.x+bi.x,Wo=Vs.y+bi.y,Ys=ai.projection.projectTilePoint(Mo,Wo,qn),ys=ai.projection.upVector(qn,Vs.x,Vs.y);let Ur=_i,Ks=Ri;if(li){const No=Us(Mo,Wo,_i,Ri,li,en,fn,Rr);Ur+=No.base,Ks+=No.top}0!==_i?Io(Zn,Ys.x+ys[0]*Xn*Ur,Ys.y+ys[1]*Xn*Ur,Ys.z+ys[2]*Xn*Ur):Io(Zn,Ys.x,Ys.y,Ys.z),Io(co,Ys.x+ys[0]*Xn*Ks,Ys.y+ys[1]*Xn*Ks,Ys.z+ys[2]*Xn*Ks),ds(Zn,Zn,$n),ds(co,co,$n),os.push(new Pn(Zn[0],Zn[1],Zn[2])),_s.push(new Pn(co[0],co[1],co[2]))}cn.push(os),Go.push(_s)}return[cn,Go]}(Ae,Ie,Le,st,nt,Et,Yt,ct,Pt,Lt,l.tileID.canonical):Yt?function(ai,bt,_i,Ri,bi,$n,li,en,fn){const Rr=[],qn=[],cn=[0,0,0,1];for(const Go of ai){const Xn=[],Zn=[];for(const co of Go){const Io=co.x+Ri.x,jo=co.y+Ri.y,ko=Us(Io,jo,bt,_i,$n,li,en,fn);cn[0]=Io,cn[1]=jo,cn[2]=ko.base,cn[3]=1,Kh(cn,cn,bi),cn[3]=Math.max(cn[3],1e-5);const os=new Pn(cn[0]/cn[3],cn[1]/cn[3],cn[2]/cn[3]);cn[0]=Io,cn[1]=jo,cn[2]=ko.top,cn[3]=1,Kh(cn,cn,bi),cn[3]=Math.max(cn[3],1e-5);const _s=new Pn(cn[0]/cn[3],cn[1]/cn[3],cn[2]/cn[3]);Xn.push(os),Zn.push(_s)}Rr.push(Xn),qn.push(Zn)}return[Rr,qn]}(Ie,Le,st,nt,Et,Yt,ct,Pt,Lt):function(ai,bt,_i,Ri,bi){const $n=[],li=[],en=bi[8]*bt,fn=bi[9]*bt,Rr=bi[10]*bt,qn=bi[11]*bt,cn=bi[8]*_i,Go=bi[9]*_i,Xn=bi[10]*_i,Zn=bi[11]*_i;for(const co of ai){const Io=[],jo=[];for(const ko of co){const os=ko.x+Ri.x,_s=ko.y+Ri.y,Vs=bi[0]*os+bi[4]*_s+bi[12],Mo=bi[1]*os+bi[5]*_s+bi[13],Wo=bi[2]*os+bi[6]*_s+bi[14],Ys=bi[3]*os+bi[7]*_s+bi[15],ys=Vs+en,Ur=Mo+fn,Ks=Wo+Rr,No=Math.max(Ys+qn,1e-5),Fc=Vs+cn,ya=Mo+Go,Xa=Wo+Xn,Za=Math.max(Ys+Zn,1e-5);Io.push(new Pn(ys/No,Ur/No,Ks/No)),jo.push(new Pn(Fc/Za,ya/Za,Xa/Za))}$n.push(Io),li.push(jo)}return[$n,li]}(Ie,Le,st,nt,Et)),_e=l.queryGeometry;var Ae,Ie,Le,st,nt,Et,Yt,ct,Pt,Lt;return function(Ae,Ie,Le){let st=1/0;kd(Le,Ie)&&(st=Vl(Le,Ie[0]));for(let nt=0;nt<Ie.length;nt++){const Et=Ie[nt],Yt=Ae[nt];for(let ct=0;ct<Et.length-1;ct++){const Pt=Et[ct],Lt=[Pt,Et[ct+1],Yt[ct+1],Yt[ct],Pt];Om(Le,Lt)&&(st=Math.min(st,Vl(Le,Lt)))}}return st!==1/0&&st}(ge,De,_e.isPointQuery()?_e.screenBounds:_e.screenGeometry)}},line:class extends qs{constructor(l){super(l,Bx),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if("line-gradient"===l){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof sl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,s){super.recalculate(l,s),this.paint._values["line-floorwidth"]=np.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new ip(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(l){return new Ju(this,l)}queryRadius(l){const s=l,c=Ab(Bf("line-width",this,s),Bf("line-gap-width",this,s)),h=Bf("line-offset",this,s);return c/2+Math.abs(h)+nb(this.paint.get("line-translate"))}queryIntersectsFeature(l,s,c,h,m,b){if(l.queryGeometry.isAboveHorizon)return!1;const w=rb(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,l.pixelToTileUnitsFactor),S=l.pixelToTileUnitsFactor/2*Ab(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),D=this.paint.get("line-offset").evaluate(s,c);return D&&(h=function(k,N){const V=[],G=new pi(0,0);for(let q=0;q<k.length;q++){const Y=k[q],Q=[];for(let ae=0;ae<Y.length;ae++){const ge=Y[ae],De=Y[ae+1],_e=0===ae?G:ge.sub(Y[ae-1])._unit()._perp(),Ae=ae===Y.length-1?G:De.sub(ge)._unit()._perp(),Ie=_e._add(Ae)._unit();Ie._mult(1/(Ie.x*Ae.x+Ie.y*Ae.y)),Q.push(Ie._mult(N)._add(ge))}V.push(Q)}return V}(h,D*l.pixelToTileUnitsFactor)),function(k,N,V){for(let G=0;G<N.length;G++){const q=N[G];if(k.length>=3)for(let Y=0;Y<q.length;Y++)if(ch(k,q[Y]))return!0;if(xx(k,q,V))return!0}return!1}(w,h,S)}isTileClipped(){return!0}},symbol:h_,background:class extends qs{constructor(l){super(l,nS)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends qs{constructor(l){super(l,kM)}getProgramIds(){return["raster"]}},sky:class extends qs{constructor(l){super(l,RM),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){"sky-gradient"===l?this._updateColorRamp():"sky-atmosphere-sun"!==l&&"sky-atmosphere-halo-color"!==l&&"sky-atmosphere-color"!==l&&"sky-atmosphere-sun-intensity"!==l||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=xy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(l,s){if("atmosphere"===this.paint.get("sky-type")){const h=this.paint.get("sky-atmosphere-sun"),m=!h,b=l.style.light,w=b.properties.get("position");return m&&"viewport"===b.properties.get("anchor")&&_o("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?ef(w.azimuthal,90-w.polar,s):ef(h[0],90-h[1],s)}const c=this.paint.get("sky-gradient-center");return ef(c[0],90-c[1],s)}is3D(){return!1}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return"atmosphere"===l?["skyboxCapture","skybox"]:"gradient"===l?["skyboxGradient"]:null}}};class p_{constructor(s,c,h,m){this.context=s,this.format=h,this.texture=s.gl.createTexture(),this.update(c,m)}update(s,c,h){const{width:m,height:b}=s,{context:w}=this,{gl:S}=w,{HTMLImageElement:D,HTMLCanvasElement:k,HTMLVideoElement:N,ImageData:V,ImageBitmap:G}=gt;if(S.bindTexture(S.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!c||!1!==c.premultiply)),h||this.size&&this.size[0]===m&&this.size[1]===b){const{x:q,y:Y}=h||{x:0,y:0};s instanceof D||s instanceof k||s instanceof N||s instanceof V||G&&s instanceof G?S.texSubImage2D(S.TEXTURE_2D,0,q,Y,S.RGBA,S.UNSIGNED_BYTE,s):S.texSubImage2D(S.TEXTURE_2D,0,q,Y,m,b,S.RGBA,S.UNSIGNED_BYTE,s.data)}else this.size=[m,b],s instanceof D||s instanceof k||s instanceof N||s instanceof V||G&&s instanceof G?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,s):S.texImage2D(S.TEXTURE_2D,0,this.format,m,b,0,this.format,S.UNSIGNED_BYTE,s.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&S.generateMipmap(S.TEXTURE_2D)}bind(s,c){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?s===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:s),this.filter=s),c!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class f_{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class sp{constructor(){this.tasks={},this.taskQueue=[],to(["process"],this),this.invoker=new f_(this.process),this.nextId=0}add(s,c){const h=this.nextId++,m=function({type:b,isSymbolTile:w,zoom:S}){return S=S||0,"message"===b?0:"maybePrepare"!==b||w?"parseTile"!==b||w?"parseTile"===b&&w?300-S:"maybePrepare"===b&&w?400-S:500:200-S:100-S}(c);if(0===m){Jl();try{s()}finally{}return{cancel:()=>{}}}return this.tasks[h]={fn:s,metadata:c,priority:m,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){Jl();try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const s=this.pick();if(null===s)return;const c=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let s=null,c=1/0;for(let m=0;m<this.taskQueue.length;m++){const b=this.tasks[this.taskQueue[m]];b.priority<c&&(c=b.priority,s=m)}if(null===s)return null;const h=this.taskQueue[s];return this.taskQueue.splice(s,1),h}remove(){this.invoker.remove()}}class sw{constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const h=s[c];this._stringToNumber[h]=c,this._numberToString[c]=h}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const PM=["tile","layer","source","sourceLayer","state"];class tf{constructor(s,c,h,m,b){this.type="Feature",this._vectorTileFeature=s,this._z=c,this._x=h,this._y=m,this.properties=s.properties,this.id=b}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(s.id=this.id);for(const c of PM)void 0!==this[c]&&(s[c]=this[c]);return s}}const _=33,E=new Uint16Array(8184);for(let l=0;l<2046;l++){let s=l+2,c=0,h=0,m=0,b=0,w=0,S=0;for(1&s?m=b=w=32:c=h=S=32;(s>>=1)>1;){const k=c+m>>1,N=h+b>>1;1&s?(m=c,b=h,c=w,h=S):(c=m,h=b,m=w,b=S),w=k,S=N}const D=4*l;E[D+0]=c,E[D+1]=h,E[D+2]=m,E[D+3]=b}const L=new Uint16Array(2178),$=new Uint8Array(1089),te=new Uint16Array(1089);function fe(l){return 0===l?-.03125:32===l?.03125:0}var Pe=$e([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const je={type:2,extent:Xi,loadGeometry:()=>[[new pi(0,0),new pi(Xi+1,0),new pi(Xi+1,Xi+1),new pi(0,Xi+1),new pi(0,0)]]};class Qe{constructor(s,c,h,m,b){this.tileID=s,this.uid=Fi(),this.uses=0,this.tileSize=c,this.tileZoom=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(s){const c=s+this.timeAdded;c<vd.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=mu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,c,h){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(m,b){const w={};if(!b)return w;for(const S of m){const D=S.layerIds.map(k=>b.getLayer(k)).filter(Boolean);if(0!==D.length){S.layers=D,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(k=>D.filter(N=>N.id===k)[0]));for(const k of D)w[k.id]=S}}return w}(s.buckets,c.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const b=this.buckets[m];if(b instanceof _u){if(this.hasSymbolBuckets=!0,!h)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const b=this.buckets[m];if(b instanceof _u&&b.hasRTLText){this.hasRTLText=!0,F.isLoading()||F.isLoaded()||"deferred"!==T()||P();break}}this.queryPadding=0;for(const m in this.buckets){const b=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(m).queryRadius(b))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas)}else this.collisionBoxArray=new ro}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(s){return this.buckets[s.id]}upload(s){for(const h in this.buckets){const m=this.buckets[h];m.uploadPending()&&m.upload(s)}const c=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new p_(s,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new p_(s,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new p_(s,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,c,h,m,b,w,S,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:S,transform:w,params:b,tileTransform:this.tileTransform},s,c,h):{}}querySourceFeatures(s,c){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const m=h.loadVTLayers(),b=c?c.sourceLayer:"",w=m._geojsonTileLayer||m[b];if(!w)return;const S=Vh(c&&c.filter),{z:D,x:k,y:N}=this.tileID.canonical,V={z:D,x:k,y:N};for(let G=0;G<w.length;G++){const q=w.feature(G);if(S.needGeometry){const ae=Wp(q,!0);if(!S.filter(new z(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!S.filter(new z(this.tileID.overscaledZ),q))continue;const Y=h.getId(q,b),Q=new tf(q,D,k,N,Y);Q.tile=V,s.push(Q)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const c=this.expirationTime;if(s.cacheControl){const h=vc(s.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const h=Date.now();let m=!1;if(this.expirationTime>h)m=!1;else if(c)if(this.expirationTime<c)m=!0;else{const b=this.expirationTime-c;b?this.expirationTime=h+Math.max(b,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(s,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(s).length||!c)return;const h=this.latestFeatureIndex.loadVTLayers(),m=c.style.listImages();for(const b in this.buckets){if(!c.style.hasLayer(b))continue;const w=this.buckets[b],S=w.layers[0].sourceLayer||"_geojsonTileLayer",D=h[S],k=s[S];if(!D||!k||0===Object.keys(k).length)continue;if(w.update(k,D,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof ip||w instanceof Sy){const V=c.style._getSourceCache(w.layers[0].source);c._terrain&&c._terrain.enabled&&V&&w.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(V.id,this.tileID)}const N=c&&c.style&&c.style.getLayer(b);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(w)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<vd.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=vd.now()+s}setTexture(s,c){const h=c.context,m=h.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture?this.texture.update(s,{useMipmap:!0}):(this.texture=new p_(h,s,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE))}setDependencies(s,c){const h={};for(const m of c)h[m]=!0;this.dependencies[s]=h}hasDependency(s,c){for(const h of s){const m=this.dependencies[h];if(m)for(const b of c)if(m[b])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,c){if(!c||"mercator"===c.name||this._tileDebugBuffer)return;const h=sd(je,this.tileID.canonical,this.tileTransform)[0],m=new St,b=new rc;for(let w=0;w<h.length;w++){const{x:S,y:D}=h[w];m.emplaceBack(S,D),b.emplaceBack(w)}b.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(b),this._tileDebugBuffer=s.createVertexBuffer(m,Pf.members),this._tileDebugSegments=As.simpleSegment(0,0,m.length,b.length)}_makeTileBoundsBuffers(s,c){if(this._tileBoundsBuffer||!c||"mercator"===c.name)return;const h=sd(je,this.tileID.canonical,this.tileTransform)[0];let m,b;if(this.isRaster){const w=function(S,D){const k=mu(S,D),N=Math.pow(2,S.z);for(let ae=0;ae<_;ae++)for(let ge=0;ge<_;ge++){const De=od((S.x+(ge+fe(ge))/32)/N),_e=Ha((S.y+(ae+fe(ae))/32)/N),Ae=D.project(De,_e),Ie=ae*_+ge;L[2*Ie+0]=Math.round((Ae.x*k.scale-k.x)*Xi),L[2*Ie+1]=Math.round((Ae.y*k.scale-k.y)*Xi)}$.fill(0),te.fill(0);for(let ae=2045;ae>=0;ae--){const ge=4*ae,De=E[ge+0],_e=E[ge+1],Ae=E[ge+2],Ie=E[ge+3],Le=De+Ae>>1,st=_e+Ie>>1,nt=Le+st-_e,Et=st+De-Le,Yt=_e*_+De,ct=Ie*_+Ae,Pt=st*_+Le,Lt=Math.hypot((L[2*Yt+0]+L[2*ct+0])/2-L[2*Pt+0],(L[2*Yt+1]+L[2*ct+1])/2-L[2*Pt+1])>=16;$[Pt]=$[Pt]||(Lt?1:0),ae<1022&&($[Pt]=$[Pt]||$[(_e+Et>>1)*_+(De+nt>>1)]||$[(Ie+Et>>1)*_+(Ae+nt>>1)])}const V=new vt,G=new Bi;let q=0;function Y(ae,ge){const De=ge*_+ae;return 0===te[De]&&(V.emplaceBack(L[2*De+0],L[2*De+1],ae*Xi/32,ge*Xi/32),te[De]=++q),te[De]-1}function Q(ae,ge,De,_e,Ae,Ie){const Le=ae+De>>1,st=ge+_e>>1;if(Math.abs(ae-Ae)+Math.abs(ge-Ie)>1&&$[st*_+Le])Q(Ae,Ie,ae,ge,Le,st),Q(De,_e,Ae,Ie,Le,st);else{const nt=Y(ae,ge),Et=Y(De,_e),Yt=Y(Ae,Ie);G.emplaceBack(nt,Et,Yt)}}return Q(0,0,32,32,32,0),Q(32,32,0,0,0,32),{vertices:V,indices:G}}(this.tileID.canonical,c);m=w.vertices,b=w.indices}else{m=new vt,b=new Bi;for(const{x:S,y:D}of h)m.emplaceBack(S,D,0,0);const w=Kg(m.int16,void 0,4);for(let S=0;S<w.length;S+=3)b.emplaceBack(w[S],w[S+1],w[S+2])}this._tileBoundsBuffer=s.createVertexBuffer(m,Pe.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(b),this._tileBoundsSegments=As.simpleSegment(0,0,m.length,b.length)}_makeGlobeTileDebugBuffers(s,c){const h=c.projection;if(!h||"globe"!==h.name||c.freezeTileCoverage)return;const m=this.tileID.canonical,b=qg(X1(m,c)),w=du(c.zoom);let S;w>0&&(S=Dm(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,m,c,b,S,w),this._makeGlobeTileDebugTextBuffer(s,m,c,b,S,w)}_globePoint(s,c,h,m,b,w,S){let D=Is(s,c,h);if(w){const k=1<<h.z,N=uu(m.center.lng),V=lh(m.center.lat),G=(h.x+.5)/k-N;let q=0;G>.5?q=-1:G<-.5&&(q=1);let Y=(s/Xi+h.x)/k+q,Q=(c/Xi+h.y)/k;Y=(Y-N)*m._pixelsPerMercatorPixel+N,Q=(Q-V)*m._pixelsPerMercatorPixel+V;const ae=[Y*m.worldSize,Q*m.worldSize,0];ds(ae,ae,w),D=Fm(D,ae,S)}return ds(D,D,b)}_makeGlobeTileDebugBorderBuffer(s,c,h,m,b,w){const S=new St,D=new rc,k=new Je,N=(G,q,Y,Q,ae)=>{const ge=(Y-G)/(ae-1),De=(Q-q)/(ae-1),_e=S.length;for(let Ae=0;Ae<ae;Ae++){const Ie=G+Ae*ge,Le=q+Ae*De;S.emplaceBack(Ie,Le);const st=this._globePoint(Ie,Le,c,h,m,b,w);k.emplaceBack(st[0],st[1],st[2]),D.emplaceBack(_e+Ae)}},V=Xi;N(0,0,V,0,16),N(V,0,V,V,16),N(V,V,0,V,16),N(0,V,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(D),this._tileDebugBuffer=s.createVertexBuffer(S,Pf.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(k,au.members),this._tileDebugSegments=As.simpleSegment(0,0,S.length,D.length)}_makeGlobeTileDebugTextBuffer(s,c,h,m,b,w){const S=Xi/4,D=new St,k=new Bi,N=new Je,V=25;k.reserve(32),D.reserve(V),N.reserve(V);const G=(q,Y)=>V*q+Y;for(let q=0;q<V;q++){const Y=q*S;for(let Q=0;Q<V;Q++){const ae=Q*S;D.emplaceBack(ae,Y);const ge=this._globePoint(ae,Y,c,h,m,b,w);N.emplaceBack(ge[0],ge[1],ge[2])}}for(let q=0;q<4;q++)for(let Y=0;Y<4;Y++){const Q=G(q,Y),ae=G(q,Y+1),ge=G(q+1,Y),De=G(q+1,Y+1);k.emplaceBack(Q,ae,ge),k.emplaceBack(ge,ae,De)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(k),this._tileDebugTextBuffer=s.createVertexBuffer(D,Pf.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(N,au.members),this._tileDebugTextSegments=As.simpleSegment(0,0,V,32)}}class $t{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,h){const m=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][m]=this.stateChanges[s][m]||{},Qo(this.stateChanges[s][m],h),null===this.deletedStates[s]){this.deletedStates[s]={};for(const b in this.state[s])b!==m&&(this.deletedStates[s][b]=null)}else if(this.deletedStates[s]&&null===this.deletedStates[s][m]){this.deletedStates[s][m]={};for(const b in this.state[s][m])h[b]||(this.deletedStates[s][m][b]=null)}else for(const b in h)this.deletedStates[s]&&this.deletedStates[s][m]&&null===this.deletedStates[s][m][b]&&delete this.deletedStates[s][m][b]}removeFeatureState(s,c,h){if(null===this.deletedStates[s])return;const m=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},h&&void 0!==c)null!==this.deletedStates[s][m]&&(this.deletedStates[s][m]=this.deletedStates[s][m]||{},this.deletedStates[s][m][h]=null);else if(void 0!==c)if(this.stateChanges[s]&&this.stateChanges[s][m])for(h in this.deletedStates[s][m]={},this.stateChanges[s][m])this.deletedStates[s][m][h]=null;else this.deletedStates[s][m]=null;else this.deletedStates[s]=null}getState(s,c){const h=String(c),m=Qo({},(this.state[s]||{})[h],(this.stateChanges[s]||{})[h]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){const b=this.deletedStates[s][c];if(null===b)return{};for(const w in b)delete m[w]}return m}initializeTileState(s,c){s.setFeatureState(this.state,c)}coalesceChanges(s,c){const h={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const b={};for(const w in this.stateChanges[m])this.state[m][w]||(this.state[m][w]={}),Qo(this.state[m][w],this.stateChanges[m][w]),b[w]=this.state[m][w];h[m]=b}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const b={};if(null===this.deletedStates[m])for(const w in this.state[m])b[w]={},this.state[m][w]={};else for(const w in this.deletedStates[m]){if(null===this.deletedStates[m][w])this.state[m][w]={};else if(this.state[m][w])for(const S of Object.keys(this.deletedStates[m][w]))delete this.state[m][w][S];b[w]=this.state[m][w]}h[m]=h[m]||{},Qo(h[m],b)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(h).length)for(const m in s)s[m].setFeatureState(h,c)}}class qt{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,c){const h=this.toIdx(s,c);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(s,c){return this.leaves[this.toIdx(s,c)]}toIdx(s,c){return c*this.size+s}}function ci(l,s,c,h){let m=0,b=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(h[w])<1e-15){if(c[w]<l[w]||c[w]>s[w])return null}else{const S=1/h[w];let D=(l[w]-c[w])*S,k=(s[w]-c[w])*S;if(D>k){const N=D;D=k,k=N}if(D>m&&(m=D),k<b&&(b=k),m>b)return null}return m}function Li(l,s,c,h,m,b,w,S,D,k,N){const V=h-l,G=m-s,q=b-c,Y=w-l,Q=S-s,ae=D-c,ge=N[1]*ae-N[2]*Q,De=N[2]*Y-N[0]*ae,_e=N[0]*Q-N[1]*Y,Ae=V*ge+G*De+q*_e;if(Math.abs(Ae)<1e-15)return null;const Ie=1/Ae,Le=k[0]-l,st=k[1]-s,nt=k[2]-c,Et=(Le*ge+st*De+nt*_e)*Ie;if(Et<0||Et>1)return null;const Yt=st*q-nt*G,ct=nt*V-Le*q,Pt=Le*G-st*V,Lt=(N[0]*Yt+N[1]*ct+N[2]*Pt)*Ie;return Lt<0||Et+Lt>1?null:(Y*Yt+Q*ct+ae*Pt)*Ie}function an(l,s,c){return(l-s)/(c-s)}function zn(l,s,c,h,m,b,w,S,D){const k=1<<c,N=b-h,V=w-m,G=(l+1)/k*N+h,q=(s+0)/k*V+m,Y=(s+1)/k*V+m;S[0]=(l+0)/k*N+h,S[1]=q,D[0]=G,D[1]=Y}class yr{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(b){const w=Math.ceil(Math.log2(b.dim/8)),S=[];let D=Math.ceil(Math.pow(2,w));const k=1/D,N=(q,Y,Q,ae,ge)=>{const De=ae?1:0,_e=(q+1)*Q-De,Ae=Y*Q,Ie=(Y+1)*Q-De;ge[0]=q*Q,ge[1]=Ae,ge[2]=_e,ge[3]=Ie};let V=new qt(D);const G=[];for(let q=0;q<D*D;q++){N(q%D,Math.floor(q/D),k,!1,G);const Y=Ln(G[0],G[1],b),Q=Ln(G[2],G[1],b),ae=Ln(G[2],G[3],b),ge=Ln(G[0],G[3],b);V.minimums.push(Math.min(Y,Q,ae,ge)),V.maximums.push(Math.max(Y,Q,ae,ge)),V.leaves.push(1)}for(S.push(V),D/=2;D>=1;D/=2){const q=S[S.length-1];V=new qt(D);for(let Y=0;Y<D*D;Y++){N(Y%D,Math.floor(Y/D),2,!0,G);const Q=q.getElevation(G[0],G[1]),ae=q.getElevation(G[2],G[1]),ge=q.getElevation(G[2],G[3]),De=q.getElevation(G[0],G[3]),_e=q.isLeaf(G[0],G[1]),Ae=q.isLeaf(G[2],G[1]),Ie=q.isLeaf(G[2],G[3]),Le=q.isLeaf(G[0],G[3]),st=Math.min(Q.min,ae.min,ge.min,De.min),nt=Math.max(Q.max,ae.max,ge.max,De.max),Et=_e&&Ae&&Ie&&Le;V.maximums.push(nt),V.minimums.push(st),V.leaves.push(nt-st<=5&&Et?1:0)}S.push(V)}return S}(this.dem),h=c.length-1,m=c[h];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(c,0,0,h,0)}raycastRoot(s,c,h,m,b,w,S=1){return ci([s,c,-100],[h,m,this.maximums[0]*S],b,w)}raycast(s,c,h,m,b,w,S=1){if(!this.nodeCount)return null;const D=this.raycastRoot(s,c,h,m,b,w,S);if(null==D)return null;const k=[],N=[],V=[],G=[],q=[{idx:0,t:D,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:Y,t:Q,nodex:ae,nodey:ge,depth:De}=q.pop();if(this.leaves[Y]){zn(ae,ge,De,s,c,h,m,V,G);const Ae=1<<De,Ie=(ae+0)/Ae,Le=(ae+1)/Ae,st=(ge+0)/Ae,nt=(ge+1)/Ae,Et=Ln(Ie,st,this.dem)*S,Yt=Ln(Le,st,this.dem)*S,ct=Ln(Le,nt,this.dem)*S,Pt=Ln(Ie,nt,this.dem)*S,Lt=Li(V[0],V[1],Et,G[0],V[1],Yt,G[0],G[1],ct,b,w),Gt=Li(G[0],G[1],ct,V[0],G[1],Pt,V[0],V[1],Et,b,w),ai=Math.min(null!==Lt?Lt:Number.MAX_VALUE,null!==Gt?Gt:Number.MAX_VALUE);if(ai!==Number.MAX_VALUE)return ai;{const bt=Gp([],b,w,Q);if(bn(Et,Yt,Pt,ct,an(bt[0],V[0],G[0]),an(bt[1],V[1],G[1]))>=bt[2])return Q}continue}let _e=0;for(let Ae=0;Ae<this._siblingOffset.length;Ae++){zn((ae<<1)+this._siblingOffset[Ae][0],(ge<<1)+this._siblingOffset[Ae][1],De+1,s,c,h,m,V,G),V[2]=-100,G[2]=this.maximums[this.childOffsets[Y]+Ae]*S;const Ie=ci(V,G,b,w);if(null!=Ie){const Le=Ie;k[Ae]=Le;let st=!1;for(let nt=0;nt<_e&&!st;nt++)Le>=k[N[nt]]&&(N.splice(nt,0,Ae),st=!0);st||(N[_e]=Ae),_e++}}for(let Ae=0;Ae<_e;Ae++){const Ie=N[Ae];q.push({idx:this.childOffsets[Y]+Ie,t:k[Ie],nodex:(ae<<1)+this._siblingOffset[Ie][0],nodey:(ge<<1)+this._siblingOffset[Ie][1],depth:De+1})}}return null}_addNode(s,c,h){return this.minimums.push(s),this.maximums.push(c),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(s,c,h,m,b){if(1===s[m].isLeaf(c,h))return;this.childOffsets[b]||(this.childOffsets[b]=this.nodeCount);const w=m-1,S=s[w];let D=0,k=0;for(let N=0;N<this._siblingOffset.length;N++){const V=2*c+this._siblingOffset[N][0],G=2*h+this._siblingOffset[N][1],q=S.getElevation(V,G),Y=S.isLeaf(V,G),Q=this._addNode(q.min,q.max,Y);Y&&(D|=1<<N),k||(k=Q)}for(let N=0;N<this._siblingOffset.length;N++)D&1<<N||this._construct(s,2*c+this._siblingOffset[N][0],2*h+this._siblingOffset[N][1],w,k+N)}}function bn(l,s,c,h,m,b){return Mr(Mr(l,c,b),Mr(s,h,b),m)}function Ln(l,s,c){const h=c.dim,m=pr(l*h-.5,0,h-1),b=pr(s*h-.5,0,h-1),w=Math.floor(m),S=Math.floor(b),D=Math.min(w+1,h-1),k=Math.min(S+1,h-1);return bn(c.get(w,S),c.get(D,S),c.get(w,k),c.get(D,k),m-w,b-S)}const zr={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Ld(l,s,c){return(256*l*256+256*s+c)/10-1e4}function dc(l,s,c){return 256*l+s+c/256-32768}class uc{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,c,h,m=!1,b=!1){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(h&&"mapbox"!==h&&"terrarium"!==h)return _o(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const w=this.dim=c.height-2,S=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=h||"mapbox",this.borderReady=m,!m){for(let D=0;D<w;D++)S[this._idx(-1,D)]=S[this._idx(0,D)],S[this._idx(w,D)]=S[this._idx(w-1,D)],S[this._idx(D,-1)]=S[this._idx(D,0)],S[this._idx(D,w)]=S[this._idx(D,w-1)];S[this._idx(-1,-1)]=S[this._idx(0,0)],S[this._idx(w,-1)]=S[this._idx(w-1,0)],S[this._idx(-1,w)]=S[this._idx(0,w-1)],S[this._idx(w,w)]=S[this._idx(w-1,w-1)],b&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new yr(this)}get(s,c,h=!1){h&&(s=pr(s,-1,this.dim),c=pr(c,-1,this.dim));const m=4*this._idx(s,c);return("terrarium"===this.encoding?dc:Ld)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(s){return zr[s]}get unpackVector(){return zr[this.encoding]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}static pack(s,c){const h=[0,0,0,0],m=uc.getUnpackVector(c);let b=Math.floor((s+m[3])/m[2]);return h[2]=b%256,b=Math.floor(b/256),h[1]=b%256,b=Math.floor(b/256),h[0]=b,h}getPixels(){return new fl({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,c,h){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,b=c*this.dim+this.dim,w=h*this.dim,S=h*this.dim+this.dim;switch(c){case-1:m=b-1;break;case 1:b=m+1}switch(h){case-1:w=S-1;break;case 1:S=w+1}const D=-c*this.dim,k=-h*this.dim;for(let N=w;N<S;N++)for(let V=m;V<b;V++){const G=4*this._idx(V,N),q=4*this._idx(V+D,N+k);this.pixels[G+0]=s.pixels[q+0],this.pixels[G+1]=s.pixels[q+1],this.pixels[G+2]=s.pixels[q+2],this.pixels[G+3]=s.pixels[q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ii(uc,"DEMData"),Ii(yr,"DemMinMaxQuadTree",{omit:["dem"]});class _a{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(const s in this.data)for(const c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,h){const m=s.wrapped().key;void 0===this.data[m]&&(this.data[m]=[]);const b={value:c,timeout:void 0};if(void 0!==h&&(b.timeout=setTimeout(()=>{this.remove(s,b)},h)),this.data[m].push(b),this.order.push(m),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),0===this.data[s].length&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){const c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;const h=s.wrapped().key,m=void 0===c?0:this.data[h].indexOf(c),b=this.data[h][m];return this.data[h].splice(m,1),b.timeout&&clearTimeout(b.timeout),0===this.data[h].length&&delete this.data[h],this.onRemove(b.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){const c=[];for(const h in this.data)for(const m of this.data[h])s(m.value)||c.push(m);for(const h of c)this.remove(h.value.tileID,h)}}class yl{constructor(s,c,h){this.func=s,this.mask=c,this.range=h}}yl.ReadOnly=!1,yl.ReadWrite=!0,yl.disabled=new yl(519,yl.ReadOnly,[0,1]);class Zb{constructor(s,c,h,m,b,w){this.test=s,this.ref=c,this.mask=h,this.fail=m,this.depthFail=b,this.pass=w}}Zb.disabled=new Zb({func:519,mask:0},0,0,7680,7680,7680);class ap{constructor(s,c,h){this.blendFunction=s,this.blendColor=c,this.mask=h}}ap.Replace=[1,0],ap.disabled=new ap(ap.Replace,fs.transparent,[!1,!1,!1,!1]),ap.unblended=new ap(ap.Replace,fs.transparent,[!0,!0,!0,!0]),ap.alphaBlended=new ap([1,771],fs.transparent,[!0,!0,!0,!0]);class gh{constructor(s,c,h){this.enable=s,this.mode=c,this.frontFace=h}}gh.disabled=new gh(!1,1029,2305),gh.backCCW=new gh(!0,1029,2305),gh.backCW=new gh(!0,1029,2304),gh.frontCW=new gh(!0,1028,2304),gh.frontCCW=new gh(!0,1028,2305);class ig extends Dh{constructor(s,c,h){super(),this.id=s,this._onlySymbols=h,c.on("data",m=>{"source"===m.dataType&&"metadata"===m.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===m.dataType&&"content"===m.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new _a(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new $t,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(s){this.map=s,this._minTileCacheSize=void 0===this._minTileCacheSize&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const c=this._tiles[s];if("loaded"!==c.state&&"errored"!==c.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,c){return s.isSymbolTile=this._onlySymbols,this._source.loadTile(s,c)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s,()=>{})}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const h=this._tiles[c];h.upload(s),h.prepare(this.map.style.imageManager)}}getIds(){return Nu(this._tiles).map(s=>s.tileID).sort(fr).map(s=>s.key)}getRenderableIds(s){const c=[];for(const h in this._tiles)this._isIdRenderable(+h,s)&&c.push(this._tiles[h]);return s?c.sort((h,m)=>{const b=h.tileID,w=m.tileID,S=new pi(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),D=new pi(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-w.overscaledZ||D.y-S.y||D.x-S.x}).map(h=>h.tileID.key):c.map(h=>h.tileID).sort(fr).map(h=>h.key)}hasRenderableParent(s){const c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)"errored"!==this._tiles[s].state&&this._reloadTile(+s,"reloading")}}_reloadTile(s,c){const h=this._tiles[s];h&&("loading"!==h.state&&(h.state=c),this._loadTile(h,this._tileLoaded.bind(this,h,s,c)))}_tileLoaded(s,c,h,m){if(m)if(s.state="errored",404!==m.status)this._source.fire(new qd(m,{tile:s}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform);else s.timeAdded=vd.now(),"expired"===h&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),"raster-dem"===this._source.type&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new Xc("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const c=this.getRenderableIds();for(let m=0;m<c.length;m++){const b=c[m];if(s.neighboringTiles&&s.neighboringTiles[b]){const w=this.getTileByID(b);h(s,w),h(w,s)}}function h(m,b){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let w=b.tileID.canonical.x-m.tileID.canonical.x;const S=b.tileID.canonical.y-m.tileID.canonical.y,D=Math.pow(2,m.tileID.canonical.z),k=b.tileID.key;0===w&&0===S||Math.abs(S)>1||(Math.abs(w)>1&&(1===Math.abs(w+D)?w+=D:1===Math.abs(w-D)&&(w-=D)),b.dem&&m.dem&&(m.dem.backfillBorder(b.dem,w,S),m.neighboringTiles&&m.neighboringTiles[k]&&(m.neighboringTiles[k].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,h,m){for(const b in this._tiles){let w=this._tiles[b];if(m[b]||!w.hasData()||w.tileID.overscaledZ<=c||w.tileID.overscaledZ>h)continue;let S=w.tileID;for(;w&&w.tileID.overscaledZ>c+1;){const k=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[k.key],w&&w.hasData()&&(S=k)}let D=S;for(;D.overscaledZ>c;)if(D=D.scaledTo(D.overscaledZ-1),s[D.key]){m[S.key]=S;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){const h=this._loadedParentTiles[s.key];return h&&h.tileID.overscaledZ>=c?h:null}for(let h=s.overscaledZ-1;h>=c;h--){const m=s.scaledTo(h),b=this._getLoadedTile(m);if(b)return b}}_getLoadedTile(s){const c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,c){c=c||this._source.tileSize;const h=Math.ceil(s.width/c)+1,m=Math.ceil(s.height/c)+1,b=Math.floor(h*m*5),w="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,b):b,S="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)}handleWrapJump(s){const c=Math.round((s-(void 0===this._prevLng?s:this._prevLng))/360);if(this._prevLng=s,c){const h={};for(const m in this._tiles){const b=this._tiles[m];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+c),h[b.tileID.key]=b}this._tiles=h;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(s,c,h){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!h)return;let m;this.updateCacheSize(s,c),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(S=>new ml(S.canonical.z,S.wrap,S.canonical.z,S.canonical.x,S.canonical.y)):(m=s.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter(S=>this._source.hasTile(S)))):m=[];const b=this._updateRetainedTiles(m);if(ft(this._source.type)&&0!==m.length){const S={},D={},k=Object.keys(b);for(const V of k){const G=b[V],q=this._tiles[V];if(!q||q.fadeEndTime&&q.fadeEndTime<=vd.now())continue;const Y=this.findLoadedParent(G,Math.max(G.overscaledZ-ig.maxOverzooming,this._source.minzoom));Y&&(this._addTile(Y.tileID),S[Y.tileID.key]=Y.tileID),D[V]=G}const N=m[m.length-1].overscaledZ;for(const V in this._tiles){const G=this._tiles[V];if(b[V]||!G.hasData())continue;let q=G.tileID;for(;q.overscaledZ>N;){q=q.scaledTo(q.overscaledZ-1);const Y=this._tiles[q.key];if(Y&&Y.hasData()&&D[q.key]){b[V]=G.tileID;break}}}for(const V in S)b[V]||(this._coveredTiles[V]=!0,b[V]=S[V])}for(const S in b)this._tiles[S].clearFadeHold();const w=function(S,D){const k=[];for(const N in S)N in D||k.push(N);return k}(this._tiles,b);for(const S of w){const D=this._tiles[S];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(+S)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const c={};if(0===s.length)return c;const h={},m=s.reduce((k,N)=>Math.min(k,N.overscaledZ),1/0),b=s[0].overscaledZ,w=Math.max(b-ig.maxOverzooming,this._source.minzoom),S=Math.max(b+ig.maxUnderzooming,this._source.minzoom),D={};for(const k of s){const N=this._addTile(k);c[k.key]=k,N.hasData()||m<this._source.maxzoom&&(D[k.key]=k)}this._retainLoadedChildren(D,m,S,c);for(const k of s){let N=this._tiles[k.key];if(N.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const G=k.children(this._source.maxzoom)[0],q=this.getTile(G);if(q&&q.hasData()){c[G.key]=G;continue}}else{const G=k.children(this._source.maxzoom);if(c[G[0].key]&&c[G[1].key]&&c[G[2].key]&&c[G[3].key])continue}let V=N.wasRequested();for(let G=k.overscaledZ-1;G>=w;--G){const q=k.scaledTo(G);if(h[q.key]||(h[q.key]=!0,N=this.getTile(q),!N&&V&&(N=this._addTile(q)),N&&(c[q.key]=q,V=N.wasRequested(),N.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const c=[];let h,m=this._tiles[s].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){h=this._loadedParentTiles[m.key];break}c.push(m.key);const b=m.scaledTo(m.overscaledZ-1);if(h=this._getLoadedTile(b),h)break;m=b}for(const b of c)this._loadedParentTiles[b]=h}}_addTile(s){let c=this._tiles[s.key];if(c)return c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));const h=!!c;if(!h){const m=this.map?this.map.painter:null;c=new Qe(s,this._source.tileSize*s.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,s.key,c.state))}return c?(c.uses++,this._tiles[s.key]=c,h||this._source.fire(new Xc("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const h=c.getExpiryTimeout();h&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},h))}_removeTile(s){const c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&"reloading"!==c.state?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,c,h){const m=[],b=this.transform;if(!b)return m;const w="globe"===b.projection.name,S=uu(b.center.lng);for(const D in this._tiles){const k=this._tiles[D];if(h&&k.clearQueryDebugViz(),k.holdingForFade())continue;let N;if(w){const V=k.tileID.canonical;if(0===V.z){const G=[Math.abs(pr(S,...Zy(V,-1))-S),Math.abs(pr(S,...Zy(V,1))-S)];N=[0,2*G.indexOf(Math.min(...G))-1]}else{const G=[Math.abs(pr(S,...Zy(V,-1))-S),Math.abs(pr(S,...Zy(V,0))-S),Math.abs(pr(S,...Zy(V,1))-S)];N=[G.indexOf(Math.min(...G))-1]}}else N=[0];for(const V of N){const G=s.containsTile(k,b,c,V);G&&m.push(G)}}return m}getVisibleCoordinates(s){const c=this.getRenderableIds(s).map(h=>this._tiles[h].tileID);for(const h of c)h.projMatrix=this.transform.calculateProjMatrix(h.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(ft(this._source.type))for(const s in this._tiles){const c=this._tiles[s];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=vd.now())return!0}return!1}setFeatureState(s,c,h){this._state.updateState(s=s||"_geojsonTileLayer",c,h)}removeFeatureState(s,c,h){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,h)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,h){const m=this._tiles[s];m&&m.setDependencies(c,h)}reloadTilesForDependencies(s,c){for(const h in this._tiles)this._tiles[h].hasDependency(s,c)&&this._reloadTile(+h,"reloading");this._cache.filter(h=>!h.hasDependency(s,c))}_preloadTiles(s,c){if(!this._sourceLoaded){const S=()=>{this._sourceLoaded&&(this._source.off("data",S),this._preloadTiles(s,c))};return void this._source.on("data",S)}const h=new Map,m=Array.isArray(s)?s:[s],b=this.map.painter.terrain,w=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(const S of m){const D=S.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of D)h.set(k.key,k);this.usedForTerrain&&S.updateElevation(!1)}Bo(Array.from(h.values()),(S,D)=>{const k=new Qe(S,this._source.tileSize*S.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,N=>{"raster-dem"===this._source.type&&k.dem&&this._backfillDEM(k),D(N,k)})},c)}}function fr(l,s){const c=Math.abs(2*l.wrap)-+(l.wrap<0),h=Math.abs(2*s.wrap)-+(s.wrap<0);return l.overscaledZ-s.overscaledZ||h-c||s.canonical.y-l.canonical.y||s.canonical.x-l.canonical.x}function ft(l){return"raster"===l||"image"===l||"video"===l||"custom"===l}function Zy(l,s){const c=1<<l.z;return[l.x/c+s,(l.x+1)/c+s]}ig.maxOverzooming=10,ig.maxUnderzooming=3;class LM{constructor(s,c,h){this._demTile=s,this._dem=this._demTile.dem,this._scale=c,this._offset=h}static create(s,c,h){const m=h||s.findDEMTileFor(c);if(!m||!m.dem)return;const b=m.dem,w=m.tileID,S=1<<c.canonical.z-w.canonical.z;return new LM(m,m.tileSize/Xi/S,[(c.canonical.x/S-w.canonical.x)*b.dim,(c.canonical.y/S-w.canonical.y)*b.dim])}tileCoordToPixel(s,c){const h=c*this._scale+this._offset[1],m=Math.floor(s*this._scale+this._offset[0]),b=Math.floor(h);return new pi(m,b)}getElevationAt(s,c,h,m){const b=s*this._scale+this._offset[0],w=c*this._scale+this._offset[1],S=Math.floor(b),D=Math.floor(w),k=this._dem;return m=!!m,h?Mr(Mr(k.get(S,D,m),k.get(S,D+1,m),w-D),Mr(k.get(S+1,D,m),k.get(S+1,D+1,m),w-D),b-S):k.get(S,D,m)}getElevationAtPixel(s,c,h){return this._dem.get(s,c,!!h)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*hu(1,s)*this._dem.stride}}class rS{constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Yu(Xi,16,0),this.featureIndexArray=new lo,this.promoteId=c}insert(s,c,h,m,b,w=0){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,b,w);const D=this.grid;for(let k=0;k<c.length;k++){const N=c[k],V=[1/0,1/0,-1/0,-1/0];for(let G=0;G<N.length;G++){const q=N[G];V[0]=Math.min(V[0],q.x),V[1]=Math.min(V[1],q.y),V[2]=Math.max(V[2],q.x),V[3]=Math.max(V[3],q.y)}V[0]<Xi&&V[1]<Xi&&V[2]>=0&&V[3]>=0&&D.insert(S,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new t_(new zb(this.rawTileData)).layers,this.sourceLayerCoder=new sw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,c,h,m){this.loadVTLayers();const b=s.params||{},w=Vh(b.filter),S=s.tileResult,D=s.transform,k=S.bufferedTilespaceBounds,N=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(Y,Q,ae,ge)=>tb(S.bufferedTilespaceGeometry,Y,Q,ae,ge));N.sort(GD);let V=null;D.elevation&&N.length>0&&(V=LM.create(D.elevation,this.tileID));const G={};let q;for(let Y=0;Y<N.length;Y++){const Q=N[Y];if(Q===q)continue;q=Q;const ae=this.featureIndexArray.get(Q);let ge=null;this.loadMatchingFeature(G,ae,w,b.layers,b.availableImages,c,h,m,(De,_e,Ae,Ie=0)=>(ge||(ge=sd(De,this.tileID.canonical,s.tileTransform)),_e.queryIntersectsFeature(S,De,Ae,ge,this.z,s.transform,s.pixelPosMatrix,V,Ie)))}return G}loadMatchingFeature(s,c,h,m,b,w,S,D,k){const{featureIndex:N,bucketIndex:V,sourceLayerIndex:G,layoutVertexArrayOffset:q}=c,Y=this.bucketLayerIDs[V];if(m&&!function(De,_e){for(let Ae=0;Ae<De.length;Ae++)if(_e.indexOf(De[Ae])>=0)return!0;return!1}(m,Y))return;const Q=this.sourceLayerCoder.decode(G),ae=this.vtLayers[Q].feature(N);if(h.needGeometry){const De=Wp(ae,!0);if(!h.filter(new z(this.tileID.overscaledZ),De,this.tileID.canonical))return}else if(!h.filter(new z(this.tileID.overscaledZ),ae))return;const ge=this.getId(ae,Q);for(let De=0;De<Y.length;De++){const _e=Y[De];if(m&&m.indexOf(_e)<0)continue;const Ae=w[_e];if(!Ae)continue;let Ie={};void 0!==ge&&D&&(Ie=D.getState(Ae.sourceLayer||"_geojsonTileLayer",ge));const Le=Qo({},S[_e]);Le.paint=FM(Le.paint,Ae.paint,ae,Ie,b),Le.layout=FM(Le.layout,Ae.layout,ae,Ie,b);const st=!k||k(ae,Ae,Ie,q);if(!st)continue;const nt=new tf(ae,this.z,this.x,this.y,ge);nt.layer=Le;let Et=s[_e];void 0===Et&&(Et=s[_e]=[]),Et.push({featureIndex:N,feature:nt,intersectionZ:st})}}lookupSymbolFeatures(s,c,h,m,b,w,S,D){const k={};this.loadVTLayers();const N=Vh(b);for(const V of s)this.loadMatchingFeature(k,{bucketIndex:h,sourceLayerIndex:m,featureIndex:V,layoutVertexArrayOffset:0},N,w,S,D,c);return k}loadFeature(s){const{featureIndex:c,sourceLayerIndex:h}=s;this.loadVTLayers();const m=this.sourceLayerCoder.decode(h),b=this.vtFeatures[m];if(b[c])return b[c];const w=this.vtLayers[m].feature(c);return b[c]=w,w}hasLayer(s){for(const c of this.bucketLayerIDs)for(const h of c)if(s===h)return!0;return!1}getId(s,c){let h=s.id;if(this.promoteId){const m="string"==typeof this.promoteId?this.promoteId:this.promoteId[c];null!=m&&(h=s.properties[m]),"boolean"==typeof h&&(h=Number(h))}return h}}function FM(l,s,c,h,m){return rr(l,(b,w)=>{const S=s instanceof me?s.get(w):null;return S&&S.evaluate?S.evaluate(c,h,m):S})}function GD(l,s){return s-l}Ii(rS,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class oS{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.image=new ep({width:s,height:c}),this.positions={},this.uploaded=!1}getDash(s,c){const h=this.getKey(s,c);return this.positions[h]}trim(){const s=this.width,c=this.height=ws(this.nextRow);this.image.resize({width:s,height:c})}getKey(s,c){return s.join(",")+c}getDashRanges(s,c,h){const m=[];let b=s.length%2==1?-s[s.length-1]*h:0,w=s[0]*h,S=!0;m.push({left:b,right:w,isDash:S,zeroLength:0===s[0]});let D=s[0];for(let k=1;k<s.length;k++){S=!S;const N=s[k];b=D*h,D+=N,w=D*h,m.push({left:b,right:w,isDash:S,zeroLength:0===N})}return m}addRoundDash(s,c,h){const m=c/2;for(let b=-h;b<=h;b++){const w=this.width*(this.nextRow+h+b);let S=0,D=s[S];for(let k=0;k<this.width;k++){k/D.right>1&&(D=s[++S]);const N=Math.abs(k-D.left),V=Math.abs(k-D.right),G=Math.min(N,V);let q;const Y=b/h*(m+1);if(D.isDash){const Q=m-Math.abs(Y);q=Math.sqrt(G*G+Q*Q)}else q=m-Math.sqrt(G*G+Y*Y);this.image.data[w+k]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(s,c){for(let D=s.length-1;D>=0;--D){const k=s[D],N=s[D+1];k.zeroLength?s.splice(D,1):N&&N.isDash===k.isDash&&(N.left=k.left,s.splice(D,1))}const h=s[0],m=s[s.length-1];h.isDash===m.isDash&&(h.left=m.left-this.width,m.right=h.right+this.width);const b=this.width*this.nextRow;let w=0,S=s[w];for(let D=0;D<this.width;D++){D/S.right>1&&(S=s[++w]);const k=Math.abs(D-S.left),N=Math.abs(D-S.right),V=Math.min(k,N);this.image.data[b+D]=Math.max(0,Math.min(255,(S.isDash?V:-V)+c+128))}}addDash(s,c){const h=this.getKey(s,c);if(this.positions[h])return this.positions[h];const m="round"===c,b=m?7:0,w=2*b+1;if(this.nextRow+w>this.height)return _o("LineAtlas out of space"),null;0===s.length&&s.push(1);let S=0;for(let N=0;N<s.length;N++)s[N]<0&&(_o("Negative value is found in line dasharray, replacing values with 0"),s[N]=0),S+=s[N];if(0!==S){const N=this.width/S,V=this.getDashRanges(s,this.width,N);m?this.addRoundDash(V,N,b):this.addRegularDash(V,"square"===c?.5*N:0)}const D=this.nextRow+b;this.nextRow+=w;const k={tl:[D,b],br:[S,0]};return this.positions[h]=k,k}}Ii(oS,"LineAtlas");const OM=1*Rd;class sS{constructor(s){const c={},h=[];for(const S in s){const D=s[S],k=c[S]={};for(const N in D.glyphs){const V=D.glyphs[+N];if(!V||0===V.bitmap.width||0===V.bitmap.height)continue;const G=V.metrics.localGlyph?OM:1,q={x:0,y:0,w:V.bitmap.width+2*G,h:V.bitmap.height+2*G};h.push(q),k[N]=q}}const{w:m,h:b}=Oy(h),w=new ep({width:m||1,height:b||1});for(const S in s){const D=s[S];for(const k in D.glyphs){const N=D.glyphs[+k];if(!N||0===N.bitmap.width||0===N.bitmap.height)continue;const V=c[S][k],G=N.metrics.localGlyph?OM:1;ep.copy(N.bitmap,w,{x:0,y:0},{x:V.x+G,y:V.y+G},N.bitmap)}}this.image=w,this.positions=c}}Ii(sS,"GlyphAtlas");class aS{constructor(s){this.tileID=new ml(s.tileID.overscaledZ,s.tileID.wrap,s.tileID.canonical.z,s.tileID.canonical.x,s.tileID.canonical.y),this.tileZoom=s.tileZoom,this.uid=s.uid,this.zoom=s.zoom,this.canonical=s.tileID.canonical,this.pixelRatio=s.pixelRatio,this.tileSize=s.tileSize,this.source=s.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=s.showCollisionBoxes,this.collectResourceTiming=!!s.collectResourceTiming,this.returnDependencies=!!s.returnDependencies,this.promoteId=s.promoteId,this.enableTerrain=!!s.enableTerrain,this.isSymbolTile=s.isSymbolTile,this.tileTransform=mu(s.tileID.canonical,s.projection),this.projection=s.projection}parse(s,c,h,m,b){this.status="parsing",this.data=s,this.collisionBoxArray=new ro;const w=new sw(Object.keys(s.layers).sort()),S=new rS(this.tileID,this.promoteId);S.bucketLayerIDs=[];const D={},k=new oS(256,256),N={featureIndex:S,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:h},V=c.familiesBySource[this.source];for(const Ie in V){const Le=s.layers[Ie];if(!Le)continue;let st=!1,nt=!1;for(const ct of V[Ie])"symbol"===ct[0].type?st=!0:nt=!0;if(!0===this.isSymbolTile&&!st||!1===this.isSymbolTile&&!nt)continue;1===Le.version&&_o(`Vector tile source "${this.source}" layer "${Ie}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Et=w.encode(Ie),Yt=[];for(let ct=0;ct<Le.length;ct++){const Pt=Le.feature(ct),Lt=S.getId(Pt,Ie);Yt.push({feature:Pt,id:Lt,index:ct,sourceLayerIndex:Et})}for(const ct of V[Ie]){const Pt=ct[0];void 0!==this.isSymbolTile&&"symbol"===Pt.type!==this.isSymbolTile||Pt.minzoom&&this.zoom<Math.floor(Pt.minzoom)||Pt.maxzoom&&this.zoom>=Pt.maxzoom||"none"!==Pt.visibility&&(NM(ct,this.zoom,h),(D[Pt.id]=Pt.createBucket({index:S.bucketLayerIDs.length,layers:ct,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Et,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:h})).populate(Yt,N,this.tileID.canonical,this.tileTransform),S.bucketLayerIDs.push(ct.map(Lt=>Lt.id)))}}let G,q,Y,Q;k.trim();const ae={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ge=()=>{if(G)return b(G);if(q&&Y&&Q){const Ie=new sS(q),Le=new Ny(Y,Q);for(const st in D){const nt=D[st];nt instanceof _u?(NM(nt.layers,this.zoom,h),jb(nt,q,Ie.positions,Y,Le.iconPositions,this.showCollisionBoxes,h,this.tileID.canonical,this.tileZoom,this.projection)):nt.hasPattern&&(nt instanceof ip||nt instanceof Sy||nt instanceof i_)&&(NM(nt.layers,this.zoom,h),nt.addFeatures(N,this.tileID.canonical,Le.patternPositions,h,this.tileTransform))}this.status="done",b(null,{buckets:Nu(D).filter(st=>!st.isEmpty()),featureIndex:S,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ie.image,lineAtlas:k,imageAtlas:Le,glyphMap:this.returnDependencies?q:null,iconMap:this.returnDependencies?Y:null,glyphPositions:this.returnDependencies?Ie.positions:null})}},De=rr(N.glyphDependencies,Ie=>Object.keys(Ie).map(Number));Object.keys(De).length?m.send("getGlyphs",{uid:this.uid,stacks:De},(Ie,Le)=>{G||(G=Ie,q=Le,ge())},void 0,!1,ae):q={};const _e=Object.keys(N.iconDependencies);_e.length?m.send("getImages",{icons:_e,source:this.source,tileID:this.tileID,type:"icons"},(Ie,Le)=>{G||(G=Ie,Y=Le,ge())},void 0,!1,ae):Y={};const Ae=Object.keys(N.patternDependencies);Ae.length?m.send("getImages",{icons:Ae,source:this.source,tileID:this.tileID,type:"patterns"},(Ie,Le)=>{G||(G=Ie,Q=Le,ge())},void 0,!1,ae):Q={},ge()}}function NM(l,s,c){const h=new z(s);for(const m of l)m.recalculate(h,c)}class lS{constructor(s){this.entries={},this.scheduler=s}request(s,c,h,m){const b=this.entries[s]=this.entries[s]||{callbacks:[]};if(b.result){const[w,S]=b.result;return this.scheduler?this.scheduler.add(()=>{m(w,S)},c):m(w,S),()=>{}}return b.callbacks.push(m),b.cancel||(b.cancel=h((w,S)=>{b.result=[w,S];for(const D of b.callbacks)this.scheduler?this.scheduler.add(()=>{D(w,S)},c):D(w,S);setTimeout(()=>delete this.entries[s],3e3)})),()=>{b.result||(b.callbacks=b.callbacks.filter(w=>w!==m),b.callbacks.length||(b.cancel(),delete this.entries[s]))}}}function jD(l,s,c){const h=JSON.stringify(l.request);return l.data&&(this.deduped.entries[h]={result:[null,l.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},m=>{const b=Uu(l.request,(w,S,D,k)=>{w?m(w):S&&m(null,{vectorTile:c?void 0:new t_(new zb(S)),rawData:S,cacheControl:D,expires:k})});return()=>{b.cancel(),m()}},s)}const BM=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class lw{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,h]=new Uint8Array(s,0,2);if(219!==c)throw new Error("Data does not appear to be in a KDBush format.");const m=h>>4;if(1!==m)throw new Error(`Got v${m} data when expected v1.`);const b=BM[15&h];if(!b)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(s,2,1),[S]=new Uint32Array(s,4,1);return new lw(S,w,b,s)}constructor(s,c=64,h=Float64Array,m){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=h,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const b=BM.indexOf(this.ArrayType),w=2*s*this.ArrayType.BYTES_PER_ELEMENT,S=s*this.IndexArrayType.BYTES_PER_ELEMENT,D=(8-S%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${h}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+S+D,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+w+S+D),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+S+D,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=s)}add(s,c){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=s,this.coords[this._pos++]=c,h}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return vl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,c,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:w,nodeSize:S}=this,D=[0,b.length-1,0],k=[];for(;D.length;){const N=D.pop()||0,V=D.pop()||0,G=D.pop()||0;if(V-G<=S){for(let ae=G;ae<=V;ae++){const ge=w[2*ae],De=w[2*ae+1];ge>=s&&ge<=h&&De>=c&&De<=m&&k.push(b[ae])}continue}const q=G+V>>1,Y=w[2*q],Q=w[2*q+1];Y>=s&&Y<=h&&Q>=c&&Q<=m&&k.push(b[q]),(0===N?s<=Y:c<=Q)&&(D.push(G),D.push(q-1),D.push(1-N)),(0===N?h>=Y:m>=Q)&&(D.push(q+1),D.push(V),D.push(1-N))}return k}within(s,c,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:b,nodeSize:w}=this,S=[0,m.length-1,0],D=[],k=h*h;for(;S.length;){const N=S.pop()||0,V=S.pop()||0,G=S.pop()||0;if(V-G<=w){for(let ae=G;ae<=V;ae++)Yb(b[2*ae],b[2*ae+1],s,c)<=k&&D.push(m[ae]);continue}const q=G+V>>1,Y=b[2*q],Q=b[2*q+1];Yb(Y,Q,s,c)<=k&&D.push(m[q]),(0===N?s-h<=Y:c-h<=Q)&&(S.push(G),S.push(q-1),S.push(1-N)),(0===N?s+h>=Y:c+h>=Q)&&(S.push(q+1),S.push(V),S.push(1-N))}return D}}function vl(l,s,c,h,m,b){if(m-h<=c)return;const w=h+m>>1;oe(l,s,w,h,m,b),vl(l,s,c,h,w-1,1-b),vl(l,s,c,w+1,m,1-b)}function oe(l,s,c,h,m,b){for(;m>h;){if(m-h>600){const k=m-h+1,N=c-h+1,V=Math.log(k),G=.5*Math.exp(2*V/3),q=.5*Math.sqrt(V*G*(k-G)/k)*(N-k/2<0?-1:1);oe(l,s,c,Math.max(h,Math.floor(c-N*G/k+q)),Math.min(m,Math.floor(c+(k-N)*G/k+q)),b)}const w=s[2*c+b];let S=h,D=m;for(lp(l,s,h,c),s[2*m+b]>w&&lp(l,s,h,m);S<D;){for(lp(l,s,S,D),S++,D--;s[2*S+b]<w;)S++;for(;s[2*D+b]>w;)D--}s[2*h+b]===w?lp(l,s,h,D):(D++,lp(l,s,D,m)),D<=c&&(h=D+1),c<=D&&(m=D-1)}}function lp(l,s,c,h){zM(l,c,h),zM(s,2*c,2*h),zM(s,2*c+1,2*h+1)}function zM(l,s,c){const h=l[s];l[s]=l[c],l[c]=h}function Yb(l,s,c,h){const m=l-c,b=s-h;return m*m+b*b}g.ARRAY_TYPE=Ns,g.AUTH_ERR_MSG=Fe,g.Aabb=ul,g.Actor=class{constructor(l,s,c){this.target=l,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},to(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Jl()?l:gt,this.scheduler=new sp}send(l,s,c,h,m=!1,b){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=b,this.callbacks[w]=c);const S=Ep(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:l,hasCallback:!!c,targetMapId:h,mustQueue:m,sourceMapId:this.mapId,data:$h(s,S)},S),{cancel:()=>{c&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(l){const s=l.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if("<cancel>"===s.type){const h=this.cancelCallbacks[c];delete this.cancelCallbacks[c],h&&h.cancel()}else if(s.mustQueue||Jl()){const h=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,s),h&&h.metadata||{type:"message"})}else this.processTask(c,s)}processTask(l,s){if("<response>"===s.type){const c=this.callbacks[l];delete this.callbacks[l],c&&(s.error?c(Bp(s.error)):c(null,Bp(s.data)))}else{const c=Ep(this.globalScope)?void 0:[],h=s.hasCallback?(b,w)=>{delete this.cancelCallbacks[l],this.target.postMessage({id:l,type:"<response>",sourceMapId:this.mapId,error:b?$h(b):null,data:$h(w,c)},c)}:b=>{},m=Bp(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,m,h);else if(this.parent.getWorkerSource){const b=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,b[0],m.source)[b[1]](m,h)}else h(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},g.CanonicalTileID=Ul,g.Color=fs,g.ColorMode=ap,g.CullFaceMode=gh,g.DEMData=uc,g.DataConstantProperty=J,g.DedupedRequest=lS,g.DepthMode=yl,g.EXTENT=Xi,g.Elevation=class{isDataAvailableAtPoint(l){const s=this._source();if(this.isUsingMockSource()||!s||l.y<0||l.y>1)return!1;const c=s.getSource().maxzoom,h=1<<c,m=Math.floor(l.x),b=Math.floor((l.x-m)*h),w=Math.floor(l.y*h),S=this.findDEMTileFor(new ml(c,m,c,b,w));return!(!S||!S.dem)}getAtPointOrZero(l,s=0){return this.getAtPoint(l,s)||0}getAtPoint(l,s,c=!0){if(this.isUsingMockSource())return null;null==s&&(s=null);const h=this._source();if(!h||l.y<0||l.y>1)return s;const m=h.getSource().maxzoom,b=1<<m,w=Math.floor(l.x),S=l.x-w,D=new ml(m,w,m,Math.floor(S*b),Math.floor(l.y*b)),k=this.findDEMTileFor(D);if(!k||!k.dem)return s;const N=k.dem,V=1<<k.tileID.canonical.z,G=(S*V-k.tileID.canonical.x)*N.dim,q=(l.y*V-k.tileID.canonical.y)*N.dim,Y=Math.floor(G),Q=Math.floor(q);return(c?this.exaggeration():1)*Mr(Mr(N.get(Y,Q),N.get(Y,Q+1),q-Q),Mr(N.get(Y+1,Q),N.get(Y+1,Q+1),q-Q),G-Y)}getAtTileOffset(l,s,c){const h=1<<l.canonical.z;return this.getAtPointOrZero(new Jh(l.wrap+(l.canonical.x+s/Xi)/h,(l.canonical.y+c/Xi)/h))}getAtTileOffsetFunc(l,s,c,h){return m=>{const b=this.getAtTileOffset(l,m.x,m.y),w=h.upVector(l.canonical,m.x,m.y);return Nl(w,w,b*h.upVectorScale(l.canonical,s,c).metersToTile),w}}getForTilePoints(l,s,c,h){if(this.isUsingMockSource())return!1;const m=LM.create(this,l,h);return!!m&&(s.forEach(b=>{b[2]=this.exaggeration()*m.getElevationAt(b[0],b[1],c)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(l);if(!s||!s.dem)return null;const c=s.dem.tree,h=s.tileID,m=1<<l.canonical.z-h.canonical.z;let b=l.canonical.x/m-h.canonical.x,w=l.canonical.y/m-h.canonical.y,S=0;for(let D=0;D<l.canonical.z-h.canonical.z&&!c.leaves[S];D++){b*=2,w*=2;const k=2*Math.floor(w)+Math.floor(b);S=c.childOffsets[S]+k,b%=1,w%=1}return{min:this.exaggeration()*c.minimums[S],max:this.exaggeration()*c.maximums[S]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,s,c){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},g.ErrorEvent=qd,g.EvaluationParameters=z,g.Event=Xc,g.Evented=Dh,g.FillExtrusionBucket=i_,g.Frustum=oh,g.FrustumCorners=hy,g.GLOBE_RADIUS=sh,g.GLOBE_SCALE_MATCH_LATITUDE=45,g.GLOBE_ZOOM_THRESHOLD_MAX=py,g.GLOBE_ZOOM_THRESHOLD_MIN=Gn,g.GlobeSharedBuffers=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const l of this._wireframeSegments)l.destroy()}}_fillGridMeshWithLods(l,s){const c=new St,h=new Bi,m=[],b=l+1+2,w=s[0]+1,S=s[0]+1+(1+s.length),D=(k,N,V)=>{let G=k===b-1?k-2:0===k?k:k-1;return G+=V?24575:0,[G,N]};for(let k=0;k<b;++k)c.emplaceBack(...D(k,0,!0));for(let k=0;k<w;++k)for(let N=0;N<b;++N)c.emplaceBack(...D(N,k,(0===N||N===b-1)&&!0));for(let k=0;k<s.length;++k){const N=s[k];for(let V=0;V<b;++V)c.emplaceBack(...D(V,N,!0))}for(let k=0;k<s.length;++k){const N=h.length,V=s[k]+1+2,G=new Bi;for(let Q=0;Q<V-1;Q++){const ae=Q===V-2,ge=ae?b*(S-s.length+k-Q):b;for(let De=0;De<b-1;De++){const _e=Q*b+De;0===Q||ae||0===De||De===b-2?(G.emplaceBack(_e+1,_e,_e+ge),G.emplaceBack(_e+ge,_e+ge+1,_e+1)):(h.emplaceBack(_e+1,_e,_e+ge),h.emplaceBack(_e+ge,_e+ge+1,_e+1))}}const q=As.simpleSegment(0,N,c.length,h.length-N);for(let Q=0;Q<G.uint16.length;Q+=3)h.emplaceBack(G.uint16[Q],G.uint16[Q+1],G.uint16[Q+2]);const Y=As.simpleSegment(0,N,c.length,h.length-N);m.push({withoutSkirts:q,withSkirts:Y})}return{vertices:c,indices:h,segments:m}}_createGrid(l){const s=this._fillGridMeshWithLods(64,lu);this._gridSegments=s.segments,this._gridBuffer=l.createVertexBuffer(s.vertices,Pf.members),this._gridIndexBuffer=l.createIndexBuffer(s.indices,!0)}_createPoles(l){const s=new Bi;for(let m=0;m<=64;m++)s.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=l.createIndexBuffer(s,!0);const c=new To,h=new To;this._poleSegments=[];for(let m=0,b=0;m<Gn;m++){const w=360/(1<<m);c.emplaceBack(0,-sh,0,.5,0),h.emplaceBack(0,-sh,0,.5,1);for(let S=0;S<=64;S++){const D=S/64,k=Mr(0,w,D),[N,V,G]=jg(Zv,yx,k,sh);c.emplaceBack(N,V,G,D,0),h.emplaceBack(N,V,G,D,1)}this._poleSegments.push(As.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(c,wn,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(h,wn,!1)}getGridBuffers(l,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}getWirefameBuffers(l,s){if(!this._wireframeSegments){const c=new ua,h=64,m=h+1+2,b=1;this._wireframeSegments=[];for(let w=0,S=0;w<lu.length;w++){const D=lu[w];for(let N=b;N<D+b;N++)for(let V=b;V<h+b;V++){const G=N*m+V;c.emplaceBack(G,G+1),c.emplaceBack(G,G+m),c.emplaceBack(G,G+m+1)}const k=D*h*3;this._wireframeSegments.push(As.simpleSegment(0,S,(D+1)*m,k)),S+=k}this._wireframeIndexBuffer=l.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[s]]}},g.GlyphManager=dd,g.ImagePosition=$m,g.KDBush=lw,g.LivePerformanceUtils=q_,g.LngLat=kr,g.LngLatBounds=eh,g.LocalGlyphMode=d_,g.MAX_MERCATOR_LATITUDE=Ga,g.MercatorCoordinate=Jh,g.ONE_EM=fa,g.OverscaledTileID=ml,g.PerformanceMarkers=Tp,g.Point=pi,g.Properties=xe,g.RGBAImage=fl,g.Ray=rh,g.RequestManager=class{constructor(l,s,c){this._transformRequestFn=l,this._customAccessToken=s,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const l=function(){let s="";for(let c=0;c<10;c++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Gd,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=l.token,this._skuTokenExpiresAt=l.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(l,s){return this._transformRequestFn&&this._transformRequestFn(l,s)||{url:l}}normalizeStyleURL(l,s){if(!He(l))return l;const c=fi(l);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeGlyphsURL(l,s){if(!He(l))return l;const c=fi(l);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeSourceURL(l,s,c,h){if(!He(l))return l;const m=fi(l);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),c&&m.params.push(`language=${c}`),h&&m.params.push(`worldview=${h}`),this._makeAPIURL(m,this._customAccessToken||s)}normalizeSpriteURL(l,s,c,h){const m=fi(l);return He(l)?(m.path=`/styles/v1${m.path}/sprite${s}${c}`,this._makeAPIURL(m,this._customAccessToken||h)):(m.path+=`${s}${c}`,Kt(m))}normalizeTileURL(l,s,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),l&&!He(l))return l;const h=fi(l);h.path=h.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||c&&"raster"!==h.authority&&512===c?"@2x":""}${jn.supported?".webp":"$1"}`),"raster"===h.authority?h.path=`/${Hn.RASTER_URL_PREFIX}${h.path}`:(h.path=h.path.replace(/^.+\/v4\//,"/"),h.path=`/${Hn.TILE_URL_VERSION}${h.path}`);const m=this._customAccessToken||function(b){for(const w of b){const S=w.match(/^access_token=(.*)$/);if(S)return S[1]}return null}(h.params)||Hn.ACCESS_TOKEN;return Hn.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&h.params.push(`sku=${this._skuToken}`),this._makeAPIURL(h,m)}canonicalizeTileURL(l,s){const c=fi(l);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return l;let h="mapbox://";c.path.match(/^\/raster\/v1\//)?h+=`raster/${c.path.replace(`/${Hn.RASTER_URL_PREFIX}/`,"")}`:h+=`tiles/${c.path.replace(`/${Hn.TILE_URL_VERSION}/`,"")}`;let m=c.params;return s&&(m=m.filter(b=>!b.match(/^access_token=/))),m.length&&(h+=`?${m.join("&")}`),h}canonicalizeTileset(l,s){const c=!!s&&He(s),h=[];for(const m of l.tiles||[])Ke(m)?h.push(this.canonicalizeTileURL(m,c)):h.push(m);return h}_makeAPIURL(l,s){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",h=fi(Hn.API_URL);if(l.protocol=h.protocol,l.authority=h.authority,"http"===l.protocol){const m=l.params.indexOf("secure");m>=0&&l.params.splice(m,1)}if("/"!==h.path&&(l.path=`${h.path}${l.path}`),!Hn.REQUIRE_ACCESS_TOKEN)return Kt(l);if(s=s||Hn.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if("s"===s[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return l.params=l.params.filter(m=>-1===m.indexOf("access_token")),l.params.push(`access_token=${s||""}`),Kt(l)}},g.ResourceType=Ra,g.SegmentVector=As,g.SourceCache=ig,g.StencilMode=Zb,g.StructArrayLayout1ui2=rc,g.StructArrayLayout2f1f2i16=nn,g.StructArrayLayout2i4=St,g.StructArrayLayout2ui4=ua,g.StructArrayLayout3f12=Bn,g.StructArrayLayout3ui6=Bi,g.StructArrayLayout4i8=vt,g.StructArrayLayout5f20=To,g.Texture=p_,g.Tile=Qe,g.Transitionable=K,g.Uniform1f=Pg,g.Uniform1i=class extends ha{constructor(l){super(l),this.current=0}set(l,s,c){this.fetchUniformLocation(l,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},g.Uniform2f=class extends ha{constructor(l){super(l),this.current=[0,0]}set(l,s,c){this.fetchUniformLocation(l,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},g.Uniform3f=class extends ha{constructor(l){super(l),this.current=[0,0,0]}set(l,s,c){this.fetchUniformLocation(l,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},g.Uniform4f=Lg,g.UniformColor=sy,g.UniformMatrix2f=class extends ha{constructor(l){super(l),this.current=Rc}set(l,s,c){if(this.fetchUniformLocation(l,s))for(let h=0;h<4;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}},g.UniformMatrix3f=class extends ha{constructor(l){super(l),this.current=ly}set(l,s,c){if(this.fetchUniformLocation(l,s))for(let h=0;h<9;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}},g.UniformMatrix4f=class extends ha{constructor(l){super(l),this.current=ay}set(l,s,c){if(this.fetchUniformLocation(l,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let h=1;h<16;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},g.UnwrappedTileID=r_,g.ValidationError=ii,g.VectorTileFeature=Dy,g.VectorTileWorkerSource=class extends Dh{constructor(l,s,c,h,m){super(),this.actor=l,this.layerIndex=s,this.availableImages=c,this.loadVectorData=m||jD,this.loading={},this.loaded={},this.deduped=new lS(l.scheduler),this.isSpriteLoaded=h,this.scheduler=l.scheduler}loadTile(l,s){const c=l.uid,h=l&&l.request,m=h&&h.collectResourceTiming,b=this.loading[c]=new aS(l);b.abort=this.loadVectorData(l,(w,S)=>{const D=!this.loading[c];if(delete this.loading[c],D||w||!S)return b.status="done",D||(this.loaded[c]=b),s(w);const k=S.rawData,N={};S.expires&&(N.expires=S.expires),S.cacheControl&&(N.cacheControl=S.cacheControl),b.vectorTile=S.vectorTile||new t_(new zb(k));const V=()=>{b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,(G,q)=>{if(G||!q)return s(G);const Y={};if(m){const Q=Ms(h);Q.length>0&&(Y.resourceTiming=JSON.parse(JSON.stringify(Q)))}s(null,Qo({rawTileData:k.slice(0)},q,N,Y))})};this.isSpriteLoaded?V():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom}):V()}),this.loaded=this.loaded||{},this.loaded[c]=b})}reloadTile(l,s){const c=this.loaded,h=l.uid,m=this;if(c&&c[h]){const b=c[h];b.showCollisionBoxes=l.showCollisionBoxes,b.enableTerrain=!!l.enableTerrain,b.projection=l.projection,b.tileTransform=mu(l.tileID.canonical,l.projection);const w=(S,D)=>{const k=b.reloadCallback;k&&(delete b.reloadCallback,b.parse(b.vectorTile,m.layerIndex,this.availableImages,m.actor,k)),s(S,D)};"parsing"===b.status?b.reloadCallback=w:"done"===b.status&&(b.vectorTile?b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(l,s){const c=l.uid,h=this.loading[c];h&&(h.abort&&h.abort(),delete this.loading[c]),s()}removeTile(l,s){const c=this.loaded,h=l.uid;c&&c[h]&&delete c[h],s()}},g.WritingMode=lc,g.ZoomDependentExpression=In,g.add=su,g.addDynamicAttributes=Qp,g.adjoint=function(l,s){var c=s[0],h=s[1],m=s[2],b=s[3],w=s[4],S=s[5],D=s[6],k=s[7],N=s[8];return l[0]=w*N-S*k,l[1]=m*k-h*N,l[2]=h*S-m*w,l[3]=S*D-b*N,l[4]=c*N-m*D,l[5]=m*b-c*S,l[6]=b*k-w*D,l[7]=h*D-c*k,l[8]=c*w-h*b,l},g.asyncAll=Bo,g.bezier=Sh,g.bindAll=to,g.boundsAttributes=Pe,g.bufferConvexPolygon=function(l,s){const c=[];for(let h=0;h<l.length;h++){const m=Cn(h-1,-1,l.length-1),b=Cn(h+1,-1,l.length-1),w=l[h],S=l[b],D=l[m].sub(w).unit(),k=S.sub(w).unit(),N=k.angleWithSep(D.x,D.y),V=D.add(k).unit().mult(-1*s/Math.sin(N/2));c.push(w.add(V))}return c},g.cacheEntryPossiblyAdded=function(l){Ah++,Ah>Wd&&(l.getActor().send("enforceCacheSizeLimit",zu),Ah=0)},g.calculateGlobeLabelMatrix=function(l,s){const{x:c,y:h}=l.point,m=Of(c,h,l.worldSize/l._pixelsPerMercatorPixel,0,0);return Xh(m,m,zl(cu(s)))},g.calculateGlobeMatrix=function(l){const{x:s,y:c}=l.point,{lng:h,lat:m}=l._center;return Of(s,c,l.worldSize,h,m)},g.calculateGlobeMercatorMatrix=function(l){const s=l.pixelsPerMeter,c=s/hu(1,l.center.lat),h=Ds(new Float64Array(16));return Zh(h,h,[l.point.x,l.point.y,0]),nd(h,h,[c,c,s]),Float32Array.from(h)},g.circumferenceAtLatitude=vx,g.clamp=pr,g.clearTileCache=function(l){if(!Cp())return;const s=gt.caches.delete(wa);l&&s.catch(l).then(()=>l())},g.clipLine=bM,g.clone=function(l){var s=new Ns(16);return s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5],s[6]=l[6],s[7]=l[7],s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15],s},g.clone$1=rl,g.collisionCircleLayout=zx,g.config=Hn,g.conjugate=function(l,s){return l[0]=-s[0],l[1]=-s[1],l[2]=-s[2],l[3]=s[3],l},g.create=function(){var l=new Ns(16);return Ns!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},g.create$1=Vv,g.createExpression=al,g.createLayout=$e,g.createStyleLayer=function(l){return"custom"===l.type?new tg(l):new tn[l.type](l)},g.cross=Pm,g.degToRad=er,g.distance=function(l,s){return Math.hypot(s[0]-l[0],s[1]-l[1],s[2]-l[2])},g.div=function(l,s,c){return l[0]=s[0]/c[0],l[1]=s[1]/c[1],l[2]=s[2]/c[2],l},g.dot=Ad,g.earthRadius=rd,g.ease=yc,g.easeCubicInOut=hm,g.ecefToLatLng=function([l,s,c]){const h=Math.hypot(l,s,c),m=Math.atan2(l,c),b=.5*Math.PI-Math.acos(-s/h);return new kr(ia(m),ia(b))},g.emitValidationErrors=Bv,g.endsWith=go,g.enforceCacheSizeLimit=function(l){Wc(),wc&&wc.then(s=>{s.keys().then(c=>{for(let h=0;h<c.length-l;h++)s.delete(c[h])})})},g.evaluateSizeForFeature=a_,g.evaluateSizeForZoom=uh,g.evaluateVariableOffset=Qx,g.evented=C,g.exactEquals=function(l,s){return l[0]===s[0]&&l[1]===s[1]&&l[2]===s[2]&&l[3]===s[3]},g.exactEquals$1=function(l,s){return l[0]===s[0]&&l[1]===s[1]&&l[2]===s[2]},g.exported=vd,g.exported$1=jn,g.extend=Qo,g.extend$1=bd,g.fillExtrusionHeightLift=Ry,g.filterObject=vn,g.fromMat4=function(l,s){return l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[4],l[4]=s[5],l[5]=s[6],l[6]=s[8],l[7]=s[9],l[8]=s[10],l},g.fromQuat=function(l,s){var c=s[0],h=s[1],m=s[2],b=s[3],w=c+c,S=h+h,D=m+m,k=c*w,N=h*w,V=h*S,G=m*w,q=m*S,Y=m*D,Q=b*w,ae=b*S,ge=b*D;return l[0]=1-V-Y,l[1]=N+ge,l[2]=G-ae,l[3]=0,l[4]=N-ge,l[5]=1-k-Y,l[6]=q+Q,l[7]=0,l[8]=G+ae,l[9]=q-Q,l[10]=1-k-V,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},g.fromRotation=function(l,s){var c=Math.sin(s),h=Math.cos(s);return l[0]=h,l[1]=c,l[2]=0,l[3]=-c,l[4]=h,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},g.fromScaling=Im,g.furthestTileCorner=function(l){const s=Math.round((l+45+360)%360/90)%4;return mf[s]},g.getAABBPointSquareDist=function(l,s,c){let h=0;for(let m=0;m<2;++m){const b=c?c[m]:0;l[m]>b&&(h+=(l[m]-b)*(l[m]-b)),s[m]<b&&(h+=(b-s[m])*(b-s[m]))}return h},g.getAnchorAlignment=qx,g.getAnchorJustification=Km,g.getBounds=function(l){let s=1/0,c=1/0,h=-1/0,m=-1/0;for(const b of l)s=Math.min(s,b.x),c=Math.min(c,b.y),h=Math.max(h,b.x),m=Math.max(m,b.y);return{min:new pi(s,c),max:new pi(h,m)}},g.getColumn=xc,g.getDefaultExportFromCjs=Jo,g.getGridMatrix=function(l,s,c,h){const m=s.getNorth(),b=s.getSouth(),w=s.getWest(),S=s.getEast(),D=1<<l.z,k=S-w,N=m-b,V=k/64,G=-N/lu[c],q=[0,V,0,G,0,0,m,w,0];if(l.z>0){const Y=180/h;Va(q,q,[Y/k+1,0,0,0,Y/N+1,0,-.5*Y/V,.5*Y/G,1])}return q[2]=D,q[5]=l.x,q[8]=l.y,q},g.getImage=Me,g.getJSON=function(l,s){return md(Qo(l,{type:"json"}),s)},g.getLatitudinalLod=function(l){const s=Ga-5;l=pr(l,-s,s)/s*90;const c=Math.pow(Math.abs(Math.sin(er(l))),3);return Math.round(c*(lu.length-1))},g.getMapSessionAPI=na,g.getPerformanceMeasurement=Ms,g.getProjection=Xb,g.getRTLTextPluginStatus=T,g.getReferrer=$d,g.getTilePoint=function(l,{x:s,y:c},h=0){return new pi(((s-h)*l.scale-l.x)*Xi,(c*l.scale-l.y)*Xi)},g.getTileVec3=function(l,s,c=0){return Rf(((s.x-c)*l.scale-l.x)*Xi,(s.y*l.scale-l.y)*Xi,bx(s.z,s.y))},g.getVideo=function(l,s){const c=gt.document.createElement("video");c.muted=!0,c.onloadstart=function(){s(null,c)};for(let h=0;h<l.length;h++){const m=gt.document.createElement("source");Sp(l[h])||(c.crossOrigin="Anonymous"),m.src=l[h],c.appendChild(m)}return{cancel:()=>{}}},g.globeCenterToScreenPoint=function(l){const s=[0,0,0],c=Ds(new Float64Array(16));return Xh(c,l.pixelMatrix,l.globeMatrix),ds(s,s,c),new pi(s[0],s[1])},g.globeDenormalizeECEF=zl,g.globeECEFOrigin=function(l,s){const c=[0,0,0];return ds(c,c,qg(cu(s.canonical))),ds(c,c,l),c},g.globeMetersToEcef=Lc,g.globeNormalizeECEF=qg,g.globePixelsToTileUnits=function(l,s){return Xi/(512*Math.pow(2,l))*$g(cu(s))},g.globePoleMatrixForTile=function(l,s,c){const h=Ds(new Float64Array(16)),m=(s/(1<<l)-.5)*Math.PI*2;return th(h,c.globeMatrix,m),Float32Array.from(h)},g.globeTileBounds=cu,g.globeTiltAtLngLat=Nf,g.globeToMercatorTransition=du,g.globeUseCustomAntiAliasing=function(l,s,c){const h=du(c.zoom),m=l.style.map._antialias,b=!!s.extStandardDerivatives,w=s.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return 0===h&&!m&&!w&&b},g.identity=Ds,g.identity$1=zg,g.invert=Dm,g.isFullscreen=function(){return!!gt.document.fullscreenElement||!!gt.document.webkitFullscreenElement},g.isLngLatBehindGlobe=jp,g.isMapAuthenticated=function(l){return La.has(l)},g.isMapboxURL=He,g.isSafariWithAntialiasingBug=function(l){const s=l.navigator?l.navigator.userAgent:null;return!!Ep(l)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},g.latFromMercatorY=Ha,g.latLngToECEF=Wg,g.len=Wv,g.length=km,g.length$1=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},g.lngFromMercatorX=od,g.loadVectorTile=jD,g.makeRequest=md,g.mapValue=function(l,s,c,h,m){return pr((l-s)/(c-s)*(m-h)+h,h,m)},g.mercatorScale=my,g.mercatorXfromLng=uu,g.mercatorYfromLat=lh,g.mercatorZfromAltitude=hu,g.mul=Ng,g.mul$1=Bg,g.multiply=Xh,g.multiply$1=Va,g.multiply$2=Rm,g.nextPowerOfTwo=ws,g.normalize=Bs,g.normalize$1=Hg,g.normalize$2=uy,g.number=Mr,g.ortho=function(l,s,c,h,m,b,w){var S=1/(s-c),D=1/(h-m),k=1/(b-w);return l[0]=-2*S,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*D,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*k,l[11]=0,l[12]=(s+c)*S,l[13]=(m+h)*D,l[14]=(w+b)*k,l[15]=1,l},g.pbf=Hf,g.perspective=function(l,s,c,h,m){var b,w=1/Math.tan(s/2);return l[0]=w/c,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=w,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,null!=m&&m!==1/0?(l[10]=(m+h)*(b=1/(h-m)),l[14]=2*m*h*b):(l[10]=-1,l[14]=-2*h),l},g.pick=function(l,s){const c={};for(let h=0;h<s.length;h++){const m=s[h];m in l&&(c[m]=l[m])}return c},g.plugin=F,g.pointGeometry=Sl,g.polesInViewport=function(l){const s=Ds(new Float64Array(16));Xh(s,l.pixelMatrix,l.globeMatrix);const c=[0,hl,0],h=[0,pl,0];return ds(c,c,s),ds(h,h,s),[c[0]>0&&c[0]<=l.width&&c[1]>0&&c[1]<=l.height&&!jp(l,new kr(l.center.lat,90)),h[0]>0&&h[0]<=l.width&&h[1]>0&&h[1]<=l.height&&!jp(l,new kr(l.center.lat,-90))]},g.polygonContainsPoint=ch,g.polygonIntersectsBox=tb,g.polygonIntersectsPolygon=Om,g.polygonizeBounds=function(l,s,c=0,h=!0){const m=new pi(c,c),b=l.sub(m),w=s.add(m),S=[b,new pi(w.x,b.y),w,new pi(b.x,w.y)];return h&&S.push(b.clone()),S},g.posAttributes=Pf,g.postMapLoadEvent=Tr,g.postPerformanceEvent=Ps,g.postTurnstileEvent=dr,g.potpack=Oy,g.prevPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},g.radToDeg=ia,g.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],g.registerForPluginStateChange=function(l){return l({pluginStatus:v,pluginURL:d}),C.on("pluginStateChange",l),l},g.removeAuthState=function(l){La.delete(l)},g.renderColorRamp=xy,g.resample=Id,g.rotateX=cy,g.rotateX$1=Ug,g.rotateY=th,g.rotateY$1=Vg,g.rotateZ=function(l,s,c){var h=Math.sin(c),m=Math.cos(c),b=s[0],w=s[1],S=s[2],D=s[3],k=s[4],N=s[5],V=s[6],G=s[7];return s!==l&&(l[8]=s[8],l[9]=s[9],l[10]=s[10],l[11]=s[11],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[0]=b*m+k*h,l[1]=w*m+N*h,l[2]=S*m+V*h,l[3]=D*m+G*h,l[4]=k*m-b*h,l[5]=N*m-w*h,l[6]=V*m-S*h,l[7]=G*m-D*h,l},g.rotateZ$1=function(l,s,c){c*=.5;var h=s[0],m=s[1],b=s[2],w=s[3],S=Math.sin(c),D=Math.cos(c);return l[0]=h*D+m*S,l[1]=m*D-h*S,l[2]=b*D+w*S,l[3]=w*D-b*S,l},g.scale=nd,g.scale$1=dy,g.scale$2=Nl,g.scaleAndAdd=Gp,g.set=function(l,s,c,h){return l[0]=s,l[1]=c,l[2]=h,l},g.setCacheLimits=function(l,s){zu=l,Wd=s},g.setColumn=function(l,s,c){l[4*s+0]=c[0],l[4*s+1]=c[1],l[4*s+2]=c[2],l[4*s+3]=c[3]},g.setRTLTextPlugin=function(l,s,c=!1){if(v===Fs||v===Am||v===ny)throw new Error("setRTLTextPlugin cannot be called multiple times.");d=vd.resolveURL(l),v=Fs,iu=s,x(),c||P()},g.smoothstep=Th,g.spec=yt,g.squaredLength=function(l){var s=l[0],c=l[1],h=l[2];return s*s+c*c+h*h},g.storeAuthState=function(l,s){s?La.add(l):La.delete(l)},g.sub=Dd,g.subtract=Gv,g.symbolSize=Rb,g.tileAABB=function(l,s,c,h,m,b,w,S,D){if("globe"===D.name)return function Z1(l,s,c){const h=s/l.worldSize,m=l.globeMatrix;if(c.z<=1){const nt=cu(c).getCorners();return Gg(nt,m,h),ul.fromPoints(nt)}const b=fy(c),w=Lf(b);Gg(w,m,h);const S=Number.MAX_VALUE,D=[-S,-S,-S],k=[S,S,S];if(b.contains(l.center)){for(const Yt of w)ih(k,k,Yt),Hp(D,D,Yt);D[2]=0;const nt=l.point,Et=[nt.x*h,nt.y*h,0];return ih(k,k,Et),Hp(D,D,Et),new ul(k,D)}const N=[m[12]*h,m[13]*h,m[14]*h],V=b.getCenter(),G=pr(l.center.lat,-Ga,Ga),q=pr(V.lat,-Ga,Ga),Y=uu(l.center.lng),Q=lh(G);let ae=Y-uu(V.lng);const ge=Q-lh(q);ae>.5?ae-=1:ae<-.5&&(ae+=1);let De=0;Math.abs(ae)>Math.abs(ge)?De=ae>=0?1:3:(De=ge>=0?0:2,Gp(N,N,[m[4]*h,m[5]*h,m[6]*h],-Math.sin(er(ge>=0?b.getSouth():b.getNorth()))*sh));const _e=w[De],Ae=w[(De+1)%4],Ie=new _x(_e,Ae,N),Le=[qv(Ie,0)||_e[0],qv(Ie,1)||_e[1],qv(Ie,2)||_e[2]],st=du(l.zoom);if(st>0){const nt=function({x:Yt,y:ct,z:Pt},Lt,Gt,ai,bt){const _i=1/(1<<Pt);let Ri=Yt*_i,bi=Ri+_i,$n=ct*_i,li=$n+_i,en=0;const fn=(Ri+bi)/2-ai;return fn>.5?en=-1:fn<-.5&&(en=1),Ri=((Ri+en)*Lt-(ai*=Lt))*Gt+ai,bi=((bi+en)*Lt-ai)*Gt+ai,$n=($n*Lt-(bt*=Lt))*Gt+bt,li=(li*Lt-bt)*Gt+bt,[[Ri,li,0],[bi,li,0],[bi,$n,0],[Ri,$n,0]]}(c,s,l._pixelsPerMercatorPixel,Y,Q);for(let Yt=0;Yt<w.length;Yt++)Fm(w[Yt],nt[Yt],st);const Et=su([],nt[De],nt[(De+1)%4]);Nl(Et,Et,.5),Fm(Le,Et,st)}for(const nt of w)ih(k,k,nt),Hp(D,D,nt);return k[2]=Math.min(_e[2],Ae[2]),ih(k,k,Le),Hp(D,D,Le),new ul(k,D)}(l,s,new Ul(c,h,m));const k=mu({z:c,x:h,y:m},D);return new ul([(b+k.x/k.scale)*s,s*(k.y/k.scale),w],[(b+k.x2/k.scale)*s,s*(k.y2/k.scale),S])},g.tileCornersToBounds=fy,g.tileTransform=mu,g.transformMat3=function(l,s,c){var h=s[0],m=s[1],b=s[2];return l[0]=h*c[0]+m*c[3]+b*c[6],l[1]=h*c[1]+m*c[4]+b*c[7],l[2]=h*c[2]+m*c[5]+b*c[8],l},g.transformMat4=ds,g.transformMat4$1=Kh,g.transformQuat=jv,g.transitionTileAABBinECEF=X1,g.translate=Zh,g.transpose=function(l,s){if(l===s){var c=s[1],h=s[2],m=s[5];l[1]=s[3],l[2]=s[6],l[3]=c,l[5]=s[7],l[6]=h,l[7]=m}else l[0]=s[0],l[1]=s[3],l[2]=s[6],l[3]=s[1],l[4]=s[4],l[5]=s[7],l[6]=s[2],l[7]=s[5],l[8]=s[8];return l},g.triggerPluginCompletionEvent=p,g.uniqueId=Fi,g.updateGlobeVertexNormal=function(l,s,c,h,m){const b=5*s+2;l.float32[b+0]=c,l.float32[b+1]=h,l.float32[b+2]=m},g.validateCustomStyleLayer=function(l){const s=[],c=l.id;return void 0===c&&s.push({message:`layers.${c}: missing required property "id"`}),void 0===l.render&&s.push({message:`layers.${c}: missing required method "render"`}),l.renderingMode&&"2d"!==l.renderingMode&&"3d"!==l.renderingMode&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},g.validateFilter=l=>ed(ca(l)),g.validateFog=l=>ed(Dr(l)),g.validateLayer=l=>ed(jh(l)),g.validateLight=l=>ed(Af(l)),g.validateSource=l=>ed(ue(l)),g.validateStyle=Wh,g.validateTerrain=l=>ed(nc(l)),g.values=Nu,g.vectorTile=e_,g.version=xs,g.warnOnce=_o,g.window=gt,g.wrap=Cn}),Oe(0,function(g){function gt(Te){if("number"==typeof Te||"boolean"==typeof Te||"string"==typeof Te||null==Te)return JSON.stringify(Te);if(Array.isArray(Te)){let re="[";for(const Me of Te)re+=`${gt(Me)},`;return`${re}]`}let ie="{";for(const re of Object.keys(Te).sort())ie+=`${re}:${gt(Te[re])},`;return`${ie}}`}function xs(Te){let ie="";for(const re of g.refProperties)ie+=`/${gt(Te[re])}`;return ie}class _c{constructor(ie){this.keyCache={},ie&&this.replace(ie)}replace(ie){this._layerConfigs={},this._layers={},this.update(ie,[])}update(ie,re){for(const Fe of ie)this._layerConfigs[Fe.id]=Fe,(this._layers[Fe.id]=g.createStyleLayer(Fe)).compileFilter(),this.keyCache[Fe.id]&&delete this.keyCache[Fe.id];for(const Fe of re)delete this.keyCache[Fe],delete this._layerConfigs[Fe],delete this._layers[Fe];this.familiesBySource={};const Me=function(Fe,He){const Ke={};for(let Ge=0;Ge<Fe.length;Ge++){const lt=He&&He[Fe[Ge].id]||xs(Fe[Ge]);He&&(He[Fe[Ge].id]=lt);let ri=Ke[lt];ri||(ri=Ke[lt]=[]),ri.push(Fe[Ge])}const Ze=[];for(const Ge in Ke)Ze.push(Ke[Ge]);return Ze}(g.values(this._layerConfigs),this.keyCache);for(const Fe of Me){const He=Fe.map(fi=>this._layers[fi.id]),Ke=He[0];if("none"===Ke.visibility)continue;const Ze=Ke.source||"";let Ge=this.familiesBySource[Ze];Ge||(Ge=this.familiesBySource[Ze]={});const lt=Ke.sourceLayer||"_geojsonTileLayer";let ri=Ge[lt];ri||(ri=Ge[lt]=[]),ri.push(He)}}}class Hn{loadTile(ie,re){const{uid:Me,encoding:Fe,rawImageData:He,padding:Ke,buildQuadTree:Ze}=ie,Ge=g.window.ImageBitmap&&He instanceof g.window.ImageBitmap?this.getImageData(He,Ke):He;re(null,new g.DEMData(Me,Ge,Fe,Ke<1,Ze))}getImageData(ie,re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);const Me=this.offscreenCanvasContext.getImageData(-re,-re,ie.width+2*re,ie.height+2*re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Me}}function jn(Te,ie){if(0!==Te.length){hs(Te[0],ie);for(var re=1;re<Te.length;re++)hs(Te[re],!ie)}}function hs(Te,ie){for(var re=0,Me=0,Fe=0,He=Te.length,Ke=He-1;Fe<He;Ke=Fe++){var Ze=(Te[Fe][0]-Te[Ke][0])*(Te[Ke][1]+Te[Fe][1]),Ge=re+Ze;Me+=Math.abs(re)>=Math.abs(Ze)?re-Ge+Ze:Ze-Ge+re,re=Ge}re+Me>=0!=!!ie&&Te.reverse()}var ps=g.getDefaultExportFromCjs(function Te(ie,re){var Me,Fe=ie&&ie.type;if("FeatureCollection"===Fe)for(Me=0;Me<ie.features.length;Me++)Te(ie.features[Me],re);else if("GeometryCollection"===Fe)for(Me=0;Me<ie.geometries.length;Me++)Te(ie.geometries[Me],re);else if("Feature"===Fe)Te(ie.geometry,re);else if("Polygon"===Fe)jn(ie.coordinates,re);else if("MultiPolygon"===Fe)for(Me=0;Me<ie.coordinates.length;Me++)jn(ie.coordinates[Me],re);return ie});const Yl=g.VectorTileFeature.prototype.toGeoJSON;var Cl={exports:{}},pd=g.pointGeometry,Gd=g.vectorTile.VectorTileFeature,Jo=ta;function ta(Te,ie){this.options=ie||{},this.features=Te,this.length=Te.length}function nl(Te,ie){this.id="number"==typeof Te.id?Te.id:void 0,this.type=Te.type,this.rawGeometry=1===Te.type?[Te.geometry]:Te.geometry,this.properties=Te.tags,this.extent=ie||4096}ta.prototype.feature=function(Te){return new nl(this.features[Te],this.options.extent)},nl.prototype.loadGeometry=function(){var Te=this.rawGeometry;this.geometry=[];for(var ie=0;ie<Te.length;ie++){for(var re=Te[ie],Me=[],Fe=0;Fe<re.length;Fe++)Me.push(new pd(re[Fe][0],re[Fe][1]));this.geometry.push(Me)}return this.geometry},nl.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Te=this.geometry,ie=1/0,re=-1/0,Me=1/0,Fe=-1/0,He=0;He<Te.length;He++)for(var Ke=Te[He],Ze=0;Ze<Ke.length;Ze++){var Ge=Ke[Ze];ie=Math.min(ie,Ge.x),re=Math.max(re,Ge.x),Me=Math.min(Me,Ge.y),Fe=Math.max(Fe,Ge.y)}return[ie,Me,re,Fe]},nl.prototype.toGeoJSON=Gd.prototype.toGeoJSON;var ka=g.pbf,Sl=Jo;function Rs(Te){var ie=new ka;return function(re,Me){for(var Fe in re.layers)Me.writeMessage(3,pi,re.layers[Fe])}(Te,ie),ie.finish()}function pi(Te,ie){var re;ie.writeVarintField(15,Te.version||1),ie.writeStringField(1,Te.name||""),ie.writeVarintField(5,Te.extent||4096);var Me={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<Te.length;re++)Me.feature=Te.feature(re),ie.writeMessage(2,Gc,Me);var Fe=Me.keys;for(re=0;re<Fe.length;re++)ie.writeStringField(3,Fe[re]);var He=Me.values;for(re=0;re<He.length;re++)ie.writeMessage(4,hm,He[re])}function Gc(Te,ie){var re=Te.feature;void 0!==re.id&&ie.writeVarintField(1,re.id),ie.writeMessage(2,jc,Te),ie.writeVarintField(3,re.type),ie.writeMessage(4,mf,re)}function jc(Te,ie){var re=Te.feature,Me=Te.keys,Fe=Te.values,He=Te.keycache,Ke=Te.valuecache;for(var Ze in re.properties){var Ge=re.properties[Ze],lt=He[Ze];if(null!==Ge){void 0===lt&&(Me.push(Ze),He[Ze]=lt=Me.length-1),ie.writeVarint(lt);var ri=typeof Ge;"string"!==ri&&"boolean"!==ri&&"number"!==ri&&(Ge=JSON.stringify(Ge));var fi=ri+":"+Ge,Kt=Ke[fi];void 0===Kt&&(Fe.push(Ge),Ke[fi]=Kt=Fe.length-1),ie.writeVarint(Kt)}}}function er(Te,ie){return(ie<<3)+(7&Te)}function ia(Te){return Te<<1^Te>>31}function mf(Te,ie){for(var re=Te.loadGeometry(),Me=Te.type,Fe=0,He=0,Ke=re.length,Ze=0;Ze<Ke;Ze++){var Ge=re[Ze],lt=1;1===Me&&(lt=Ge.length),ie.writeVarint(er(1,lt));for(var ri=3===Me?Ge.length-1:Ge.length,fi=0;fi<ri;fi++){1===fi&&1!==Me&&ie.writeVarint(er(2,ri-1));var Kt=Ge[fi].x-Fe,On=Ge[fi].y-He;ie.writeVarint(ia(Kt)),ie.writeVarint(ia(On)),Fe+=Kt,He+=On}3===Me&&ie.writeVarint(er(7,1))}}function hm(Te,ie){var re=typeof Te;"string"===re?ie.writeStringField(1,Te):"boolean"===re?ie.writeBooleanField(7,Te):"number"===re&&(Te%1!=0?ie.writeDoubleField(3,Te):Te<0?ie.writeSVarintField(6,Te):ie.writeVarintField(5,Te))}Cl.exports=Rs,Cl.exports.fromVectorTileJs=Rs,Cl.exports.fromGeojsonVt=function(Te,ie){ie=ie||{};var re={};for(var Me in Te)re[Me]=new Sl(Te[Me].features,ie),re[Me].name=Me,re[Me].version=ie.version,re[Me].extent=ie.extent;return Rs({layers:re})},Cl.exports.GeoJSONWrapper=Sl;var Sh=g.getDefaultExportFromCjs(Cl.exports);const yc={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Te=>Te},pr=Math.fround||(Th=new Float32Array(1),Te=>(Th[0]=+Te,Th[0]));var Th;const Cn=3,Bo=5,Nu=6;class Qo{constructor(ie){this.options=Object.assign(Object.create(yc),ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ie){const{log:re,minZoom:Me,maxZoom:Fe}=this.options;re&&console.time("total time");const He=`prepare ${ie.length} points`;re&&console.time(He),this.points=ie;const Ke=[];for(let Ge=0;Ge<ie.length;Ge++){const lt=ie[Ge];if(!lt.geometry)continue;const[ri,fi]=lt.geometry.coordinates,Kt=pr(jd(ri)),On=pr(ws(fi));Ke.push(Kt,On,1/0,Ge,-1,1),this.options.reduce&&Ke.push(0)}let Ze=this.trees[Fe+1]=this._createTree(Ke);re&&console.timeEnd(He);for(let Ge=Fe;Ge>=Me;Ge--){const lt=+Date.now();Ze=this.trees[Ge]=this._createTree(this._cluster(Ze,Ge)),re&&console.log("z%d: %d clusters in %dms",Ge,Ze.numItems,+Date.now()-lt)}return re&&console.timeEnd("total time"),this}getClusters(ie,re){let Me=((ie[0]+180)%360+360)%360-180;const Fe=Math.max(-90,Math.min(90,ie[1]));let He=180===ie[2]?180:((ie[2]+180)%360+360)%360-180;const Ke=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)Me=-180,He=180;else if(Me>He){const fi=this.getClusters([Me,Fe,180,Ke],re),Kt=this.getClusters([-180,Fe,He,Ke],re);return fi.concat(Kt)}const Ze=this.trees[this._limitZoom(re)],Ge=Ze.range(jd(Me),ws(Ke),jd(He),ws(Fe)),lt=Ze.data,ri=[];for(const fi of Ge){const Kt=this.stride*fi;ri.push(lt[Kt+Bo]>1?xa(lt,Kt,this.clusterProps):this.points[lt[Kt+Cn]])}return ri}getChildren(ie){const re=this._getOriginId(ie),Me=this._getOriginZoom(ie),Fe="No cluster with the specified id.",He=this.trees[Me];if(!He)throw new Error(Fe);const Ke=He.data;if(re*this.stride>=Ke.length)throw new Error(Fe);const Ze=this.options.radius/(this.options.extent*Math.pow(2,Me-1)),Ge=He.within(Ke[re*this.stride],Ke[re*this.stride+1],Ze),lt=[];for(const ri of Ge){const fi=ri*this.stride;Ke[fi+4]===ie&&lt.push(Ke[fi+Bo]>1?xa(Ke,fi,this.clusterProps):this.points[Ke[fi+Cn]])}if(0===lt.length)throw new Error(Fe);return lt}getLeaves(ie,re,Me){const Fe=[];return this._appendLeaves(Fe,ie,re=re||10,Me=Me||0,0),Fe}getTile(ie,re,Me){const Fe=this.trees[this._limitZoom(ie)],He=Math.pow(2,ie),{extent:Ke,radius:Ze}=this.options,Ge=Ze/Ke,lt=(Me-Ge)/He,ri=(Me+1+Ge)/He,fi={features:[]};return this._addTileFeatures(Fe.range((re-Ge)/He,lt,(re+1+Ge)/He,ri),Fe.data,re,Me,He,fi),0===re&&this._addTileFeatures(Fe.range(1-Ge/He,lt,1,ri),Fe.data,He,Me,He,fi),re===He-1&&this._addTileFeatures(Fe.range(0,lt,Ge/He,ri),Fe.data,-1,Me,He,fi),fi.features.length?fi:null}getClusterExpansionZoom(ie){let re=this._getOriginZoom(ie)-1;for(;re<=this.options.maxZoom;){const Me=this.getChildren(ie);if(re++,1!==Me.length)break;ie=Me[0].properties.cluster_id}return re}_appendLeaves(ie,re,Me,Fe,He){const Ke=this.getChildren(re);for(const Ze of Ke){const Ge=Ze.properties;if(Ge&&Ge.cluster?He+Ge.point_count<=Fe?He+=Ge.point_count:He=this._appendLeaves(ie,Ge.cluster_id,Me,Fe,He):He<Fe?He++:ie.push(Ze),ie.length===Me)break}return He}_createTree(ie){const re=new g.KDBush(ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Me=0;Me<ie.length;Me+=this.stride)re.add(ie[Me],ie[Me+1]);return re.finish(),re.data=ie,re}_addTileFeatures(ie,re,Me,Fe,He,Ke){for(const Ze of ie){const Ge=Ze*this.stride,lt=re[Ge+Bo]>1;let ri,fi,Kt;if(lt)ri=Fi(re,Ge,this.clusterProps),fi=re[Ge],Kt=re[Ge+1];else{const An=this.points[re[Ge+Cn]];ri=An.properties;const[tr,dr]=An.geometry.coordinates;fi=jd(tr),Kt=ws(dr)}const On={type:1,geometry:[[Math.round(this.options.extent*(fi*He-Me)),Math.round(this.options.extent*(Kt*He-Fe))]],tags:ri};let or;or=lt||this.options.generateId?re[Ge+Cn]:this.points[re[Ge+Cn]].id,void 0!==or&&(On.id=or),Ke.features.push(On)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,re){const{radius:Me,extent:Fe,reduce:He,minPoints:Ke}=this.options,Ze=Me/(Fe*Math.pow(2,re)),Ge=ie.data,lt=[],ri=this.stride;for(let fi=0;fi<Ge.length;fi+=ri){if(Ge[fi+2]<=re)continue;Ge[fi+2]=re;const Kt=Ge[fi],On=Ge[fi+1],or=ie.within(Ge[fi],Ge[fi+1],Ze),An=Ge[fi+Bo];let tr=An;for(const dr of or){const zo=dr*ri;Ge[zo+2]>re&&(tr+=Ge[zo+Bo])}if(tr>An&&tr>=Ke){let dr,zo=Kt*An,Tr=On*An,Pa=-1;const Ps=((fi/ri|0)<<5)+(re+1)+this.points.length;for(const gd of or){const na=gd*ri;if(Ge[na+2]<=re)continue;Ge[na+2]=re;const La=Ge[na+Bo];zo+=Ge[na]*La,Tr+=Ge[na+1]*La,Ge[na+4]=Ps,He&&(dr||(dr=this._map(Ge,fi,!0),Pa=this.clusterProps.length,this.clusterProps.push(dr)),He(dr,this._map(Ge,na)))}Ge[fi+4]=Ps,lt.push(zo/tr,Tr/tr,1/0,Ps,-1,tr),He&&lt.push(Pa)}else{for(let dr=0;dr<ri;dr++)lt.push(Ge[fi+dr]);if(tr>1)for(const dr of or){const zo=dr*ri;if(!(Ge[zo+2]<=re)){Ge[zo+2]=re;for(let Tr=0;Tr<ri;Tr++)lt.push(Ge[zo+Tr])}}}}return lt}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,re,Me){if(ie[re+Bo]>1){const Ke=this.clusterProps[ie[re+Nu]];return Me?Object.assign({},Ke):Ke}const Fe=this.points[ie[re+Cn]].properties,He=this.options.map(Fe);return Me&&He===Fe?Object.assign({},He):He}}function xa(Te,ie,re){return{type:"Feature",id:Te[ie+Cn],properties:Fi(Te,ie,re),geometry:{type:"Point",coordinates:[(Me=Te[ie],360*(Me-.5)),fd(Te[ie+1])]}};var Me}function Fi(Te,ie,re){const Me=Te[ie+Bo],Fe=Me>=1e4?`${Math.round(Me/1e3)}k`:Me>=1e3?Math.round(Me/100)/10+"k":Me,He=Te[ie+Nu],Ke=-1===He?{}:Object.assign({},re[He]);return Object.assign(Ke,{cluster:!0,cluster_id:Te[ie+Cn],point_count:Me,point_count_abbreviated:Fe})}function jd(Te){return Te/360+.5}function ws(Te){const ie=Math.sin(Te*Math.PI/180),re=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return re<0?0:re>1?1:re}function fd(Te){const ie=(180-360*Te)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function to(Te,ie,re,Me){for(var Fe,He=Me,Ke=re-ie>>1,Ze=re-ie,Ge=Te[ie],lt=Te[ie+1],ri=Te[re],fi=Te[re+1],Kt=ie+3;Kt<re;Kt+=3){var On=go(Te[Kt],Te[Kt+1],Ge,lt,ri,fi);if(On>He)Fe=Kt,He=On;else if(On===He){var or=Math.abs(Kt-Ke);or<Ze&&(Fe=Kt,Ze=or)}}He>Me&&(Fe-ie>3&&to(Te,ie,Fe,Me),Te[Fe+2]=He,re-Fe>3&&to(Te,Fe,re,Me))}function go(Te,ie,re,Me,Fe,He){var Ke=Fe-re,Ze=He-Me;if(0!==Ke||0!==Ze){var Ge=((Te-re)*Ke+(ie-Me)*Ze)/(Ke*Ke+Ze*Ze);Ge>1?(re=Fe,Me=He):Ge>0&&(re+=Ke*Ge,Me+=Ze*Ge)}return(Ke=Te-re)*Ke+(Ze=ie-Me)*Ze}function rr(Te,ie,re,Me){var Fe={id:void 0===Te?null:Te,type:ie,geometry:re,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(He){var Ke=He.geometry,Ze=He.type;if("Point"===Ze||"MultiPoint"===Ze||"LineString"===Ze)vn(He,Ke);else if("Polygon"===Ze||"MultiLineString"===Ze)for(var Ge=0;Ge<Ke.length;Ge++)vn(He,Ke[Ge]);else if("MultiPolygon"===Ze)for(Ge=0;Ge<Ke.length;Ge++)for(var lt=0;lt<Ke[Ge].length;lt++)vn(He,Ke[Ge][lt])}(Fe),Fe}function vn(Te,ie){for(var re=0;re<ie.length;re+=3)Te.minX=Math.min(Te.minX,ie[re]),Te.minY=Math.min(Te.minY,ie[re+1]),Te.maxX=Math.max(Te.maxX,ie[re]),Te.maxY=Math.max(Te.maxY,ie[re+1])}function rl(Te,ie,re,Me){if(ie.geometry){var Fe=ie.geometry.coordinates,He=ie.geometry.type,Ke=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2),Ze=[],Ge=ie.id;if(re.promoteId?Ge=ie.properties[re.promoteId]:re.generateId&&(Ge=Me||0),"Point"===He)Bu(Fe,Ze);else if("MultiPoint"===He)for(var lt=0;lt<Fe.length;lt++)Bu(Fe[lt],Ze);else if("LineString"===He)_o(Fe,Ze,Ke,!1);else if("MultiLineString"===He){if(re.lineMetrics){for(lt=0;lt<Fe.length;lt++)_o(Fe[lt],Ze=[],Ke,!1),Te.push(rr(Ge,"LineString",Ze,ie.properties));return}Kl(Fe,Ze,Ke,!1)}else if("Polygon"===He)Kl(Fe,Ze,Ke,!0);else{if("MultiPolygon"!==He){if("GeometryCollection"===He){for(lt=0;lt<ie.geometry.geometries.length;lt++)rl(Te,{id:Ge,geometry:ie.geometry.geometries[lt],properties:ie.properties},re,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(lt=0;lt<Fe.length;lt++){var ri=[];Kl(Fe[lt],ri,Ke,!0),Ze.push(ri)}}Te.push(rr(Ge,He,Ze,ie.properties))}}function Bu(Te,ie){ie.push(Tl(Te[0])),ie.push(Jl(Te[1])),ie.push(0)}function _o(Te,ie,re,Me){for(var Fe,He,Ke=0,Ze=0;Ze<Te.length;Ze++){var Ge=Tl(Te[Ze][0]),lt=Jl(Te[Ze][1]);ie.push(Ge),ie.push(lt),ie.push(0),Ze>0&&(Ke+=Me?(Fe*lt-Ge*He)/2:Math.sqrt(Math.pow(Ge-Fe,2)+Math.pow(lt-He,2))),Fe=Ge,He=lt}var ri=ie.length-3;ie[2]=1,to(ie,0,ri,re),ie[ri+2]=1,ie.size=Math.abs(Ke),ie.start=0,ie.end=ie.size}function Kl(Te,ie,re,Me){for(var Fe=0;Fe<Te.length;Fe++){var He=[];_o(Te[Fe],He,re,Me),ie.push(He)}}function Tl(Te){return Te/360+.5}function Jl(Te){var ie=Math.sin(Te*Math.PI/180),re=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return re<0?0:re>1?1:re}function vc(Te,ie,re,Me,Fe,He,Ke,Ze){if(Me/=ie,He>=(re/=ie)&&Ke<Me)return Te;if(Ke<re||He>=Me)return null;for(var Ge=[],lt=0;lt<Te.length;lt++){var ri=Te[lt],fi=ri.geometry,Kt=ri.type,On=0===Fe?ri.minX:ri.minY,or=0===Fe?ri.maxX:ri.maxY;if(On>=re&&or<Me)Ge.push(ri);else if(!(or<re||On>=Me)){var An=[];if("Point"===Kt||"MultiPoint"===Kt)bc(fi,An,re,Me,Fe);else if("LineString"===Kt)Ep(fi,An,re,Me,Fe,!1,Ze.lineMetrics);else if("MultiLineString"===Kt)xc(fi,An,re,Me,Fe,!1);else if("Polygon"===Kt)xc(fi,An,re,Me,Fe,!0);else if("MultiPolygon"===Kt)for(var tr=0;tr<fi.length;tr++){var dr=[];xc(fi[tr],dr,re,Me,Fe,!0),dr.length&&An.push(dr)}if(An.length){if(Ze.lineMetrics&&"LineString"===Kt){for(tr=0;tr<An.length;tr++)Ge.push(rr(ri.id,Kt,An[tr],ri.tags));continue}"LineString"!==Kt&&"MultiLineString"!==Kt||(1===An.length?(Kt="LineString",An=An[0]):Kt="MultiLineString"),"Point"!==Kt&&"MultiPoint"!==Kt||(Kt=3===An.length?"Point":"MultiPoint"),Ge.push(rr(ri.id,Kt,An,ri.tags))}}}return Ge.length?Ge:null}function bc(Te,ie,re,Me,Fe){for(var He=0;He<Te.length;He+=3){var Ke=Te[He+Fe];Ke>=re&&Ke<=Me&&(ie.push(Te[He]),ie.push(Te[He+1]),ie.push(Te[He+2]))}}function Ep(Te,ie,re,Me,Fe,He,Ke){for(var Ze,Ge,lt=pm(Te),ri=0===Fe?zu:Wd,fi=Te.start,Kt=0;Kt<Te.length-3;Kt+=3){var On=Te[Kt],or=Te[Kt+1],An=Te[Kt+2],tr=Te[Kt+3],dr=Te[Kt+4],zo=0===Fe?On:or,Tr=0===Fe?tr:dr,Pa=!1;Ke&&(Ze=Math.sqrt(Math.pow(On-tr,2)+Math.pow(or-dr,2))),zo<re?Tr>re&&(Ge=ri(lt,On,or,tr,dr,re),Ke&&(lt.start=fi+Ze*Ge)):zo>Me?Tr<Me&&(Ge=ri(lt,On,or,tr,dr,Me),Ke&&(lt.start=fi+Ze*Ge)):wa(lt,On,or,An),Tr<re&&zo>=re&&(Ge=ri(lt,On,or,tr,dr,re),Pa=!0),Tr>Me&&zo<=Me&&(Ge=ri(lt,On,or,tr,dr,Me),Pa=!0),!He&&Pa&&(Ke&&(lt.end=fi+Ze*Ge),ie.push(lt),lt=pm(Te)),Ke&&(fi+=Ze)}var Ps=Te.length-3;On=Te[Ps],or=Te[Ps+1],An=Te[Ps+2],(zo=0===Fe?On:or)>=re&&zo<=Me&&wa(lt,On,or,An),Ps=lt.length-3,He&&Ps>=3&&(lt[Ps]!==lt[0]||lt[Ps+1]!==lt[1])&&wa(lt,lt[0],lt[1],lt[2]),lt.length&&ie.push(lt)}function pm(Te){var ie=[];return ie.size=Te.size,ie.start=Te.start,ie.end=Te.end,ie}function xc(Te,ie,re,Me,Fe,He){for(var Ke=0;Ke<Te.length;Ke++)Ep(Te[Ke],ie,re,Me,Fe,He,!1)}function wa(Te,ie,re,Me){Te.push(ie),Te.push(re),Te.push(Me)}function zu(Te,ie,re,Me,Fe,He){var Ke=(He-ie)/(Me-ie);return Te.push(He),Te.push(re+(Fe-re)*Ke),Te.push(1),Ke}function Wd(Te,ie,re,Me,Fe,He){var Ke=(He-re)/(Fe-re);return Te.push(ie+(Me-ie)*Ke),Te.push(He),Te.push(1),Ke}function wc(Te,ie){for(var re=[],Me=0;Me<Te.length;Me++){var Fe,He=Te[Me],Ke=He.type;if("Point"===Ke||"MultiPoint"===Ke||"LineString"===Ke)Fe=Al(He.geometry,ie);else if("MultiLineString"===Ke||"Polygon"===Ke){Fe=[];for(var Ze=0;Ze<He.geometry.length;Ze++)Fe.push(Al(He.geometry[Ze],ie))}else if("MultiPolygon"===Ke)for(Fe=[],Ze=0;Ze<He.geometry.length;Ze++){for(var Ge=[],lt=0;lt<He.geometry[Ze].length;lt++)Ge.push(Al(He.geometry[Ze][lt],ie));Fe.push(Ge)}re.push(rr(He.id,Ke,Fe,He.tags))}return re}function Al(Te,ie){var re=[];re.size=Te.size,void 0!==Te.start&&(re.start=Te.start,re.end=Te.end);for(var Me=0;Me<Te.length;Me+=3)re.push(Te[Me]+ie,Te[Me+1],Te[Me+2]);return re}function Cp(Te,ie){if(Te.transformed)return Te;var re,Me,Fe,He=1<<Te.z,Ke=Te.x,Ze=Te.y;for(re=0;re<Te.features.length;re++){var Ge=Te.features[re],lt=Ge.geometry,ri=Ge.type;if(Ge.geometry=[],1===ri)for(Me=0;Me<lt.length;Me+=2)Ge.geometry.push(Wc(lt[Me],lt[Me+1],ie,He,Ke,Ze));else for(Me=0;Me<lt.length;Me++){var fi=[];for(Fe=0;Fe<lt[Me].length;Fe+=2)fi.push(Wc(lt[Me][Fe],lt[Me][Fe+1],ie,He,Ke,Ze));Ge.geometry.push(fi)}}return Te.transformed=!0,Te}function Wc(Te,ie,re,Me,Fe,He){return[Math.round(re*(Te*Me-Fe)),Math.round(re*(ie*Me-He))]}function $c(Te,ie,re,Me,Fe){for(var He=ie===Fe.maxZoom?0:Fe.tolerance/((1<<ie)*Fe.extent),Ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:re,y:Me,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ze=0;Ze<Te.length;Ze++){Ke.numFeatures++,Ah(Ke,Te[Ze],He,Fe);var Ge=Te[Ze].minX,lt=Te[Ze].minY,ri=Te[Ze].maxX,fi=Te[Ze].maxY;Ge<Ke.minX&&(Ke.minX=Ge),lt<Ke.minY&&(Ke.minY=lt),ri>Ke.maxX&&(Ke.maxX=ri),fi>Ke.maxY&&(Ke.maxY=fi)}return Ke}function Ah(Te,ie,re,Me){var Fe=ie.geometry,He=ie.type,Ke=[];if("Point"===He||"MultiPoint"===He)for(var Ze=0;Ze<Fe.length;Ze+=3)Ke.push(Fe[Ze]),Ke.push(Fe[Ze+1]),Te.numPoints++,Te.numSimplified++;else if("LineString"===He)Ra(Ke,Fe,Te,re,!1,!1);else if("MultiLineString"===He||"Polygon"===He)for(Ze=0;Ze<Fe.length;Ze++)Ra(Ke,Fe[Ze],Te,re,"Polygon"===He,0===Ze);else if("MultiPolygon"===He)for(var Ge=0;Ge<Fe.length;Ge++){var lt=Fe[Ge];for(Ze=0;Ze<lt.length;Ze++)Ra(Ke,lt[Ze],Te,re,!0,0===Ze)}if(Ke.length){var ri=ie.tags||null;if("LineString"===He&&Me.lineMetrics){for(var fi in ri={},ie.tags)ri[fi]=ie.tags[fi];ri.mapbox_clip_start=Fe.start/Fe.size,ri.mapbox_clip_end=Fe.end/Fe.size}var Kt={geometry:Ke,type:"Polygon"===He||"MultiPolygon"===He?3:"LineString"===He||"MultiLineString"===He?2:1,tags:ri};null!==ie.id&&(Kt.id=ie.id),Te.features.push(Kt)}}function Ra(Te,ie,re,Me,Fe,He){var Ke=Me*Me;if(Me>0&&ie.size<(Fe?Ke:Me))re.numPoints+=ie.length/3;else{for(var Ze=[],Ge=0;Ge<ie.length;Ge+=3)(0===Me||ie[Ge+2]>Ke)&&(re.numSimplified++,Ze.push(ie[Ge]),Ze.push(ie[Ge+1])),re.numPoints++;Fe&&function(lt,ri){for(var fi=0,Kt=0,On=lt.length,or=On-2;Kt<On;or=Kt,Kt+=2)fi+=(lt[Kt]-lt[or])*(lt[Kt+1]+lt[or+1]);if(fi>0===ri)for(Kt=0,On=lt.length;Kt<On/2;Kt+=2){var An=lt[Kt],tr=lt[Kt+1];lt[Kt]=lt[On-2-Kt],lt[Kt+1]=lt[On-1-Kt],lt[On-2-Kt]=An,lt[On-1-Kt]=tr}}(Ze,He),Te.push(Ze)}}function qc(Te,ie){var re=(ie=this.options=function(Fe,He){for(var Ke in He)Fe[Ke]=He[Ke];return Fe}(Object.create(this.options),ie)).debug;if(re&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");var Fe,He,Ke,Ze,Ge,lt,Me=function(Fe,He){var Ke=[];if("FeatureCollection"===Fe.type)for(var Ze=0;Ze<Fe.features.length;Ze++)rl(Ke,Fe.features[Ze],He,Ze);else rl(Ke,"Feature"===Fe.type?Fe:{geometry:Fe},He);return Ke}(Te,ie);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ze=Fe=Me,Ge=vc(Fe,1,-1-(Ke=(He=ie).buffer/He.extent),Ke,0,-1,2,He),lt=vc(Fe,1,1-Ke,2+Ke,0,-1,2,He),(Ge||lt)&&(Ze=vc(Fe,1,-Ke,1+Ke,0,-1,2,He)||[],Ge&&(Ze=wc(Ge,1).concat(Ze)),lt&&(Ze=Ze.concat(wc(lt,-1)))),(Me=Ze).length&&this.splitTile(Me,0,0,0),re&&(Me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $d(Te,ie,re){return 32*((1<<Te)*re+ie)+Te}function md(Te,ie){const re=Te.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);const Me=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!Me)return ie(null,null);const Fe=new class{constructor(Ke){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=g.EXTENT,this.length=Ke.length,this._features=Ke}feature(Ke){return new class{constructor(Ze){this._feature=Ze,this.extent=g.EXTENT,this.type=Ze.type,this.properties=Ze.tags,"id"in Ze&&!isNaN(Ze.id)&&(this.id=parseInt(Ze.id,10))}loadGeometry(){if(1===this._feature.type){const Ze=[];for(const Ge of this._feature.geometry)Ze.push([new g.Point(Ge[0],Ge[1])]);return Ze}{const Ze=[];for(const Ge of this._feature.geometry){const lt=[];for(const ri of Ge)lt.push(new g.Point(ri[0],ri[1]));Ze.push(lt)}return Ze}}toGeoJSON(Ze,Ge,lt){return Yl.call(this,Ze,Ge,lt)}}(this._features[Ke])}}(Me.features);let He=Sh(Fe);0===He.byteOffset&&He.byteLength===He.buffer.byteLength||(He=new Uint8Array(He)),ie(null,{vectorTile:Fe,rawData:He.buffer})}qc.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},qc.prototype.splitTile=function(Te,ie,re,Me,Fe,He,Ke){for(var Ze=[Te,ie,re,Me],Ge=this.options,lt=Ge.debug;Ze.length;){Me=Ze.pop(),re=Ze.pop(),ie=Ze.pop(),Te=Ze.pop();var ri=1<<ie,fi=$d(ie,re,Me),Kt=this.tiles[fi];if(!Kt&&(lt>1&&console.time("creation"),Kt=this.tiles[fi]=$c(Te,ie,re,Me,Ge),this.tileCoords.push({z:ie,x:re,y:Me}),lt)){lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,re,Me,Kt.numFeatures,Kt.numPoints,Kt.numSimplified),console.timeEnd("creation"));var On="z"+ie;this.stats[On]=(this.stats[On]||0)+1,this.total++}if(Kt.source=Te,Fe){if(ie===Ge.maxZoom||ie===Fe)continue;var or=1<<Fe-ie;if(re!==Math.floor(He/or)||Me!==Math.floor(Ke/or))continue}else if(ie===Ge.indexMaxZoom||Kt.numPoints<=Ge.indexMaxPoints)continue;if(Kt.source=null,0!==Te.length){lt>1&&console.time("clipping");var An,tr,dr,zo,Tr,Pa,Ps=.5*Ge.buffer/Ge.extent,gd=.5-Ps,na=.5+Ps,La=1+Ps;An=tr=dr=zo=null,Tr=vc(Te,ri,re-Ps,re+na,0,Kt.minX,Kt.maxX,Ge),Pa=vc(Te,ri,re+gd,re+La,0,Kt.minX,Kt.maxX,Ge),Te=null,Tr&&(An=vc(Tr,ri,Me-Ps,Me+na,1,Kt.minY,Kt.maxY,Ge),tr=vc(Tr,ri,Me+gd,Me+La,1,Kt.minY,Kt.maxY,Ge),Tr=null),Pa&&(dr=vc(Pa,ri,Me-Ps,Me+na,1,Kt.minY,Kt.maxY,Ge),zo=vc(Pa,ri,Me+gd,Me+La,1,Kt.minY,Kt.maxY,Ge),Pa=null),lt>1&&console.timeEnd("clipping"),Ze.push(An||[],ie+1,2*re,2*Me),Ze.push(tr||[],ie+1,2*re,2*Me+1),Ze.push(dr||[],ie+1,2*re+1,2*Me),Ze.push(zo||[],ie+1,2*re+1,2*Me+1)}}},qc.prototype.getTile=function(Te,ie,re){var Me=this.options,Fe=Me.extent,He=Me.debug;if(Te<0||Te>24)return null;var Ke=1<<Te,Ze=$d(Te,ie=(ie%Ke+Ke)%Ke,re);if(this.tiles[Ze])return Cp(this.tiles[Ze],Fe);He>1&&console.log("drilling down to z%d-%d-%d",Te,ie,re);for(var Ge,lt=Te,ri=ie,fi=re;!Ge&&lt>0;)lt--,ri=Math.floor(ri/2),fi=Math.floor(fi/2),Ge=this.tiles[$d(lt,ri,fi)];return Ge&&Ge.source?(He>1&&console.log("found parent tile z%d-%d-%d",lt,ri,fi),He>1&&console.time("drilling down"),this.splitTile(Ge.source,lt,ri,fi,Te,ie,re),He>1&&console.timeEnd("drilling down"),this.tiles[Ze]?Cp(this.tiles[Ze],Fe):null):null};class Uu extends g.VectorTileWorkerSource{constructor(ie,re,Me,Fe,He){super(ie,re,Me,Fe,md),He&&(this.loadGeoJSON=He)}loadData(ie,re){const Me=ie&&ie.request,Fe=Me&&Me.collectResourceTiming;this.loadGeoJSON(ie,(He,Ke)=>{if(He||!Ke)return re(He);if("object"!=typeof Ke)return re(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{ps(Ke,!0);try{if(ie.filter){const Ge=g.createExpression(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ge.result)throw new Error(Ge.value.map(ri=>`${ri.key}: ${ri.message}`).join(", "));Ke={type:"FeatureCollection",features:Ke.features.filter(ri=>Ge.value.evaluate({zoom:0},ri))}}this._geoJSONIndex=ie.cluster?new Qo(function({superclusterOptions:Ge,clusterProperties:lt}){if(!lt||!Ge)return Ge;const ri={},fi={},Kt={accumulated:null,zoom:0},On={properties:null},or=Object.keys(lt);for(const An of or){const[tr,dr]=lt[An],zo=g.createExpression(dr),Tr=g.createExpression("string"==typeof tr?[tr,["accumulated"],["get",An]]:tr);ri[An]=zo.value,fi[An]=Tr.value}return Ge.map=An=>{On.properties=An;const tr={};for(const dr of or)tr[dr]=ri[dr].evaluate(Kt,On);return tr},Ge.reduce=(An,tr)=>{On.properties=tr;for(const dr of or)Kt.accumulated=An[dr],An[dr]=fi[dr].evaluate(Kt,On)},Ge}(ie)).load(Ke.features):new qc(Ge=Ke,ie.geojsonVtOptions)}catch(Ge){return re(Ge)}this.loaded={};const Ze={};if(Fe){const Ge=g.getPerformanceMeasurement(Me);Ge&&(Ze.resourceTiming={},Ze.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Ge)))}re(null,Ze)}var Ge})}reloadTile(ie,re){const Me=this.loaded;return Me&&Me[ie.uid]?super.reloadTile(ie,re):this.loadTile(ie,re)}loadGeoJSON(ie,re){if(ie.request)g.getJSON(ie.request,re);else{if("string"!=typeof ie.data)return re(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));try{return re(null,JSON.parse(ie.data))}catch{return re(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ie,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(Me){re(Me)}}getClusterChildren(ie,re){try{re(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(Me){re(Me)}}getClusterLeaves(ie,re){try{re(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(Me){re(Me)}}}class Sp{constructor(ie){this.self=ie,this.actor=new g.Actor(ie,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=g.getProjection({name:"mercator"}),this.workerSourceTypes={vector:g.VectorTileWorkerSource,geojson:Uu},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,Me)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=Me},this.self.registerRTLTextPlugin=re=>{if(g.plugin.isParsed())throw new Error("RTL text plugin already registered.");g.plugin.applyArabicShaping=re.applyArabicShaping,g.plugin.processBidirectionalText=re.processBidirectionalText,g.plugin.processStyledBidirectionalText=re.processStyledBidirectionalText}}clearCaches(ie,re,Me){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],delete this.demWorkerSources[ie],Me()}checkIfReady(ie,re,Me){Me()}setReferrer(ie,re){this.referrer=re}spriteLoaded(ie,re){this.isSpriteLoaded[ie]=re;for(const Me in this.workerSources[ie]){const Fe=this.workerSources[ie][Me];for(const He in Fe)Fe[He]instanceof g.VectorTileWorkerSource&&(Fe[He].isSpriteLoaded=re,Fe[He].fire(new g.Event("isSpriteLoaded")))}}setImages(ie,re,Me){this.availableImages[ie]=re;for(const Fe in this.workerSources[ie]){const He=this.workerSources[ie][Fe];for(const Ke in He)He[Ke].availableImages=re}Me()}enableTerrain(ie,re,Me){this.terrain=re,Me()}setProjection(ie,re){this.projections[ie]=g.getProjection(re)}setLayers(ie,re,Me){this.getLayerIndex(ie).replace(re),Me()}updateLayers(ie,re,Me){this.getLayerIndex(ie).update(re.layers,re.removedIds),Me()}loadTile(ie,re,Me){const Fe=this.enableTerrain?g.extend({enableTerrain:this.terrain},re):re;Fe.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,re.type,re.source).loadTile(Fe,Me)}loadDEMTile(ie,re,Me){const Fe=this.enableTerrain?g.extend({buildQuadTree:this.terrain},re):re;this.getDEMWorkerSource(ie,re.source).loadTile(Fe,Me)}reloadTile(ie,re,Me){const Fe=this.enableTerrain?g.extend({enableTerrain:this.terrain},re):re;Fe.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,re.type,re.source).reloadTile(Fe,Me)}abortTile(ie,re,Me){this.getWorkerSource(ie,re.type,re.source).abortTile(re,Me)}removeTile(ie,re,Me){this.getWorkerSource(ie,re.type,re.source).removeTile(re,Me)}removeSource(ie,re,Me){if(!this.workerSources[ie]||!this.workerSources[ie][re.type]||!this.workerSources[ie][re.type][re.source])return;const Fe=this.workerSources[ie][re.type][re.source];delete this.workerSources[ie][re.type][re.source],void 0!==Fe.removeSource?Fe.removeSource(re,Me):Me()}loadWorkerSource(ie,re,Me){try{this.self.importScripts(re.url),Me()}catch(Fe){Me(Fe.toString())}}syncRTLPluginState(ie,re,Me){try{g.plugin.setState(re);const Fe=g.plugin.getPluginURL();if(g.plugin.isLoaded()&&!g.plugin.isParsed()&&null!=Fe){this.self.importScripts(Fe);const He=g.plugin.isParsed();Me(He?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Fe}`),He)}}catch(Fe){Me(Fe.toString())}}getAvailableImages(ie){let re=this.availableImages[ie];return re||(re=[]),re}getLayerIndex(ie){let re=this.layerIndexes[ie];return re||(re=this.layerIndexes[ie]=new _c),re}getWorkerSource(ie,re,Me){return this.workerSources[ie]||(this.workerSources[ie]={}),this.workerSources[ie][re]||(this.workerSources[ie][re]={}),this.workerSources[ie][re][Me]||(this.workerSources[ie][re][Me]=new this.workerSourceTypes[re]({send:(He,Ke,Ze,Ge,lt,ri)=>{this.actor.send(He,Ke,Ze,ie,lt,ri)},scheduler:this.actor.scheduler},this.getLayerIndex(ie),this.getAvailableImages(ie),this.isSpriteLoaded[ie])),this.workerSources[ie][re][Me]}getDEMWorkerSource(ie,re){return this.demWorkerSources[ie]||(this.demWorkerSources[ie]={}),this.demWorkerSources[ie][re]||(this.demWorkerSources[ie][re]=new Hn),this.demWorkerSources[ie][re]}enforceCacheSizeLimit(ie,re){g.enforceCacheSizeLimit(re)}getWorkerPerformanceMetrics(ie,re,Me){Me(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Sp(self)),Sp}),Oe(0,function(g){function gt(v,d){if(Array.isArray(v)){if(!Array.isArray(d)||v.length!==d.length)return!1;for(let p=0;p<v.length;p++)if(!gt(v[p],d[p]))return!1;return!0}if("object"==typeof v&&null!==v&&null!==d){if("object"!=typeof d||Object.keys(v).length!==Object.keys(d).length)return!1;for(const p in v)if(!gt(v[p],d[p]))return!1;return!0}return v===d}var xs=_c;function _c(v){return d=v,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,C,T=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(T);try{C=new Worker(P),x=!0}catch{x=!1}return C&&C.terminate(),URL.revokeObjectURL(P),x}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var x=document.createElement("canvas");x.width=x.height=1;var C=x.getContext("2d");if(!C)return!1;var T=C.getImageData(0,0,1,1);return T&&T.width===x.width}()||(void 0===Hn[p=d&&d.failIfMajorPerformanceCaveat]&&(Hn[p]=function(x){var C,P,F,z,T=(P=x,F=document.createElement("canvas"),(z=Object.create(_c.webGLContextAttributes)).failIfMajorPerformanceCaveat=P,F.getContext("webgl",z)||F.getContext("experimental-webgl",z));if(!T)return!1;try{C=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!C||T.isContextLost())&&(T.shaderSource(C,"void main() {}"),T.compileShader(C),!0===T.getShaderParameter(C,T.COMPILE_STATUS))}(p)),!Hn[p]||document.documentMode));var d,p}var Hn={};function jn(v,d,p){const x=g.window.document.createElement(v);return void 0!==d&&(x.className=d),p&&p.appendChild(x),x}function hs(v,d,p){const x=g.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const C of Object.keys(d))x.setAttributeNS(null,C,d[C]);return p&&p.appendChild(x),x}_c.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ps=g.window.document&&g.window.document.documentElement.style,Yl=ps&&void 0!==ps.userSelect?"userSelect":"WebkitUserSelect";let Cl;function pd(){ps&&Yl&&(Cl=ps[Yl],ps[Yl]="none")}function Gd(){ps&&Yl&&(ps[Yl]=Cl)}function Jo(v){v.preventDefault(),v.stopPropagation(),g.window.removeEventListener("click",Jo,!0)}function ta(){g.window.addEventListener("click",Jo,!0),g.window.setTimeout(()=>{g.window.removeEventListener("click",Jo,!0)},0)}function nl(v,d){const p=v.getBoundingClientRect();return Rs(v,p,d)}function ka(v,d){const p=v.getBoundingClientRect(),x=[];for(let C=0;C<d.length;C++)x.push(Rs(v,p,d[C]));return x}function Sl(v){return void 0!==g.window.InstallTrigger&&2===v.button&&v.ctrlKey&&g.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function Rs(v,d,p){const x=v.offsetWidth===d.width?1:v.offsetWidth/d.width;return new g.Point((p.clientX-d.left)*x,(p.clientY-d.top)*x)}function pi(v,d){var p=d[0],x=d[1],C=d[2],T=d[3],P=p*T-C*x;return P?(v[0]=T*(P=1/P),v[1]=-x*P,v[2]=-C*P,v[3]=p*P,v):null}function Gc(v){const{userImage:d}=v;return!!(d&&d.render&&d.render())&&(v.data.replace(new Uint8Array(d.data.buffer)),!0)}class jc extends g.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new g.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(d){if(this.loaded!==d&&(this.loaded=d,d)){for(const{ids:p,callback:x}of this.requestors)this._notify(p,x);this.requestors=[]}}hasImage(d){return!!this.getImage(d)}getImage(d){return this.images[d]}addImage(d,p){this._validate(d,p)&&(this.images[d]=p)}_validate(d,p){let x=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new g.ErrorEvent(new Error(`Image "${d}" has invalid "stretchX" value`))),x=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new g.ErrorEvent(new Error(`Image "${d}" has invalid "stretchY" value`))),x=!1),this._validateContent(p.content,p)||(this.fire(new g.ErrorEvent(new Error(`Image "${d}" has invalid "content" value`))),x=!1),x}_validateStretch(d,p){if(!d)return!0;let x=0;for(const C of d){if(C[0]<x||C[1]<C[0]||p<C[1])return!1;x=C[1]}return!0}_validateContent(d,p){return!(d&&(4!==d.length||d[0]<0||p.data.width<d[0]||d[1]<0||p.data.height<d[1]||d[2]<0||p.data.width<d[2]||d[3]<0||p.data.height<d[3]||d[2]<d[0]||d[3]<d[1]))}updateImage(d,p){p.version=this.images[d].version+1,this.images[d]=p,this.updatedImages[d]=!0}removeImage(d){const p=this.images[d];delete this.images[d],delete this.patterns[d],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(d,p){let x=!0;if(!this.isLoaded())for(const C of d)this.images[C]||(x=!1);this.isLoaded()||x?this._notify(d,p):this.requestors.push({ids:d,callback:p})}_notify(d,p){const x={};for(const C of d){this.images[C]||this.fire(new g.Event("styleimagemissing",{id:C}));const T=this.images[C];T?x[C]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:!(!T.userImage||!T.userImage.render)}:g.warnOnce(`Image "${C}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,x)}getPixelSize(){const{width:d,height:p}=this.atlasImage;return{width:d,height:p}}getPattern(d){const p=this.patterns[d],x=this.getImage(d);if(!x)return null;if(p&&p.position.version===x.version)return p.position;if(p)p.position.version=x.version;else{const C={w:x.data.width+2,h:x.data.height+2,x:0,y:0},T=new g.ImagePosition(C,x);this.patterns[d]={bin:C,position:T}}return this._updatePatternAtlas(),this.patterns[d].position}bind(d){const p=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new g.Texture(d,this.atlasImage,p.RGBA),this.atlasTexture&&this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const d=[];for(const T in this.patterns)d.push(this.patterns[T].bin);const{w:p,h:x}=g.potpack(d),C=this.atlasImage;C.resize({width:p||1,height:x||1});for(const T in this.patterns){const{bin:P}=this.patterns[T],F=P.x+1,z=P.y+1,j=this.images[T].data,W=j.width,K=j.height;g.RGBAImage.copy(j,C,{x:0,y:0},{x:F,y:z},{width:W,height:K}),g.RGBAImage.copy(j,C,{x:0,y:K-1},{x:F,y:z-1},{width:W,height:1}),g.RGBAImage.copy(j,C,{x:0,y:0},{x:F,y:z+K},{width:W,height:1}),g.RGBAImage.copy(j,C,{x:W-1,y:0},{x:F-1,y:z},{width:1,height:K}),g.RGBAImage.copy(j,C,{x:0,y:0},{x:F+W,y:z},{width:1,height:K})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(d){for(const p of d){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const x=this.images[p];Gc(x)&&this.updateImage(p,x)}}}const er=new g.Properties({anchor:new g.DataConstantProperty(g.spec.light.anchor),position:new class{constructor(){this.specification=g.spec.light.position}possiblyEvaluate(v,d){return function([p,x,C]){const T=g.degToRad(x+90),P=g.degToRad(C);return{x:p*Math.cos(T)*Math.sin(P),y:p*Math.sin(T)*Math.sin(P),z:p*Math.cos(P),azimuthal:x,polar:C}}(v.expression.evaluate(d))}interpolate(v,d,p){return{x:g.number(v.x,d.x,p),y:g.number(v.y,d.y,p),z:g.number(v.z,d.z,p),azimuthal:g.number(v.azimuthal,d.azimuthal,p),polar:g.number(v.polar,d.polar,p)}}},color:new g.DataConstantProperty(g.spec.light.color),intensity:new g.DataConstantProperty(g.spec.light.intensity)});class ia extends g.Evented{constructor(d){super(),this._transitionable=new g.Transitionable(er),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(d,p={}){if(!this._validate(g.validateLight,d,p))for(const x in d){const C=d[x];g.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),C):this._transitionable.setValue(x,C)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,p,x){return(!x||!1!==x.validate)&&g.emitValidationErrors(this,d.call(g.validateStyle,g.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:g.spec})))}}const mf=new g.Properties({source:new g.DataConstantProperty(g.spec.terrain.source),exaggeration:new g.DataConstantProperty(g.spec.terrain.exaggeration)});let hm=class extends g.Evented{constructor(v,d){super(),this._transitionable=new g.Transitionable(mf),this.set(v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(v){for(const d in v){const p=v[d];g.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-11),p):this._transitionable.setValue(d,p)}}updateTransitions(v){this._transitioning=this._transitionable.transitioned(v,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(v){this.properties=this._transitioning.possiblyEvaluate(v)}};function Sh(v,d,p,x){const C=g.smoothstep(45,65,p),[T,P]=yc(v,x),F=g.length(d);let z=1-Math.min(1,Math.exp((F-T)/(P-T)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*C*v.alpha}function yc(v,d){const p=.5/Math.tan(.5*d);return[v.range[0]+p,v.range[1]+p]}const pr=new g.Properties({range:new g.DataConstantProperty(g.spec.fog.range),color:new g.DataConstantProperty(g.spec.fog.color),"high-color":new g.DataConstantProperty(g.spec.fog["high-color"]),"space-color":new g.DataConstantProperty(g.spec.fog["space-color"]),"horizon-blend":new g.DataConstantProperty(g.spec.fog["horizon-blend"]),"star-intensity":new g.DataConstantProperty(g.spec.fog["star-intensity"])});class Th extends g.Evented{constructor(d,p){super(),this._transitionable=new g.Transitionable(pr),this.set(d),this._transitioning=this._transitionable.untransitioned(),this._transform=p}get state(){const d=this._transform,p="globe"===d.projection.name,x=g.globeToMercatorTransition(d.zoom),C=this.properties.get("range"),T=[.5,3];return{range:p?[g.number(T[0],C[0],x),g.number(T[1],C[1],x)]:C,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(d,p={}){if(!this._validate(g.validateFog,d,p)){for(const x of Object.keys(g.spec.fog))d&&void 0===d[x]&&(d[x]=g.spec.fog[x].default);for(const x in d){const C=d[x];g.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),C):this._transitionable.setValue(x,C)}}}getOpacity(d){if(!this._transform.projection.supportsFog)return 0;const p=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:g.smoothstep(45,65,d))*p.a}getOpacityAtLatLng(d,p){return this._transform.projection.supportsFog?function(x,C,T){const P=g.MercatorCoordinate.fromLngLat(C),F=T.elevation?T.elevation.getAtPointOrZero(P):0,z=[P.x,P.y,F];return g.transformMat4(z,z,T.mercatorFogMatrix),Sh(x,z,T.pitch,T._fov)}(this.state,d,p):0}getFovAdjustedRange(d){return this._transform.projection.supportsFog?yc(this.state,d):[0,1]}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,p,x){return(!x||!1!==x.validate)&&g.emitValidationErrors(this,d.call(g.validateStyle,g.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:g.spec})))}}class Cn{constructor(d,p){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=g.uniqueId();const x=this.workerPool.acquire(this.id);for(let C=0;C<x.length;C++){const T=new Cn.Actor(x[C],p,this.id);T.name=`Worker ${C}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(d,p,x){g.asyncAll(this.actors,(C,T)=>{C.send(d,p,T)},x=x||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(d=>{d.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Bo(v,d,p){return d*(g.EXTENT/(v.tileSize*Math.pow(2,p-v.tileID.overscaledZ)))}Cn.Actor=g.Actor;class Nu{constructor(d,p,x,C){this.screenBounds=d,this.cameraPoint=p,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,C)}static createFromScreenPoints(d,p){let x,C;if(d instanceof g.Point||"number"==typeof d[0]){const T=g.Point.convert(d);x=[T],C=p.isPointAboveHorizon(T)}else{const T=g.Point.convert(d[0]),P=g.Point.convert(d[1]);x=[T,P],C=g.polygonizeBounds(T,P).every(F=>p.isPointAboveHorizon(F))}return new Nu(x,p.getCameraPoint(),C,p)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(d){return g.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],d)}bufferedCameraGeometry(d){const p=this.screenBounds[0],x=1===this.screenBounds.length?this.screenBounds[0].add(new g.Point(1,1)):this.screenBounds[1],C=g.polygonizeBounds(p,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>p.x&&this.cameraPoint.x<x.x?C.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?C[2]=this.cameraPoint:this.cameraPoint.x<=p.x&&(C[3]=this.cameraPoint)),g.bufferConvexPolygon(C,d)}bufferedCameraGeometryGlobe(d){const p=this.screenBounds[0],x=1===this.screenBounds.length?this.screenBounds[0].add(new g.Point(1,1)):this.screenBounds[1],C=g.polygonizeBounds(p,x,d),T=this.cameraPoint.clone();switch(3*((T.y>p.y)+(T.y>x.y))+((T.x>p.x)+(T.x>x.x))){case 0:C[0]=T,C[4]=T.clone();break;case 1:C.splice(1,0,T);break;case 2:C[1]=T;break;case 3:C.splice(4,0,T);break;case 5:C.splice(2,0,T);break;case 6:C[3]=T;break;case 7:C.splice(3,0,T);break;case 8:C[2]=T}return C}containsTile(d,p,x,C=0){const T=d.queryPadding/p._pixelsPerMercatorPixel+1,P=x?this._bufferedCameraMercator(T,p):this._bufferedScreenMercator(T,p);let F=d.tileID.wrap+(P.unwrapped?C:0);const z=P.polygon.map(me=>g.getTilePoint(d.tileTransform,me,F));if(!g.polygonIntersectsBox(z,0,0,g.EXTENT,g.EXTENT))return;F=d.tileID.wrap+(this.screenGeometryMercator.unwrapped?C:0);const j=this.screenGeometryMercator.polygon.map(me=>g.getTileVec3(d.tileTransform,me,F)),W=j.map(me=>new g.Point(me[0],me[1])),K=p.getFreeCameraOptions().position||new g.MercatorCoordinate(0,0,0),ne=g.getTileVec3(d.tileTransform,K,F),he=j.map(me=>{const J=g.sub(me,me,ne);return g.normalize(J,J),new g.Ray(ne,J)}),pe=Bo(d,1,p.zoom)*p._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:W,tilespaceRays:he,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(le=g.getBounds(z),le.min.x=g.clamp(le.min.x,0,g.EXTENT),le.min.y=g.clamp(le.min.y,0,g.EXTENT),le.max.x=g.clamp(le.max.x,0,g.EXTENT),le.max.y=g.clamp(le.max.y,0,g.EXTENT),le),tile:d,tileID:d.tileID,pixelToTileUnitsFactor:pe};var le}_bufferedScreenMercator(d,p){const x=Fi(d);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let C;return C="globe"===p.projection.name?this._projectAndResample(this.bufferedScreenGeometry(d),p):{polygon:this.bufferedScreenGeometry(d).map(T=>p.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[x]=C,C}}_bufferedCameraMercator(d,p){const x=Fi(d);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let C;return C="globe"===p.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(d),p):{polygon:this.bufferedCameraGeometry(d).map(T=>p.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[x]=C,C}}_projectAndResample(d,p){const x=function(T,P){const F=g.multiply([],P.pixelMatrix,P.globeMatrix),z=[0,-g.GLOBE_RADIUS,0,1],j=[0,g.GLOBE_RADIUS,0,1],W=[0,0,0,1];g.transformMat4$1(z,z,F),g.transformMat4$1(j,j,F),g.transformMat4$1(W,W,F);const K=new g.Point(z[0]/z[3],z[1]/z[3]),ne=new g.Point(j[0]/j[3],j[1]/j[3]),he=g.polygonContainsPoint(T,K)&&z[3]<W[3],pe=g.polygonContainsPoint(T,ne)&&j[3]<W[3];if(!he&&!pe)return null;const le=function(ke,We,$e){for(let Ye=1;Ye<ke.length;Ye++){const St=xa(We.pointCoordinate3D(ke[Ye-1]).x),Je=xa(We.pointCoordinate3D(ke[Ye]).x);if($e<0){if(St<Je)return{idx:Ye,t:-St/(Je-1-St)}}else if(Je<St)return{idx:Ye,t:(1-St)/(Je+1-St)}}return null}(T,P,he?-1:1);if(!le)return null;const{idx:me,t:J}=le;let de=me>1?Qo(T.slice(0,me),P):[],be=me<T.length?Qo(T.slice(me),P):[];de=de.map(ke=>new g.Point(xa(ke.x),ke.y)),be=be.map(ke=>new g.Point(xa(ke.x),ke.y));const xe=[...de];0===xe.length&&xe.push(be[be.length-1]);const Ne=g.number(xe[xe.length-1].y,(0===be.length?de[0]:be[0]).y,J);let Be;return Be=he?[new g.Point(0,Ne),new g.Point(0,0),new g.Point(1,0),new g.Point(1,Ne)]:[new g.Point(1,Ne),new g.Point(1,1),new g.Point(0,1),new g.Point(0,Ne)],xe.push(...Be),0===be.length?xe.push(de[0]):xe.push(...be),{polygon:xe.map(ke=>new g.MercatorCoordinate(ke.x,ke.y)),unwrapped:!1}}(d,p);if(x)return x;const C=function(T,P){let F=!1,z=-1/0,j=0;for(let K=0;K<T.length-1;K++)T[K].x>z&&(z=T[K].x,j=K);for(let K=0;K<T.length-1;K++){const ne=(j+K)%(T.length-1),he=T[ne],pe=T[ne+1];Math.abs(he.x-pe.x)>.5&&(he.x<pe.x?(he.x+=1,0===ne&&(T[T.length-1].x+=1)):(pe.x+=1,ne+1===T.length-1&&(T[0].x+=1)),F=!0)}const W=g.mercatorXfromLng(P.center.lng);return F&&W<Math.abs(W-1)&&T.forEach(K=>{K.x-=1}),{polygon:T,unwrapped:F}}(Qo(d,p).map(T=>new g.Point(xa(T.x),T.y)),p);return{polygon:C.polygon.map(T=>new g.MercatorCoordinate(T.x,T.y)),unwrapped:C.unwrapped}}}function Qo(v,d){return g.resample(v,p=>{const x=d.pointCoordinate3D(p);p.x=x.x,p.y=x.y},1/256)}function xa(v){return v<0?1+v%1:v%1}function Fi(v){return 100*v|0}function jd(v,d,p,x,C){const T=function(P,F){if(P)return C(P);if(F){v.url&&F.tiles&&v.tiles&&delete v.tiles;const z=g.pick(g.extend(F,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);F.vector_layers&&(z.vectorLayers=F.vector_layers,z.vectorLayerIds=z.vectorLayers.map(j=>j.id)),z.tiles=d.canonicalizeTileset(z,v.url),C(null,z)}};return v.url?g.getJSON(d.transformRequest(d.normalizeSourceURL(v.url,null,p,x),g.ResourceType.Source),T):g.exported.frame(()=>T(null,v))}class ws{constructor(d,p,x){this.bounds=g.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=p||0,this.maxzoom=x||24}validateBounds(d){return Array.isArray(d)&&4===d.length?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]}contains(d){const p=Math.pow(2,d.z),x=Math.floor(g.mercatorXfromLng(this.bounds.getWest())*p),C=Math.floor(g.mercatorYfromLat(this.bounds.getNorth())*p),T=Math.ceil(g.mercatorXfromLng(this.bounds.getEast())*p),P=Math.ceil(g.mercatorYfromLat(this.bounds.getSouth())*p);return d.x>=x&&d.x<T&&d.y>=C&&d.y<P}}class fd{constructor(d,p,x){this.context=d;const C=d.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(d){const p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const to={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class go{constructor(d,p,x,C){this.length=p.length,this.attributes=x,this.itemSize=p.bytesPerElement,this.dynamicDraw=C,this.context=d;const T=d.gl;this.buffer=T.createBuffer(),d.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(d){const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,d.arrayBuffer)}enableAttributes(d,p){for(let x=0;x<this.attributes.length;x++){const C=p.attributes[this.attributes[x].name];void 0!==C&&d.enableVertexAttribArray(C)}}setVertexAttribPointers(d,p,x){for(let C=0;C<this.attributes.length;C++){const T=this.attributes[C],P=p.attributes[T.name];void 0!==P&&d.vertexAttribPointer(P,T.components,d[to[T.type]],!1,this.itemSize,T.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class rr{constructor(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(d){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class vn extends rr{getDefault(){return g.Color.transparent}set(d){const p=this.current;(d.r!==p.r||d.g!==p.g||d.b!==p.b||d.a!==p.a||this.dirty)&&(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class rl extends rr{getDefault(){return 1}set(d){(d!==this.current||this.dirty)&&(this.gl.clearDepth(d),this.current=d,this.dirty=!1)}}class Bu extends rr{getDefault(){return 0}set(d){(d!==this.current||this.dirty)&&(this.gl.clearStencil(d),this.current=d,this.dirty=!1)}}class _o extends rr{getDefault(){return[!0,!0,!0,!0]}set(d){const p=this.current;(d[0]!==p[0]||d[1]!==p[1]||d[2]!==p[2]||d[3]!==p[3]||this.dirty)&&(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class Kl extends rr{getDefault(){return!0}set(d){(d!==this.current||this.dirty)&&(this.gl.depthMask(d),this.current=d,this.dirty=!1)}}class Tl extends rr{getDefault(){return 255}set(d){(d!==this.current||this.dirty)&&(this.gl.stencilMask(d),this.current=d,this.dirty=!1)}}class Jl extends rr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(d){const p=this.current;(d.func!==p.func||d.ref!==p.ref||d.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)}}class vc extends rr{getDefault(){const d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]}set(d){const p=this.current;(d[0]!==p[0]||d[1]!==p[1]||d[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)}}class bc extends rr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;d?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=d,this.dirty=!1}}class Ep extends rr{getDefault(){return[0,1]}set(d){const p=this.current;(d[0]!==p[0]||d[1]!==p[1]||this.dirty)&&(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)}}class pm extends rr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;d?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=d,this.dirty=!1}}class xc extends rr{getDefault(){return this.gl.LESS}set(d){(d!==this.current||this.dirty)&&(this.gl.depthFunc(d),this.current=d,this.dirty=!1)}}class wa extends rr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;d?p.enable(p.BLEND):p.disable(p.BLEND),this.current=d,this.dirty=!1}}class zu extends rr{getDefault(){const d=this.gl;return[d.ONE,d.ZERO]}set(d){const p=this.current;(d[0]!==p[0]||d[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)}}class Wd extends rr{getDefault(){return g.Color.transparent}set(d){const p=this.current;(d.r!==p.r||d.g!==p.g||d.b!==p.b||d.a!==p.a||this.dirty)&&(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class wc extends rr{getDefault(){return this.gl.FUNC_ADD}set(d){(d!==this.current||this.dirty)&&(this.gl.blendEquation(d),this.current=d,this.dirty=!1)}}class Al extends rr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;d?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=d,this.dirty=!1}}class Cp extends rr{getDefault(){return this.gl.BACK}set(d){(d!==this.current||this.dirty)&&(this.gl.cullFace(d),this.current=d,this.dirty=!1)}}class Wc extends rr{getDefault(){return this.gl.CCW}set(d){(d!==this.current||this.dirty)&&(this.gl.frontFace(d),this.current=d,this.dirty=!1)}}let $c,Ah=class extends rr{getDefault(){return null}set(v){(v!==this.current||this.dirty)&&(this.gl.useProgram(v),this.current=v,this.dirty=!1)}};class Ra extends rr{getDefault(){return this.gl.TEXTURE0}set(d){(d!==this.current||this.dirty)&&(this.gl.activeTexture(d),this.current=d,this.dirty=!1)}}class qc extends rr{getDefault(){const d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]}set(d){const p=this.current;(d[0]!==p[0]||d[1]!==p[1]||d[2]!==p[2]||d[3]!==p[3]||this.dirty)&&(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class $d extends rr{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,d),this.current=d,this.dirty=!1}}class md extends rr{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class Uu extends rr{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,d),this.current=d,this.dirty=!1}}class Sp extends rr{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class Te extends rr{getDefault(){return null}set(d){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class ie extends rr{constructor(d){super(d),this.vao=d.extVertexArrayObject}getDefault(){return null}set(d){this.vao&&(d!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(d),this.current=d,this.dirty=!1)}}class re extends rr{getDefault(){return 4}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1}}class Me extends rr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1}}class Fe extends rr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1}}class He extends rr{constructor(d,p){super(d),this.context=d,this.parent=p}getDefault(){return null}}class Ke extends He{setDirty(){this.dirty=!0}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,d,0),this.current=d,this.dirty=!1}}class Ze extends He{attachment(){return this.gl.DEPTH_ATTACHMENT}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,this.attachment(),p.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class Ge extends Ze{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class lt{constructor(d,p,x,C){this.context=d,this.width=p,this.height=x;const T=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new Ke(d,T),C&&(this.depthAttachment=new Ze(d,T))}destroy(){const d=this.context.gl,p=this.colorAttachment.get();if(p&&d.deleteTexture(p),this.depthAttachment){const x=this.depthAttachment.get();x&&d.deleteRenderbuffer(x)}d.deleteFramebuffer(this.framebuffer)}}class ri{constructor(d,p=!1){if(this.gl=d,this.isWebGL2=p,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),p){const x=d;this.extVertexArrayObject={createVertexArrayOES:x.createVertexArray.bind(d),deleteVertexArrayOES:x.deleteVertexArray.bind(d),bindVertexArrayOES:x.bindVertexArray.bind(d)}}this.clearColor=new vn(this),this.clearDepth=new rl(this),this.clearStencil=new Bu(this),this.colorMask=new _o(this),this.depthMask=new Kl(this),this.stencilMask=new Tl(this),this.stencilFunc=new Jl(this),this.stencilOp=new vc(this),this.stencilTest=new bc(this),this.depthRange=new Ep(this),this.depthTest=new pm(this),this.depthFunc=new xc(this),this.blend=new wa(this),this.blendFunc=new zu(this),this.blendColor=new Wd(this),this.blendEquation=new wc(this),this.cullFace=new Al(this),this.cullFaceSide=new Cp(this),this.frontFace=new Wc(this),this.program=new Ah(this),this.activeTexture=new Ra(this),this.viewport=new qc(this),this.bindFramebuffer=new $d(this),this.bindRenderbuffer=new md(this),this.bindTexture=new Uu(this),this.bindVertexBuffer=new Sp(this),this.bindElementBuffer=new Te(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ie(this),this.pixelStoreUnpack=new re(this),this.pixelStoreUnpackPremultiplyAlpha=new Me(this),this.pixelStoreUnpackFlipY=new Fe(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=d.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=d.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=d.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),p||(this.extTextureHalfFloat=d.getExtension("OES_texture_half_float")),(p||this.extTextureHalfFloat&&d.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=p||d.getExtension("OES_standard_derivatives"),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(d,p){return new fd(this,d,p)}createVertexBuffer(d,p,x){return new go(this,d,p,x)}createRenderbuffer(d,p,x){const C=this.gl,T=C.createRenderbuffer();return this.bindRenderbuffer.set(T),C.renderbufferStorage(C.RENDERBUFFER,d,p,x),this.bindRenderbuffer.set(null),T}createFramebuffer(d,p,x){return new lt(this,d,p,x)}clear({color:d,depth:p,stencil:x}){const C=this.gl;let T=0;d&&(T|=C.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),void 0!==p&&(T|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),void 0!==x&&(T|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),C.clear(T)}setCullFace(d){!1===d.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))}setDepthMode(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)}setStencilMode(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)}setColorMode(d){gt(d.blendFunction,g.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class fi extends g.Evented{constructor(d,p,x,C){if(super(),this.id=d,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,g.extend(this,g.pick(p,["url","scheme","tileSize","promoteId"])),this._options=g.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C),this._tileWorkers={},this._deduped=new g.DedupedRequest}load(d){this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"}));const p=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=jd(this._options,this.map._requestManager,p,x,(C,T)=>{this._tileJSONRequest=null,this._loaded=!0,C?(p&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${p}`),x&&2!==x.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new g.ErrorEvent(C))):T&&(g.extend(this,T),T.bounds&&(this.tileBounds=new ws(T.bounds,this.minzoom,this.maxzoom)),g.postTurnstileEvent(T.tiles,this.map._requestManager._customAccessToken),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(C)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return g.extend({},this._options)}loadTile(d,p){const x=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),C={request:this.map._requestManager.transformRequest(x,g.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:g.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(C.request.collectResourceTiming=this._collectResourceTiming,d.actor&&"expired"!==d.state)"loading"===d.state?d.reloadCallback=p:d.request=d.actor.send("reloadTile",C,T.bind(this));else if(d.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",C,T.bind(this),void 0,!0);else{const P=g.loadVectorTile.call({deduped:this._deduped},C,(F,z)=>{F||!z?T.call(this,F):(C.data={cacheControl:z.cacheControl,expires:z.expires,rawData:z.rawData.slice(0)},d.actor&&d.actor.send("loadTile",C,T.bind(this),void 0,!0))},!0);d.request={cancel:P}}function T(P,F){return delete d.request,d.aborted?p(null):P&&404!==P.status?p(P):(F&&F.resourceTiming&&(d.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&F&&d.setExpiryData(F),d.loadVectorData(F,this.map.painter),g.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Kt extends g.Evented{constructor(d,p,x,C){super(),this.id=d,this.dispatcher=x,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=g.extend({type:"raster"},p),g.extend(this,g.pick(p,["url","scheme","tileSize"]))}load(d){this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=jd(this._options,this.map._requestManager,null,null,(p,x)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new g.ErrorEvent(p)):x&&(g.extend(this,x),x.bounds&&(this.tileBounds=new ws(x.bounds,this.minzoom,this.maxzoom)),g.postTurnstileEvent(x.tiles),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(p)})}loaded(){return this._loaded}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return g.extend({},this._options)}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,p){const x=g.exported.devicePixelRatio>=2,C=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);d.request=g.getImage(this.map._requestManager.transformRequest(C,g.ResourceType.Tile),(T,P,F,z)=>(delete d.request,d.aborted?(d.state="unloaded",p(null)):T?(d.state="errored",p(T)):P?(this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:F,expires:z}),d.setTexture(P,this.map.painter),d.state="loaded",g.cacheEntryPossiblyAdded(this.dispatcher),void p(null)):p(null)))}static loadTileData(d,p,x){d.setTexture(p,x)}static unloadTileData(d,p){d.texture&&p.saveTileTexture(d.texture)}abortTile(d,p){d.request&&(d.request.cancel(),delete d.request),p()}unloadTile(d,p){d.texture&&this.map.painter.saveTileTexture(d.texture),p()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function On(v,d,p,x,C,T,P,F){const z=[v,p,C,d,x,T,1,1,1],j=[P,F,1],W=g.adjoint([],z),[K,ne,he]=g.transformMat3(j,j,g.transpose(W,W));return g.multiply$1(z,[K,0,0,0,ne,0,0,0,he],z)}class or extends g.Evented{constructor(d,p,x,C){super(),this.id=d,this.dispatcher=x,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=p,this._dirty=!1}load(d,p){this._loaded=p||!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=g.getImage(this.map._requestManager.transformRequest(this.url,g.ResourceType.Image),(x,C)=>{if(this._imageRequest=null,this._loaded=!0,x)this.fire(new g.ErrorEvent(x));else if(C){const{HTMLImageElement:T}=g.window;this.image=C instanceof T?g.exported.getImageData(C):C,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,d&&(this.coordinates=d),this._finishLoading()}})}loaded(){return this._loaded}updateImage(d){return this.image&&d.url?(this._imageRequest&&d.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=d.url,this.load(d.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(d){this.map=d,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(d){this.coordinates=d,this._boundsArray=void 0;const p=d.map(g.MercatorCoordinate.fromLngLat);return this.tileID=function(x){let C=1/0,T=1/0,P=-1/0,F=-1/0;for(const K of x)C=Math.min(C,K.x),T=Math.min(T,K.y),P=Math.max(P,K.x),F=Math.max(F,K.y);const z=Math.max(P-C,F-T),j=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),W=Math.pow(2,j);return new g.CanonicalTileID(j,Math.floor((C+P)/2*W),Math.floor((T+F)/2*W))}(p),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(d){for(const z in this.tiles){const j=this.tiles[z];"loaded"!==j.state&&(j.state="loaded",j.texture=this.texture)}if(this._boundsArray)return;const p=g.tileTransform(this.tileID,this.map.transform.projection),[x,C,T,P]=this.coordinates.map(z=>{const j=p.projection.project(z[0],z[1]);return g.getTilePoint(p,j)._round()});this.perspectiveTransform=function(z,j,W,K,ne,he,pe,le,me,J){const de=On(0,0,z,0,0,j,z,j),be=On(W,K,ne,he,pe,le,me,J);return g.multiply$1(be,g.adjoint(de,de),be),[be[6]/be[8]*z/g.EXTENT,be[7]/be[8]*j/g.EXTENT]}(this.width,this.height,x.x,x.y,C.x,C.y,P.x,P.y,T.x,T.y);const F=this._boundsArray=new g.StructArrayLayout4i8;F.emplaceBack(x.x,x.y,0,0),F.emplaceBack(C.x,C.y,g.EXTENT,0),F.emplaceBack(P.x,P.y,0,g.EXTENT),F.emplaceBack(T.x,T.y,g.EXTENT,g.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=d.createVertexBuffer(F,g.boundsAttributes.members),this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const d=this.map.painter.context,p=d.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new g.Texture(d,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(d)}loadTile(d,p){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d,d.buckets={},p(null)):(d.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const An={vector:fi,raster:Kt,"raster-dem":class extends Kt{constructor(v,d,p,x){super(v,d,p,x),this.type="raster-dem",this.maxzoom=22,this._options=g.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}loadTile(v,d){const p=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(C,T){C&&(v.state="errored",d(C)),T&&(v.dem=T,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",d(null))}v.request=g.getImage(this.map._requestManager.transformRequest(p,g.ResourceType.Tile),function(C,T,P,F){if(delete v.request,v.aborted)v.state="unloaded",d(null);else if(C)v.state="errored",d(C);else if(T){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:P,expires:F});const z=g.window.ImageBitmap&&T instanceof g.window.ImageBitmap&&(null==$c&&($c=g.window.OffscreenCanvas&&new g.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof g.window.createImageBitmap),$c),j=1-(T.width-g.prevPowerOfTwo(T.width))/2;j<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const W=z?T:g.exported.getImageData(T,j),K={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:W,encoding:this.encoding,padding:j};v.actor&&"expired"!==v.state||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",K,x.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(v){const d=v.canonical,p=Math.pow(2,d.z),x=(d.x-1+p)%p,C=0===d.x?v.wrap-1:v.wrap,T=(d.x+1+p)%p,P=d.x+1===p?v.wrap+1:v.wrap,F={};return F[new g.OverscaledTileID(v.overscaledZ,C,d.z,x,d.y).key]={backfilled:!1},F[new g.OverscaledTileID(v.overscaledZ,P,d.z,T,d.y).key]={backfilled:!1},d.y>0&&(F[new g.OverscaledTileID(v.overscaledZ,C,d.z,x,d.y-1).key]={backfilled:!1},F[new g.OverscaledTileID(v.overscaledZ,v.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},F[new g.OverscaledTileID(v.overscaledZ,P,d.z,T,d.y-1).key]={backfilled:!1}),d.y+1<p&&(F[new g.OverscaledTileID(v.overscaledZ,C,d.z,x,d.y+1).key]={backfilled:!1},F[new g.OverscaledTileID(v.overscaledZ,v.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},F[new g.OverscaledTileID(v.overscaledZ,P,d.z,T,d.y+1).key]={backfilled:!1}),F}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends g.Evented{constructor(v,d,p,x){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=p.getActor(),this.setEventedParent(x),this._data=d.data,this._options=g.extend({},d),this._collectResourceTiming=d.collectResourceTiming,void 0!==d.maxzoom&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const C=g.EXTENT/this.tileSize;this.workerOptions=g.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(void 0!==d.buffer?d.buffer:128)*C,tolerance:(void 0!==d.tolerance?d.tolerance:.375)*C,extent:g.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:void 0!==d.clusterMaxZoom?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:g.EXTENT,radius:(void 0!==d.clusterRadius?d.clusterRadius:50)*C,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},d),this}getClusterChildren(v,d){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},d),this}getClusterLeaves(v,d,p,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:d,offset:p},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new g.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=g.extend({},this.workerOptions),d=this._data;"string"==typeof d?(v.request=this.map._requestManager.transformRequest(g.exported.resolveURL(d),g.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(p,x)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new g.ErrorEvent(p));else{const C={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(C.resourceTiming=x.resourceTiming[this.id]),this.fire(new g.Event("data",C)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,d){const p=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(p,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:g.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(x,C)=>(delete v.request,v.unloadVectorData(),v.aborted?d(null):x?d(x):(v.loadVectorData(C,this.map.painter,"reloadTile"===p),d(null))),void 0,"loadTile"===p)}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return g.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends or{constructor(v,d,p,x){super(v,d,p,x),this.roundZoom=!0,this.type="video",this.options=d}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const d of v.urls)this.urls.push(this.map._requestManager.transformRequest(d,g.ResourceType.Source).url);g.getVideo(this.urls,(d,p)=>{this._loaded=!0,d?this.fire(new g.ErrorEvent(d)):p&&(this.video=p,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const d=this.video.seekable;v<d.start(0)||v>d.end(0)?this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const v=this.map.painter.context,d=v.gl;this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new g.Texture(v,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:or,canvas:class extends or{constructor(v,d,p,x){super(v,d,p,x),d.coordinates?Array.isArray(d.coordinates)&&4===d.coordinates.length&&!d.coordinates.some(C=>!Array.isArray(C)||2!==C.length||C.some(T=>"number"!=typeof T))||this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),d.animate&&"boolean"!=typeof d.animate&&this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),d.canvas?"string"==typeof d.canvas||d.canvas instanceof g.window.HTMLCanvasElement||this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=d,this.animate=void 0===d.animate||d.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof g.window.HTMLCanvasElement?this.options.canvas:g.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new g.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const d=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new g.Texture(d,this.canvas,d.gl.RGBA,{premultiply:!0}),this._prepareData(d)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends g.Evented{constructor(v,d,p,x){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=p,this._implementation=d,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new g.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new g.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ws(this._implementation.bounds,this.minzoom,this.maxzoom)),d.update=this._update.bind(this),d.clearTiles=this._clearTiles.bind(this),d.coveringTiles=this._coveringTiles.bind(this),g.extend(this,g.pick(d,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return g.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:d,y:p,z:x}=v.canonical;return this._implementation.hasTile({x:d,y:p,z:x})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,d){const{x:p,y:x,z:C}=v.tileID.canonical,T=new g.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:p,y:x,z:C},{signal:T.signal})).then(function(P){return delete v.request,v.aborted?(v.state="unloaded",d(null)):void 0===P?(v.state="errored",d(null)):null===P?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",d(null)):(F=P)instanceof g.window.ImageData||F instanceof g.window.HTMLCanvasElement||F instanceof g.window.ImageBitmap||F instanceof g.window.HTMLImageElement?(this.loadTileData(v,P),v.state="loaded",void d(null)):(v.state="errored",d(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var F}.bind(this)).catch(P=>{20!==P.code&&(v.state="errored",d(P))}),v.request.cancel=()=>T.abort()}loadTileData(v,d){Kt.loadTileData(v,d,this._map.painter)}unloadTileData(v){Kt.unloadTileData(v,this._map.painter)}unloadTile(v,d){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:p,y:x,z:C}=v.tileID.canonical;this._implementation.unloadTile({x:p,y:x,z:C})}d()}abortTile(v,d){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),d()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"}))}}},tr=function(v,d,p,x){const C=new An[d.type](v,d,p,x);if(C.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${C.id}`);return g.bindAll(["load","abort","unload","serialize","prepare"],C),C};function dr(v,d){const p=g.identity([]);return g.scale(p,p,[.5*v.width,.5*-v.height,1]),g.translate(p,p,[1,-1,0]),g.multiply(p,p,v.calculateProjMatrix(d.toUnwrapped())),Float32Array.from(p)}function zo(v,d,p,x,C,T,P,F=!1){const z=v.tilesIn(x,P,F);z.sort(Pa);const j=[];for(const K of z)j.push({wrappedTileID:K.tile.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(d,p,v._state,K,C,T,dr(v.transform,K.tile.tileID),F)});const W=function(K){const ne={},he={};for(const pe of K){const le=pe.queryResults,me=pe.wrappedTileID,J=he[me]=he[me]||{};for(const de in le){const be=le[de],xe=J[de]=J[de]||{},Ne=ne[de]=ne[de]||[];for(const Be of be)xe[Be.featureIndex]||(xe[Be.featureIndex]=!0,Ne.push(Be))}}return ne}(j);for(const K in W)W[K].forEach(ne=>{const he=ne.feature,pe=he.layer;pe&&"background"!==pe.type&&"sky"!==pe.type&&(he.source=pe.source,pe["source-layer"]&&(he.sourceLayer=pe["source-layer"]),he.state=void 0!==he.id?v.getFeatureState(pe["source-layer"],he.id):{})});return W}function Tr(v,d){const p=v.getRenderableIds().map(T=>v.getTileByID(T)),x=[],C={};for(let T=0;T<p.length;T++){const P=p[T],F=P.tileID.canonical.key;C[F]||(C[F]=!0,P.querySourceFeatures(x,d))}return x}function Pa(v,d){const p=v.tileID,x=d.tileID;return p.overscaledZ-x.overscaledZ||p.canonical.y-x.canonical.y||p.wrap-x.wrap||p.canonical.x-x.canonical.x}function Ps(){return null!=iu.workerClass?new iu.workerClass:new g.window.Worker(iu.workerUrl)}const gd="mapboxgl_preloaded_worker_pool";class na{constructor(){this.active={}}acquire(d){if(!this.workers)for(this.workers=[];this.workers.length<na.workerCount;)this.workers.push(new Ps);return this.active[d]=!0,this.workers.slice()}release(d){delete this.active[d],0===this.numActive()&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[gd]}numActive(){return Object.keys(this.active).length}}let La;function Tp(){return La||(La=new na),La}function q_(v,d){const p={};for(const x in v)"ref"!==x&&(p[x]=v[x]);return g.refProperties.forEach(x=>{x in d&&(p[x]=d[x])}),p}function _d(v){v=v.slice();const d=Object.create(null);for(let p=0;p<v.length;p++)d[v[p].id]=v[p];for(let p=0;p<v.length;p++)"ref"in v[p]&&(v[p]=q_(v[p],d[v[p].ref]));return v}na.workerCount=2;const Gr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ms(v,d,p){p.push({command:Gr.addSource,args:[v,d[v]]})}function yd(v,d,p){d.push({command:Gr.removeSource,args:[v]}),p[v]=!0}function Ql(v,d,p,x){yd(v,p,x),Ms(v,d,p)}function xg(v,d,p){let x;for(x in v[p])if(v[p].hasOwnProperty(x)&&"data"!==x&&!gt(v[p][x],d[p][x]))return!1;for(x in d[p])if(d[p].hasOwnProperty(x)&&"data"!==x&&!gt(v[p][x],d[p][x]))return!1;return!0}function ec(v,d,p,x,C,T){let P;for(P in d=d||{},v=v||{})v.hasOwnProperty(P)&&(gt(v[P],d[P])||p.push({command:T,args:[x,P,d[P],C]}));for(P in d)d.hasOwnProperty(P)&&!v.hasOwnProperty(P)&&(gt(v[P],d[P])||p.push({command:T,args:[x,P,d[P],C]}))}function vd(v){return v.id}function Vu(v,d){return v[d.id]=d,v}class fm{constructor(d,p){this.reset(d,p)}reset(d,p){this.points=d||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(d){if(1===this.points.length)return this.points[0];d=g.clamp(d,0,1);let p=1,x=this._distances[p];const C=d*this.paddedLength+this.padding;for(;x<C&&p<this._distances.length;)x=this._distances[++p];const T=p-1,P=this._distances[T],F=x-P,z=F>0?(C-P)/F:0;return this.points[T].mult(1-z).add(this.points[p].mult(z))}}class Xc{constructor(d,p,x){const C=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(d/x),this.yCellCount=Math.ceil(p/x);for(let P=0;P<this.xCellCount*this.yCellCount;P++)C.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=p,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(d,p,x,C,T){this._forEachCell(p,x,C,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(p),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(T)}insertCircle(d,p,x,C){this._forEachCell(p-C,x-C,p+C,x+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(p),this.circles.push(x),this.circles.push(C)}_insertBoxCell(d,p,x,C,T,P){this.boxCells[T].push(P)}_insertCircleCell(d,p,x,C,T,P){this.circleCells[T].push(P)}_query(d,p,x,C,T,P){if(x<0||d>this.width||C<0||p>this.height)return!T&&[];const F=[];if(d<=0&&p<=0&&this.width<=x&&this.height<=C){if(T)return!0;for(let z=0;z<this.boxKeys.length;z++)F.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const j=this.circles[3*z],W=this.circles[3*z+1],K=this.circles[3*z+2];F.push({key:this.circleKeys[z],x1:j-K,y1:W-K,x2:j+K,y2:W+K})}return P?F.filter(P):F}return this._forEachCell(d,p,x,C,this._queryCell,F,{hitTest:T,seenUids:{box:{},circle:{}}},P),T?F.length>0:F}_queryCircle(d,p,x,C,T){const P=d-x,F=d+x,z=p-x,j=p+x;if(F<0||P>this.width||j<0||z>this.height)return!C&&[];const W=[];return this._forEachCell(P,z,F,j,this._queryCellCircle,W,{hitTest:C,circle:{x:d,y:p,radius:x},seenUids:{box:{},circle:{}}},T),C?W.length>0:W}query(d,p,x,C,T){return this._query(d,p,x,C,!1,T)}hitTest(d,p,x,C,T){return this._query(d,p,x,C,!0,T)}hitTestCircle(d,p,x,C){return this._queryCircle(d,p,x,!0,C)}_queryCell(d,p,x,C,T,P,F,z){const j=F.seenUids,W=this.boxCells[T];if(null!==W){const ne=this.bboxes;for(const he of W)if(!j.box[he]){j.box[he]=!0;const pe=4*he;if(d<=ne[pe+2]&&p<=ne[pe+3]&&x>=ne[pe+0]&&C>=ne[pe+1]&&(!z||z(this.boxKeys[he]))){if(F.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[he],x1:ne[pe],y1:ne[pe+1],x2:ne[pe+2],y2:ne[pe+3]})}}}const K=this.circleCells[T];if(null!==K){const ne=this.circles;for(const he of K)if(!j.circle[he]){j.circle[he]=!0;const pe=3*he;if(this._circleAndRectCollide(ne[pe],ne[pe+1],ne[pe+2],d,p,x,C)&&(!z||z(this.circleKeys[he]))){if(F.hitTest)return P.push(!0),!0;{const le=ne[pe],me=ne[pe+1],J=ne[pe+2];P.push({key:this.circleKeys[he],x1:le-J,y1:me-J,x2:le+J,y2:me+J})}}}}}_queryCellCircle(d,p,x,C,T,P,F,z){const j=F.circle,W=F.seenUids,K=this.boxCells[T];if(null!==K){const he=this.bboxes;for(const pe of K)if(!W.box[pe]){W.box[pe]=!0;const le=4*pe;if(this._circleAndRectCollide(j.x,j.y,j.radius,he[le+0],he[le+1],he[le+2],he[le+3])&&(!z||z(this.boxKeys[pe])))return P.push(!0),!0}}const ne=this.circleCells[T];if(null!==ne){const he=this.circles;for(const pe of ne)if(!W.circle[pe]){W.circle[pe]=!0;const le=3*pe;if(this._circlesCollide(he[le],he[le+1],he[le+2],j.x,j.y,j.radius)&&(!z||z(this.circleKeys[pe])))return P.push(!0),!0}}}_forEachCell(d,p,x,C,T,P,F,z){const j=this._convertToXCellCoord(d),W=this._convertToYCellCoord(p),K=this._convertToXCellCoord(x),ne=this._convertToYCellCoord(C);for(let he=j;he<=K;he++)for(let pe=W;pe<=ne;pe++)if(T.call(this,d,p,x,C,this.xCellCount*pe+he,P,F,z))return}_convertToXCellCoord(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))}_convertToYCellCoord(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))}_circlesCollide(d,p,x,C,T,P){const F=C-d,z=T-p,j=x+P;return j*j>F*F+z*z}_circleAndRectCollide(d,p,x,C,T,P,F){const z=(P-C)/2,j=Math.abs(d-(C+z));if(j>z+x)return!1;const W=(F-T)/2,K=Math.abs(p-(T+W));if(K>W+x)return!1;if(j<=z||K<=W)return!0;const ne=j-z,he=K-W;return ne*ne+he*he<=x*x}}const qd={unknown:0,flipRequired:1,flipNotRequired:2},Dh=Math.tan(85*Math.PI/180);function yt(v,d,p,x,C,T,P){const F=g.create();if(p)if("globe"===T.name){const z=g.calculateGlobeLabelMatrix(C,d);g.multiply(F,F,z)}else{const z=pi([],P);F[0]=z[0],F[1]=z[1],F[4]=z[2],F[5]=z[3],x||g.rotateZ(F,F,C.angle)}else g.multiply(F,C.labelPlaneMatrix,v);return F}function bd(v,d,p,x,C,T,P){const F=yt(v,d,p,x,C,T,P);return"globe"===T.name&&p||(F[2]=F[6]=F[10]=F[14]=0),F}function Es(v,d,p,x,C,T,P){if(p){if("globe"===T.name){const F=yt(v,d,p,x,C,T,P);return g.invert(F,F),g.multiply(F,v,F),F}{const F=g.clone(v),z=g.identity([]);return z[0]=P[0],z[1]=P[1],z[4]=P[2],z[5]=P[3],g.multiply(F,F,z),x||g.rotateZ(F,F,-C.angle),F}}return C.glCoordMatrix}function ra(v,d,p,x){const C=[v,d,p,1];p?g.transformMat4$1(C,C,x):Jn(C,C,x);const T=C[3];return C[0]/=T,C[1]/=T,C[2]/=T,C}function X_(v,d){return Math.min(.5+v/d*.5,1.5)}function Zc(v,d){const p=v[0]/v[3],x=v[1]/v[3];return p>=-d[0]&&p<=d[0]&&x>=-d[1]&&x<=d[1]}function mm(v,d,p,x,C,T,P,F,z,j){const W=p.transform,K=x?v.textSizeData:v.iconSizeData,ne=g.evaluateSizeForZoom(K,p.transform.zoom),he="globe"===W.projection.name,pe=[256/p.width*2+1,256/p.height*2+1],le=x?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;le.clear();let me=null;he&&(me=x?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const J=v.lineVertexArray,de=x?v.text.placedSymbolArray:v.icon.placedSymbolArray,be=p.transform.width/p.transform.height;let xe,Ne=!1;for(let Be=0;Be<de.length;Be++){const ke=de.get(Be),{numGlyphs:We,writingMode:$e}=ke;if($e!==g.WritingMode.vertical||Ne||xe===g.WritingMode.horizontal||(Ne=!0),xe=$e,(ke.hidden||$e===g.WritingMode.vertical)&&!Ne){Co(We,le);continue}Ne=!1;const Ye=new g.Point(ke.tileAnchorX,ke.tileAnchorY);let{x:St,y:Je,z:vt}=W.projection.projectTilePoint(Ye.x,Ye.y,j.canonical);if(z){const[Qi,Ai,nn]=z(Ye);St+=Qi,Je+=Ai,vt+=nn}const et=[St,Je,vt,1];if(g.transformMat4$1(et,et,d),!Zc(et,pe)){Co(We,le);continue}const Rt=X_(p.transform.cameraToCenterDistance,et[3]),tt=g.evaluateSizeForFeature(K,ne,ke),Mt=P?tt/Rt:tt*Rt,Nt=ra(St,Je,vt,C);if(Nt[3]<=0){Co(We,le);continue}let Bt={};const Zt=P?null:z,$i=oi(ke,Mt,!1,F,d,C,T,v.glyphOffsetArray,J,le,me,Nt,Ye,Bt,be,Zt,W.projection,j,P);Ne=$i.useVertical,Zt&&$i.needsFlipping&&(Bt={}),($i.notEnoughRoom||Ne||$i.needsFlipping&&oi(ke,Mt,!0,F,d,C,T,v.glyphOffsetArray,J,le,me,Nt,Ye,Bt,be,Zt,W.projection,j,P).notEnoughRoom)&&Co(We,le)}x?(v.text.dynamicLayoutVertexBuffer.updateData(le),me&&v.text.globeExtVertexBuffer.updateData(me)):(v.icon.dynamicLayoutVertexBuffer.updateData(le),me&&v.icon.globeExtVertexBuffer.updateData(me))}function wg(v,d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le){const{lineStartIndex:me,glyphStartIndex:J,segment:de}=F,be=J+F.numGlyphs,xe=me+F.lineLength,Ne=d.getoffsetX(J),Be=d.getoffsetX(be-1),ke=oa(v*Ne,p,x,C,T,P,de,me,xe,z,j,W,K,ne,!0,he,pe,le);if(!ke)return null;const We=oa(v*Be,p,x,C,T,P,de,me,xe,z,j,W,K,ne,!0,he,pe,le);return We?{first:ke,last:We}:null}function Zo(v,d,p,x){return v===g.WritingMode.horizontal&&Math.abs(x)>Math.abs(p)?{useVertical:!0}:v===g.WritingMode.vertical?x>0?{needsFlipping:!0}:null:d!==qd.unknown&&(0===(C=p)||Math.abs(x/C)>Dh)?d===qd.flipRequired?{needsFlipping:!0}:null:p<0?{needsFlipping:!0}:null;var C}function oi(v,d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le,me,J,de){const be=d/24,xe=v.lineOffsetX*be,Ne=v.lineOffsetY*be,{lineStartIndex:Be,glyphStartIndex:ke,numGlyphs:We,segment:$e,writingMode:Ye,flipState:St}=v,Je=Be+v.lineLength,vt=et=>{if(W){const[Nt,Bt,Zt]=et.up,$i=j.length;g.updateGlobeVertexNormal(W,$i+0,Nt,Bt,Zt),g.updateGlobeVertexNormal(W,$i+1,Nt,Bt,Zt),g.updateGlobeVertexNormal(W,$i+2,Nt,Bt,Zt),g.updateGlobeVertexNormal(W,$i+3,Nt,Bt,Zt)}const[Rt,tt,Mt]=et.point;g.addDynamicAttributes(j,Rt,tt,Mt,et.angle)};if(We>1){const et=wg(be,F,xe,Ne,p,K,ne,v,z,T,he,le,!1,me,J,de);if(!et)return{notEnoughRoom:!0};if(x&&!p){let[Rt,tt,Mt]=et.first.point,[Nt,Bt,Zt]=et.last.point;[Rt,tt]=ra(Rt,tt,Mt,P),[Nt,Bt]=ra(Nt,Bt,Zt,P);const $i=Zo(Ye,St,(Nt-Rt)*pe,Bt-tt);if(v.flipState=$i&&$i.needsFlipping?qd.flipRequired:qd.flipNotRequired,$i)return $i}vt(et.first);for(let Rt=ke+1;Rt<ke+We-1;Rt++){const tt=oa(be*F.getoffsetX(Rt),xe,Ne,p,K,ne,$e,Be,Je,z,T,he,le,!1,!1,me,J,de);if(!tt)return j.length-=4*(Rt-ke),{notEnoughRoom:!0};vt(tt)}vt(et.last)}else{if(x&&!p){const Rt=ra(ne.x,ne.y,0,C),tt=Be+$e+1,Mt=new g.Point(z.getx(tt),z.gety(tt)),Nt=ra(Mt.x,Mt.y,0,C),Bt=Nt[3]>0?Nt:Wn(ne,Mt,Rt,1,C,void 0,me,J.canonical),Zt=Zo(Ye,St,(Bt[0]-Rt[0])*pe,Bt[1]-Rt[1]);if(v.flipState=Zt&&Zt.needsFlipping?qd.flipRequired:qd.flipNotRequired,Zt)return Zt}const et=oa(be*F.getoffsetX(ke),xe,Ne,p,K,ne,$e,Be,Je,z,T,he,le,!1,!1,me,J,de);if(!et)return{notEnoughRoom:!0};vt(et)}return{}}function Jt(v,d,p,x,C){const{x:T,y:P,z:F}=x.projectTilePoint(v.x,v.y,d);if(!C)return ra(T,P,F,p);const[z,j,W]=C(v);return ra(T+z,P+j,F+W,p)}function Wn(v,d,p,x,C,T,P,F){const z=Jt(v.sub(d)._unit()._add(v),F,C,P,T);return g.sub(z,p,z),g.normalize(z,z),g.scaleAndAdd(z,p,z,x)}function oa(v,d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le,me,J){const de=x?v-d:v+d;let be=de>0?1:-1,xe=0;x&&(be*=-1,xe=Math.PI),be<0&&(xe+=Math.PI);let Ne=F+P+(be>0?0:1)|0,Be=C,ke=C,We=0,$e=0;const Ye=Math.abs(de),St=[],Je=[];let vt=T,et=vt;const Rt=()=>Wn(et,vt,ke,Ye-We+1,W,ne,le,me.canonical);for(;We+$e<=Ye;){if(Ne+=be,Ne<F||Ne>=z)return null;if(ke=Be,et=vt,St.push(ke),he&&Je.push(et),vt=new g.Point(j.getx(Ne),j.gety(Ne)),Be=K[Ne],!Be){const nn=Jt(vt,me.canonical,W,le,ne);Be=nn[3]>0?K[Ne]=nn:Rt()}We+=$e,$e=g.distance(ke,Be)}pe&&ne&&(K[Ne]&&(Be=Rt(),$e=g.distance(ke,Be)),K[Ne]=Be);const tt=(Ye-We)/$e,Mt=vt.sub(et)._mult(tt)._add(et),Nt=g.sub([],Be,ke),Bt=g.scaleAndAdd([],ke,Nt,tt);let Zt=[0,0,1],$i=Nt[0],Qi=Nt[1];if(J&&(Zt=le.upVector(me.canonical,Mt.x,Mt.y),0!==Zt[0]||0!==Zt[1]||1!==Zt[2])){const nn=[Zt[2],0,-Zt[0]],sr=g.cross([],Zt,nn);g.normalize(nn,nn),g.normalize(sr,sr),$i=g.dot(Nt,nn),Qi=g.dot(Nt,sr)}if(p){const nn=g.cross([],Zt,Nt);g.normalize(nn,nn),g.scaleAndAdd(Bt,Bt,nn,p*be)}const Ai=xe+Math.atan2(Qi,$i);return St.push(Bt),he&&Je.push(Mt),{point:Bt,angle:Ai,path:St,tilePath:Je,up:Zt}}function Co(v,d){const p=d.length,x=p+4*v;d.resize(x),d.float32.fill(-1/0,4*p,4*x)}function Jn(v,d,p){const x=d[0],C=d[1];return v[0]=p[0]*x+p[4]*C+p[12],v[1]=p[1]*x+p[5]*C+p[13],v[3]=p[3]*x+p[7]*C+p[15],v}const Dl=100;class jr{constructor(d,p,x=new Xc(d.width+200,d.height+200,25),C=new Xc(d.width+200,d.height+200,25)){this.transform=d,this.grid=x,this.ignoredGrid=C,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+Dl,this.screenBottomBoundary=d.height+Dl,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200,this.fogState=p}placeCollisionBox(d,p,x,C,T,P,F,z){let j=x.projectedAnchorX,W=x.projectedAnchorY,K=x.projectedAnchorZ;const ne=x.elevation,he=x.tileID,pe=d.getProjection();if(ne&&he){const[Be,ke,We]=pe.upVector(he.canonical,x.tileAnchorX,x.tileAnchorY),$e=pe.upVectorScale(he.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;j+=Be*ne*$e,W+=ke*ne*$e,K+=We*ne*$e}const le=this.projectAndGetPerspectiveRatio(F,j,W,K,x.tileID,"globe"===pe.name||!!ne||this.transform.pitch>0,pe),me=P*le.perspectiveRatio,J=(x.x1*p+C.x-x.padding)*me+le.point.x,de=(x.y1*p+C.y-x.padding)*me+le.point.y,be=(x.x2*p+C.x+x.padding)*me+le.point.x,xe=(x.y2*p+C.y+x.padding)*me+le.point.y,Ne=le.perspectiveRatio<=.55||le.occluded;return!this.isInsideGrid(J,de,be,xe)||!T&&this.grid.hitTest(J,de,be,xe,z)||Ne?{box:[],offscreen:!1,occluded:le.occluded}:{box:[J,de,be,xe],offscreen:this.isOffscreen(J,de,be,xe),occluded:!1}}placeCollisionCircles(d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le){const me=[],J=this.transform.elevation,de=d.getProjection(),be=J?J.getAtTileOffsetFunc(le,this.transform.center.lat,this.transform.worldSize,de):null,xe=new g.Point(x.tileAnchorX,x.tileAnchorY);let{x:Ne,y:Be,z:ke}=de.projectTilePoint(xe.x,xe.y,le.canonical);if(be){const[Mt,Nt,Bt]=be(xe);Ne+=Mt,Be+=Nt,ke+=Bt}const We="globe"===de.name,$e=this.projectAndGetPerspectiveRatio(F,Ne,Be,ke,le,We||!!J||this.transform.pitch>0,de),{perspectiveRatio:Ye}=$e,St=(K?P/Ye:P*Ye)/g.ONE_EM,Je=ra(Ne,Be,ke,z),vt=$e.signedDistanceFromCamera>0?wg(St,T,x.lineOffsetX*St,x.lineOffsetY*St,!1,Je,xe,x,C,z,{},J&&!K?be:null,K&&!!J,de,le,K):null;let et=!1,Rt=!1,tt=!0;if(vt&&!$e.occluded){const Mt=.5*he*Ye+pe,Nt=new g.Point(-100,-100),Bt=new g.Point(this.screenRightBoundary,this.screenBottomBoundary),Zt=new fm,{first:$i,last:Qi}=vt,Ai=$i.path.length;let nn=[];for(let Bi=Ai-1;Bi>=1;Bi--)nn.push($i.path[Bi]);for(let Bi=1;Bi<Qi.path.length;Bi++)nn.push(Qi.path[Bi]);const sr=2.5*Mt;j&&(nn=nn.map(([Bi,Jr,Di],no)=>(be&&!We&&(Di=be(no<Ai-1?$i.tilePath[Ai-1-no]:Qi.tilePath[no-Ai+2])[2]),ra(Bi,Jr,Di,j))),nn.some(Bi=>Bi[3]<=0)&&(nn=[]));let Bn=[];if(nn.length>0){let Bi=1/0,Jr=-1/0,Di=1/0,no=-1/0;for(const To of nn)Bi=Math.min(Bi,To[0]),Di=Math.min(Di,To[1]),Jr=Math.max(Jr,To[0]),no=Math.max(no,To[1]);Jr>=Nt.x&&Bi<=Bt.x&&no>=Nt.y&&Di<=Bt.y&&(Bn=[nn.map(To=>new g.Point(To[0],To[1]))],(Bi<Nt.x||Jr>Bt.x||Di<Nt.y||no>Bt.y)&&(Bn=g.clipLine(Bn,Nt.x,Nt.y,Bt.x,Bt.y)))}for(const Bi of Bn){Zt.reset(Bi,.25*Mt);let Jr=0;Jr=Zt.length<=.5*Mt?1:Math.ceil(Zt.paddedLength/sr)+1;for(let Di=0;Di<Jr;Di++){const no=Di/Math.max(Jr-1,1),To=Zt.lerp(no),za=To.x+Dl,ua=To.y+Dl;me.push(za,ua,Mt,0);const rc=za-Mt,oc=ua-Mt,ao=za+Mt,ro=ua+Mt;if(tt=tt&&this.isOffscreen(rc,oc,ao,ro),Rt=Rt||this.isInsideGrid(rc,oc,ao,ro),!p&&this.grid.hitTestCircle(za,ua,Mt,ne)&&(et=!0,!W))return{circles:[],offscreen:!1,collisionDetected:et,occluded:!1}}}}return{circles:!W&&et||!Rt?[]:me,offscreen:tt,collisionDetected:et,occluded:$e.occluded}}queryRenderedSymbols(d){if(0===d.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const p=[];let x=1/0,C=1/0,T=-1/0,P=-1/0;for(const W of d){const K=new g.Point(W.x+Dl,W.y+Dl);x=Math.min(x,K.x),C=Math.min(C,K.y),T=Math.max(T,K.x),P=Math.max(P,K.y),p.push(K)}const F=this.grid.query(x,C,T,P).concat(this.ignoredGrid.query(x,C,T,P)),z={},j={};for(const W of F){const K=W.key;if(void 0===z[K.bucketInstanceId]&&(z[K.bucketInstanceId]={}),z[K.bucketInstanceId][K.featureIndex])continue;const ne=[new g.Point(W.x1,W.y1),new g.Point(W.x2,W.y1),new g.Point(W.x2,W.y2),new g.Point(W.x1,W.y2)];g.polygonIntersectsPolygon(p,ne)&&(z[K.bucketInstanceId][K.featureIndex]=!0,void 0===j[K.bucketInstanceId]&&(j[K.bucketInstanceId]=[]),j[K.bucketInstanceId].push(K.featureIndex))}return j}insertCollisionBox(d,p,x,C,T){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:C,collisionGroupID:T},d[0],d[1],d[2],d[3])}insertCollisionCircles(d,p,x,C,T){const P=p?this.ignoredGrid:this.grid,F={bucketInstanceId:x,featureIndex:C,collisionGroupID:T};for(let z=0;z<d.length;z+=4)P.insertCircle(F,d[z],d[z+1],d[z+2])}projectAndGetPerspectiveRatio(d,p,x,C,T,P,F){const z=[p,x,C,1];let j=!1;C||this.transform.pitch>0?(g.transformMat4$1(z,z,d),this.fogState&&T&&"globe"!==F.name&&(j=function(ne,he,pe,le,me,J){const de=J.calculateFogTileMatrix(me),be=[he,pe,le];return g.transformMat4(be,be,de),Sh(ne,be,J.pitch,J._fov)}(this.fogState,p,x,C,T.toUnwrapped(),this.transform)>.9)):Jn(z,z,d);const W=z[3];return{point:new g.Point((z[0]/W+1)/2*this.transform.width+Dl,(-z[1]/W+1)/2*this.transform.height+Dl),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(F)/W*.5,1.5),signedDistanceFromCamera:W,occluded:P&&z[2]>W||j}}isOffscreen(d,p,x,C){return x<Dl||d>=this.screenRightBoundary||C<Dl||p>this.screenBottomBoundary}isInsideGrid(d,p,x,C){return x>=0&&d<this.gridRightBoundary&&C>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const d=g.identity([]);return g.translate(d,d,[-100,-100,0]),d}}function Mc(v,d,p){const x=d.createTileMatrix(v,v.worldSize,p.toUnwrapped());return g.multiply(new Float32Array(16),v.projMatrix,x)}function yo(v,d,p){if(d.projection.name===p.projection.name)return v.projMatrix;const x=p.clone();return x.setProjection(d.projection),Mc(x,d.getProjection(),v)}function So(v,d,p){return d.name===p.projection.name?v.projMatrix:Mc(p,d,v)}class gm{constructor(d,p,x,C){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?p:-p))):C&&x?1:0,this.placed=x}isHidden(){return 0===this.opacity&&!this.placed}}class ir{constructor(d,p,x,C,T,P=!1){this.text=new gm(d?d.text:null,p,x,T),this.icon=new gm(d?d.icon:null,p,C,T),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _n{constructor(d,p,x,C=!1){this.text=d,this.icon=p,this.skipFade=x,this.clipped=C}}class Hu{constructor(){this.invProjMatrix=g.create(),this.viewportMatrix=g.create(),this.circles=[]}}class Ap{constructor(d,p,x,C,T){this.bucketInstanceId=d,this.featureIndex=p,this.sourceLayerIndex=x,this.bucketIndex=C,this.tileID=T}}class Pv{constructor(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}}get(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){const p=++this.maxGroupID;this.collisionGroups[d]={ID:p,predicate:x=>x.collisionGroupID===p}}return this.collisionGroups[d]}}function Ih(v,d,p,x,C){const{horizontalAlign:T,verticalAlign:P}=g.getAnchorAlignment(v),F=-(T-.5)*d,z=-(P-.5)*p,j=g.evaluateVariableOffset(v,x);return new g.Point(F+j[0]*C,z+j[1]*C)}function Ct(v,d,p,x,C){const T=new g.Point(v,d);return p&&T._rotate(x?C:-C),T}class Gu{constructor(d,p,x,C,T){this.transform=d.clone(),this.projection=d.projection.name,this.collisionIndex=new jr(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Pv(x),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(d,p,x,C){const T=x.getBucket(p),P=x.latestFeatureIndex;if(!T||!P||p.id!==T.layerIds[0])return;const F=T.layers[0].layout,z=x.collisionBoxArray,j=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),W=x.tileSize/g.EXTENT,K=x.tileID.toUnwrapped();this.transform.setProjection(T.projection);const ne=(he=x.tileID,pe=T.getProjection(),le=this.transform,pe.name===this.projection?le.calculateProjMatrix(he.toUnwrapped()):Mc(le,pe,he));var he,pe,le;const me="map"===F.get("text-pitch-alignment"),J="map"===F.get("text-rotation-alignment");p.compileFilter();const de=p.dynamicFilter(),be=p.dynamicFilterNeedsFeature(),xe=this.transform.calculatePixelsToTileUnitsMatrix(x),Ne=bd(ne,x.tileID.canonical,me,J,this.transform,T.getProjection(),xe);let Be=null;if(me){const $e=Es(ne,x.tileID.canonical,me,J,this.transform,T.getProjection(),xe);Be=g.multiply([],this.transform.labelPlaneMatrix,$e)}let ke=null;de&&x.latestFeatureIndex&&(ke={unwrappedTileID:K,dynamicFilter:de,dynamicFilterNeedsFeature:be,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Ap(T.bucketInstanceId,P,T.sourceLayerIndex,T.index,x.tileID);const We={bucket:T,layout:F,posMatrix:ne,textLabelPlaneMatrix:Ne,labelToScreenMatrix:Be,clippingData:ke,scale:j,textPixelRatio:W,holdingForFade:x.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:g.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:g.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(C)for(const $e of T.sortKeyRanges){const{sortKey:Ye,symbolInstanceStart:St,symbolInstanceEnd:Je}=$e;d.push({sortKey:Ye,symbolInstanceStart:St,symbolInstanceEnd:Je,parameters:We})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:We})}attemptAnchorPlacement(d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le,me,J,de){const{textOffset0:be,textOffset1:xe,crossTileID:Ne}=ne,Be=[be,xe],ke=Ih(d,x,C,Be,T),We=this.collisionIndex.placeCollisionBox(pe,T,p,Ct(ke.x,ke.y,P,F,this.transform.angle),K,z,j,W.predicate);if(me){const $e=pe.getSymbolInstanceIconSize(de,this.transform.zoom,ne.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(pe,$e,me,Ct(ke.x,ke.y,P,F,this.transform.angle),K,z,j,W.predicate).box.length)return}if(We.box.length>0){let $e;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ne]&&this.prevPlacement.placements[Ne]&&this.prevPlacement.placements[Ne].text&&($e=this.prevPlacement.variableOffsets[Ne].anchor),this.variableOffsets[Ne]={textOffset:Be,width:x,height:C,anchor:d,textScale:T,prevAnchor:$e},this.markUsedJustification(pe,d,ne,le),pe.allowVerticalPlacement&&(this.markUsedOrientation(pe,le,ne),this.placedOrientations[Ne]=le),{shift:ke,placedGlyphBoxes:We}}}placeLayerBucketPart(d,p,x,C){const{bucket:T,layout:P,posMatrix:F,textLabelPlaneMatrix:z,labelToScreenMatrix:j,clippingData:W,textPixelRatio:K,holdingForFade:ne,collisionBoxArray:he,partiallyEvaluatedTextSize:pe,partiallyEvaluatedIconSize:le,collisionGroup:me}=d.parameters,J=P.get("text-optional"),de=P.get("icon-optional"),be=P.get("text-allow-overlap"),xe=P.get("icon-allow-overlap"),Ne="map"===P.get("text-rotation-alignment"),Be="map"===P.get("text-pitch-alignment"),ke="none"!==P.get("icon-text-fit"),We="viewport-y"===P.get("symbol-z-order");this.transform.setProjection(T.projection);let $e=be&&(xe||!T.hasIconData()||de),Ye=xe&&(be||!T.hasTextData()||J);!T.collisionArrays&&he&&T.deserializeCollisionBoxes(he),x&&C&&T.updateCollisionDebugBuffers(this.transform.zoom,he);const St=(Je,vt,et)=>{const{crossTileID:Rt,numVerticalGlyphVertices:tt}=Je;if(W){const ao={zoom:this.transform.zoom,pitch:this.transform.pitch};let ro=null;if(W.dynamicFilterNeedsFeature){const Ir=this.retainedQueryData[T.bucketInstanceId];ro=W.featureIndex.loadFeature({featureIndex:Je.featureIndex,bucketIndex:Ir.bucketIndex,sourceLayerIndex:Ir.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,W.dynamicFilter)(ao,ro,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new g.Point(Je.tileAnchorX,Je.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[Rt]=new _n(!1,!1,!1,!0),void p.add(Rt)}if(p.has(Rt))return;if(ne)return void(this.placements[Rt]=new _n(!1,!1,!1));let Mt=!1,Nt=!1,Bt=!0,Zt=!1,$i=!1,Qi=null,Ai={box:null,offscreen:null,occluded:null},nn={box:null,offscreen:null,occluded:null},sr=null,Bn=null,Bi=null,Jr=0,Di=0,no=0;et.textFeatureIndex?Jr=et.textFeatureIndex:Je.useRuntimeCollisionCircles&&(Jr=Je.featureIndex),et.verticalTextFeatureIndex&&(Di=et.verticalTextFeatureIndex);const To=ao=>{ao.tileID=this.retainedQueryData[T.bucketInstanceId].tileID;const ro=this.transform.elevation;(ro||ao.elevation)&&(ao.elevation=ro?ro.getAtTileOffset(ao.tileID,ao.tileAnchorX,ao.tileAnchorY):0)},za=et.textBox;if(za){To(za);const ao=Ir=>{let gs=g.WritingMode.horizontal;if(T.allowVerticalPlacement&&!Ir&&this.prevPlacement){const Ua=this.prevPlacement.placedOrientations[Rt];Ua&&(this.placedOrientations[Rt]=Ua,gs=Ua,this.markUsedOrientation(T,gs,Je))}return gs},ro=(Ir,gs)=>{if(T.allowVerticalPlacement&&tt>0&&et.verticalTextBox){for(const Ua of T.writingModes)if(Ua===g.WritingMode.vertical?(Ai=gs(),nn=Ai):Ai=Ir(),Ai&&Ai.box&&Ai.box.length)break}else Ai=Ir()};if(P.get("text-variable-anchor")){let Ir=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Rt]){const xo=this.prevPlacement.variableOffsets[Rt];Ir.indexOf(xo.anchor)>0&&(Ir=Ir.filter(Ut=>Ut!==xo.anchor),Ir.unshift(xo.anchor))}const gs=(xo,Ut,xr)=>{const $r=T.getSymbolInstanceTextSize(pe,Je,this.transform.zoom,vt),lo=(xo.x2-xo.x1)*$r+2*xo.padding,Ho=(xo.y2-xo.y1)*$r+2*xo.padding,nu=ke&&!xe?Ut:null;nu&&To(nu);let sc={box:[],offscreen:!1,occluded:!1};const Fl=be?2*Ir.length:Ir.length;for(let ru=0;ru<Fl;++ru){const Df=this.attemptAnchorPlacement(Ir[ru%Ir.length],xo,lo,Ho,$r,Ne,Be,K,F,me,ru>=Ir.length,Je,vt,T,xr,nu,pe,le);if(Df&&(sc=Df.placedGlyphBoxes,sc&&sc.box&&sc.box.length)){Mt=!0,Qi=Df.shift;break}}return sc};ro(()=>gs(za,et.iconBox,g.WritingMode.horizontal),()=>{const xo=et.verticalTextBox;return xo&&To(xo),T.allowVerticalPlacement&&!(Ai&&Ai.box&&Ai.box.length)&&tt>0&&xo?gs(xo,et.verticalIconBox,g.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ai&&(Mt=Ai.box,Bt=Ai.offscreen,Zt=Ai.occluded);const Ua=ao(!(!Ai||!Ai.box));if(!Mt&&this.prevPlacement){const xo=this.prevPlacement.variableOffsets[Rt];xo&&(this.variableOffsets[Rt]=xo,this.markUsedJustification(T,xo.anchor,Je,Ua))}}else{const Ir=(gs,Ua)=>{const xo=T.getSymbolInstanceTextSize(pe,Je,this.transform.zoom,vt),Ut=this.collisionIndex.placeCollisionBox(T,xo,gs,new g.Point(0,0),be,K,F,me.predicate);return Ut&&Ut.box&&Ut.box.length&&(this.markUsedOrientation(T,Ua,Je),this.placedOrientations[Rt]=Ua),Ut};ro(()=>Ir(za,g.WritingMode.horizontal),()=>{const gs=et.verticalTextBox;return T.allowVerticalPlacement&&tt>0&&gs?(To(gs),Ir(gs,g.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),ao(!!(Ai&&Ai.box&&Ai.box.length))}}if(sr=Ai,Mt=sr&&sr.box&&sr.box.length>0,Bt=sr&&sr.offscreen,Zt=sr&&sr.occluded,Je.useRuntimeCollisionCircles){const ao=T.text.placedSymbolArray.get(Je.centerJustifiedTextSymbolIndex>=0?Je.centerJustifiedTextSymbolIndex:Je.verticalPlacedTextSymbolIndex),ro=g.evaluateSizeForFeature(T.textSizeData,pe,ao),Ir=P.get("text-padding");Bn=this.collisionIndex.placeCollisionCircles(T,be,ao,T.lineVertexArray,T.glyphOffsetArray,ro,F,z,j,x,Be,me.predicate,Je.collisionCircleDiameter*ro/g.ONE_EM,Ir,this.retainedQueryData[T.bucketInstanceId].tileID),Mt=be||Bn.circles.length>0&&!Bn.collisionDetected,Bt=Bt&&Bn.offscreen,Zt=Bn.occluded}if(et.iconFeatureIndex&&(no=et.iconFeatureIndex),et.iconBox){const ao=ro=>{To(ro);const Ir=ke&&Qi?Ct(Qi.x,Qi.y,Ne,Be,this.transform.angle):new g.Point(0,0),gs=T.getSymbolInstanceIconSize(le,this.transform.zoom,Je.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(T,gs,ro,Ir,xe,K,F,me.predicate)};nn&&nn.box&&nn.box.length&&et.verticalIconBox?(Bi=ao(et.verticalIconBox),Nt=Bi.box.length>0):(Bi=ao(et.iconBox),Nt=Bi.box.length>0),Bt=Bt&&Bi.offscreen,$i=Bi.occluded}const ua=J||0===Je.numHorizontalGlyphVertices&&0===tt,rc=de||0===Je.numIconVertices;if(ua||rc?rc?ua||(Nt=Nt&&Mt):Mt=Nt&&Mt:Nt=Mt=Nt&&Mt,Mt&&sr&&sr.box&&this.collisionIndex.insertCollisionBox(sr.box,P.get("text-ignore-placement"),T.bucketInstanceId,nn&&nn.box&&Di?Di:Jr,me.ID),Nt&&Bi&&this.collisionIndex.insertCollisionBox(Bi.box,P.get("icon-ignore-placement"),T.bucketInstanceId,no,me.ID),Bn&&(Mt&&this.collisionIndex.insertCollisionCircles(Bn.circles,P.get("text-ignore-placement"),T.bucketInstanceId,Jr,me.ID),x)){const ao=T.bucketInstanceId;let ro=this.collisionCircleArrays[ao];void 0===ro&&(ro=this.collisionCircleArrays[ao]=new Hu);for(let Ir=0;Ir<Bn.circles.length;Ir+=4)ro.circles.push(Bn.circles[Ir+0]),ro.circles.push(Bn.circles[Ir+1]),ro.circles.push(Bn.circles[Ir+2]),ro.circles.push(Bn.collisionDetected?1:0)}const oc="globe"!==T.projection.name;$e=$e&&(oc||!Zt),Ye=Ye&&(oc||!$i),this.placements[Rt]=new _n(Mt||$e,Nt||Ye,Bt||T.justReloaded),p.add(Rt)};if(We){const Je=T.getSortedSymbolIndexes(this.transform.angle);for(let vt=Je.length-1;vt>=0;--vt){const et=Je[vt];St(T.symbolInstances.get(et),et,T.collisionArrays[et])}}else for(let Je=d.symbolInstanceStart;Je<d.symbolInstanceEnd;Je++)St(T.symbolInstances.get(Je),Je,T.collisionArrays[Je]);if(x&&T.bucketInstanceId in this.collisionCircleArrays){const Je=this.collisionCircleArrays[T.bucketInstanceId];g.invert(Je.invProjMatrix,F),Je.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(d,p,x,C){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:z,crossTileID:j}=x,W=g.getAnchorJustification(p),K=C===g.WritingMode.vertical?z:"left"===W?T:"center"===W?P:"right"===W?F:-1;T>=0&&(d.text.placedSymbolArray.get(T).crossTileID=K>=0&&T!==K?0:j),P>=0&&(d.text.placedSymbolArray.get(P).crossTileID=K>=0&&P!==K?0:j),F>=0&&(d.text.placedSymbolArray.get(F).crossTileID=K>=0&&F!==K?0:j),z>=0&&(d.text.placedSymbolArray.get(z).crossTileID=K>=0&&z!==K?0:j)}markUsedOrientation(d,p,x){const C=p===g.WritingMode.horizontal||p===g.WritingMode.horizontalOnly?p:0,T=p===g.WritingMode.vertical?p:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:F,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:j}=x,W=d.text.placedSymbolArray;P>=0&&(W.get(P).placedOrientation=C),F>=0&&(W.get(F).placedOrientation=C),z>=0&&(W.get(z).placedOrientation=C),j>=0&&(W.get(j).placedOrientation=T)}commit(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let x=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const C=p?p.symbolFadeChange(d):1,T=p?p.opacities:{},P=p?p.variableOffsets:{},F=p?p.placedOrientations:{};for(const z in this.placements){const j=this.placements[z],W=T[z];W?(this.opacities[z]=new ir(W,C,j.text,j.icon,null,j.clipped),x=x||j.text!==W.text.placed||j.icon!==W.icon.placed):(this.opacities[z]=new ir(null,C,j.text,j.icon,j.skipFade,j.clipped),x=x||j.text||j.icon)}for(const z in T){const j=T[z];if(!this.opacities[z]){const W=new ir(j,C,!1,!1);W.isHidden()||(this.opacities[z]=W,x=x||j.text.placed||j.icon.placed)}}for(const z in P)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=P[z]);for(const z in F)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=F[z]);x?this.lastPlacementChangeTime=d:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:d)}updateLayerOpacities(d,p){const x=new Set;for(const C of p){const T=C.getBucket(d);T&&C.latestFeatureIndex&&d.id===T.layerIds[0]&&this.updateBucketOpacities(T,x,C.collisionBoxArray)}}updateBucketOpacities(d,p,x){d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();const C=d.layers[0].layout,T=!!d.layers[0].dynamicFilter(),P=new ir(null,0,!1,!1,!0),F=C.get("text-allow-overlap"),z=C.get("icon-allow-overlap"),j=C.get("text-variable-anchor"),W="map"===C.get("text-rotation-alignment"),K="map"===C.get("text-pitch-alignment"),ne="none"!==C.get("icon-text-fit"),he=new ir(null,0,F&&(z||!d.hasIconData()||C.get("icon-optional")),z&&(F||!d.hasTextData()||C.get("text-optional")),!0);!d.collisionArrays&&x&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(x);const pe=(me,J,de)=>{for(let be=0;be<J/4;be++)me.opacityVertexArray.emplaceBack(de)};let le=0;for(let me=0;me<d.symbolInstances.length;me++){const J=d.symbolInstances.get(me),{numHorizontalGlyphVertices:de,numVerticalGlyphVertices:be,crossTileID:xe,numIconVertices:Ne}=J,Be=p.has(xe);let ke=this.opacities[xe];Be?ke=P:ke||(ke=he,this.opacities[xe]=ke),p.add(xe);const We=de>0||be>0,$e=Ne>0,Ye=this.placedOrientations[xe],St=Ye===g.WritingMode.vertical,Je=Ye===g.WritingMode.horizontal||Ye===g.WritingMode.horizontalOnly;if(!We&&!$e||ke.isHidden()||le++,We){const vt=gf(ke.text);pe(d.text,de,St?ts:vt),pe(d.text,be,Je?ts:vt);const et=ke.text.isHidden(),{leftJustifiedTextSymbolIndex:Rt,centerJustifiedTextSymbolIndex:tt,rightJustifiedTextSymbolIndex:Mt,verticalPlacedTextSymbolIndex:Nt}=J,Bt=d.text.placedSymbolArray,Zt=et||St?1:0;Rt>=0&&(Bt.get(Rt).hidden=Zt),tt>=0&&(Bt.get(tt).hidden=Zt),Mt>=0&&(Bt.get(Mt).hidden=Zt),Nt>=0&&(Bt.get(Nt).hidden=et||Je?1:0);const $i=this.variableOffsets[xe];$i&&this.markUsedJustification(d,$i.anchor,J,Ye);const Qi=this.placedOrientations[xe];Qi&&(this.markUsedJustification(d,"left",J,Qi),this.markUsedOrientation(d,Qi,J))}if($e){const vt=gf(ke.icon),{placedIconSymbolIndex:et,verticalPlacedIconSymbolIndex:Rt}=J,tt=d.icon.placedSymbolArray,Mt=ke.icon.isHidden()?1:0;et>=0&&(pe(d.icon,Ne,St?ts:vt),tt.get(et).hidden=Mt),Rt>=0&&(pe(d.icon,J.numVerticalIconVertices,Je?ts:vt),tt.get(Rt).hidden=Mt)}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){const vt=d.collisionArrays[me];if(vt){let et=new g.Point(0,0),Rt=!0;if(vt.textBox||vt.verticalTextBox){if(j){const Mt=this.variableOffsets[xe];Mt?(et=Ih(Mt.anchor,Mt.width,Mt.height,Mt.textOffset,Mt.textScale),W&&et._rotate(K?this.transform.angle:-this.transform.angle)):Rt=!1}T&&(Rt=!ke.clipped),vt.textBox&&Dn(d.textCollisionBox.collisionVertexArray,ke.text.placed,!Rt||St,et.x,et.y),vt.verticalTextBox&&Dn(d.textCollisionBox.collisionVertexArray,ke.text.placed,!Rt||Je,et.x,et.y)}const tt=Rt&&!(Je||!vt.verticalIconBox);vt.iconBox&&Dn(d.iconCollisionBox.collisionVertexArray,ke.icon.placed,tt,ne?et.x:0,ne?et.y:0),vt.verticalIconBox&&Dn(d.iconCollisionBox.collisionVertexArray,ke.icon.placed,!tt,ne?et.x:0,ne?et.y:0)}}}if(d.fullyClipped=0===le,d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){const me=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=me.invProjMatrix,d.placementViewportMatrix=me.viewportMatrix,d.collisionCircleArray=me.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}}symbolFadeChange(d){return 0===this.fadeDuration?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(d){return Math.max(0,(this.transform.zoom-d)/1.5)}hasTransitions(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(d,p){const x=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*x>d}setStale(){this.stale=!0}}function Dn(v,d,p,x,C){v.emplaceBack(d?1:0,p?1:0,x||0,C||0),v.emplaceBack(d?1:0,p?1:0,x||0,C||0),v.emplaceBack(d?1:0,p?1:0,x||0,C||0),v.emplaceBack(d?1:0,p?1:0,x||0,C||0)}const ur=Math.pow(2,25),fs=Math.pow(2,24),Z_=Math.pow(2,17),_m=Math.pow(2,16),Ma=Math.pow(2,9),es=Math.pow(2,8),Lv=Math.pow(2,1);function gf(v){if(0===v.opacity&&!v.placed)return 0;if(1===v.opacity&&v.placed)return 4294967295;const d=v.placed?1:0,p=Math.floor(127*v.opacity);return p*ur+d*fs+p*Z_+d*_m+p*Ma+d*es+p*Lv+d}const ts=0;class Ec{constructor(d){this._sortAcrossTiles="viewport-y"!==d.layout.get("symbol-z-order")&&void 0!==d.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(d,p,x,C,T){const P=this._bucketParts;for(;this._currentTileIndex<d.length;)if(p.getBucketParts(P,C,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((F,z)=>F.sortKey-z.sortKey));this._currentPartIndex<P.length;){const F=P[this._currentPartIndex];if(p.placeLayerBucketPart(F,this._seenCrossTileIDs,x,0===F.symbolInstanceStart),this._currentPartIndex++,T())return!0}return!1}}class Y_{constructor(d,p,x,C,T,P,F,z){this.placement=new Gu(d,T,P,F,z),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=C,this._done=!1}isDone(){return this._done}continuePlacement(d,p,x){const C=g.exported.now(),T=()=>{const P=g.exported.now()-C;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=p[d[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if("symbol"===P.type&&(!P.minzoom||P.minzoom<=F)&&(!P.maxzoom||P.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new Ec(P)),this._inProgressLayer.continuePlacement(x[P.source],this.placement,this._showCollisionBoxes,P,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(d){return this.placement.commit(d),this.placement}}const Dp=512/g.EXTENT/2;class Fa{constructor(d,p,x){this.tileID=d,this.bucketInstanceId=x,this.index=new g.KDBush(p.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const C=d.canonical.x*g.EXTENT,T=d.canonical.y*g.EXTENT;for(let P=0;P<p.length;P++){const{key:F,crossTileID:z,tileAnchorX:j,tileAnchorY:W}=p.get(P),K=Math.floor((C+j)*Dp),ne=Math.floor((T+W)*Dp);this.index.add(K,ne),this.keys.push(F),this.crossTileIDs.push(z)}this.index.finish()}findMatches(d,p,x){const C=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),T=Dp/Math.pow(2,p.canonical.z-this.tileID.canonical.z),P=p.canonical.x*g.EXTENT,F=p.canonical.y*g.EXTENT;for(let z=0;z<d.length;z++){const j=d.get(z);if(j.crossTileID)continue;const{key:W,tileAnchorX:K,tileAnchorY:ne}=j,he=Math.floor((P+K)*T),pe=Math.floor((F+ne)*T),le=this.index.range(he-C,pe-C,he+C,pe+C);for(const me of le){const J=this.crossTileIDs[me];if(this.keys[me]===W&&!x.has(J)){x.add(J),j.crossTileID=J;break}}}}}class K_{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Oo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(d){const p=Math.round((d-this.lng)/360);if(0!==p)for(const x in this.indexes){const C=this.indexes[x],T={};for(const P in C){const F=C[P];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+p),T[F.tileID.key]=F}this.indexes[x]=T}this.lng=d}addBucket(d,p,x){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(let T=0;T<p.symbolInstances.length;T++)p.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]=new Set);const C=this.usedCrossTileIDs[d.overscaledZ];for(const T in this.indexes){const P=this.indexes[T];if(Number(T)>d.overscaledZ)for(const F in P){const z=P[F];z.tileID.isChildOf(d)&&z.findMatches(p.symbolInstances,d,C)}else{const F=P[d.scaledTo(Number(T)).key];F&&F.findMatches(p.symbolInstances,d,C)}}for(let T=0;T<p.symbolInstances.length;T++){const P=p.symbolInstances.get(T);P.crossTileID||(P.crossTileID=x.generate(),C.add(P.crossTileID))}return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new Fa(d,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(d,p){for(const x of p.crossTileIDs)this.usedCrossTileIDs[d].delete(x)}removeStaleBuckets(d){let p=!1;for(const x in this.indexes){const C=this.indexes[x];for(const T in C)d[C[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,C[T]),delete C[T],p=!0)}return p}}class Kr{constructor(){this.layerIndexes={},this.crossTileIDs=new K_,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(d,p,x,C){let T=this.layerIndexes[d.id];void 0===T&&(T=this.layerIndexes[d.id]=new Oo);let P=!1;const F={};"globe"!==C.name&&T.handleWrapJump(x);for(const z of p){const j=z.getBucket(d);j&&d.id===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(z.tileID,j,this.crossTileIDs)&&(P=!0),F[j.bucketInstanceId]=!0)}return T.removeStaleBuckets(F)&&(P=!0),P}pruneUnusedLayers(d){const p={};d.forEach(x=>{p[x]=!0});for(const x in this.layerIndexes)p[x]||delete this.layerIndexes[x]}}const ju=(v,d)=>g.emitValidationErrors(v,d&&d.filter(p=>"source.canvas"!==p.identifier)),Mg=g.pick(Gr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Cc=g.pick(Gr,["setCenter","setZoom","setBearing","setPitch"]),io={version:8,layers:[],sources:{}},_f={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Xd extends g.Evented{constructor(d,p={}){super(),this.map=d,this.dispatcher=new Cn(Tp(),this),this.imageManager=new jc,this.imageManager.setEventedParent(this),this.glyphManager=new g.GlyphManager(d._requestManager,p.localFontFamily?g.LocalGlyphMode.all:p.localIdeographFontFamily?g.LocalGlyphMode.ideographs:g.LocalGlyphMode.none,p.localFontFamily||p.localIdeographFontFamily),this.crossTileSymbolIndex=new Kr,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",g.getReferrer());const x=this;this._rtlTextPluginCallback=Xd.registerForPluginStateChange(C=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},(T,P)=>{if(g.triggerPluginCompletionEvent(T),P&&P.every(F=>F))for(const F in x._sourceCaches){const z=x._sourceCaches[F],j=z.getSource().type;"vector"!==j&&"geojson"!==j||z.reload()}})}),this.on("data",C=>{if("source"!==C.dataType||"metadata"!==C.sourceDataType)return;const T=this.getSource(C.sourceId);if(T&&T.vectorLayerIds)for(const P in this._layers){const F=this._layers[P];F.source===T.id&&this._validateLayer(F)}})}loadURL(d,p={}){this.fire(new g.Event("dataloading",{dataType:"style"}));const x="boolean"==typeof p.validate?p.validate:!g.isMapboxURL(d);d=this.map._requestManager.normalizeStyleURL(d,p.accessToken);const C=this.map._requestManager.transformRequest(d,g.ResourceType.Style);this._request=g.getJSON(C,(T,P)=>{this._request=null,T?this.fire(new g.ErrorEvent(T)):P&&this._load(P,x)})}loadJSON(d,p={}){this.fire(new g.Event("dataloading",{dataType:"style"})),this._request=g.exported.frame(()=>{this._request=null,this._load(d,!1!==p.validate)})}loadEmpty(){this.fire(new g.Event("dataloading",{dataType:"style"})),this._load(io,!1)}_updateLayerCount(d,p){const x=p?1:-1;d.is3D()&&(this._num3DLayers+=x),"circle"===d.type&&(this._numCircleLayers+=x),"symbol"===d.type&&(this._numSymbolLayers+=x)}_load(d,p){if(p&&ju(this,g.validateStyle(d)))return;this._loaded=!0,this.stylesheet=g.clone$1(d),this._updateMapProjection();for(const C in d.sources)this.addSource(C,d.sources[C],{validate:!1});this._changed=!1,d.sprite?this._loadSprite(d.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(d.glyphs);const x=_d(this.stylesheet.layers);this._order=x.map(C=>C.id),this._layers={},this._serializedLayers={};for(const C of x){const T=g.createStyleLayer(C);T.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ia(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new g.Event("data",{dataType:"style"})),this.fire(new g.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(d){d?this.stylesheet.projection=d:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(d){this._spriteRequest=function(p,x,C){let T,P,F;const z=g.exported.devicePixelRatio>1?"@2x":"";let j=g.getJSON(x.transformRequest(x.normalizeSpriteURL(p,z,".json"),g.ResourceType.SpriteJSON),(ne,he)=>{j=null,F||(F=ne,T=he,K())}),W=g.getImage(x.transformRequest(x.normalizeSpriteURL(p,z,".png"),g.ResourceType.SpriteImage),(ne,he)=>{W=null,F||(F=ne,P=he,K())});function K(){if(F)C(F);else if(T&&P){const ne=g.exported.getImageData(P),he={};for(const pe in T){const{width:le,height:me,x:J,y:de,sdf:be,pixelRatio:xe,stretchX:Ne,stretchY:Be,content:ke}=T[pe],We=new g.RGBAImage({width:le,height:me});g.RGBAImage.copy(ne,We,{x:J,y:de},{x:0,y:0},{width:le,height:me}),he[pe]={data:We,pixelRatio:xe,sdf:be,stretchX:Ne,stretchY:Be,content:ke}}C(null,he)}}return{cancel(){j&&(j.cancel(),j=null),W&&(W.cancel(),W=null)}}}(d,this.map._requestManager,(p,x)=>{if(this._spriteRequest=null,p)this.fire(new g.ErrorEvent(p));else if(x)for(const C in x)this.imageManager.addImage(C,x[C]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new g.Event("data",{dataType:"style"}))})}_validateLayer(d){const p=this.getSource(d.source);if(!p)return;const x=d.sourceLayer;x&&("geojson"===p.type||p.vectorLayerIds&&-1===p.vectorLayerIds.indexOf(x))&&this.fire(new g.ErrorEvent(new Error(`Source layer "${x}" does not exist on source "${p.id}" as specified by style layer "${d.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const d in this._sourceCaches)if(!this._sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(d){const p=[];for(const x of d){const C=this._layers[x];"custom"!==C.type&&p.push(C.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const d in this._sourceCaches)if(this._sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(d){return!!this.terrain&&("function"==typeof d.isLayerDraped?d.isLayerDraped():_f[d.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(d){if(!this._loaded)return;const p=this._changed;if(this._changed){const C=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(C.length||T.length)&&this._updateWorkerLayers(C,T);for(const P in this._updatedSources){const F=this._updatedSources[P];"reload"===F?this._reloadSource(P):"clear"===F&&this._clearSource(P)}this._updateTilesForChangedImages();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(d);this.light.updateTransitions(d),this.fog&&this.fog.updateTransitions(d),this._resetUpdates()}const x={};for(const C in this._sourceCaches){const T=this._sourceCaches[C];x[C]=T.used,T.used=!1}for(const C of this._order){const T=this._layers[C];if(T.recalculate(d,this._availableImages),!T.isHidden(d.zoom)){const F=this._getLayerSourceCache(T);F&&(F.used=!0)}const P=this.map.painter;if(P){const F=T.getProgramIds();if(!F)continue;const z=T.getProgramConfiguration(d.zoom);for(const j of F)P.useProgram(j,z)}}for(const C in x){const T=this._sourceCaches[C];x[C]!==T.used&&T.getSource().fire(new g.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(d),this.terrain&&this.terrain.recalculate(d),this.fog&&this.fog.recalculate(d),this.z=d.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new g.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const d=Object.keys(this._changedImages);if(d.length){for(const p in this._sourceCaches)this._sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}}_updateWorkerLayers(d,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(d),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(d){if(this._checkLoaded(),ju(this,g.validateStyle(d)))return!1;(d=g.clone$1(d)).layers=_d(d.layers);const p=function(C,T){if(!C)return[{command:Gr.setStyle,args:[T]}];let P=[];try{if(!gt(C.version,T.version))return[{command:Gr.setStyle,args:[T]}];gt(C.center,T.center)||P.push({command:Gr.setCenter,args:[T.center]}),gt(C.zoom,T.zoom)||P.push({command:Gr.setZoom,args:[T.zoom]}),gt(C.bearing,T.bearing)||P.push({command:Gr.setBearing,args:[T.bearing]}),gt(C.pitch,T.pitch)||P.push({command:Gr.setPitch,args:[T.pitch]}),gt(C.sprite,T.sprite)||P.push({command:Gr.setSprite,args:[T.sprite]}),gt(C.glyphs,T.glyphs)||P.push({command:Gr.setGlyphs,args:[T.glyphs]}),gt(C.transition,T.transition)||P.push({command:Gr.setTransition,args:[T.transition]}),gt(C.light,T.light)||P.push({command:Gr.setLight,args:[T.light]}),gt(C.fog,T.fog)||P.push({command:Gr.setFog,args:[T.fog]}),gt(C.projection,T.projection)||P.push({command:Gr.setProjection,args:[T.projection]});const F={},z=[];!function(K,ne,he,pe){let le;for(le in ne=ne||{},K=K||{})K.hasOwnProperty(le)&&(ne.hasOwnProperty(le)||yd(le,he,pe));for(le in ne){if(!ne.hasOwnProperty(le))continue;const me=ne[le];K.hasOwnProperty(le)?gt(K[le],me)||("geojson"===K[le].type&&"geojson"===me.type&&xg(K,ne,le)?he.push({command:Gr.setGeoJSONSourceData,args:[le,me.data]}):Ql(le,ne,he,pe)):Ms(le,ne,he)}}(C.sources,T.sources,z,F);const j=[];C.layers&&C.layers.forEach(K=>{K.source&&F[K.source]?P.push({command:Gr.removeLayer,args:[K.id]}):j.push(K)});let W=C.terrain;W&&F[W.source]&&(P.push({command:Gr.setTerrain,args:[void 0]}),W=void 0),P=P.concat(z),gt(W,T.terrain)||P.push({command:Gr.setTerrain,args:[T.terrain]}),function(K,ne,he){ne=ne||[];const pe=(K=K||[]).map(vd),le=ne.map(vd),me=K.reduce(Vu,{}),J=ne.reduce(Vu,{}),de=pe.slice(),be=Object.create(null);let xe,Ne,Be,ke,We,$e,Ye;for(xe=0,Ne=0;xe<pe.length;xe++)Be=pe[xe],J.hasOwnProperty(Be)?Ne++:(he.push({command:Gr.removeLayer,args:[Be]}),de.splice(de.indexOf(Be,Ne),1));for(xe=0,Ne=0;xe<le.length;xe++)Be=le[le.length-1-xe],de[de.length-1-xe]!==Be&&(me.hasOwnProperty(Be)?(he.push({command:Gr.removeLayer,args:[Be]}),de.splice(de.lastIndexOf(Be,de.length-Ne),1)):Ne++,$e=de[de.length-xe],he.push({command:Gr.addLayer,args:[J[Be],$e]}),de.splice(de.length-xe,0,Be),be[Be]=!0);for(xe=0;xe<le.length;xe++)if(Be=le[xe],ke=me[Be],We=J[Be],!be[Be]&&!gt(ke,We))if(gt(ke.source,We.source)&&gt(ke["source-layer"],We["source-layer"])&&gt(ke.type,We.type)){for(Ye in ec(ke.layout,We.layout,he,Be,null,Gr.setLayoutProperty),ec(ke.paint,We.paint,he,Be,null,Gr.setPaintProperty),gt(ke.filter,We.filter)||he.push({command:Gr.setFilter,args:[Be,We.filter]}),gt(ke.minzoom,We.minzoom)&&gt(ke.maxzoom,We.maxzoom)||he.push({command:Gr.setLayerZoomRange,args:[Be,We.minzoom,We.maxzoom]}),ke)ke.hasOwnProperty(Ye)&&"layout"!==Ye&&"paint"!==Ye&&"filter"!==Ye&&"metadata"!==Ye&&"minzoom"!==Ye&&"maxzoom"!==Ye&&(0===Ye.indexOf("paint.")?ec(ke[Ye],We[Ye],he,Be,Ye.slice(6),Gr.setPaintProperty):gt(ke[Ye],We[Ye])||he.push({command:Gr.setLayerProperty,args:[Be,Ye,We[Ye]]}));for(Ye in We)We.hasOwnProperty(Ye)&&!ke.hasOwnProperty(Ye)&&"layout"!==Ye&&"paint"!==Ye&&"filter"!==Ye&&"metadata"!==Ye&&"minzoom"!==Ye&&"maxzoom"!==Ye&&(0===Ye.indexOf("paint.")?ec(ke[Ye],We[Ye],he,Be,Ye.slice(6),Gr.setPaintProperty):gt(ke[Ye],We[Ye])||he.push({command:Gr.setLayerProperty,args:[Be,Ye,We[Ye]]}))}else he.push({command:Gr.removeLayer,args:[Be]}),$e=de[de.lastIndexOf(Be)+1],he.push({command:Gr.addLayer,args:[We,$e]})}(j,T.layers,P)}catch(F){console.warn("Unable to compute style diff:",F),P=[{command:Gr.setStyle,args:[T]}]}return P}(this.serialize(),d).filter(C=>!(C.command in Cc));if(0===p.length)return!1;const x=p.filter(C=>!(C.command in Mg));if(x.length>0)throw new Error(`Unimplemented: ${x.map(C=>C.command).join(", ")}.`);return p.forEach(C=>{"setTransition"!==C.command&&"setProjection"!==C.command&&this[C.command].apply(this,C.args)}),this.stylesheet=d,this._updateMapProjection(),!0}addImage(d,p){return this.getImage(d)?this.fire(new g.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(d,p),this._afterImageUpdated(d),this)}updateImage(d,p){this.imageManager.updateImage(d,p)}getImage(d){return this.imageManager.getImage(d)}removeImage(d){return this.getImage(d)?(this.imageManager.removeImage(d),this._afterImageUpdated(d),this):this.fire(new g.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new g.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(d,p,x={}){if(this._checkLoaded(),void 0!==this.getSource(d))throw new Error("There is already a source with this ID");if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(g.validateSource,`sources.${d}`,p,null,x))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const C=tr(d,p,this.dispatcher,this);C.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(d),source:C.serialize(),sourceId:d}));const T=P=>{const F=(P?"symbol:":"other:")+d,z=this._sourceCaches[F]=new g.SourceCache(F,C,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[d]=z,z.style=this,z.onAdd(this.map)};T(!1),"vector"!==p.type&&"geojson"!==p.type||T(!0),C.onAdd&&C.onAdd(this.map),this._changed=!0}removeSource(d){this._checkLoaded();const p=this.getSource(d);if(!p)throw new Error("There is no source with this ID");for(const C in this._layers)if(this._layers[C].source===d)return this.fire(new g.ErrorEvent(new Error(`Source "${d}" cannot be removed while layer "${C}" is using it.`)));if(this.terrain&&this.terrain.get().source===d)return this.fire(new g.ErrorEvent(new Error(`Source "${d}" cannot be removed while terrain is using it.`)));const x=this._getSourceCaches(d);for(const C of x)delete this._sourceCaches[C.id],delete this._updatedSources[C.id],C.fire(new g.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:C.getSource().id})),C.setEventedParent(null),C.clearTiles();return delete this._otherSourceCaches[d],delete this._symbolSourceCaches[d],p.setEventedParent(null),p.onRemove&&p.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(d,p){this._checkLoaded(),this.getSource(d).setData(p),this._changed=!0}getSource(d){const p=this._getSourceCache(d);return p&&p.getSource()}_getSources(){const d=[];for(const p in this._otherSourceCaches){const x=this._getSourceCache(p);x&&d.push(x.getSource())}return d}addLayer(d,p,x={}){this._checkLoaded();const C=d.id;if(this.getLayer(C))return void this.fire(new g.ErrorEvent(new Error(`Layer with id "${C}" already exists on this map`)));let T;if("custom"===d.type){if(ju(this,g.validateCustomStyleLayer(d)))return;T=g.createStyleLayer(d)}else{if("object"==typeof d.source&&(this.addSource(C,d.source),d=g.clone$1(d),d=g.extend(d,{source:C})),this._validate(g.validateLayer,`layers.${C}`,d,{arrayIndex:-1},x))return;T=g.createStyleLayer(d),this._validateLayer(T),T.setEventedParent(this,{layer:{id:C}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const P=p?this._order.indexOf(p):this._order.length;if(p&&-1===P)return void this.fire(new g.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`)));this._order.splice(P,0,C),this._layerOrderChanged=!0,this._layers[C]=T;const F=this._getLayerSourceCache(T);if(this._removedLayers[C]&&T.source&&F&&"custom"!==T.type){const z=this._removedLayers[C];delete this._removedLayers[C],z.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",F.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(d,p){if(this._checkLoaded(),this._changed=!0,!this._layers[d])return void this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be moved.`)));if(d===p)return;const x=this._order.indexOf(d);this._order.splice(x,1);const C=p?this._order.indexOf(p):this._order.length;p&&-1===C?this.fire(new g.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`))):(this._order.splice(C,0,d),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(d){this._checkLoaded();const p=this._layers[d];if(!p)return void this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be removed.`)));p.setEventedParent(null),this._updateLayerCount(p,!1);const x=this._order.indexOf(d);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=p,delete this._layers[d],delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],p.onRemove&&p.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(d){return this._layers[d]}hasLayer(d){return d in this._layers}hasLayerType(d){for(const p in this._layers)if(this._layers[p].type===d)return!0;return!1}setLayerZoomRange(d,p,x){this._checkLoaded();const C=this.getLayer(d);C?C.minzoom===p&&C.maxzoom===x||(null!=p&&(C.minzoom=p),null!=x&&(C.maxzoom=x),this._updateLayer(C)):this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(d,p,x={}){this._checkLoaded();const C=this.getLayer(d);if(C){if(!gt(C.filter,p))return null==p?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(g.validateFilter,`layers.${C.id}.filter`,p,{layerType:C.type},x)||(C.filter=g.clone$1(p),this._updateLayer(C)))}else this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be filtered.`)))}getFilter(d){const p=this.getLayer(d);return p&&g.clone$1(p.filter)}setLayoutProperty(d,p,x,C={}){this._checkLoaded();const T=this.getLayer(d);T?gt(T.getLayoutProperty(p),x)||(T.setLayoutProperty(p,x,C),this._updateLayer(T)):this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(d,p){const x=this.getLayer(d);if(x)return x.getLayoutProperty(p);this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style.`)))}setPaintProperty(d,p,x,C={}){this._checkLoaded();const T=this.getLayer(d);T?gt(T.getPaintProperty(p),x)||(T.setPaintProperty(p,x,C)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(d,p){const x=this.getLayer(d);return x&&x.getPaintProperty(p)}setFeatureState(d,p){this._checkLoaded();const x=d.source,C=d.sourceLayer,T=this.getSource(x);if(!T)return void this.fire(new g.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const P=T.type;if("geojson"===P&&C)return void this.fire(new g.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===P&&!C)return void this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===d.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided.")));const F=this._getSourceCaches(x);for(const z of F)z.setFeatureState(C,d.id,p)}removeFeatureState(d,p){this._checkLoaded();const x=d.source,C=this.getSource(x);if(!C)return void this.fire(new g.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const T=C.type,P="vector"===T?d.sourceLayer:void 0;if("vector"===T&&!P)return void this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(p&&"string"!=typeof d.id&&"number"!=typeof d.id)return void this.fire(new g.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const F=this._getSourceCaches(x);for(const z of F)z.removeFeatureState(P,d.id,p)}getFeatureState(d){this._checkLoaded();const p=d.source,x=d.sourceLayer,C=this.getSource(p);if(C){if("vector"!==C.type||x)return void 0===d.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(p)[0].getFeatureState(x,d.id);this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new g.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return g.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const d={};for(const p in this._sourceCaches){const x=this._sourceCaches[p].getSource();d[x.id]||(d[x.id]=x.serialize())}return g.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:d,layers:this._serializeLayers(this._order)},p=>void 0!==p)}_updateLayer(d){this._updatedLayers[d.id]=!0;const p=this._getLayerSourceCache(d);d.source&&!this._updatedSources[d.source]&&p&&"raster"!==p.getSource().type&&(this._updatedSources[d.source]="reload",p.pause()),this._changed=!0,d.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(d){const p=P=>"fill-extrusion"===this._layers[P].type,x={},C=[];for(let P=this._order.length-1;P>=0;P--){const F=this._order[P];if(p(F)){x[F]=P;for(const z of d){const j=z[F];if(j)for(const W of j)C.push(W)}}}C.sort((P,F)=>F.intersectionZ-P.intersectionZ);const T=[];for(let P=this._order.length-1;P>=0;P--){const F=this._order[P];if(p(F))for(let z=C.length-1;z>=0;z--){const j=C[z].feature;if(x[j.layer.id]<P)break;T.push(j),C.pop()}else for(const z of d){const j=z[F];if(j)for(const W of j)T.push(W.feature)}}return T}queryRenderedFeatures(d,p,x){p&&p.filter&&this._validate(g.validateFilter,"queryRenderedFeatures.filter",p.filter,null,p);const C={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new g.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of p.layers){const j=this._layers[z];if(!j)return this.fire(new g.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];C[j.source]=!0}}const T=[];p.availableImages=this._availableImages;const P=p&&p.layers?p.layers.some(z=>{const j=this.getLayer(z);return j&&j.is3D()}):this.has3DLayers(),F=Nu.createFromScreenPoints(d,x);for(const z in this._sourceCaches){const j=this._sourceCaches[z].getSource().id;p.layers&&!C[j]||T.push(zo(this._sourceCaches[z],this._layers,this._serializedLayers,F,p,x,P,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(z,j,W,K,ne,he,pe){const le={},me=he.queryRenderedSymbols(K),J=[];for(const de of Object.keys(me).map(Number))J.push(pe[de]);J.sort(Pa);for(const de of J){const be=de.featureIndex.lookupSymbolFeatures(me[de.bucketInstanceId],j,de.bucketIndex,de.sourceLayerIndex,ne.filter,ne.layers,ne.availableImages,z);for(const xe in be){const Ne=le[xe]=le[xe]||[],Be=be[xe];Be.sort((ke,We)=>{const $e=de.featureSortOrder;if($e){const Ye=$e.indexOf(ke.featureIndex);return $e.indexOf(We.featureIndex)-Ye}return We.featureIndex-ke.featureIndex});for(const ke of Be)Ne.push(ke)}}for(const de in le)le[de].forEach(be=>{const xe=be.feature,Ne=W(z[de]);if(!Ne)return;const Be=Ne.getFeatureState(xe.layer["source-layer"],xe.id);xe.source=xe.layer.source,xe.layer["source-layer"]&&(xe.sourceLayer=xe.layer["source-layer"]),xe.state=Be});return le}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),F.screenGeometry,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(d,p){p&&p.filter&&this._validate(g.validateFilter,"querySourceFeatures.filter",p.filter,null,p);const x=this._getSourceCaches(d);let C=[];for(const T of x)C=C.concat(Tr(T,p));return C}addSourceType(d,p,x){return Xd.getSourceType(d)?x(new Error(`A source type called "${d}" already exists.`)):(Xd.setSourceType(d,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:d,url:p.workerSourceURL},x):x(null,null))}getLight(){return this.light.getLight()}setLight(d,p={}){this._checkLoaded();const x=this.light.getLight();let C=!1;for(const P in d)if(!gt(d[P],x[P])){C=!0;break}if(!C)return;const T=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(d,p),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(d,p=1){if(this._checkLoaded(),!d)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let x=d;if(1===p){if("object"==typeof x.source){const C="terrain-dem-src";this.addSource(C,x.source),x=g.clone$1(x),x=g.extend(x,{source:C})}if(this._validate(g.validateTerrain,"terrain",x))return}if(!this.terrain||this.terrain&&p!==this.terrain.drapeRenderMode){if(!x)return;this._createTerrain(x,p)}else{const C=this.terrain,T=C.get();for(const P of Object.keys(g.spec.terrain))!x.hasOwnProperty(P)&&g.spec.terrain[P].default&&(x[P]=g.spec.terrain[P].default);for(const P in x)if(!gt(x[P],T[P])){C.set(x),this.stylesheet.terrain=x;const F=this._setTransitionParameters({duration:0});C.updateTransitions(F);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(d){const p=this.fog=new Th(d,this.map.transform);this.stylesheet.fog=d;const x=this._setTransitionParameters({duration:0});p.updateTransitions(x)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const d of this.map._markers)d._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(d){if(this._checkLoaded(),!d)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const p=this.fog,x=p.get();0===Object.keys(d).length&&p.set(d);for(const C in d)if(!gt(d[C],x[C])){p.set(d),this.stylesheet.fog=d;const T=this._setTransitionParameters({duration:0});p.updateTransitions(T);break}}else this._createFog(d);this._markersNeedUpdate=!0}_setTransitionParameters(d){return{now:g.exported.now(),transition:g.extend(d,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const d=this._order.filter(x=>this.isLayerDraped(this._layers[x])),p=this._order.filter(x=>!this.isLayerDraped(this._layers[x]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...d),this._drapedFirstOrder.push(...p)}_createTerrain(d,p){const x=this.terrain=new hm(d,p);this.stylesheet.terrain=d,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const C=this._setTransitionParameters({duration:0});x.updateTransitions(C)}_force3DLayerUpdate(){for(const d in this._layers){const p=this._layers[d];"fill-extrusion"===p.type&&this._updateLayer(p)}}_forceSymbolLayerUpdate(){for(const d in this._layers){const p=this._layers[d];"symbol"===p.type&&this._updateLayer(p)}}_validate(d,p,x,C,T={}){return(!T||!1!==T.validate)&&ju(this,d.call(g.validateStyle,g.extend({key:p,style:this.serialize(),value:x,styleSpec:g.spec},C)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),g.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this._sourceCaches)this._sourceCaches[d].clearTiles(),this._sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(d){const p=this._getSourceCaches(d);for(const x of p)x.clearTiles()}_reloadSource(d){const p=this._getSourceCaches(d);for(const x of p)x.resume(),x.reload()}_reloadSources(){for(const d of this._getSources())d.reload&&d.reload()}_updateSources(d){for(const p in this._sourceCaches)this._sourceCaches[p].update(d)}_generateCollisionBoxes(){for(const d in this._sourceCaches){const p=this._sourceCaches[d];p.resume(),p.reload()}}_updatePlacement(d,p,x,C,T=!1){let P=!1,F=!1;const z={};for(const j of this._order){const W=this._layers[j];if("symbol"!==W.type)continue;if(!z[W.source]){const ne=this._getLayerSourceCache(W);if(!ne)continue;z[W.source]=ne.getRenderableIds(!0).map(he=>ne.getTileByID(he)).sort((he,pe)=>pe.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(pe.tileID)?-1:1))}const K=this.crossTileSymbolIndex.addLayer(W,z[W.source],d.center.lng,d.projection);P=P||K}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||0===x,this._layerOrderChanged&&this.fire(new g.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(g.exported.now(),d.zoom))&&(this.pauseablePlacement=new Y_(d,this._order,T,p,x,C,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(g.exported.now()),F=!0),P&&this.pauseablePlacement.placement.setStale()),F||P)for(const j of this._order){const W=this._layers[j];"symbol"===W.type&&this.placement.updateLayerOpacities(W,z[W.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(g.exported.now())}_releaseSymbolFadeTiles(){for(const d in this._sourceCaches)this._sourceCaches[d].releaseSymbolFadeTiles()}getImages(d,p,x){this.imageManager.getImages(p.icons,x),this._updateTilesForChangedImages();const C=T=>{T&&T.setDependencies(p.tileID.key,p.type,p.icons)};C(this._otherSourceCaches[p.source]),C(this._symbolSourceCaches[p.source])}getGlyphs(d,p,x){this.glyphManager.getGlyphs(p.stacks,x)}getResource(d,p,x){return g.makeRequest(p,x)}_getSourceCache(d){return this._otherSourceCaches[d]}_getLayerSourceCache(d){return"symbol"===d.type?this._symbolSourceCaches[d.source]:this._otherSourceCaches[d.source]}_getSourceCaches(d){const p=[];return this._otherSourceCaches[d]&&p.push(this._otherSourceCaches[d]),this._symbolSourceCaches[d]&&p.push(this._symbolSourceCaches[d]),p}_isSourceCacheLoaded(d){const p=this._getSourceCaches(d);return 0===p.length?(this.fire(new g.ErrorEvent(new Error(`There is no source with ID '${d}'`))),!1):p.every(x=>x.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Xd.getSourceType=function(v){return An[v]},Xd.setSourceType=function(v,d){An[v]=d},Xd.registerForPluginStateChange=g.registerForPluginStateChange;var Eg="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Qt="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",is="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Rn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Oa="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let yf={},Zd={};const Na=[];kh(Eg,Na),kh(is,Na),kh(Rn,Na),kh(Oa,Na),yf=xi("",is),Zd=xi(Oa,Rn);const ym=xi("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Wu=Eg,Ip="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var vf={background:xi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:xi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:xi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:xi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:xi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:xi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:xi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:xi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:xi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:xi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:xi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:xi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:xi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:xi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:xi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:xi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:xi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:xi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:xi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:xi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:xi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:xi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:xi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:xi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:xi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Qt),skyboxGradient:xi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Qt),skyboxCapture:xi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:xi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:xi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function kh(v,d){const p=v.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let x of p)if(x=x.trim(),"#"===x[0]&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const C=x.split(" ");for(const T of C)d.includes(T)||d.push(T)}}function xi(v,d){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=d.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),C={},T=[...Na];return kh(v,T),kh(d,T),{fragmentSource:v=v.replace(p,(P,F,z,j,W)=>(C[W]=!0,"define"===F?`\n#ifndef HAS_UNIFORM_u_${W}\nvarying ${z} ${j} ${W};\n#else\nuniform ${z} ${j} u_${W};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${W}\n    ${z} ${j} ${W} = u_${W};\n#endif\n`)),vertexSource:d=d.replace(p,(P,F,z,j,W)=>{const K="float"===j?"vec2":"vec4",ne=W.match(/color/)?"color":K;return C[W]?"define"===F?`\n#ifndef HAS_UNIFORM_u_${W}\nuniform lowp float u_${W}_t;\nattribute ${z} ${K} a_${W};\nvarying ${z} ${j} ${W};\n#else\nuniform ${z} ${j} u_${W};\n#endif\n`:"vec4"===ne?`\n#ifndef HAS_UNIFORM_u_${W}\n    ${W} = a_${W};\n#else\n    ${z} ${j} ${W} = u_${W};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${W}\n    ${W} = unpack_mix_${ne}(a_${W}, u_${W}_t);\n#else\n    ${z} ${j} ${W} = u_${W};\n#endif\n`:"define"===F?`\n#ifndef HAS_UNIFORM_u_${W}\nuniform lowp float u_${W}_t;\nattribute ${z} ${K} a_${W};\n#else\nuniform ${z} ${j} u_${W};\n#endif\n`:"vec4"===ne?`\n#ifndef HAS_UNIFORM_u_${W}\n    ${z} ${j} ${W} = a_${W};\n#else\n    ${z} ${j} ${W} = u_${W};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${W}\n    ${z} ${j} ${W} = unpack_mix_${ne}(a_${W}, u_${W}_t);\n#else\n    ${z} ${j} ${W} = u_${W};\n#endif\n`}),staticAttributes:x,usedDefines:T}}class ol{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(d,p,x,C,T,P,F){this.context=d;let z=this.boundPaintVertexBuffers.length!==C.length;for(let W=0;!z&&W<C.length;W++)this.boundPaintVertexBuffers[W]!==C[W]&&(z=!0);let j=this.boundDynamicVertexBuffers.length!==F.length;for(let W=0;!j&&W<F.length;W++)this.boundDynamicVertexBuffers[W]!==F[W]&&(j=!0);if(!d.extVertexArrayObject||!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==x||z||j||this.boundIndexBuffer!==T||this.boundVertexOffset!==P)this.freshBind(p,x,C,T,P,F);else{d.bindVertexArrayOES.set(this.vao);for(const W of F)W&&W.bind();T&&T.dynamicDraw&&T.bind()}}freshBind(d,p,x,C,T,P){let F;const z=d.numAttributes,j=this.context,W=j.gl;if(j.extVertexArrayObject)this.vao&&this.destroy(),this.vao=j.extVertexArrayObject.createVertexArrayOES(),j.bindVertexArrayOES.set(this.vao),F=0,this.boundProgram=d,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=C,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=P;else{F=j.currentNumAttributes||0;for(let K=z;K<F;K++)W.disableVertexAttribArray(K)}p.enableAttributes(W,d),p.bind(),p.setVertexAttribPointers(W,d,T);for(const K of x)K.enableAttributes(W,d),K.bind(),K.setVertexAttribPointers(W,d,T);for(const K of P)K&&(K.enableAttributes(W,d),K.bind(),K.setVertexAttribPointers(W,d,T));C&&C.bind(),j.currentNumAttributes=z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function vm(v,d){const p=Math.pow(2,d.canonical.z),x=d.canonical.y;return[new g.MercatorCoordinate(0,x/p).toLngLat().lat,new g.MercatorCoordinate(0,(x+1)/p).toLngLat().lat]}function Uo(v,d,p,x,C,T,P){const F=v.context,z=F.gl,j=p.fbo;if(!j)return;v.prepareDrawTile();const W=v.useProgram("hillshade");F.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,j.colorAttachment.get());const K=((le,me,J,de)=>{const be=J.paint.get("hillshade-shadow-color"),xe=J.paint.get("hillshade-highlight-color"),Ne=J.paint.get("hillshade-accent-color");let Be=J.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===J.paint.get("hillshade-illumination-anchor")&&(Be-=le.transform.angle);const ke=!le.options.moving;return{u_matrix:de||le.transform.calculateProjMatrix(me.tileID.toUnwrapped(),ke),u_image:0,u_latrange:vm(0,me.tileID),u_light:[J.paint.get("hillshade-exaggeration"),Be],u_shadow:be,u_highlight:xe,u_accent:Ne}})(v,p,x,v.terrain?d.projMatrix:null);v.prepareDrawProgram(F,W,d.toUnwrapped());const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:he,tileBoundsSegments:pe}=v.getTileBoundsBuffers(p);W.draw(F,z.TRIANGLES,C,T,P,g.CullFaceMode.disabled,K,x.id,ne,he,pe)}function bm(v,d,p){if(!d.needsDEMTextureUpload)return;const x=v.context,C=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),d.demTexture=d.demTexture||v.getTileTexture(p.stride);const T=p.getPixels();d.demTexture?d.demTexture.update(T,{premultiply:!1}):d.demTexture=new g.Texture(x,T,C.RGBA,{premultiply:!1}),d.needsDEMTextureUpload=!1}function J_(v,d,p,x,C,T){const P=v.context,F=P.gl;if(!d.dem)return;const z=d.dem;if(P.activeTexture.set(F.TEXTURE1),bm(v,d,z),!d.demTexture)return;d.demTexture.bind(F.NEAREST,F.CLAMP_TO_EDGE);const j=z.dim;P.activeTexture.set(F.TEXTURE0);let W=d.fbo;if(!W){const pe=new g.Texture(P,{width:j,height:j,data:null},F.RGBA);pe.bind(F.LINEAR,F.CLAMP_TO_EDGE),W=d.fbo=P.createFramebuffer(j,j,!0),W.colorAttachment.set(pe.texture)}P.bindFramebuffer.set(W.framebuffer),P.viewport.set([0,0,j,j]);const{tileBoundsBuffer:K,tileBoundsIndexBuffer:ne,tileBoundsSegments:he}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(P,F.TRIANGLES,x,C,T,g.CullFaceMode.disabled,((pe,le)=>{const me=le.stride,J=g.create();return g.ortho(J,0,g.EXTENT,-g.EXTENT,0,0,1),g.translate(J,J,[0,-g.EXTENT,0]),{u_matrix:J,u_image:1,u_dimension:[me,me],u_zoom:pe.overscaledZ,u_unpack:le.unpackVector}})(d.tileID,z),p.id,K,ne,he),d.needsHillshadePrepare=!1}const Nr=v=>({u_matrix:new g.UniformMatrix4f(v),u_image0:new g.Uniform1i(v),u_skirt_height:new g.Uniform1f(v)}),$u=(v,d)=>({u_matrix:v,u_image0:0,u_skirt_height:d}),bf=(v,d,p,x,C,T,P,F,z,j,W,K,ne,he,pe)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:d,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:p,u_zoom_transition:C,u_merc_center:T,u_image0:0,u_frustum_tl:P,u_frustum_tr:F,u_frustum_br:z,u_frustum_bl:j,u_globe_pos:W,u_globe_radius:K,u_viewport:ne,u_grid_matrix:pe?Float32Array.from(pe):new Float32Array(9),u_skirt_height:he});function Ro(v,d){return null!=v&&null!=d&&!(!v.hasData()||!d.hasData())&&null!=v.demTexture&&null!=d.demTexture&&v.tileID.key!==d.tileID.key}const Ls=new class{constructor(){this.operations={}}newMorphing(v,d,p,x,C){if(v in this.operations){const T=this.operations[v];T.to.tileID.key!==p.tileID.key&&(T.queued=p)}else this.operations[v]={startTime:x,phase:0,duration:C,from:d,to:p,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const d=this.operations[v];return{from:d.from,to:d.to,phase:d.phase}}update(v){for(const d in this.operations){const p=this.operations[d];for(p.phase=(v-p.startTime)/p.duration;p.phase>=1||!this._validOp(p);)if(!this._nextOp(p,v)){delete this.operations[d];break}}}_nextOp(v,d){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=d,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},Yc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Rh(v){return 6*Math.pow(1.5,22-v)}function xm(v,d){const p=1<<v.z;return!d&&(0===v.x||v.x===p-1)||0===v.y||v.y===p-1}const xf=v=>({u_matrix:v});function Cg(v,d,p,x,C){if(C>0){const T=g.exported.now(),P=(T-v.timeAdded)/C,F=d?(T-d.timeAdded)/C:-1,z=p.getSource(),j=x.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),W=!d||Math.abs(d.tileID.overscaledZ-j)>Math.abs(v.tileID.overscaledZ-j),K=W&&v.refreshedUponExpiration?1:g.clamp(W?P:1-F,0,1);return v.refreshedUponExpiration&&P>=1&&(v.refreshedUponExpiration=!1),d?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}class wm extends g.SourceCache{constructor(d){const p={type:"raster-dem",maxzoom:d.transform.maxZoom},x=new Cn(Tp(),null),C=tr("mock-dem",p,x,d.style);super("mock-dem",C,!1),C.setEventedParent(this),this._sourceLoaded=!0}_loadTile(d,p){d.state="loaded",p(null)}}class xd extends g.SourceCache{constructor(d){const p=tr("proxy",{type:"geojson",maxzoom:d.transform.maxZoom},new Cn(Tp(),null),d.style);super("proxy",p,!1),p.setEventedParent(this),this.map=this.getSource().map=d,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(d,p,x){if(d.freezeTileCoverage)return;this.transform=d;const C=d.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,P)=>{if(T[P.key]="",!this._tiles[P.key]){const F=new g.Tile(P,this._source.tileSize*P.overscaleFactor(),d.tileZoom);F.state="loaded",this._tiles[P.key]=F}return T},{});for(const T in this._tiles)T in C||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(d){const p=this.proxyCachedFBO[d];if(void 0!==p){const x=Object.values(p);this.renderCachePool.push(...x),delete this.proxyCachedFBO[d]}}deallocRenderCache(){this.renderCache.forEach(d=>d.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ph extends g.OverscaledTileID{constructor(d,p,x){super(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y),this.proxyTileKey=p,this.projMatrix=x}}class sl extends g.Elevation{constructor(d,p){super(),this.painter=d,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,C,T]=function(z){const j=new g.StructArrayLayout2i4,W=new g.StructArrayLayout3ui6,K=131;j.reserve(17161),W.reserve(33800);const ne=g.EXTENT/128,he=g.EXTENT+ne/2,pe=he+ne;for(let me=-ne;me<pe;me+=ne)for(let J=-ne;J<pe;J+=ne){const de=J<0||J>he||me<0||me>he?24575:0,be=g.clamp(Math.round(J),0,g.EXTENT),xe=g.clamp(Math.round(me),0,g.EXTENT);j.emplaceBack(be+de,xe)}const le=(me,J)=>{const de=J*K+me;W.emplaceBack(de+1,de,de+K),W.emplaceBack(de+K,de+K+1,de+1)};for(let me=1;me<129;me++)for(let J=1;J<129;J++)le(J,me);return[0,129].forEach(me=>{for(let J=0;J<130;J++)le(J,me),le(me,J)}),[j,W,32768]}(),P=d.context;this.gridBuffer=P.createVertexBuffer(x,g.posAttributes.members),this.gridIndexBuffer=P.createIndexBuffer(C),this.gridSegments=g.SegmentVector.simpleSegment(0,0,x.length,C.length),this.gridNoSkirtSegments=g.SegmentVector.simpleSegment(0,0,x.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new xd(p.map),this.orthoMatrix=g.create(),g.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,g.EXTENT,0,g.EXTENT,0,1);const F=P.gl;this._overlapStencilMode=new g.StencilMode({func:F.GEQUAL,mask:255},0,255,F.KEEP,F.KEEP,F.REPLACE),this._previousZoom=d.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=p,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new wm(p.map)}set style(d){d.on("data",this._onStyleDataEvent.bind(this)),d.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=d,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(d,p,x){if(d&&d.terrain){this._style!==d&&(this.style=d),this.enabled=!0;const C=d.terrain.properties;this.sourceCache=0===d.terrain.drapeRenderMode?this._mockSourceCache:d._getSourceCache(C.get("source")),this._exaggeration=C.get("exaggeration");const T=()=>{this.sourceCache.used&&g.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(p,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),p.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(p),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(d){this._findCoveringTileCache[d]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const d=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==d.efficiency&&g.warnOnce(`Terrain render cache efficiency is not optimal (${d.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${d.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(d){d.coord&&"source"===d.dataType?this._clearRenderCacheForTile(d.sourceCacheId,d.coord):"style"===d.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const d in this._style._sourceCaches)this._style._sourceCaches[d].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(d=>d.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const d=2*this.proxySourceCache.getSource().tileSize;return[d,d]}set useVertexMorphing(d){this._useVertexMorphing=d}updateTileBinding(d){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const p=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=0===x._centerAltitude&&-1===this.getAtPointOrZero(g.MercatorCoordinate.fromLngLat(x.center),-1),this._emptyDEMTextureDirty=!this._initializing);const C=this.proxyCoords=p.getIds().map(z=>{const j=p.getTileByID(z).tileID;return j.projMatrix=x.calculateProjMatrix(j.toUnwrapped()),j});(function(z,j){const W=j.transform.pointCoordinate(j.transform.getCameraPoint()),K=new g.Point(W.x,W.y);z.sort((ne,he)=>{if(he.overscaledZ-ne.overscaledZ)return he.overscaledZ-ne.overscaledZ;const pe=new g.Point(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),le=new g.Point(he.canonical.x+(1<<he.canonical.z)*he.wrap,he.canonical.y),me=K.mult(1<<ne.canonical.z);return me.x-=.5,me.y-=.5,me.distSqr(pe)-me.distSqr(le)})})(C,this.painter),this._previousZoom=x.zoom;const T=this.proxyToSource||{};this.proxyToSource={},C.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const P=this._style._sourceCaches;for(const z in P){const j=P[z];if(!j.used||(j!==this.sourceCache&&this.resetTileLookupCache(j.id),this._setupProxiedCoordsForOrtho(j,d[z],T),j.usedForTerrain))continue;const W=d[z];j.getSource().reparseOverscaled&&this._assignTerrainTiles(W)}this.proxiedCoords[p.id]=C.map(z=>new Ph(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(C),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=g.exported.now();const F={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const j=this.terrainTileForTile[z.key];if(!j)continue;const W=j.tileID.key;W in F||(this._visibleDemTiles.push(j),F[W]=W)}}_assignTerrainTiles(d){this._initializing||d.forEach(p=>{if(this.terrainTileForTile[p.key])return;const x=this._findTileCoveringTileID(p,this.sourceCache);x&&(this.terrainTileForTile[p.key]=x)})}_prepareDEMTextures(){const d=this.painter.context,p=d.gl;for(const x in this.terrainTileForTile){const C=this.terrainTileForTile[x],T=C.dem;!T||C.demTexture&&!C.needsDEMTextureUpload||(d.activeTexture.set(p.TEXTURE1),bm(this.painter,C,T))}}_prepareDemTileUniforms(d,p,x,C){if(!p||null==p.demTexture)return!1;const T=d.tileID.canonical,P=Math.pow(2,p.tileID.canonical.z-T.z),F=C||"";return x[`u_dem_tl${F}`]=[T.x*P%1,T.y*P%1],x[`u_dem_scale${F}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const d=this.painter.context,p=d.gl;if(!this._emptyDepthBufferTexture){const x=new g.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new g.Texture(d,x,p.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let d=0;const p=this._visibleDemTiles.reduce((x,C)=>{if(!C.dem)return x;const T=C.dem.tree.minimums[0];return T>0&&d++,x+T},0);return d?p/d:0}_updateEmptyDEMTexture(){const d=this.painter.context,p=d.gl;d.activeTexture.set(p.TEXTURE2);const x=this._getLoadedAreaMinimum(),C=new g.RGBAImage({width:1,height:1},new Uint8Array(g.DEMData.pack(x,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(C,{premultiply:!1}):T=this._emptyDEMTexture=new g.Texture(d,C,p.RGBA,{premultiply:!1}),T}setupElevationDraw(d,p,x){const C=this.painter.context,T=C.gl,P=(F=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:g.DEMData.getUnpackVector(F),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var F;P.u_dem_size=this.sourceCache.getSource().tileSize,P.u_exaggeration=this.exaggeration();let z=null,j=null,W=1;if(x&&x.morphing&&this._useVertexMorphing){const K=x.morphing.srcDemTile,ne=x.morphing.dstDemTile;W=x.morphing.phase,K&&ne&&(this._prepareDemTileUniforms(d,K,P,"_prev")&&(j=K),this._prepareDemTileUniforms(d,ne,P)&&(z=ne))}if(j&&z?(C.activeTexture.set(T.TEXTURE2),z.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),C.activeTexture.set(T.TEXTURE4),j.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),P.u_dem_lerp=W):(z=this.terrainTileForTile[d.tileID.key],C.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(d,z,P)?z.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),C.activeTexture.set(T.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&z){const K=(1<<z.tileID.canonical.z)*g.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=K}if(x&&x.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),p.setTerrainUniformValues(C,P),"globe"===this.painter.transform.projection.name){const K=this.globeUniformValues(this.painter.transform,d.tileID.canonical,x&&x.useDenormalizedUpVectorScale);p.setGlobeUniformValues(C,K)}}globeUniformValues(d,p,x){const C=d.projection;return{u_tile_tl_up:C.upVector(p,0,0),u_tile_tr_up:C.upVector(p,g.EXTENT,0),u_tile_br_up:C.upVector(p,g.EXTENT,g.EXTENT),u_tile_bl_up:C.upVector(p,0,g.EXTENT),u_tile_up_scale:x?g.globeMetersToEcef(1):C.upVectorScale(p,d.center.lat,d.worldSize).metersToTile}}renderToBackBuffer(d){const p=this.painter,x=this.painter.context;0!==d.length&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,p.width,p.height]),p.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(C,T,P,F,z){if("globe"===C.transform.projection.name)!function(j,W,K,ne,he){const pe=j.context,le=pe.gl;let me,J;const de=j.options.showTerrainWireframe?2:0,be=j.transform,xe=g.globeUseCustomAntiAliasing(j,pe,be),Ne=(Rt,tt)=>{if(J===Rt)return;const Mt=[Yc[Rt],"PROJECTION_GLOBE_VIEW"];xe&&Mt.push("CUSTOM_ANTIALIASING"),tt&&Mt.push(Yc[de]),me=j.useProgram("globeRaster",null,Mt),J=Rt},Be=j.colorModeForRenderPass(),ke=new g.DepthMode(le.LEQUAL,g.DepthMode.ReadWrite,j.depthRangeFor3D);Ls.update(he);const We=g.calculateGlobeMercatorMatrix(be),$e=[g.mercatorXfromLng(be.center.lng),g.mercatorYfromLat(be.center.lat)],Ye=de?[!1,!0]:[!1],St=j.globeSharedBuffers,Je=[be.width*g.exported.devicePixelRatio,be.height*g.exported.devicePixelRatio],vt=Float32Array.from(be.globeMatrix),et={useDenormalizedUpVectorScale:!0};if(Ye.forEach(Rt=>{const tt=j.transform,Mt=Rh(tt.zoom)*W.exaggeration();J=-1;const Nt=Rt?le.LINES:le.TRIANGLES;for(const Bt of ne){const Zt=K.getTile(Bt),$i=g.StencilMode.disabled,Qi=W.prevTerrainTileForTile[Bt.key],Ai=W.terrainTileForTile[Bt.key];Ro(Qi,Ai)&&Ls.newMorphing(Bt.key,Qi,Ai,he,250),pe.activeTexture.set(le.TEXTURE0),Zt.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const nn=Ls.getMorphValuesForProxy(Bt.key),sr=nn?1:0;nn&&g.extend$1(et,{morphing:{srcDemTile:nn.from,dstDemTile:nn.to,phase:g.easeCubicInOut(nn.phase)}});const Bn=g.tileCornersToBounds(Bt.canonical),Bi=g.getLatitudinalLod(Bn.getCenter().lat),Jr=g.getGridMatrix(Bt.canonical,Bn,Bi,tt.worldSize/tt._pixelsPerMercatorPixel),Di=g.globeNormalizeECEF(g.globeTileBounds(Bt.canonical)),no=bf(tt.projMatrix,vt,We,Di,g.globeToMercatorTransition(tt.zoom),$e,tt.frustumCorners.TL,tt.frustumCorners.TR,tt.frustumCorners.BR,tt.frustumCorners.BL,tt.globeCenterInViewSpace,tt.globeRadius,Je,Mt,Jr);if(Ne(sr,Rt),W.setupElevationDraw(Zt,me,et),j.prepareDrawProgram(pe,me,Bt.toUnwrapped()),St){const[To,za,ua]=Rt?St.getWirefameBuffers(j.context,Bi):St.getGridBuffers(Bi,0!==Mt);me.draw(pe,Nt,ke,$i,Be,g.CullFaceMode.backCCW,no,"globe_raster",To,za,ua)}}}),St){const Rt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];xe&&Rt.push("CUSTOM_ANTIALIASING"),me=j.useProgram("globeRaster",null,Rt);for(const tt of ne){const{x:Mt,y:Nt,z:Bt}=tt.canonical,Zt=0===Nt,$i=Nt===(1<<Bt)-1,[Qi,Ai,nn,sr]=St.getPoleBuffers(Bt);if(sr&&(Zt||$i)){const Bn=K.getTile(tt);pe.activeTexture.set(le.TEXTURE0),Bn.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);let Bi=g.globePoleMatrixForTile(Bt,Mt,be);const Jr=g.globeNormalizeECEF(g.globeTileBounds(tt.canonical)),Di=(no,To)=>no.draw(pe,le.TRIANGLES,ke,g.StencilMode.disabled,Be,g.CullFaceMode.disabled,bf(be.projMatrix,Bi,Bi,Jr,0,$e,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,Je,0),"globe_pole_raster",To,nn,sr);W.setupElevationDraw(Bn,me,et),j.prepareDrawProgram(pe,me,tt.toUnwrapped()),Zt&&Di(me,Qi),$i&&(Bi=g.scale(g.create(),Bi,[1,-1,1]),Di(me,Ai))}}}}(C,T,P,F,z);else{const j=C.context,W=j.gl;let K,ne;const he=C.options.showTerrainWireframe?2:0,pe=(be,xe)=>{if(ne===be)return;const Ne=[Yc[be]];xe&&Ne.push(Yc[he]),K=C.useProgram("terrainRaster",null,Ne),ne=be},le=C.colorModeForRenderPass(),me=new g.DepthMode(W.LEQUAL,g.DepthMode.ReadWrite,C.depthRangeFor3D);Ls.update(z);const J=C.transform,de=Rh(J.zoom)*T.exaggeration();(he?[!1,!0]:[!1]).forEach(be=>{ne=-1;const xe=be?W.LINES:W.TRIANGLES,[Ne,Be]=be?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const ke of F){const We=P.getTile(ke),$e=g.StencilMode.disabled,Ye=T.prevTerrainTileForTile[ke.key],St=T.terrainTileForTile[ke.key];Ro(Ye,St)&&Ls.newMorphing(ke.key,Ye,St,z,250),j.activeTexture.set(W.TEXTURE0),We.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST);const Je=Ls.getMorphValuesForProxy(ke.key),vt=Je?1:0;let et;Je&&(et={morphing:{srcDemTile:Je.from,dstDemTile:Je.to,phase:g.easeCubicInOut(Je.phase)}});const Rt=$u(ke.projMatrix,xm(ke.canonical,J.renderWorldCopies)?de/10:de);pe(vt,be),T.setupElevationDraw(We,K,et),C.prepareDrawProgram(j,K,ke.toUnwrapped()),K.draw(j,xe,me,$e,le,g.CullFaceMode.backCCW,Rt,"terrain_raster",T.gridBuffer,Ne,Be)}})}}(p,this,this.proxySourceCache,d,this._updateTimestamp),this.renderingToTexture=!0,p.gpuTimingDeferredRenderEnd(),d.splice(0,d.length))}renderBatch(d){if(0===this._drapedRenderBatches.length)return d+1;this.renderingToTexture=!0;const p=this.painter,x=this.painter.context,C=this.proxySourceCache,T=this.proxiedCoords[C.id],P=this._drapedRenderBatches.shift(),F=[],z=p.style.order;let j=0;for(const W of T){const K=C.getTileByID(W.proxyTileKey),ne=C.proxyCachedFBO[W.key]?C.proxyCachedFBO[W.key][d]:void 0,he=void 0!==ne?C.renderCache[ne]:this.pool[j++],pe=void 0!==ne;if(K.texture=he.tex,pe&&!he.dirty){F.push(K.tileID);continue}let le;x.bindFramebuffer.set(he.fb.framebuffer),this.renderedToTile=!1,he.dirty&&(x.clear({color:g.Color.transparent,stencil:0}),he.dirty=!1);for(let me=P.start;me<=P.end;++me){const J=p.style._layers[z[me]];if(J.isHidden(p.transform.zoom))continue;const de=p.style._getLayerSourceCache(J),be=de?this.proxyToSource[W.key][de.id]:[W];if(!be)continue;const xe=be;x.viewport.set([0,0,he.fb.width,he.fb.height]),le!==(de?de.id:null)&&(this._setupStencil(he,be,J,de),le=de?de.id:null),p.renderLayer(p,de,J,xe)}this.renderedToTile?(he.dirty=!0,F.push(K.tileID)):pe||--j,5===j&&(j=0,this.renderToBackBuffer(F))}return this.renderToBackBuffer(F),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,p.width,p.height]),P.end+1}postRender(){}renderCacheEfficiency(d){const p=d.order.length;if(0===p)return{efficiency:100};let x,C=0,T=0,P=!1;for(let F=0;F<p;++F){const z=d._layers[d.order[F]];this._style.isLayerDraped(z)?(P&&++C,++T):P||(P=!0,x=z.id)}return 0===T?{efficiency:100}:{efficiency:100*(1-C/T),firstUndrapedLayer:x}}getMinElevationBelowMSL(){let d=0;return this._visibleDemTiles.filter(p=>p.dem).forEach(p=>{d=Math.min(d,p.dem.tree.minimums[0])}),0===d?d:(d-30)*this._exaggeration}raycast(d,p,x){if(!this._visibleDemTiles)return null;const C=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const P=T.tileID,F=1<<P.overscaledZ,{x:z,y:j}=P.canonical,W=z/F,K=(z+1)/F,ne=j/F,he=(j+1)/F;return{minx:W,miny:ne,maxx:K,maxy:he,t:T.dem.tree.raycastRoot(W,ne,K,he,d,p,x),tile:T}});C.sort((T,P)=>(null!==T.t?T.t:Number.MAX_VALUE)-(null!==P.t?P.t:Number.MAX_VALUE));for(const T of C){if(null==T.t)return null;const P=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,d,p,x);if(null!=P)return P}return null}_createFBO(){const d=this.painter.context,p=d.gl,x=this.drapeBufferSize;d.activeTexture.set(p.TEXTURE0);const C=new g.Texture(d,{width:x[0],height:x[1],data:null},p.RGBA);C.bind(p.LINEAR,p.CLAMP_TO_EDGE);const T=d.createFramebuffer(x[0],x[1],!1);return T.colorAttachment.set(C.texture),T.depthAttachment=new Ge(d,T.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=d.createRenderbuffer(d.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),d.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),d.extTextureFilterAnisotropic&&!d.extTextureFilterAnisotropicForceOff&&p.texParameterf(p.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax),{fb:T,tex:C,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d].hasTransition())return!0;return this._style.order.some(d=>{const p=this._style._layers[d],x=p.isHidden(this.painter.transform.zoom);return"custom"===p.type?!x&&p.shouldRedrape():!x&&p.hasTransition()})}_clearLineLayersFromRenderCache(){let d=!1;for(const x of this._style._getSources())if(x instanceof fi){d=!0;break}if(!d)return;const p={};for(let x=0;x<this._style.order.length;++x){const C=this._style._layers[this._style.order[x]],T=this._style._getLayerSourceCache(C);if(T&&!p[T.id]&&!C.isHidden(this.painter.transform.zoom)&&"line"===C.type&&C.widthExpression()instanceof g.ZoomDependentExpression){p[T.id]=!0;for(const P of this.proxyCoords){const F=this.proxyToSource[P.key][T.id];if(F)for(const z of F)this._clearRenderCacheForTile(T.id,z)}}}}_clearRasterLayersFromRenderCache(){let d=!1;for(const x in this._style._sourceCaches)if(this._style._sourceCaches[x]._source instanceof Kt){d=!0;break}if(!d)return;const p={};for(let x=0;x<this._style.order.length;++x){const C=this._style._layers[this._style.order[x]],T=this._style._getLayerSourceCache(C);if(!T||p[T.id]||C.isHidden(this.painter.transform.zoom)||"raster"!==C.type)continue;const P=C.paint.get("raster-fade-duration");for(const F of this.proxyCoords){const z=this.proxyToSource[F.key][T.id];if(z)for(const j of z){const W=Cg(T.getTile(j),T.findLoadedParent(j,0),T,this.painter.transform,P);(1!==W.opacity||0!==W.mix)&&this._clearRenderCacheForTile(T.id,j)}}}}_setupDrapedRenderBatches(){const d=this._style.order,p=d.length;if(0===p)return;const x=[];let C,T=0,P=this._style._layers[d[T]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++T<p;)P=this._style._layers[d[T]];for(;T<p;++T){const F=this._style._layers[d[T]];F.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(F)?void 0===C&&(C=T):void 0!==C&&(x.push({start:C,end:T-1}),C=void 0))}void 0!==C&&x.push({start:C,end:T-1}),this._drapedRenderBatches=x}_setupRenderCache(d){const p=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,p.renderCache.length>p.renderCachePool.length){const P=Object.values(p.proxyCachedFBO);p.proxyCachedFBO={};for(let F=0;F<P.length;++F){const z=Object.values(P[F]);p.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,C=this._tilesDirty;for(let P=x.length-1;P>=0;P--){const F=x[P];if(p.getTileByID(F.key),void 0!==p.proxyCachedFBO[F.key]){const z=d[F.key],j=this.proxyToSource[F.key];let W=0;for(const K in j){const ne=j[K],he=z[K];if(!he||he.length!==ne.length||ne.some((pe,le)=>pe!==he[le]||C[K]&&C[K].hasOwnProperty(pe.key))){W=-1;break}++W}for(const K in p.proxyCachedFBO[F.key])p.renderCache[p.proxyCachedFBO[F.key][K]].dirty=W<0||W!==Object.values(z).length}}const T=[...this._drapedRenderBatches];T.sort((P,F)=>F.end-F.start-(P.end-P.start));for(const P of T)for(const F of x){if(p.proxyCachedFBO[F.key])continue;let z=p.renderCachePool.pop();void 0===z&&p.renderCache.length<50&&(z=p.renderCache.length,p.renderCache.push(this._createFBO())),void 0!==z&&(p.proxyCachedFBO[F.key]={},p.proxyCachedFBO[F.key][P.start]=z,p.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(d,p,x,C){if(!C||!this._sourceTilesOverlap[C.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,P=T.gl;if(p.length<=1)return void(this._overlapStencilType=!1);let F;if(x.isTileClipped())F=p.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(p[0].overscaledZ>p[p.length-1].overscaledZ))return void(this._overlapStencilType=!1);F=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+F>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=F,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(p,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(d){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[d.key]),this._overlapStencilMode):g.StencilMode.disabled}_renderTileClippingMasks(d,p){const x=this.painter,C=this.painter.context,T=C.gl;x._tileClippingMaskIDs={},C.setColorMode(g.ColorMode.disabled),C.setDepthMode(g.DepthMode.disabled);const P=x.useProgram("clippingMask");for(const F of d){const z=x._tileClippingMaskIDs[F.key]=--p;P.draw(C,T.TRIANGLES,g.DepthMode.disabled,new g.StencilMode({func:T.ALWAYS,mask:0},z,255,T.KEEP,T.KEEP,T.REPLACE),g.ColorMode.disabled,g.CullFaceMode.disabled,xf(F.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(d){const p=this.painter.transform;if(d.x<0||d.x>p.width||d.y<0||d.y>p.height)return null;const x=[d.x,d.y,1,1];g.transformMat4$1(x,x,p.pixelMatrixInverse),g.scale$1(x,x,1/x[3]),x[0]/=p.worldSize,x[1]/=p.worldSize;const C=p._camera.position,T=g.mercatorZfromAltitude(1,p.center.lat),P=[C[0],C[1],C[2]/T,0],F=g.subtract([],x.slice(0,3),P);g.normalize(F,F);const z=this.raycast(P,F,this._exaggeration);return null!==z&&z?(g.scaleAndAdd(P,P,F,z),P[3]=P[2],P[2]*=T,P):null}drawDepth(){const d=this.painter,p=d.context,x=this.proxySourceCache,C=Math.ceil(d.width),T=Math.ceil(d.height);if(!this._depthFBO||this._depthFBO.width===C&&this._depthFBO.height===T||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=p.gl,F=p.createFramebuffer(C,T,!0);p.activeTexture.set(P.TEXTURE0);const z=new g.Texture(p,{width:C,height:T,data:null},P.RGBA);z.bind(P.NEAREST,P.CLAMP_TO_EDGE),F.colorAttachment.set(z.texture);const j=p.createRenderbuffer(p.gl.DEPTH_COMPONENT16,C,T);F.depthAttachment.set(j),this._depthFBO=F,this._depthTexture=z}p.bindFramebuffer.set(this._depthFBO.framebuffer),p.viewport.set([0,0,C,T]),function(P,F,z,j){if("globe"===P.transform.projection.name)return;const W=P.context,K=W.gl;W.clear({depth:1});const ne=P.useProgram("terrainDepth"),he=new g.DepthMode(K.LESS,g.DepthMode.ReadWrite,P.depthRangeFor3D);for(const pe of j){const le=z.getTile(pe),me=$u(pe.projMatrix,0);F.setupElevationDraw(le,ne),ne.draw(W,K.TRIANGLES,he,g.StencilMode.disabled,g.ColorMode.unblended,g.CullFaceMode.backCCW,me,"terrain_depth",F.gridBuffer,F.gridIndexBuffer,F.gridNoSkirtSegments)}}(d,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(d,p,x){if(d.getSource()instanceof or)return this._setupProxiedCoordsForImageSource(d,p,x);this._findCoveringTileCache[d.id]=this._findCoveringTileCache[d.id]||{};const C=this.proxiedCoords[d.id]=[],T=this.proxyCoords;for(let F=0;F<T.length;F++){const z=T[F],j=this._findTileCoveringTileID(z,d);if(j){const W=this._createProxiedId(z,j,x[z.key]&&x[z.key][d.id]);C.push(W),this.proxyToSource[z.key][d.id]=[W]}}let P=!1;for(let F=0;F<p.length;F++){const z=d.getTile(p[F]);if(!z||!z.hasData())continue;const j=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==z.tileID.canonical.z){const W=this.proxyToSource[j.tileID.key][d.id],K=this._createProxiedId(j.tileID,z,x[j.tileID.key]&&x[j.tileID.key][d.id]);W?W.splice(W.length-1,0,K):this.proxyToSource[j.tileID.key][d.id]=[K],C.push(K),P=!0}}this._sourceTilesOverlap[d.id]=P}_setupProxiedCoordsForImageSource(d,p,x){if(!d.getSource().loaded())return;const C=this.proxiedCoords[d.id]=[],T=this.proxyCoords,P=d.getSource(),F=new g.Point(P.tileID.x,P.tileID.y)._div(1<<P.tileID.z),z=P.coordinates.map(g.MercatorCoordinate.fromLngLat).reduce((W,K)=>(W.min.x=Math.min(W.min.x,K.x-F.x),W.min.y=Math.min(W.min.y,K.y-F.y),W.max.x=Math.max(W.max.x,K.x-F.x),W.max.y=Math.max(W.max.y,K.y-F.y),W),{min:new g.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new g.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(W,K)=>{const ne=W.wrap+W.canonical.x/(1<<W.canonical.z),he=W.canonical.y/(1<<W.canonical.z),pe=g.EXTENT/(1<<W.canonical.z),le=K.wrap+K.canonical.x/(1<<K.canonical.z),me=K.canonical.y/(1<<K.canonical.z);return ne+pe<le+z.min.x||ne>le+z.max.x||he+pe<me+z.min.y||he>me+z.max.y};for(let W=0;W<T.length;W++){const K=T[W];for(let ne=0;ne<p.length;ne++){const he=d.getTile(p[ne]);if(!he||!he.hasData()||j(K,he.tileID))continue;const pe=this._createProxiedId(K,he,x[K.key]&&x[K.key][d.id]),le=this.proxyToSource[K.key][d.id];le?le.push(pe):this.proxyToSource[K.key][d.id]=[pe],C.push(pe)}}}_createProxiedId(d,p,x){let C=this.orthoMatrix;if(x){const T=x.find(P=>P.key===p.tileID.key);if(T)return T}if(p.tileID.key!==d.key){const T=d.canonical.z-p.tileID.canonical.z;let P,F,z;C=g.create();const j=p.tileID.wrap-d.wrap<<d.overscaledZ;T>0?(P=g.EXTENT>>T,F=P*((p.tileID.canonical.x<<T)-d.canonical.x+j),z=P*((p.tileID.canonical.y<<T)-d.canonical.y)):(P=g.EXTENT<<-T,F=g.EXTENT*(p.tileID.canonical.x-(d.canonical.x+j<<-T)),z=g.EXTENT*(p.tileID.canonical.y-(d.canonical.y<<-T))),g.ortho(C,0,P,0,P,0,1),g.translate(C,C,[F,z,0])}return new Ph(p.tileID,d.key,C)}_findTileCoveringTileID(d,p){let x=p.getTile(d);if(x&&x.hasData())return x;const C=this._findCoveringTileCache[p.id],T=C[d.key];if(x=T?p.getTileByID(T):null,x&&x.hasData()||null===T)return x;let P=x?x.tileID:d,F=P.overscaledZ;const z=p.getSource().minzoom,j=[];if(!T){const K=p.getSource().maxzoom;if(d.canonical.z>=K){const ne=d.canonical.z-K;p.getSource().reparseOverscaled?(F=Math.max(d.canonical.z+2,p.transform.tileZoom),P=new g.OverscaledTileID(F,d.wrap,K,d.canonical.x>>ne,d.canonical.y>>ne)):0!==ne&&(F=K,P=new g.OverscaledTileID(F,d.wrap,K,d.canonical.x>>ne,d.canonical.y>>ne))}P.key!==d.key&&(j.push(P.key),x=p.getTile(P))}const W=K=>{j.forEach(ne=>{C[ne]=K}),j.length=0};for(F-=1;F>=z&&(!x||!x.hasData());F--){x&&W(x.tileID.key);const K=P.calculateScaledKey(F);if(x=p.getTileByID(K),x&&x.hasData())break;const ne=C[K];if(null===ne)break;void 0===ne?j.push(K):x=p.getTileByID(ne)}return W(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(d){return this.enabled?this._findTileCoveringTileID(d,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(d,p){let x=this._tilesDirty[d];x||(x=this._tilesDirty[d]={}),x[p.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const d=function(p){let x=0;const C=new g.StructArrayLayout2ui4,T=131;for(let P=1;P<129;P++){for(let F=1;F<129;F++)x=P*T+F,C.emplaceBack(x,x+1),C.emplaceBack(x,x+T),C.emplaceBack(x+1,x+T),128===P&&C.emplaceBack(x+T,x+T+1);C.emplaceBack(x+1,x+1+T)}return C}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(d),this.wireframeSegments=g.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,d.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Mr{static cacheKey(d,p,x,C){let T=`${p}${C?C.cacheKey:""}`;for(const P of x)d.usedDefines.includes(P)&&(T+=`/${P}`);return T}constructor(d,p,x,C,T,P){const F=d.gl;this.program=F.createProgram();const z=function(J){const de=[];for(let be=0;be<J.length;be++){if(null===J[be])continue;const xe=J[be].split(" ");de.push(xe.pop())}return de}(x.staticAttributes),j=C?C.getBinderAttributes():[],W=z.concat(j);let K=C?C.defines():[];K=K.concat(P.map(J=>`#define ${J}`));const ne=d.isWebGL2?"#version 300 es\n":"",he=ne+K.concat(d.extStandardDerivatives&&0===ne.length?"#extension GL_OES_standard_derivatives : enable\n".concat(Ip):Ip,Ip,Wu,ym.fragmentSource,Zd.fragmentSource,x.fragmentSource).join("\n"),pe=ne+K.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",Wu,ym.vertexSource,Zd.vertexSource,yf.vertexSource,x.vertexSource).join("\n"),le=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);F.shaderSource(le,he),F.compileShader(le),F.attachShader(this.program,le);const me=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(me,pe),F.compileShader(me),F.attachShader(this.program,me),this.attributes={},this.numAttributes=W.length;for(let J=0;J<this.numAttributes;J++)W[J]&&(F.bindAttribLocation(this.program,J,W[J]),this.attributes[W[J]]=J);F.linkProgram(this.program),F.deleteShader(me),F.deleteShader(le),this.fixedUniforms=T(d),this.binderUniforms=C?C.getUniforms(d):[],P.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new g.Uniform1i(J=d),u_dem_prev:new g.Uniform1i(J),u_dem_unpack:new g.Uniform4f(J),u_dem_tl:new g.Uniform2f(J),u_dem_scale:new g.Uniform1f(J),u_dem_tl_prev:new g.Uniform2f(J),u_dem_scale_prev:new g.Uniform1f(J),u_dem_size:new g.Uniform1f(J),u_dem_lerp:new g.Uniform1f(J),u_exaggeration:new g.Uniform1f(J),u_depth:new g.Uniform1i(J),u_depth_size_inv:new g.Uniform2f(J),u_meter_to_dem:new g.Uniform1f(J),u_label_plane_matrix_inv:new g.UniformMatrix4f(J)}),P.includes("GLOBE")&&(this.globeUniforms=(J=>({u_tile_tl_up:new g.Uniform3f(J),u_tile_tr_up:new g.Uniform3f(J),u_tile_br_up:new g.Uniform3f(J),u_tile_bl_up:new g.Uniform3f(J),u_tile_up_scale:new g.Uniform1f(J)}))(d)),P.includes("FOG")&&(this.fogUniforms=(J=>({u_fog_matrix:new g.UniformMatrix4f(J),u_fog_range:new g.Uniform2f(J),u_fog_color:new g.Uniform4f(J),u_fog_horizon_blend:new g.Uniform1f(J),u_fog_temporal_offset:new g.Uniform1f(J),u_frustum_tl:new g.Uniform3f(J),u_frustum_tr:new g.Uniform3f(J),u_frustum_br:new g.Uniform3f(J),u_frustum_bl:new g.Uniform3f(J),u_globe_pos:new g.Uniform3f(J),u_globe_radius:new g.Uniform1f(J),u_globe_transition:new g.Uniform1f(J),u_is_globe:new g.Uniform1i(J),u_viewport:new g.Uniform2f(J)}))(d))}var J}setTerrainUniformValues(d,p){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in p)x[C]&&x[C].set(this.program,C,p[C])}}setGlobeUniformValues(d,p){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in p)x[C]&&x[C].set(this.program,C,p[C])}}setFogUniformValues(d,p){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in p)x[C].set(this.program,C,p[C])}}draw(d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le){const me=d.gl;if(this.failedToCreate)return;d.program.set(this.program),d.setDepthMode(x),d.setStencilMode(C),d.setColorMode(T),d.setCullFace(P);for(const de of Object.keys(this.fixedUniforms))this.fixedUniforms[de].set(this.program,de,F[de]);pe&&pe.setUniforms(this.program,d,this.binderUniforms,ne,{zoom:he});const J={[me.LINES]:2,[me.TRIANGLES]:3,[me.LINE_STRIP]:1}[p];for(const de of K.get()){const be=de.vaos||(de.vaos={});(be[z]||(be[z]=new ol)).bind(d,this,j,pe?pe.getPaintVertexBuffers():[],W,de.vertexOffset,le||[]),me.drawElements(p,de.primitiveLength*J,me.UNSIGNED_SHORT,de.primitiveOffset*J*2)}}}function it(v,d){const p=Math.pow(2,d.tileID.overscaledZ),x=d.tileSize*Math.pow(2,v.transform.tileZoom)/p,C=x*(d.tileID.canonical.x+d.tileID.wrap*p),T=x*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_tile_units_to_pixels:1/Bo(d,1,v.transform.tileZoom),u_pixel_coord_upper:[C>>16,T>>16],u_pixel_coord_lower:[65535&C,65535&T]}}const Mm=g.create(),mi=(v,d,p,x,C,T,P,F,z,j,W)=>{const K=d.style.light,ne=K.properties.get("position"),he=[ne.x,ne.y,ne.z],pe=g.create$1();"viewport"===K.properties.get("anchor")&&(g.fromRotation(pe,-d.transform.angle),g.transformMat3(he,he,pe));const le=K.properties.get("color"),me=d.transform,J={u_matrix:v,u_lightpos:he,u_lightintensity:K.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+p,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Mm,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:C,u_edge_radius:T};return"globe"===me.projection.name&&(J.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],J.u_zoom_transition=z,J.u_inv_rot_matrix=W,J.u_merc_center=j,J.u_up_dir=me.projection.upVector(new g.CanonicalTileID(0,0,0),j[0]*g.EXTENT,j[1]*g.EXTENT),J.u_height_lift=F),J},Lh=(v,d,p,x,C,T,P,F,z,j,W,K)=>{const ne=mi(v,d,p,x,C,T,P,z,j,W,K),he={u_height_factor:-Math.pow(2,P.overscaledZ)/F.tileSize/8};return g.extend(ne,it(d,F),he)},wd=v=>({u_matrix:v}),Fh=(v,d,p)=>g.extend(wd(v),it(d,p)),Sg=(v,d)=>({u_matrix:v,u_world:d}),Tg=(v,d,p,x)=>g.extend(Fh(v,d,p),{u_world:x}),Fv=g.create(),Sc=(v,d,p,x,C,T)=>{const P=v.transform,F="globe"===P.projection.name;let z;if("map"===T.paint.get("circle-pitch-alignment"))if(F){const W=g.globePixelsToTileUnits(P.zoom,d.canonical)*P._pixelsPerMercatorPixel;z=Float32Array.from([W,0,0,W])}else z=P.calculatePixelsToTileUnitsMatrix(p);else z=new Float32Array([P.pixelsToGLUnits[0],0,0,P.pixelsToGLUnits[1]]);const j={u_camera_to_center_distance:P.cameraToCenterDistance,u_matrix:v.translatePosMatrix(d.projMatrix,p,T.paint.get("circle-translate"),T.paint.get("circle-translate-anchor")),u_device_pixel_ratio:g.exported.devicePixelRatio,u_extrude_scale:z,u_inv_rot_matrix:Fv,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(F){j.u_inv_rot_matrix=x,j.u_merc_center=C,j.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],j.u_zoom_transition=g.globeToMercatorTransition(P.zoom);const W=C[0]*g.EXTENT,K=C[1]*g.EXTENT;j.u_up_dir=P.projection.upVector(new g.CanonicalTileID(0,0,0),W,K)}return j},ns=v=>{const d=[];return"map"===v.paint.get("circle-pitch-alignment")&&d.push("PITCH_WITH_MAP"),"map"===v.paint.get("circle-pitch-scale")&&d.push("SCALE_WITH_MAP"),d},sa=(v,d,p,x)=>{const C=g.EXTENT/p.tileSize;return{u_matrix:v,u_camera_to_center_distance:d.getCameraToCenterDistance(x),u_extrude_scale:[d.pixelsToGLUnits[0]/C,d.pixelsToGLUnits[1]/C]}},Ea=(v,d,p=1)=>({u_matrix:v,u_color:d,u_overlay:0,u_overlay_scale:p}),Wr=g.create(),kp=(v,d,p,x,C,T,P)=>{const F=v.transform,z="globe"===F.projection.name,j=z?g.globePixelsToTileUnits(F.zoom,d.canonical)*F._pixelsPerMercatorPixel:Bo(p,1,T),W={u_matrix:d.projMatrix,u_extrude_scale:j,u_intensity:P,u_inv_rot_matrix:Wr,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){W.u_inv_rot_matrix=x,W.u_merc_center=C,W.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],W.u_zoom_transition=g.globeToMercatorTransition(F.zoom);const K=C[0]*g.EXTENT,ne=C[1]*g.EXTENT;W.u_up_dir=F.projection.upVector(new g.CanonicalTileID(0,0,0),K,ne)}return W},Ag=(v,d,p,x,C,T,P)=>{const F=v.transform,z=F.calculatePixelsToTileUnitsMatrix(d);return{u_matrix:Kc(v,d,p,x),u_pixels_to_tile_units:z,u_device_pixel_ratio:T,u_units_to_pixels:[1/F.pixelsToGLUnits[0],1/F.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:C,u_texsize:Yd(p)?d.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Nh(d,v.transform),u_alpha_discard_threshold:0,u_trim_offset:P}},Oh=(v,d,p,x,C)=>{const T=v.transform;return{u_matrix:Kc(v,d,p,x),u_texsize:d.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(d),u_device_pixel_ratio:C,u_image:0,u_tile_units_to_pixels:Nh(d,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Nh(v,d){return 1/Bo(v,1,d.tileZoom)}function Kc(v,d,p,x){return v.translatePosMatrix(x||d.tileID.projMatrix,d,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}function Yd(v){const d=v.paint.get("line-dasharray").value;return d.value||"constant"!==d.kind}const Kd=(v,d,p,x,C,T)=>{return{u_matrix:v,u_tl_parent:d,u_scale_parent:p,u_fade_t:x.mix,u_opacity:x.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(F=C.paint.get("raster-saturation"),F>0?1-1/(1.001-F):-F),u_contrast_factor:(P=C.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:Jc(C.paint.get("raster-hue-rotate")),u_perspective_transform:T};var P,F};function Jc(v){v*=Math.PI/180;const d=Math.sin(v),p=Math.cos(v);return[(2*p+1)/3,(-Math.sqrt(3)*d-p+1)/3,(Math.sqrt(3)*d-p+1)/3]}const Rp=g.create(),Pp=(v,d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le)=>{const me=C.transform,J={u_is_size_zoom_constant:+("constant"===v||"source"===v),u_is_size_feature_constant:+("constant"===v||"camera"===v),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:me.cameraToCenterDistance,u_rotate_symbol:+p,u_aspect_ratio:me.width/me.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:P,u_coord_matrix:F,u_is_text:+z,u_pitch_with_map:+x,u_texsize:j,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Rp,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Rp,u_up_vector:[0,-1,0]};return"globe"===le.name&&(J.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],J.u_zoom_transition=K,J.u_inv_rot_matrix=he,J.u_merc_center=ne,J.u_camera_forward=me._camera.forward(),J.u_ecef_origin=g.globeECEFOrigin(me.globeMatrix,W.toUnwrapped()),J.u_tile_matrix=Float32Array.from(me.globeMatrix),J.u_up_vector=pe),J},Lp=(v,d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le,me)=>g.extend(Pp(v,d,p,x,C,T,P,F,z,j,K,ne,he,pe,le,me),{u_gamma_scale:x?C.transform.cameraToCenterDistance*Math.cos(C.terrain?0:C.transform._pitch):1,u_device_pixel_ratio:g.exported.devicePixelRatio,u_is_halo:+W}),tc=(v,d,p,x,C,T,P,F,z,j,W,K,ne,he,pe,le)=>g.extend(Lp(v,d,p,x,C,T,P,F,!0,z,!0,W,K,ne,he,pe,le),{u_texsize_icon:j,u_texture_icon:1}),Bh=(v,d,p)=>({u_matrix:v,u_opacity:d,u_color:p}),Q_=(v,d,p,x,C)=>g.extend(function(T,P,F){const z=P.imageManager.getPattern(T.toString()),{width:j,height:W}=P.imageManager.getPixelSize(),K=Math.pow(2,F.tileID.overscaledZ),ne=F.tileSize*Math.pow(2,P.transform.tileZoom)/K,he=ne*(F.tileID.canonical.x+F.tileID.wrap*K),pe=ne*F.tileID.canonical.y;return{u_image:0,u_pattern_tl:z.tl,u_pattern_br:z.br,u_texsize:[j,W],u_pattern_size:z.displaySize,u_tile_units_to_pixels:1/Bo(F,1,P.transform.tileZoom),u_pixel_coord_upper:[he>>16,pe>>16],u_pixel_coord_lower:[65535&he,65535&pe]}}(x,p,C),{u_matrix:v,u_opacity:d}),Dg={fillExtrusion:v=>({u_matrix:new g.UniformMatrix4f(v),u_lightpos:new g.Uniform3f(v),u_lightintensity:new g.Uniform1f(v),u_lightcolor:new g.Uniform3f(v),u_vertical_gradient:new g.Uniform1f(v),u_opacity:new g.Uniform1f(v),u_edge_radius:new g.Uniform1f(v),u_ao:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_up_dir:new g.Uniform3f(v),u_height_lift:new g.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_lightpos:new g.Uniform3f(v),u_lightintensity:new g.Uniform1f(v),u_lightcolor:new g.Uniform3f(v),u_vertical_gradient:new g.Uniform1f(v),u_height_factor:new g.Uniform1f(v),u_edge_radius:new g.Uniform1f(v),u_ao:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_up_dir:new g.Uniform3f(v),u_height_lift:new g.Uniform1f(v),u_image:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_pixel_coord_upper:new g.Uniform2f(v),u_pixel_coord_lower:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v),u_opacity:new g.Uniform1f(v)}),fill:v=>({u_matrix:new g.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_image:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_pixel_coord_upper:new g.Uniform2f(v),u_pixel_coord_lower:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v)}),fillOutline:v=>({u_matrix:new g.UniformMatrix4f(v),u_world:new g.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_world:new g.Uniform2f(v),u_image:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_pixel_coord_upper:new g.Uniform2f(v),u_pixel_coord_lower:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new g.Uniform1f(v),u_extrude_scale:new g.UniformMatrix2f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_up_dir:new g.Uniform3f(v)}),collisionBox:v=>({u_matrix:new g.UniformMatrix4f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_extrude_scale:new g.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new g.UniformMatrix4f(v),u_inv_matrix:new g.UniformMatrix4f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_viewport_size:new g.Uniform2f(v)}),debug:v=>({u_color:new g.UniformColor(v),u_matrix:new g.UniformMatrix4f(v),u_overlay:new g.Uniform1i(v),u_overlay_scale:new g.Uniform1f(v)}),clippingMask:v=>({u_matrix:new g.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new g.Uniform1f(v),u_intensity:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_up_dir:new g.Uniform3f(v)}),heatmapTexture:v=>({u_image:new g.Uniform1i(v),u_color_ramp:new g.Uniform1i(v),u_opacity:new g.Uniform1f(v)}),hillshade:v=>({u_matrix:new g.UniformMatrix4f(v),u_image:new g.Uniform1i(v),u_latrange:new g.Uniform2f(v),u_light:new g.Uniform2f(v),u_shadow:new g.UniformColor(v),u_highlight:new g.UniformColor(v),u_accent:new g.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new g.UniformMatrix4f(v),u_image:new g.Uniform1i(v),u_dimension:new g.Uniform2f(v),u_zoom:new g.Uniform1f(v),u_unpack:new g.Uniform4f(v)}),line:v=>({u_matrix:new g.UniformMatrix4f(v),u_pixels_to_tile_units:new g.UniformMatrix2f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_units_to_pixels:new g.Uniform2f(v),u_dash_image:new g.Uniform1i(v),u_gradient_image:new g.Uniform1i(v),u_image_height:new g.Uniform1f(v),u_texsize:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v),u_alpha_discard_threshold:new g.Uniform1f(v),u_trim_offset:new g.Uniform2f(v)}),linePattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_texsize:new g.Uniform2f(v),u_pixels_to_tile_units:new g.UniformMatrix2f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_image:new g.Uniform1i(v),u_units_to_pixels:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v),u_alpha_discard_threshold:new g.Uniform1f(v)}),raster:v=>({u_matrix:new g.UniformMatrix4f(v),u_tl_parent:new g.Uniform2f(v),u_scale_parent:new g.Uniform1f(v),u_fade_t:new g.Uniform1f(v),u_opacity:new g.Uniform1f(v),u_image0:new g.Uniform1i(v),u_image1:new g.Uniform1i(v),u_brightness_low:new g.Uniform1f(v),u_brightness_high:new g.Uniform1f(v),u_saturation_factor:new g.Uniform1f(v),u_contrast_factor:new g.Uniform1f(v),u_spin_weights:new g.Uniform3f(v),u_perspective_transform:new g.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new g.Uniform1i(v),u_is_size_feature_constant:new g.Uniform1i(v),u_size_t:new g.Uniform1f(v),u_size:new g.Uniform1f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_rotate_symbol:new g.Uniform1i(v),u_aspect_ratio:new g.Uniform1f(v),u_fade_change:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_label_plane_matrix:new g.UniformMatrix4f(v),u_coord_matrix:new g.UniformMatrix4f(v),u_is_text:new g.Uniform1i(v),u_pitch_with_map:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_camera_forward:new g.Uniform3f(v),u_tile_matrix:new g.UniformMatrix4f(v),u_up_vector:new g.Uniform3f(v),u_ecef_origin:new g.Uniform3f(v),u_texture:new g.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new g.Uniform1i(v),u_is_size_feature_constant:new g.Uniform1i(v),u_size_t:new g.Uniform1f(v),u_size:new g.Uniform1f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_rotate_symbol:new g.Uniform1i(v),u_aspect_ratio:new g.Uniform1f(v),u_fade_change:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_label_plane_matrix:new g.UniformMatrix4f(v),u_coord_matrix:new g.UniformMatrix4f(v),u_is_text:new g.Uniform1i(v),u_pitch_with_map:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_texture:new g.Uniform1i(v),u_gamma_scale:new g.Uniform1f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_camera_forward:new g.Uniform3f(v),u_tile_matrix:new g.UniformMatrix4f(v),u_up_vector:new g.Uniform3f(v),u_ecef_origin:new g.Uniform3f(v),u_is_halo:new g.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new g.Uniform1i(v),u_is_size_feature_constant:new g.Uniform1i(v),u_size_t:new g.Uniform1f(v),u_size:new g.Uniform1f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_rotate_symbol:new g.Uniform1i(v),u_aspect_ratio:new g.Uniform1f(v),u_fade_change:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_label_plane_matrix:new g.UniformMatrix4f(v),u_coord_matrix:new g.UniformMatrix4f(v),u_is_text:new g.Uniform1i(v),u_pitch_with_map:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_texsize_icon:new g.Uniform2f(v),u_texture:new g.Uniform1i(v),u_texture_icon:new g.Uniform1i(v),u_gamma_scale:new g.Uniform1f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_is_halo:new g.Uniform1i(v)}),background:v=>({u_matrix:new g.UniformMatrix4f(v),u_opacity:new g.Uniform1f(v),u_color:new g.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_opacity:new g.Uniform1f(v),u_image:new g.Uniform1i(v),u_pattern_tl:new g.Uniform2f(v),u_pattern_br:new g.Uniform2f(v),u_texsize:new g.Uniform2f(v),u_pattern_size:new g.Uniform2f(v),u_pixel_coord_upper:new g.Uniform2f(v),u_pixel_coord_lower:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v)}),terrainRaster:Nr,terrainDepth:Nr,skybox:v=>({u_matrix:new g.UniformMatrix4f(v),u_sun_direction:new g.Uniform3f(v),u_cubemap:new g.Uniform1i(v),u_opacity:new g.Uniform1f(v),u_temporal_offset:new g.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new g.UniformMatrix4f(v),u_color_ramp:new g.Uniform1i(v),u_center_direction:new g.Uniform3f(v),u_radius:new g.Uniform1f(v),u_opacity:new g.Uniform1f(v),u_temporal_offset:new g.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new g.UniformMatrix3f(v),u_sun_direction:new g.Uniform3f(v),u_sun_intensity:new g.Uniform1f(v),u_color_tint_r:new g.Uniform4f(v),u_color_tint_m:new g.Uniform4f(v),u_luminance:new g.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new g.UniformMatrix4f(v),u_globe_matrix:new g.UniformMatrix4f(v),u_normalize_matrix:new g.UniformMatrix4f(v),u_merc_matrix:new g.UniformMatrix4f(v),u_zoom_transition:new g.Uniform1f(v),u_merc_center:new g.Uniform2f(v),u_image0:new g.Uniform1i(v),u_grid_matrix:new g.UniformMatrix3f(v),u_skirt_height:new g.Uniform1f(v),u_frustum_tl:new g.Uniform3f(v),u_frustum_tr:new g.Uniform3f(v),u_frustum_br:new g.Uniform3f(v),u_frustum_bl:new g.Uniform3f(v),u_globe_pos:new g.Uniform3f(v),u_globe_radius:new g.Uniform1f(v),u_viewport:new g.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new g.Uniform3f(v),u_frustum_tr:new g.Uniform3f(v),u_frustum_br:new g.Uniform3f(v),u_frustum_bl:new g.Uniform3f(v),u_horizon:new g.Uniform1f(v),u_transition:new g.Uniform1f(v),u_fadeout_range:new g.Uniform1f(v),u_color:new g.Uniform4f(v),u_high_color:new g.Uniform4f(v),u_space_color:new g.Uniform4f(v),u_star_intensity:new g.Uniform1f(v),u_star_density:new g.Uniform1f(v),u_star_size:new g.Uniform1f(v),u_temporal_offset:new g.Uniform1f(v),u_horizon_angle:new g.Uniform1f(v),u_rotation_matrix:new g.UniformMatrix4f(v)})};let wf;function Md(v,d,p,x,C,T,P){const F=v.context,z=F.gl,j=v.transform,W=v.useProgram("collisionBox"),K=[];let ne=0,he=0;for(let xe=0;xe<x.length;xe++){const Ne=x[xe],Be=d.getTile(Ne),ke=Be.getBucket(p);if(!ke)continue;const We=yo(Ne,ke,j);let $e=We;0===C[0]&&0===C[1]||($e=v.translatePosMatrix(We,Be,C,T));const Ye=P?ke.textCollisionBox:ke.iconCollisionBox,St=ke.collisionCircleArray;if(St.length>0){const Je=g.create(),vt=$e;g.mul(Je,ke.placementInvProjMatrix,j.glCoordMatrix),g.mul(Je,Je,ke.placementViewportMatrix),K.push({circleArray:St,circleOffset:he,transform:vt,invTransform:Je,projection:ke.getProjection()}),ne+=St.length/4,he=ne}Ye&&(v.terrain&&v.terrain.setupElevationDraw(Be,W),W.draw(F,z.LINES,g.DepthMode.disabled,g.StencilMode.disabled,v.colorModeForRenderPass(),g.CullFaceMode.disabled,sa($e,j,Be,ke.getProjection()),p.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,null,j.zoom,null,[Ye.collisionVertexBuffer,Ye.collisionVertexBufferExt]))}if(!P||!K.length)return;const pe=v.useProgram("collisionCircle"),le=new g.StructArrayLayout2f1f2i16;le.resize(4*ne),le._trim();let me=0;for(const xe of K)for(let Ne=0;Ne<xe.circleArray.length/4;Ne++){const Be=4*Ne,ke=xe.circleArray[Be+0],We=xe.circleArray[Be+1],$e=xe.circleArray[Be+2],Ye=xe.circleArray[Be+3];le.emplace(me++,ke,We,$e,Ye,0),le.emplace(me++,ke,We,$e,Ye,1),le.emplace(me++,ke,We,$e,Ye,2),le.emplace(me++,ke,We,$e,Ye,3)}(!wf||wf.length<2*ne)&&(wf=function(xe){const Ne=2*xe,Be=new g.StructArrayLayout3ui6;Be.resize(Ne),Be._trim();for(let ke=0;ke<Ne;ke++){const We=6*ke;Be.uint16[We+0]=4*ke+0,Be.uint16[We+1]=4*ke+1,Be.uint16[We+2]=4*ke+2,Be.uint16[We+3]=4*ke+2,Be.uint16[We+4]=4*ke+3,Be.uint16[We+5]=4*ke+0}return Be}(ne));const J=F.createIndexBuffer(wf,!0),de=F.createVertexBuffer(le,g.collisionCircleLayout.members,!0);for(const xe of K){const Ne={u_matrix:xe.transform,u_inv_matrix:xe.invTransform,u_camera_to_center_distance:(be=j).getCameraToCenterDistance(xe.projection),u_viewport_size:[be.width,be.height]};pe.draw(F,z.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,v.colorModeForRenderPass(),g.CullFaceMode.disabled,Ne,p.id,de,J,g.SegmentVector.simpleSegment(0,2*xe.circleOffset,xe.circleArray.length,xe.circleArray.length/2),null,j.zoom)}var be;de.destroy(),J.destroy()}const Tc=g.create();function Il({width:v,height:d,anchor:p,textOffset:x,textScale:C},T){const{horizontalAlign:P,verticalAlign:F}=g.getAnchorAlignment(p),z=-(P-.5)*v,j=-(F-.5)*d,W=g.evaluateVariableOffset(p,x);return new g.Point((z/C+W[0])*T,(j/C+W[1])*T)}function Ov(v,d,p,x,C,T,P,F,z,j,W){const K=v.text.placedSymbolArray,ne=v.text.dynamicLayoutVertexArray,he=v.icon.dynamicLayoutVertexArray,pe={},le=v.getProjection(),me=So(F,le,T),J=T.elevation,de=le.upVectorScale(F.canonical,T.center.lat,T.worldSize).metersToTile;ne.clear();for(let be=0;be<K.length;be++){const xe=K.get(be),{tileAnchorX:Ne,tileAnchorY:Be,numGlyphs:ke}=xe,We=xe.hidden||!xe.crossTileID||v.allowVerticalPlacement&&!xe.placedOrientation?null:x[xe.crossTileID];if(We){let $e=0,Ye=0,St=0;if(J){const Zt=J?J.getAtTileOffset(F,Ne,Be):0,[$i,Qi,Ai]=le.upVector(F.canonical,Ne,Be);$e=Zt*$i*de,Ye=Zt*Qi*de,St=Zt*Ai*de}let[Je,vt,et,Rt]=ra(xe.projectedAnchorX+$e,xe.projectedAnchorY+Ye,xe.projectedAnchorZ+St,p?me:P);const tt=X_(T.getCameraToCenterDistance(le),Rt);let Mt=C.evaluateSizeForFeature(v.textSizeData,j,xe)*tt/g.ONE_EM;p&&(Mt*=v.tilePixelRatio/z);const Nt=Il(We,Mt);p?(({x:Je,y:vt,z:et}=le.projectTilePoint(Ne+Nt.x,Be+Nt.y,F.canonical)),[Je,vt,et]=ra(Je+$e,vt+Ye,et+St,P)):(d&&Nt._rotate(-T.angle),Je+=Nt.x,vt+=Nt.y,et=0);const Bt=v.allowVerticalPlacement&&xe.placedOrientation===g.WritingMode.vertical?Math.PI/2:0;for(let Zt=0;Zt<ke;Zt++)g.addDynamicAttributes(ne,Je,vt,et,Bt);W&&xe.associatedIconIndex>=0&&(pe[xe.associatedIconIndex]={x:Je,y:vt,z:et,angle:Bt})}else Co(ke,ne)}if(W){he.clear();const be=v.icon.placedSymbolArray;for(let xe=0;xe<be.length;xe++){const Ne=be.get(xe),{numGlyphs:Be}=Ne,ke=pe[xe];if(Ne.hidden||!ke)Co(Be,he);else{const{x:We,y:$e,z:Ye,angle:St}=ke;for(let Je=0;Je<Be;Je++)g.addDynamicAttributes(he,We,$e,Ye,St)}}v.icon.dynamicLayoutVertexBuffer.updateData(he)}v.text.dynamicLayoutVertexBuffer.updateData(ne)}function Em(v,d,p){return p.iconsInText&&d?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function ey(v,d,p,x,C,T,P,F,z,j,W,K){const ne=v.context,he=ne.gl,pe=v.transform,le="map"===F,me="map"===z,J=le&&"point"!==p.layout.get("symbol-placement"),de=le&&!me&&!J,be=void 0!==p.layout.get("symbol-sort-key").constantOr(1);let xe=!1;const Ne=v.depthModeForSublayer(0,g.DepthMode.ReadOnly),Be=[g.mercatorXfromLng(pe.center.lng),g.mercatorYfromLat(pe.center.lat)],ke=p.layout.get("text-variable-anchor"),We="globe"===pe.projection.name,$e=[],Ye=[0,-1,0];let St=Ye;!We&&!pe.mercatorFromTransition||le||(St=function(Je){const vt=Je._camera.getWorldToCamera(Je.worldSize,1),et=g.multiply([],vt,Je.globeMatrix);g.invert(et,et);const Rt=[0,0,0],tt=[0,1,0,0];return g.transformMat4$1(tt,tt,et),Rt[0]=tt[0],Rt[1]=tt[1],Rt[2]=tt[2],g.normalize(Rt,Rt),Rt}(pe));for(const Je of x){const vt=d.getTile(Je),et=vt.getBucket(p);if(!et||"mercator"===et.projection.name&&We)continue;const Rt=C?et.text:et.icon;if(!Rt||et.fullyClipped||!Rt.segments.get().length)continue;const tt=Rt.programConfigurations.get(p.id),Mt=C||et.sdfIcons,Nt=C?et.textSizeData:et.iconSizeData,Bt=me||0!==pe.pitch,Zt=g.evaluateSizeForZoom(Nt,pe.zoom);let $i,Qi,Ai,nn,sr=[0,0],Bn=null;if(C)Qi=vt.glyphAtlasTexture,Ai=he.LINEAR,$i=vt.glyphAtlasTexture.size,et.iconsInText&&(sr=vt.imageAtlasTexture.size,Bn=vt.imageAtlasTexture,nn=Bt||v.options.rotating||v.options.zooming||"composite"===Nt.kind||"camera"===Nt.kind?he.LINEAR:he.NEAREST);else{const Ho=1!==p.layout.get("icon-size").constantOr(0)||et.iconsNeedLinear;Qi=vt.imageAtlasTexture,Ai=Mt||v.options.rotating||v.options.zooming||Ho||Bt?he.LINEAR:he.NEAREST,$i=vt.imageAtlasTexture.size}const Bi="globe"===et.projection.name,Jr=Bi?St:Ye,Di=Bi?g.globeToMercatorTransition(pe.zoom):0,no=So(Je,et.getProjection(),pe),To=pe.calculatePixelsToTileUnitsMatrix(vt),za=yt(no,vt.tileID.canonical,me,le,pe,et.getProjection(),To),ua=v.terrain&&me&&J?g.invert(g.create(),za):Tc,rc=Es(no,vt.tileID.canonical,me,le,pe,et.getProjection(),To),oc=ke&&et.hasTextData(),ao="none"!==p.layout.get("icon-text-fit")&&oc&&et.hasIconData();if(J){const Ho=pe.elevation,nu=Ho?Ho.getAtTileOffsetFunc(Je,pe.center.lat,pe.worldSize,et.getProjection()):null,sc=bd(no,vt.tileID.canonical,me,le,pe,et.getProjection(),To);mm(et,no,v,C,sc,rc,me,j,nu,Je)}const ro=J||C&&ke||ao,Ir=v.translatePosMatrix(no,vt,T,P),gs=ro?Tc:za,Ua=v.translatePosMatrix(rc,vt,T,P,!0),xo=et.getProjection().createInversionMatrix(pe,Je.canonical),Ut=[];v.terrainRenderModeElevated()&&me&&Ut.push("PITCH_WITH_MAP_TERRAIN"),Bi&&Ut.push("PROJECTION_GLOBE_VIEW"),ro&&Ut.push("PROJECTED_POS_ON_VIEWPORT");const xr=Mt&&0!==p.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1);let $r;$r=Mt?et.iconsInText?tc(Nt.kind,Zt,de,me,v,Ir,gs,Ua,$i,sr,Je,Di,Be,xo,Jr,et.getProjection()):Lp(Nt.kind,Zt,de,me,v,Ir,gs,Ua,C,$i,!0,Je,Di,Be,xo,Jr,et.getProjection()):Pp(Nt.kind,Zt,de,me,v,Ir,gs,Ua,C,$i,Je,Di,Be,xo,Jr,et.getProjection());const lo={program:v.useProgram(Em(Mt,C,et),tt,Ut),buffers:Rt,uniformValues:$r,atlasTexture:Qi,atlasTextureIcon:Bn,atlasInterpolation:Ai,atlasInterpolationIcon:nn,isSDF:Mt,hasHalo:xr,tile:vt,labelPlaneMatrixInv:ua};if(be&&et.canOverlap){xe=!0;const Ho=Rt.segments.get();for(const nu of Ho)$e.push({segments:new g.SegmentVector([nu]),sortKey:nu.sortKey,state:lo})}else $e.push({segments:Rt.segments,sortKey:0,state:lo})}xe&&$e.sort((Je,vt)=>Je.sortKey-vt.sortKey);for(const Je of $e){const vt=Je.state;if(v.terrain&&v.terrain.setupElevationDraw(vt.tile,vt.program,{useDepthForOcclusion:!We,labelPlaneMatrixInv:vt.labelPlaneMatrixInv}),ne.activeTexture.set(he.TEXTURE0),vt.atlasTexture.bind(vt.atlasInterpolation,he.CLAMP_TO_EDGE),vt.atlasTextureIcon&&(ne.activeTexture.set(he.TEXTURE1),vt.atlasTextureIcon&&vt.atlasTextureIcon.bind(vt.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),vt.isSDF){const et=vt.uniformValues;vt.hasHalo&&(et.u_is_halo=1,Mf(vt.buffers,Je.segments,p,v,vt.program,Ne,W,K,et)),et.u_is_halo=0}Mf(vt.buffers,Je.segments,p,v,vt.program,Ne,W,K,vt.uniformValues)}}function Mf(v,d,p,x,C,T,P,F,z){const j=x.context,W=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];C.draw(j,j.gl.TRIANGLES,T,P,F,g.CullFaceMode.disabled,z,p.id,v.layoutVertexBuffer,v.indexBuffer,d,p.paint,x.transform.zoom,v.programConfigurations.get(p.id),W)}function ty(v,d,p,x,C,T,P){const F=v.context.gl,z=p.paint.get("fill-pattern"),j=z&&z.constantOr(1);let W,K,ne,he,pe;P?(K=j&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=F.LINES):(K=j?"fillPattern":"fill",W=F.TRIANGLES);for(const le of x){const me=d.getTile(le);if(j&&!me.patternsLoaded())continue;const J=me.getBucket(p);if(!J)continue;v.prepareDrawTile();const de=J.programConfigurations.get(p.id),be=v.useProgram(K,de);j&&(v.context.activeTexture.set(F.TEXTURE0),me.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),de.updatePaintBuffers());const xe=z.constantOr(null);if(xe&&me.imageAtlas){const Be=me.imageAtlas.patternPositions[xe.toString()];Be&&de.setConstantPatternPositions(Be)}const Ne=v.translatePosMatrix(le.projMatrix,me,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(P){he=J.indexBuffer2,pe=J.segments2;const Be=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[F.drawingBufferWidth,F.drawingBufferHeight];ne="fillOutlinePattern"===K&&j?Tg(Ne,v,me,Be):Sg(Ne,Be)}else he=J.indexBuffer,pe=J.segments,ne=j?Fh(Ne,v,me):wd(Ne);v.prepareDrawProgram(v.context,be,le.toUnwrapped()),be.draw(v.context,W,C,v.stencilModeForClipping(le),T,g.CullFaceMode.disabled,ne,p.id,J.layoutVertexBuffer,he,pe,p.paint,v.transform.zoom,de)}}function zh(v,d,p,x,C,T,P){const F=v.context,z=F.gl,j=v.transform,W=p.paint.get("fill-extrusion-pattern"),K=W.constantOr(1),ne=p.paint.get("fill-extrusion-opacity"),he=[p.paint.get("fill-extrusion-ambient-occlusion-intensity"),p.paint.get("fill-extrusion-ambient-occlusion-radius")],pe=p.layout.get("fill-extrusion-edge-radius"),le=pe>0&&!p.paint.get("fill-extrusion-rounded-roof"),me=le?0:pe,J="globe"===j.projection.name?g.fillExtrusionHeightLift():0,de="globe"===j.projection.name,be=de?g.globeToMercatorTransition(j.zoom):0,xe=[g.mercatorXfromLng(j.center.lng),g.mercatorYfromLat(j.center.lat)],Ne=[];de&&Ne.push("PROJECTION_GLOBE_VIEW"),he[0]>0&&Ne.push("FAUX_AO"),le&&Ne.push("ZERO_ROOF_RADIUS");for(const Be of x){const ke=d.getTile(Be),We=ke.getBucket(p);if(!We||We.projection.name!==j.projection.name)continue;const $e=We.programConfigurations.get(p.id),Ye=v.useProgram(K?"fillExtrusionPattern":"fillExtrusion",$e,Ne);if(v.terrain){const Mt=v.terrain;if(v.style.terrainSetForDrapingOnly())Mt.setupElevationDraw(ke,Ye,{useMeterToDem:!0});else{if(!We.enableTerrain)continue;if(Mt.setupElevationDraw(ke,Ye,{useMeterToDem:!0}),Xe(F,d,Be,We,p,Mt),!We.centroidVertexBuffer){const Nt=Ye.attributes.a_centroid_pos;void 0!==Nt&&z.vertexAttrib2f(Nt,0,0)}}}K&&(v.context.activeTexture.set(z.TEXTURE0),ke.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),$e.updatePaintBuffers());const St=W.constantOr(null);if(St&&ke.imageAtlas){const Mt=ke.imageAtlas.patternPositions[St.toString()];Mt&&$e.setConstantPatternPositions(Mt)}const Je=v.translatePosMatrix(Be.projMatrix,ke,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),vt=j.projection.createInversionMatrix(j,Be.canonical),et=p.paint.get("fill-extrusion-vertical-gradient"),Rt=K?Lh(Je,v,et,ne,he,me,Be,ke,J,be,xe,vt):mi(Je,v,et,ne,he,me,Be,J,be,xe,vt);v.prepareDrawProgram(F,Ye,Be.toUnwrapped());const tt=[];v.terrain&&tt.push(We.centroidVertexBuffer),de&&tt.push(We.layoutVertexExtBuffer),Ye.draw(F,F.gl.TRIANGLES,C,T,P,g.CullFaceMode.backCCW,Rt,p.id,We.layoutVertexBuffer,We.indexBuffer,We.segments,p.paint,v.transform.zoom,$e,tt)}}function Xe(v,d,p,x,C,T){const P=[J=>{let de=J.canonical.x-1,be=J.wrap;return de<0&&(de=(1<<J.canonical.z)-1,be--),new g.OverscaledTileID(J.overscaledZ,be,J.canonical.z,de,J.canonical.y)},J=>{let de=J.canonical.x+1,be=J.wrap;return de===1<<J.canonical.z&&(de=0,be++),new g.OverscaledTileID(J.overscaledZ,be,J.canonical.z,de,J.canonical.y)},J=>new g.OverscaledTileID(J.overscaledZ,J.wrap,J.canonical.z,J.canonical.x,(0===J.canonical.y?1<<J.canonical.z:J.canonical.y)-1),J=>new g.OverscaledTileID(J.overscaledZ,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y===(1<<J.canonical.z)-1?0:J.canonical.y+1)],F=J=>{const de=d.getSource().minzoom,be=Ne=>{const Be=d.getTileByID(Ne);if(Be&&Be.hasData())return Be.getBucket(C)},xe=[0,-1,1];for(const Ne of xe){if(J.overscaledZ+Ne<de)continue;const Be=be(J.calculateScaledKey(J.overscaledZ+Ne));if(Be)return Be}},z=[0,0,0],j=(J,de)=>(z[0]=Math.min(J.min.y,de.min.y),z[1]=Math.max(J.max.y,de.max.y),z[2]=g.EXTENT-de.min.x>J.max.x?de.min.x-g.EXTENT:J.max.x,z),W=(J,de)=>(z[0]=Math.min(J.min.x,de.min.x),z[1]=Math.max(J.max.x,de.max.x),z[2]=g.EXTENT-de.min.y>J.max.y?de.min.y-g.EXTENT:J.max.y,z),K=[(J,de)=>j(J,de),(J,de)=>j(de,J),(J,de)=>W(J,de),(J,de)=>W(de,J)],ne=new g.Point(0,0);let he,pe,le;const me=(J,de,be,xe,Ne)=>{const Be=[[xe?be:J,xe?J:be,0],[xe?be:de,xe?de:be,0]],ke=Ne<0?g.EXTENT+Ne:Ne,We=[xe?ke:(J+de)/2,xe?(J+de)/2:ke,0];return 0===be&&Ne<0||0!==be&&Ne>0?T.getForTilePoints(le,[We],!0,pe):Be.push(We),T.getForTilePoints(p,Be,!0,he),Math.max(Be[0][2],Be[1][2],We[2])/T.exaggeration()};for(let J=0;J<4;J++){const de=(J<2?1:5)-J,be=x.borders[J];if(0===be.length)continue;const xe=le=P[J](p),Ne=F(xe);if(!(Ne&&Ne instanceof g.FillExtrusionBucket&&Ne.enableTerrain)||x.borderDoneWithNeighborZ[J]===Ne.canonical.z&&Ne.borderDoneWithNeighborZ[de]===x.canonical.z||(pe=T.findDEMTileFor(xe),!pe||!pe.dem))continue;if(!he){const $e=T.findDEMTileFor(p);if(!$e||!$e.dem)return;he=$e}const Be=Ne.borders[de];let ke=0;const We=Ne.borderDoneWithNeighborZ[de]!==x.canonical.z;if(x.canonical.z===Ne.canonical.z){for(let $e=0;$e<be.length;$e++){const Ye=x.featuresOnBorder[be[$e]],St=Ye.borders[J];let Je;for(;ke<Be.length&&(Je=Ne.featuresOnBorder[Be[ke]],!(Je.borders[de][1]>St[0]+3));)We&&Ne.encodeCentroid(void 0,Je,!1),ke++;if(Je&&ke<Be.length){const vt=ke;let et=0;for(;!(Je.borders[de][0]>St[1]-3)&&(et++,++ke!==Be.length);)Je=Ne.featuresOnBorder[Be[ke]];if(Je=Ne.featuresOnBorder[Be[vt]],Ye.intersectsCount()>1||Je.intersectsCount()>1||1!==et){1!==et&&(ke=vt),x.encodeCentroid(void 0,Ye,!1),We&&Ne.encodeCentroid(void 0,Je,!1);continue}const Rt=K[J](Ye,Je),tt=J%2?g.EXTENT-1:0;ne.x=me(Rt[0],Math.min(g.EXTENT-1,Rt[1]),tt,J<2,Rt[2]),ne.y=0,x.encodeCentroid(ne,Ye,!1),We&&Ne.encodeCentroid(ne,Je,!1)}else x.encodeCentroid(void 0,Ye,!1)}x.borderDoneWithNeighborZ[J]=Ne.canonical.z,x.needsCentroidUpdate=!0,We&&(Ne.borderDoneWithNeighborZ[de]=x.canonical.z,Ne.needsCentroidUpdate=!0)}else{for(const $e of be)x.encodeCentroid(void 0,x.featuresOnBorder[$e],!1);if(We){for(const $e of Be)Ne.encodeCentroid(void 0,Ne.featuresOnBorder[$e],!1);Ne.borderDoneWithNeighborZ[de]=x.canonical.z,Ne.needsCentroidUpdate=!0}x.borderDoneWithNeighborZ[J]=Ne.canonical.z,x.needsCentroidUpdate=!0}}(x.needsCentroidUpdate||!x.centroidVertexBuffer&&0!==x.centroidVertexArray.length)&&x.uploadCentroid(v)}const kt=new g.Color(1,0,0,1),wt=new g.Color(0,1,0,1),Gi=new g.Color(0,0,1,1),ui=new g.Color(1,0,1,1),so=new g.Color(0,1,1,1);function js(v,d,p){const x=v.context,C=v.transform,T=x.gl,P="globe"===C.projection.name,F=P?["PROJECTION_GLOBE_VIEW"]:null;let z=p.projMatrix;if(P&&g.globeToMercatorTransition(C.zoom)>0){const Ye=g.transitionTileAABBinECEF(p.canonical,C),St=g.globeDenormalizeECEF(Ye);z=g.multiply(new Float32Array(16),C.globeMatrix,St),g.multiply(z,C.projMatrix,z)}const j=v.useProgram("debug",null,F),W=d.getTileByID(p.key);v.terrain&&v.terrain.setupElevationDraw(W,j);const K=g.DepthMode.disabled,ne=g.StencilMode.disabled,he=v.colorModeForRenderPass();x.activeTexture.set(T.TEXTURE0),v.emptyTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),P?W._makeGlobeTileDebugBuffers(v.context,C):W._makeDebugTileBoundsBuffers(v.context,C.projection);const le=W._tileDebugBuffer||v.debugBuffer,me=W._tileDebugIndexBuffer||v.debugIndexBuffer,J=W._tileDebugSegments||v.debugSegments;j.draw(x,T.LINE_STRIP,K,ne,he,g.CullFaceMode.disabled,Ea(z,g.Color.red),"$debug",le,me,J,null,null,null,[W._globeTileDebugBorderBuffer]);const de=W.latestRawTileData,be=Math.floor((de&&de.byteLength||0)/1024),xe=d.getTile(p).tileSize,Ne=512/Math.min(xe,512)*(p.overscaledZ/C.zoom)*.5;let Be=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(Be+=` => ${p.overscaledZ}`),Be+=` ${be}kb`,function(Ye,St){Ye.initDebugOverlayCanvas();const Je=Ye.debugOverlayCanvas,vt=Ye.context.gl,et=Ye.debugOverlayCanvas.getContext("2d");et.clearRect(0,0,Je.width,Je.height),et.shadowColor="white",et.shadowBlur=2,et.lineWidth=1.5,et.strokeStyle="white",et.textBaseline="top",et.font="bold 36px Open Sans, sans-serif",et.fillText(St,5,5),et.strokeText(St,5,5),Ye.debugOverlayTexture.update(Je),Ye.debugOverlayTexture.bind(vt.LINEAR,vt.CLAMP_TO_EDGE)}(v,Be);const ke=W._tileDebugTextBuffer||v.debugBuffer,We=W._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,$e=W._tileDebugTextSegments||v.debugSegments;j.draw(x,T.TRIANGLES,K,ne,g.ColorMode.alphaBlended,g.CullFaceMode.disabled,Ea(z,g.Color.transparent,Ne),"$debug",ke,We,$e,null,null,null,[W._globeTileDebugTextBuffer])}function Po(v,d,p,x){Fp(v,0,d+p/2,v.transform.width,p,x)}function Nn(v,d,p,x){Fp(v,d-p/2,0,p,v.transform.height,x)}function Fp(v,d,p,x,C,T){const P=v.context,F=P.gl;F.enable(F.SCISSOR_TEST),F.scissor(d*g.exported.devicePixelRatio,p*g.exported.devicePixelRatio,x*g.exported.devicePixelRatio,C*g.exported.devicePixelRatio),P.clear({color:T}),F.disable(F.SCISSOR_TEST)}const kl=g.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:si}=kl;function as(v,d,p,x){v.emplaceBack(d,p,x)}class vr{constructor(d){this.vertexArray=new g.StructArrayLayout3f12,this.indices=new g.StructArrayLayout3ui6,as(this.vertexArray,-1,-1,1),as(this.vertexArray,1,-1,1),as(this.vertexArray,-1,1,1),as(this.vertexArray,1,1,1),as(this.vertexArray,-1,-1,-1),as(this.vertexArray,1,-1,-1),as(this.vertexArray,-1,1,-1),as(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=d.createVertexBuffer(this.vertexArray,si),this.indexBuffer=d.createIndexBuffer(this.indices),this.segment=g.SegmentVector.simpleSegment(0,0,36,12)}}function vo(v,d,p,x,C,T){const P=v.gl,F=d.paint.get("sky-atmosphere-color"),z=d.paint.get("sky-atmosphere-halo-color"),j=d.paint.get("sky-atmosphere-sun-intensity"),W={u_matrix_3f:g.fromMat4(g.create$1(),x),u_sun_direction:C,u_sun_intensity:j,u_color_tint_r:[(pe=F).r,pe.g,pe.b,pe.a],u_color_tint_m:[(le=z).r,le.g,le.b,le.a],u_luminance:5e-5};var pe,le;P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+T,d.skyboxTexture,0),p.draw(v,P.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,g.ColorMode.unblended,g.CullFaceMode.frontCW,W,"skyboxCapture",d.skyboxGeometry.vertexBuffer,d.skyboxGeometry.indexBuffer,d.skyboxGeometry.segment)}const Cs=g.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Br{constructor(d){const p=new g.StructArrayLayout5f20;p.emplaceBack(-1,1,1,0,0),p.emplaceBack(1,1,1,1,0),p.emplaceBack(1,-1,1,1,1),p.emplaceBack(-1,-1,1,0,1);const x=new g.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=d.createVertexBuffer(p,Cs.members),this.indexBuffer=d.createIndexBuffer(x),this.segments=g.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ws={symbol:function(v,d,p,x,C){if("translucent"!==v.renderPass)return;const T=g.StencilMode.disabled,P=v.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(F,z,j,W,K,ne,he){const pe=z.transform,le="map"===K,me="map"===ne;for(const J of F){const de=W.getTile(J),be=de.getBucket(j);if(!be||!be.text||!be.text.segments.get().length)continue;const xe=g.evaluateSizeForZoom(be.textSizeData,pe.zoom),Ne=So(J,be.getProjection(),pe),Be=pe.calculatePixelsToTileUnitsMatrix(de),ke=yt(Ne,de.tileID.canonical,me,le,pe,be.getProjection(),Be),We="none"!==j.layout.get("icon-text-fit")&&be.hasIconData();if(xe){const $e=Math.pow(2,pe.zoom-de.tileID.overscaledZ);Ov(be,le,me,he,g.symbolSize,pe,ke,J,$e,xe,We)}}}(x,v,p,d,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),C),0!==p.paint.get("icon-opacity").constantOr(1)&&ey(v,d,p,x,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),T,P),0!==p.paint.get("text-opacity").constantOr(1)&&ey(v,d,p,x,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),T,P),d.map.showCollisionBoxes&&(Md(v,d,p,x,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),Md(v,d,p,x,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(v,d,p,x){if("translucent"!==v.renderPass)return;const C=p.paint.get("circle-opacity"),T=p.paint.get("circle-stroke-width"),P=p.paint.get("circle-stroke-opacity"),F=void 0!==p.layout.get("circle-sort-key").constantOr(1);if(0===C.constantOr(1)&&(0===T.constantOr(1)||0===P.constantOr(1)))return;const z=v.context,j=z.gl,W=v.transform,K=v.depthModeForSublayer(0,g.DepthMode.ReadOnly),ne=g.StencilMode.disabled,he=v.colorModeForRenderPass(),pe="globe"===W.projection.name,le=[g.mercatorXfromLng(W.center.lng),g.mercatorYfromLat(W.center.lat)],me=[];for(let de=0;de<x.length;de++){const be=x[de],xe=d.getTile(be),Ne=xe.getBucket(p);if(!Ne||Ne.projection.name!==W.projection.name)continue;const Be=Ne.programConfigurations.get(p.id),ke=ns(p);pe&&ke.push("PROJECTION_GLOBE_VIEW");const We=v.useProgram("circle",Be,ke),$e=Ne.layoutVertexBuffer,Ye=Ne.globeExtVertexBuffer,St=Ne.indexBuffer,Je=W.projection.createInversionMatrix(W,be.canonical),vt={programConfiguration:Be,program:We,layoutVertexBuffer:$e,globeExtVertexBuffer:Ye,indexBuffer:St,uniformValues:Sc(v,be,xe,Je,le,p),tile:xe};if(F){const et=Ne.segments.get();for(const Rt of et)me.push({segments:new g.SegmentVector([Rt]),sortKey:Rt.sortKey,state:vt})}else me.push({segments:Ne.segments,sortKey:0,state:vt})}F&&me.sort((de,be)=>de.sortKey-be.sortKey);const J={useDepthForOcclusion:!pe};for(const de of me){const{programConfiguration:be,program:xe,layoutVertexBuffer:Ne,globeExtVertexBuffer:Be,indexBuffer:ke,uniformValues:We,tile:$e}=de.state,Ye=de.segments;v.terrain&&v.terrain.setupElevationDraw($e,xe,J),v.prepareDrawProgram(z,xe,$e.tileID.toUnwrapped()),xe.draw(z,j.TRIANGLES,K,ne,he,g.CullFaceMode.disabled,We,p.id,Ne,ke,Ye,p.paint,W.zoom,be,[Be])}},heatmap:function(v,d,p,x){if(0!==p.paint.get("heatmap-opacity"))if("offscreen"===v.renderPass){const C=v.context,T=C.gl,P=g.StencilMode.disabled,F=new g.ColorMode([T.ONE,T.ONE],g.Color.transparent,[!0,!0,!0,!0]);(function(he,pe,le,me){const J=he.gl,de=pe.width*me,be=pe.height*me;he.activeTexture.set(J.TEXTURE1),he.viewport.set([0,0,de,be]);let xe=le.heatmapFbo;if(!xe||xe&&(xe.width!==de||xe.height!==be)){xe&&xe.destroy();const Ne=J.createTexture();J.bindTexture(J.TEXTURE_2D,Ne),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR),xe=le.heatmapFbo=he.createFramebuffer(de,be,!1),function(Be,ke,We,$e,Ye,St){const Je=Be.gl;Je.texImage2D(Je.TEXTURE_2D,0,Be.isWebGL2&&Be.extRenderToTextureHalfFloat?Je.RGBA16F:Je.RGBA,Ye,St,0,Je.RGBA,Be.extRenderToTextureHalfFloat?Be.isWebGL2?Je.HALF_FLOAT:Be.extTextureHalfFloat.HALF_FLOAT_OES:Je.UNSIGNED_BYTE,null),$e.colorAttachment.set(We)}(he,0,Ne,xe,de,be)}else J.bindTexture(J.TEXTURE_2D,xe.colorAttachment.get()),he.bindFramebuffer.set(xe.framebuffer)})(C,v,p,"globe"===v.transform.projection.name?.5:.25),C.clear({color:g.Color.transparent});const z=v.transform,j="globe"===z.projection.name,W=j?["PROJECTION_GLOBE_VIEW"]:null,K=j?g.CullFaceMode.frontCCW:g.CullFaceMode.disabled,ne=[g.mercatorXfromLng(z.center.lng),g.mercatorYfromLat(z.center.lat)];for(let he=0;he<x.length;he++){const pe=x[he];if(d.hasRenderableParent(pe))continue;const le=d.getTile(pe),me=le.getBucket(p);if(!me||me.projection.name!==z.projection.name)continue;const J=me.programConfigurations.get(p.id),de=v.useProgram("heatmap",J,W),{zoom:be}=v.transform;v.terrain&&v.terrain.setupElevationDraw(le,de),v.prepareDrawProgram(C,de,pe.toUnwrapped());const xe=z.projection.createInversionMatrix(z,pe.canonical);de.draw(C,T.TRIANGLES,g.DepthMode.disabled,P,F,K,kp(v,pe,le,xe,ne,be,p.paint.get("heatmap-intensity")),p.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,p.paint,v.transform.zoom,J,j?[me.globeExtVertexBuffer]:null)}C.viewport.set([0,0,v.width,v.height])}else"translucent"===v.renderPass&&(v.context.setColorMode(v.colorModeForRenderPass()),function(C,T){const P=C.context,F=P.gl,z=T.heatmapFbo;if(!z)return;P.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,z.colorAttachment.get()),P.activeTexture.set(F.TEXTURE1);let j=T.colorRampTexture;j||(j=T.colorRampTexture=new g.Texture(P,T.colorRamp,F.RGBA)),j.bind(F.LINEAR,F.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(P,F.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,C.colorModeForRenderPass(),g.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:T.paint.get("heatmap-opacity")},T.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,T.paint,C.transform.zoom)}(v,p))},line:function(v,d,p,x){if("translucent"!==v.renderPass)return;const C=p.paint.get("line-opacity"),T=p.paint.get("line-width");if(0===C.constantOr(1)||0===T.constantOr(1))return;const P=v.depthModeForSublayer(0,g.DepthMode.ReadOnly),F=v.colorModeForRenderPass(),z=v.terrain&&v.terrain.renderingToTexture?1:g.exported.devicePixelRatio,j=p.paint.get("line-dasharray"),W=j.constantOr(1),K=p.layout.get("line-cap"),ne=p.paint.get("line-pattern"),he=ne.constantOr(1),pe=p.paint.get("line-gradient"),le=he?"linePattern":"line",me=v.context,J=me.gl,de=(xe=>{const Ne=[];Yd(xe)&&Ne.push("RENDER_LINE_DASH"),xe.paint.get("line-gradient")&&Ne.push("RENDER_LINE_GRADIENT");const Be=xe.paint.get("line-trim-offset");0===Be[0]&&0===Be[1]||Ne.push("RENDER_LINE_TRIM_OFFSET");const ke=xe.paint.get("line-pattern").constantOr(1),We=1!==xe.paint.get("line-opacity").constantOr(1);return!ke&&We&&Ne.push("RENDER_LINE_ALPHA_DISCARD"),Ne})(p);let be=de.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(be=!1);for(const xe of x){const Ne=d.getTile(xe);if(he&&!Ne.patternsLoaded())continue;const Be=Ne.getBucket(p);if(!Be)continue;v.prepareDrawTile();const ke=Be.programConfigurations.get(p.id),We=v.useProgram(le,ke,de),$e=ne.constantOr(null);if($e&&Ne.imageAtlas){const Mt=Ne.imageAtlas.patternPositions[$e.toString()];Mt&&ke.setConstantPatternPositions(Mt)}const Ye=j.constantOr(null),St=K.constantOr(null);if(!he&&Ye&&St&&Ne.lineAtlas){const Mt=Ne.lineAtlas.getDash(Ye,St);Mt&&ke.setConstantPatternPositions(Mt)}let[Je,vt]=p.paint.get("line-trim-offset");("round"===St||"square"===St)&&Je!==vt&&(0===Je&&(Je-=1),1===vt&&(vt+=1));const et=v.terrain?xe.projMatrix:null,Rt=he?Oh(v,Ne,p,et,z):Ag(v,Ne,p,et,Be.lineClipsArray.length,z,[Je,vt]);if(pe){const Mt=Be.gradients[p.id];let Nt=Mt.texture;if(p.gradientVersion!==Mt.version){let Bt=256;if(p.stepInterpolant){const Zt=d.getSource().maxzoom,$i=xe.canonical.z===Zt?Math.ceil(1<<v.transform.maxZoom-xe.canonical.z):1;Bt=g.clamp(g.nextPowerOfTwo(Be.maxLineLength/g.EXTENT*1024*$i),256,me.maxTextureSize)}Mt.gradient=g.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:Bt,image:Mt.gradient||void 0,clips:Be.lineClipsArray}),Mt.texture?Mt.texture.update(Mt.gradient):Mt.texture=new g.Texture(me,Mt.gradient,J.RGBA),Mt.version=p.gradientVersion,Nt=Mt.texture}me.activeTexture.set(J.TEXTURE1),Nt.bind(p.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}W&&(me.activeTexture.set(J.TEXTURE0),Ne.lineAtlasTexture.bind(J.LINEAR,J.REPEAT),ke.updatePaintBuffers()),he&&(me.activeTexture.set(J.TEXTURE0),Ne.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),ke.updatePaintBuffers()),v.prepareDrawProgram(me,We,xe.toUnwrapped());const tt=Mt=>{We.draw(me,J.TRIANGLES,P,Mt,F,g.CullFaceMode.disabled,Rt,p.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,p.paint,v.transform.zoom,ke,[Be.layoutVertexBuffer2])};if(be){const Mt=v.stencilModeForClipping(xe).ref;0===Mt&&v.terrain&&me.clear({stencil:0});const Nt={func:J.EQUAL,mask:255};Rt.u_alpha_discard_threshold=.8,tt(new g.StencilMode(Nt,Mt,255,J.KEEP,J.KEEP,J.INVERT)),Rt.u_alpha_discard_threshold=0,tt(new g.StencilMode(Nt,Mt,255,J.KEEP,J.KEEP,J.KEEP))}else tt(v.stencilModeForClipping(xe))}be&&(v.resetStencilClippingMasks(),v.terrain&&me.clear({stencil:0}))},fill:function(v,d,p,x){const C=p.paint.get("fill-color"),T=p.paint.get("fill-opacity");if(0===T.constantOr(1))return;const P=v.colorModeForRenderPass(),F=p.paint.get("fill-pattern"),z=v.opaquePassEnabledForLayer()&&!F.constantOr(1)&&1===C.constantOr(g.Color.transparent).a&&1===T.constantOr(0)?"opaque":"translucent";if(v.renderPass===z){const j=v.depthModeForSublayer(1,"opaque"===v.renderPass?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly);ty(v,d,p,x,j,P,!1)}if("translucent"===v.renderPass&&p.paint.get("fill-antialias")){const j=v.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,g.DepthMode.ReadOnly);ty(v,d,p,x,j,P,!0)}},"fill-extrusion":function(v,d,p,x){const C=p.paint.get("fill-extrusion-opacity");if(0!==C&&"translucent"===v.renderPass){const T=new g.DepthMode(v.context.gl.LEQUAL,g.DepthMode.ReadWrite,v.depthRangeFor3D);if(1!==C||p.paint.get("fill-extrusion-pattern").constantOr(1))zh(v,d,p,x,T,g.StencilMode.disabled,g.ColorMode.disabled),zh(v,d,p,x,T,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const P=v.colorModeForRenderPass();zh(v,d,p,x,T,g.StencilMode.disabled,P)}}},hillshade:function(v,d,p,x){if("offscreen"!==v.renderPass&&"translucent"!==v.renderPass)return;const C=v.context,T=v.depthModeForSublayer(0,g.DepthMode.ReadOnly),P=v.colorModeForRenderPass(),F=v.terrain&&v.terrain.renderingToTexture,[z,j]="translucent"!==v.renderPass||F?[{},x]:v.stencilConfigForOverlap(x);for(const W of j){const K=d.getTile(W);if(K.needsHillshadePrepare&&"offscreen"===v.renderPass)J_(v,K,p,T,g.StencilMode.disabled,P);else if("translucent"===v.renderPass){const ne=F&&v.terrain?v.terrain.stencilModeForRTTOverlap(W):z[W.overscaledZ];Uo(v,W,K,p,T,ne,P)}}C.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,d,p,x,C,T){if("translucent"!==v.renderPass||0===p.paint.get("raster-opacity")||!x.length)return;const P=v.context,F=P.gl,z=d.getSource(),j=v.useProgram("raster"),W=v.colorModeForRenderPass(),K=v.terrain&&v.terrain.renderingToTexture,[ne,he]=z instanceof or||K?[{},x]:v.stencilConfigForOverlap(x),pe=he[he.length-1].overscaledZ,le=!v.options.moving;for(const me of he){const J=K?g.DepthMode.disabled:v.depthModeForSublayer(me.overscaledZ-pe,1===p.paint.get("raster-opacity")?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly,F.LESS),de=me.toUnwrapped(),be=d.getTile(me);if(K&&(!be||!be.hasData()))continue;const xe=K?me.projMatrix:v.transform.calculateProjMatrix(de,le),Ne=v.terrain&&K?v.terrain.stencilModeForRTTOverlap(me):ne[me.overscaledZ],Be=T?0:p.paint.get("raster-fade-duration");be.registerFadeDuration(Be);const ke=d.findLoadedParent(me,0),We=Cg(be,ke,d,v.transform,Be);let $e,Ye;v.terrain&&v.terrain.prepareDrawTile();const St="nearest"===p.paint.get("raster-resampling")?F.NEAREST:F.LINEAR;P.activeTexture.set(F.TEXTURE0),be.texture.bind(St,F.CLAMP_TO_EDGE),P.activeTexture.set(F.TEXTURE1),ke?(ke.texture.bind(St,F.CLAMP_TO_EDGE),$e=Math.pow(2,ke.tileID.overscaledZ-be.tileID.overscaledZ),Ye=[be.tileID.canonical.x*$e%1,be.tileID.canonical.y*$e%1]):be.texture.bind(St,F.CLAMP_TO_EDGE),be.texture.useMipmap&&P.extTextureFilterAnisotropic&&v.transform.pitch>20&&F.texParameterf(F.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax);const Je=Kd(xe,Ye||[0,0],$e||1,We,p,z instanceof or?z.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(P,j,de),z instanceof or)z.boundsBuffer&&z.boundsSegments&&j.draw(P,F.TRIANGLES,J,g.StencilMode.disabled,W,g.CullFaceMode.disabled,Je,p.id,z.boundsBuffer,v.quadTriangleIndexBuffer,z.boundsSegments);else{const{tileBoundsBuffer:vt,tileBoundsIndexBuffer:et,tileBoundsSegments:Rt}=v.getTileBoundsBuffers(be);j.draw(P,F.TRIANGLES,J,Ne,W,g.CullFaceMode.disabled,Je,p.id,vt,et,Rt)}}v.resetStencilClippingMasks()},background:function(v,d,p,x){const C=p.paint.get("background-color"),T=p.paint.get("background-opacity");if(0===T)return;const P=v.context,F=P.gl,z=v.transform,j=z.tileSize,W=p.paint.get("background-pattern");if(v.isPatternMissing(W))return;const K=!W&&1===C.a&&1===T&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==K)return;const ne=g.StencilMode.disabled,he=v.depthModeForSublayer(0,"opaque"===K?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly),pe=v.colorModeForRenderPass(),le=v.useProgram(W?"backgroundPattern":"background");let me,J=x;J||(me=v.getBackgroundTiles(),J=Object.values(me).map(de=>de.tileID)),W&&(P.activeTexture.set(F.TEXTURE0),v.imageManager.bind(v.context));for(const de of J){const be=de.toUnwrapped(),xe=x?de.projMatrix:v.transform.calculateProjMatrix(be);v.prepareDrawTile();const Ne=d?d.getTile(de):me?me[de.key]:new g.Tile(de,j,z.zoom,v),Be=W?Q_(xe,T,v,W,{tileID:de,tileSize:j}):Bh(xe,T,C);v.prepareDrawProgram(P,le,be);const{tileBoundsBuffer:ke,tileBoundsIndexBuffer:We,tileBoundsSegments:$e}=v.getTileBoundsBuffers(Ne);le.draw(P,F.TRIANGLES,he,ne,pe,g.CullFaceMode.disabled,Be,p.id,ke,We,$e)}},sky:function(v,d,p){const x=v.transform,C="mercator"===x.projection.name||"globe"===x.projection.name?1:g.smoothstep(7,8,x.zoom),T=p.paint.get("sky-opacity")*C;if(0===T)return;const P=v.context,F=p.paint.get("sky-type"),z=new g.DepthMode(P.gl.LEQUAL,g.DepthMode.ReadOnly,[0,1]),j=v.frameCounter/1e3%1;"atmosphere"===F?"offscreen"===v.renderPass?p.needsSkyboxCapture(v)&&(function(W,K,ne,he){const pe=W.context,le=pe.gl;let me=K.skyboxFbo;if(!me){me=K.skyboxFbo=pe.createFramebuffer(32,32,!1),K.skyboxGeometry=new vr(pe),K.skyboxTexture=pe.gl.createTexture(),le.bindTexture(le.TEXTURE_CUBE_MAP,K.skyboxTexture),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MAG_FILTER,le.LINEAR);for(let xe=0;xe<6;++xe)le.texImage2D(le.TEXTURE_CUBE_MAP_POSITIVE_X+xe,0,le.RGBA,32,32,0,le.RGBA,le.UNSIGNED_BYTE,null)}pe.bindFramebuffer.set(me.framebuffer),pe.viewport.set([0,0,32,32]);const J=K.getCenter(W,!0),de=W.useProgram("skyboxCapture"),be=new Float64Array(16);g.identity(be),g.rotateY(be,be,.5*-Math.PI),vo(pe,K,de,be,J,0),g.identity(be),g.rotateY(be,be,.5*Math.PI),vo(pe,K,de,be,J,1),g.identity(be),g.rotateX(be,be,.5*-Math.PI),vo(pe,K,de,be,J,2),g.identity(be),g.rotateX(be,be,.5*Math.PI),vo(pe,K,de,be,J,3),g.identity(be),vo(pe,K,de,be,J,4),g.identity(be),g.rotateY(be,be,Math.PI),vo(pe,K,de,be,J,5),pe.viewport.set([0,0,W.width,W.height])}(v,p),p.markSkyboxValid(v)):"sky"===v.renderPass&&function(W,K,ne,he,pe){const le=W.context,me=le.gl,J=W.transform,de=W.useProgram("skybox");le.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_CUBE_MAP,K.skyboxTexture);const be={u_matrix:J.skyboxMatrix,u_sun_direction:K.getCenter(W,!1),u_cubemap:0,u_opacity:he,u_temporal_offset:pe};W.prepareDrawProgram(le,de),de.draw(le,me.TRIANGLES,ne,g.StencilMode.disabled,W.colorModeForRenderPass(),g.CullFaceMode.backCW,be,"skybox",K.skyboxGeometry.vertexBuffer,K.skyboxGeometry.indexBuffer,K.skyboxGeometry.segment)}(v,p,z,T,j):"gradient"===F&&"sky"===v.renderPass&&function(W,K,ne,he,pe){const le=W.context,me=le.gl,J=W.transform,de=W.useProgram("skyboxGradient");K.skyboxGeometry||(K.skyboxGeometry=new vr(le)),le.activeTexture.set(me.TEXTURE0);let be=K.colorRampTexture;be||(be=K.colorRampTexture=new g.Texture(le,K.colorRamp,me.RGBA)),be.bind(me.LINEAR,me.CLAMP_TO_EDGE);const xe=(Ne=J.skyboxMatrix,Be=K.getCenter(W,!1),ke=K.paint.get("sky-gradient-radius"),We=he,$e=pe,{u_matrix:Ne,u_color_ramp:0,u_center_direction:Be,u_radius:g.degToRad(ke),u_opacity:We,u_temporal_offset:$e});var Ne,Be,ke,We,$e;W.prepareDrawProgram(le,de),de.draw(le,me.TRIANGLES,ne,g.StencilMode.disabled,W.colorModeForRenderPass(),g.CullFaceMode.backCW,xe,"skyboxGradient",K.skyboxGeometry.vertexBuffer,K.skyboxGeometry.indexBuffer,K.skyboxGeometry.segment)}(v,p,z,T,j)},debug:function(v,d,p){for(let x=0;x<p.length;x++)js(v,d,p[x])},custom:function(v,d,p,x){const C=v.context,T=p.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||"offscreen"===v.renderPass)&&p.isLayerDraped()){if("offscreen"===v.renderPass){const P=T.prerender;if(P){if(v.setCustomLayerDefaults(),C.setColorMode(v.colorModeForRenderPass()),"globe"===v.transform.projection.name){const F=v.transform.pointMerc;P.call(T,C.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),g.globeToMercatorTransition(v.transform.zoom),[F.x,F.y],v.transform.pixelsPerMeterRatio)}else P.call(T,C.gl,v.transform.customLayerMatrix());C.setDirty(),v.setBaseState()}}else if("translucent"===v.renderPass){if(v.terrain&&v.terrain.renderingToTexture){const F=T.renderToTile;if(F){const z=x[0].canonical,j=new g.MercatorCoordinate(z.x+x[0].wrap*(1<<z.z),z.y,z.z);C.setDepthMode(g.DepthMode.disabled),C.setStencilMode(g.StencilMode.disabled),C.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),F.call(T,C.gl,j),C.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),C.setColorMode(v.colorModeForRenderPass()),C.setStencilMode(g.StencilMode.disabled);const P="3d"===T.renderingMode?new g.DepthMode(v.context.gl.LEQUAL,g.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,g.DepthMode.ReadOnly);if(C.setDepthMode(P),"globe"===v.transform.projection.name){const F=v.transform.pointMerc;T.render(C.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),g.globeToMercatorTransition(v.transform.zoom),[F.x,F.y],v.transform.pixelsPerMeterRatio)}else T.render(C.gl,v.transform.customLayerMatrix());C.setDirty(),v.setBaseState(),C.bindFramebuffer.set(null)}}else g.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class qu{constructor(d,p,x=!1){this.context=new ri(d,x),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=g.SourceCache.maxUnderzooming+g.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(d,p){const x=!!d&&!!d.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new sl(this,d));const C=this._terrain;this.transform.elevation=x?C:null,C.update(d,this.transform,p)}_updateFog(d){const p=d.fog;if(!p||"globe"===this.transform.projection.name||p.getOpacity(this.transform.pitch)<1||p.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,C]=p.getFovAdjustedRange(this.transform._fov);if(x>C)return void(this.transform.fogCullDistSq=null);const T=x+.78*(C-x);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(d,p){if(this.width=d*g.exported.devicePixelRatio,this.height=p*g.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._layers[x].resize()}setup(){const d=this.context,p=new g.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(g.EXTENT,0),p.emplaceBack(0,g.EXTENT),p.emplaceBack(g.EXTENT,g.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(p,g.posAttributes.members),this.tileExtentSegments=g.SegmentVector.simpleSegment(0,0,4,2);const x=new g.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(g.EXTENT,0),x.emplaceBack(0,g.EXTENT),x.emplaceBack(g.EXTENT,g.EXTENT),this.debugBuffer=d.createVertexBuffer(x,g.posAttributes.members),this.debugSegments=g.SegmentVector.simpleSegment(0,0,4,5);const C=new g.StructArrayLayout2i4;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(-1,1),C.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(C,g.posAttributes.members),this.viewportSegments=g.SegmentVector.simpleSegment(0,0,4,2);const T=new g.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(g.EXTENT,0,g.EXTENT,0),T.emplaceBack(0,g.EXTENT,0,g.EXTENT),T.emplaceBack(g.EXTENT,g.EXTENT,g.EXTENT,g.EXTENT),this.mercatorBoundsBuffer=d.createVertexBuffer(T,g.boundsAttributes.members),this.mercatorBoundsSegments=g.SegmentVector.simpleSegment(0,0,4,2);const P=new g.StructArrayLayout3ui6;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(P);const F=new g.StructArrayLayout1ui2;for(const j of[0,1,3,2,0])F.emplaceBack(j);this.debugIndexBuffer=d.createIndexBuffer(F),this.emptyTexture=new g.Texture(d,new g.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),d.gl.RGBA),this.identityMat=g.create();const z=this.context.gl;this.stencilClearMode=new g.StencilMode({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(g.window.performance.now()),this.atmosphereBuffer=new Br(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(d){return d._makeTileBoundsBuffers(this.context,this.transform.projection),d._tileBoundsBuffer?{tileBoundsBuffer:d._tileBoundsBuffer,tileBoundsIndexBuffer:d._tileBoundsIndexBuffer,tileBoundsSegments:d._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const d=this.context,p=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(d,p.TRIANGLES,g.DepthMode.disabled,this.stencilClearMode,g.ColorMode.disabled,g.CullFaceMode.disabled,xf(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(d,p,x){if(!p||this.currentStencilSource===p.id||!d.isTileClipped()||!x||0===x.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let F=!1;for(const z of x)if(void 0===this._tileClippingMaskIDs[z.key]){F=!0;break}if(!F)return}this.currentStencilSource=p.id;const C=this.context,T=C.gl;this.nextStencilID+x.length>256&&this.clearStencil(),C.setColorMode(g.ColorMode.disabled),C.setDepthMode(g.DepthMode.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const F of x){const z=p.getTile(F),j=this._tileClippingMaskIDs[F.key]=this.nextStencilID++,{tileBoundsBuffer:W,tileBoundsIndexBuffer:K,tileBoundsSegments:ne}=this.getTileBoundsBuffers(z);P.draw(C,T.TRIANGLES,g.DepthMode.disabled,new g.StencilMode({func:T.ALWAYS,mask:0},j,255,T.KEEP,T.KEEP,T.REPLACE),g.ColorMode.disabled,g.CullFaceMode.disabled,xf(F.projMatrix),"$clipping",W,K,ne)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const d=this.nextStencilID++,p=this.context.gl;return new g.StencilMode({func:p.NOTEQUAL,mask:255},d,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(d){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(d);const p=this.context.gl;return new g.StencilMode({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(d){const p=this.context.gl,x=d.sort((P,F)=>F.overscaledZ-P.overscaledZ),C=x[x.length-1].overscaledZ,T=x[0].overscaledZ-C+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const P={};for(let F=0;F<T;F++)P[F+C]=new g.StencilMode({func:p.GEQUAL,mask:255},F+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=T,[P,x]}return[{[C]:g.StencilMode.disabled},x]}colorModeForRenderPass(){const d=this.context.gl;return this._showOverdrawInspector?new g.ColorMode([d.CONSTANT_COLOR,d.ONE],new g.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?g.ColorMode.unblended:g.ColorMode.alphaBlended}depthModeForSublayer(d,p,x){if(!this.opaquePassEnabledForLayer())return g.DepthMode.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new g.DepthMode(x||this.context.gl.LEQUAL,p,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(d,p){this.style=d,this.options=p,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(g.exported.now()),this.imageManager.beginFrame();const x=this.style.order,C=this.style._sourceCaches;for(const j in C){const W=C[j];W.used&&W.prepare(this.context)}const T={},P={},F={};for(const j in C){const W=C[j];T[j]=W.getVisibleCoordinates(),P[j]=T[j].slice().reverse(),F[j]=W.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<x.length;j++)if(this.style._layers[x[j]].is3D()){this.opaquePassCutoff=j;break}if(this.terrain&&(this.terrain.updateTileBinding(F),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new g.GlobeSharedBuffers(this.context)),!g.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const j of x){const W=this.style._layers[j],K=d._getLayerSourceCache(W);if(!W.hasOffscreenPass()||W.isHidden(this.transform.zoom))continue;const ne=K?P[K.id]:void 0;("custom"===W.type||W.isSky()||ne&&ne.length)&&this.renderLayer(this,K,W,ne)}this.depthRangeFor3D=[0,1-(d.order.length+2)*this.numSublayers*this.depthEpsilon];const z=this.terrain;if(z&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&z.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:p.showOverdrawInspector?g.Color.black:g.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[x[this.currentLayer]],W=d._getLayerSourceCache(j);if(j.isSky())continue;const K=W?P[W.id]:void 0;this._renderTileClippingMasks(j,W,K),this.renderLayer(this,W,j,K)}if(this.style.fog&&this.transform.projection.supportsFog&&function(j,W){const K=j.context,ne=K.gl,he=j.transform,pe=new g.DepthMode(ne.LEQUAL,g.DepthMode.ReadOnly,[0,1]),le=j.useProgram("globeAtmosphere",null,"globe"===he.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),me=g.globeToMercatorTransition(he.zoom),J=W.properties.get("color").toArray01(),de=W.properties.get("high-color").toArray01(),be=W.properties.get("space-color").toArray01PremultipliedAlpha(),xe=g.identity$1([]);g.rotateY$1(xe,xe,-g.degToRad(he._center.lng)),g.rotateX$1(xe,xe,g.degToRad(he._center.lat)),g.rotateZ$1(xe,xe,he.angle),g.rotateX$1(xe,xe,-he._pitch);const Ne=g.fromQuat(new Float32Array(16),xe),Be=g.mapValue(W.properties.get("star-intensity"),0,1,0,.25),We=g.mapValue(W.properties.get("horizon-blend"),0,1,5e-4,.25),$e=g.globeUseCustomAntiAliasing(j,K,he)&&5e-4===We?he.worldSize/(2*Math.PI*1.025)-1:he.globeRadius,Ye=j.frameCounter/1e3%1,St=g.length(he.globeCenterInViewSpace),Je=Math.sqrt(Math.pow(St,2)-Math.pow($e,2)),vt=Math.acos(Je/St),et={u_frustum_tl:he.frustumCorners.TL,u_frustum_tr:he.frustumCorners.TR,u_frustum_br:he.frustumCorners.BR,u_frustum_bl:he.frustumCorners.BL,u_horizon:he.frustumCorners.horizon,u_transition:me,u_fadeout_range:We,u_color:J,u_high_color:de,u_space_color:be,u_star_intensity:Be,u_star_size:5*g.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ye,u_horizon_angle:vt,u_rotation_matrix:Ne};j.prepareDrawProgram(K,le);const Rt=j.atmosphereBuffer;Rt&&le.draw(K,ne.TRIANGLES,pe,g.StencilMode.disabled,g.ColorMode.alphaBlended,g.CullFaceMode.backCW,et,"skybox",Rt.vertexBuffer,Rt.indexBuffer,Rt.segments)}(this,this.style.fog),this.renderPass="sky",(g.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const j=this.style._layers[x[this.currentLayer]],W=d._getLayerSourceCache(j);j.isSky()&&this.renderLayer(this,W,j,W?P[W.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;){const j=this.style._layers[x[this.currentLayer]],W=d._getLayerSourceCache(j);if(j.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(j)){if(j.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const K=W?("symbol"===j.type?F:P)[W.id]:void 0;this._renderTileClippingMasks(j,W,W?T[W.id]:void 0),this.renderLayer(this,W,j,K),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let j=null;g.values(this.style._layers).forEach(W=>{const K=d._getLayerSourceCache(W);K&&!W.isHidden(this.transform.zoom)&&(!j||j.getSource().maxzoom<K.getSource().maxzoom)&&(j=K)}),j&&this.options.showTileBoundaries&&Ws.debug(this,j,j.getVisibleCoordinates())}this.options.showPadding&&function(j){const W=j.transform.padding;Po(j,j.transform.height-(W.top||0),3,kt),Po(j,W.bottom||0,3,wt),Nn(j,W.left||0,3,Gi),Nn(j,j.transform.width-(W.right||0),3,ui);const K=j.transform.centerPoint;var ne,he,pe,le;Fp(ne=j,(he=K.x)-1,(pe=j.transform.height-K.y)-10,2,20,le=so),Fp(ne,he-10,pe-1,20,2,le)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(g.window.performance.now()),this.saveCanvasCopy())}renderLayer(d,p,x,C){x.isHidden(this.transform.zoom)||("background"===x.type||"sky"===x.type||"custom"===x.type||C&&C.length)&&(this.id=x.id,this.gpuTimingStart(x),(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes(x.type)||d.terrain&&"custom"===x.type)&&Ws[x.type](d,p,x,C,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(d){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let x=this.gpuTimers[d.id];x||(x=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),x.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const d=this.context.extTimerQuery,p=d.createQueryEXT();this.deferredRenderGpuTimeQueries.push(p),d.beginQueryEXT(d.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}collectGpuTimers(){const d=this.gpuTimers;return this.gpuTimers={},d}collectDeferredRenderGpuQueries(){const d=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],d}queryGpuTimers(d){const p={};for(const x in d){const C=d[x],T=this.context.extTimerQuery,P=T.getQueryObjectEXT(C.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(C.query),p[x]=P}return p}queryGpuTimeDeferredRender(d){if(!this.options.gpuTimingDeferredRender)return 0;const p=this.context.extTimerQuery;let x=0;for(const C of d)x+=p.getQueryObjectEXT(C,p.QUERY_RESULT_EXT)/1e6,p.deleteQueryEXT(C);return x}translatePosMatrix(d,p,x,C,T){if(!x[0]&&!x[1])return d;const P=T?"map"===C?this.transform.angle:0:"viewport"===C?-this.transform.angle:0;if(P){const j=Math.sin(P),W=Math.cos(P);x=[x[0]*W-x[1]*j,x[0]*j+x[1]*W]}const F=[T?x[0]:Bo(p,x[0],this.transform.zoom),T?x[1]:Bo(p,x[1],this.transform.zoom),0],z=new Float32Array(16);return g.translate(z,d,F),z}saveTileTexture(d){const p=this._tileTextures[d.size[0]];p?p.push(d):this._tileTextures[d.size[0]]=[d]}getTileTexture(d){const p=this._tileTextures[d];return p&&p.length>0?p.pop():null}isPatternMissing(d){return null===d||void 0!==d&&!this.imageManager.getPattern(d.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const d=this.terrain&&this.terrain.renderingToTexture,p=this.terrain&&0===this.terrain.exaggeration(),x=this.style&&this.style.fog,C=[];return this.terrainRenderModeElevated()&&C.push("TERRAIN"),"globe"===this.transform.projection.name&&C.push("GLOBE"),p&&C.push("ZERO_EXAGGERATION"),x&&!d&&0!==x.getOpacity(this.transform.pitch)&&C.push("FOG"),d&&C.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&C.push("OVERDRAW_INSPECTOR"),C}useProgram(d,p,x){this.cache=this.cache||{};const C=x||[],T=this.currentGlobalDefines().concat(C),P=Mr.cacheKey(vf[d],d,T,p);return this.cache[P]||(this.cache[P]=new Mr(this.context,d,vf[d],p,Dg[d],T)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=g.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new g.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(d,p,x){if(this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const T=C.getOpacity(this.transform.pitch),P=((F,z,j,W,K,ne,he,pe,le,me,J)=>{const de=F.transform,be=z.properties.get("color").toArray01();be[3]=W;const xe=F.frameCounter/1e3%1;return{u_fog_matrix:j?de.calculateFogTileMatrix(j):F.identityMat,u_fog_range:z.getFovAdjustedRange(de._fov),u_fog_color:be,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_temporal_offset:xe,u_frustum_tl:K,u_frustum_tr:ne,u_frustum_br:he,u_frustum_bl:pe,u_globe_pos:le,u_globe_radius:me,u_viewport:J,u_globe_transition:g.globeToMercatorTransition(de.zoom),u_is_globe:+("globe"===de.projection.name)}})(this,C,x,T,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*g.exported.devicePixelRatio,this.transform.height*g.exported.devicePixelRatio]);p.setFogUniformValues(d,P)}}setTileLoadedFlag(d){this.tileLoaded=d}saveCanvasCopy(){const d=this.canvasCopy();d&&(this.frameCopies.push(d),this.tileLoaded=!1)}canvasCopy(){const d=this.context.gl,p=d.createTexture();return d.bindTexture(d.TEXTURE_2D,p),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,0,0,d.drawingBufferWidth,d.drawingBufferHeight,0),p}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const d=this.style&&this.style.fog;return!!d&&0!==d.getOpacity(this.transform.pitch)}getBackgroundTiles(){const d=this._backgroundTiles,p=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const C of x)p[C.key]=d[C.key]||new g.Tile(C,512,this.transform.tileZoom,this);return p}clearBackgroundTiles(){this._backgroundTiles={}}}class Xu{constructor(d=0,p=0,x=0,C=0){if(isNaN(d)||d<0||isNaN(p)||p<0||isNaN(x)||x<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=p,this.left=x,this.right=C}interpolate(d,p,x){return null!=p.top&&null!=d.top&&(this.top=g.number(d.top,p.top,x)),null!=p.bottom&&null!=d.bottom&&(this.bottom=g.number(d.bottom,p.bottom,x)),null!=p.left&&null!=d.left&&(this.left=g.number(d.left,p.left,x)),null!=p.right&&null!=d.right&&(this.right=g.number(d.right,p.right,x)),this}getCenter(d,p){const x=g.clamp((this.left+d-this.right)/2,0,d),C=g.clamp((this.top+p-this.bottom)/2,0,p);return new g.Point(x,C)}equals(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right}clone(){return new Xu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Uh(v,d){const p=g.getColumn(v,3);g.fromQuat(v,d),g.setColumn(v,3,p)}function Ar(v,d){const p=g.identity$1([]);return g.rotateZ$1(p,p,-d),g.rotateX$1(p,p,-v),p}function Ef(v,d){const p=[v[0],v[1],0],x=[d[0],d[1],0];if(g.length(p)>=1e-15){const P=g.normalize([],p);g.scale$2(x,P,g.dot(x,P)),d[0]=x[0],d[1]=x[1]}const C=g.cross([],d,v);if(g.len(C)<1e-15)return null;const T=Math.atan2(-C[1],C[0]);return Ar(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),T)}class ls{constructor(d,p){this.position=d,this.orientation=p}get position(){return this._position}set position(d){if(d){const p=d instanceof g.MercatorCoordinate?d:new g.MercatorCoordinate(d[0],d[1],d[2]);this._renderWorldCopies&&(p.x=g.wrap(p.x,0,1)),this._position=p}else this._position=null}lookAtPoint(d,p){if(this.orientation=null,!this.position)return;const x=this.position,C=this._elevation?this._elevation.getAtPointOrZero(g.MercatorCoordinate.fromLngLat(d)):0,T=g.MercatorCoordinate.fromLngLat(d,C),P=[T.x-x.x,T.y-x.y,T.z-x.z];p||(p=[0,0,1]),p[2]=Math.abs(p[2]),this.orientation=Ef(P,p)}setPitchBearing(d,p){this.orientation=Ar(g.degToRad(d),g.degToRad(-p))}}class Si{constructor(d,p){this._transform=g.identity([]),this.orientation=p,this.position=d}get mercatorPosition(){const d=this.position;return new g.MercatorCoordinate(d[0],d[1],d[2])}get position(){const d=g.getColumn(this._transform,3);return[d[0],d[1],d[2]]}set position(d){var p;d&&g.setColumn(this._transform,3,[(p=d)[0],p[1],p[2],1])}get orientation(){return this._orientation}set orientation(d){this._orientation=d||g.identity$1([]),d&&Uh(this._transform,this._orientation)}getPitchBearing(){const d=this.forward(),p=this.right();return{bearing:Math.atan2(-p[1],p[0]),pitch:Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2])}}setPitchBearing(d,p){this._orientation=Ar(d,p),Uh(this._transform,this._orientation)}forward(){const d=g.getColumn(this._transform,2);return[-d[0],-d[1],-d[2]]}up(){const d=g.getColumn(this._transform,1);return[-d[0],-d[1],-d[2]]}right(){const d=g.getColumn(this._transform,0);return[d[0],d[1],d[2]]}getCameraToWorld(d,p){const x=new Float64Array(16);return g.invert(x,this.getWorldToCamera(d,p)),x}getWorldToCameraPosition(d,p,x){const C=this.position;g.scale$2(C,C,-d);const T=new Float64Array(16);return g.fromScaling(T,[x,x,x]),g.translate(T,T,C),T[10]*=p,T}getWorldToCamera(d,p){const x=new Float64Array(16),C=new Float64Array(4),T=this.position;return g.conjugate(C,this._orientation),g.scale$2(T,T,-d),g.fromQuat(x,C),g.translate(x,x,T),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=p,x[9]*=p,x[10]*=p,x[11]*=p,x}getCameraToClipPerspective(d,p,x,C){const T=new Float64Array(16);return g.perspective(T,d,p,x,C),T}getDistanceToElevation(d,p=!1){const x=0===d?0:g.mercatorZfromAltitude(d,p?g.latFromMercatorY(this.position[1]):this.position[1]),C=this.forward();return(x-this.position[2])/C[2]}clone(){return new Si([...this.position],[...this.orientation])}}function Sn(v,d){const p=Ca(v.projection,v.zoom,v.width,v.height),x=function(T,P,F,z,j){const W=new g.LngLat(F.lng-180*Rl,F.lat),K=new g.LngLat(F.lng+180*Rl,F.lat),ne=T.project(W.lng,W.lat),he=T.project(K.lng,K.lat),pe=-Math.atan2(he.y-ne.y,he.x-ne.x),le=g.MercatorCoordinate.fromLngLat(F);le.y=g.clamp(le.y,-1+Rl,1-Rl);const me=le.toLngLat(),J=T.project(me.lng,me.lat),de=g.MercatorCoordinate.fromLngLat(me);de.x+=Rl;const be=de.toLngLat(),xe=T.project(be.lng,be.lat),Ne=Ac(xe.x-J.x,xe.y-J.y,pe),Be=g.MercatorCoordinate.fromLngLat(me);Be.y+=Rl;const ke=Be.toLngLat(),We=T.project(ke.lng,ke.lat),$e=Ac(We.x-J.x,We.y-J.y,pe),Ye=Math.abs(Ne.x)/Math.abs($e.y),St=g.identity([]);g.rotateZ(St,St,-pe*(1-(j?0:z)));const Je=g.identity([]);return g.scale(Je,Je,[1,1-(1-Ye)*z,1]),Je[4]=-$e.x/$e.y*z,g.rotateZ(Je,Je,pe),g.multiply(Je,St,Je),Je}(v.projection,0,v.center,p,d),C=Yo(v);return g.scale(x,x,[C,C,1]),x}function Yo(v){const d=v.projection,p=Ca(v.projection,v.zoom,v.width,v.height),x=aa(d,v.center),C=aa(d,g.LngLat.convert(d.center));return Math.pow(2,x*p+(1-p)*C)}function Ca(v,d,p,x,C=1/0){const T=v.range;if(!T)return 0;const P=Math.min(C,Math.max(p,x)),F=Math.log(P/1024)/Math.LN2;return g.smoothstep(T[0]+F,T[1]+F,d)}const Rl=1/4e4;function aa(v,d){const p=g.clamp(d.lat,-g.MAX_MERCATOR_LATITUDE,g.MAX_MERCATOR_LATITUDE),x=new g.LngLat(d.lng-180*Rl,p),C=new g.LngLat(d.lng+180*Rl,p),T=v.project(x.lng,p),P=v.project(C.lng,p),F=g.MercatorCoordinate.fromLngLat(x),z=g.MercatorCoordinate.fromLngLat(C),j=P.x-T.x,W=P.y-T.y,K=z.x-F.x,ne=z.y-F.y,he=Math.sqrt((K*K+ne*ne)/(j*j+W*W));return Math.log(he)/Math.LN2}function Ac(v,d,p){const x=Math.cos(p),C=Math.sin(p);return{x:v*x-d*C,y:v*C+d*x}}class Vo{constructor(d,p,x,C,T,P,F){this.tileSize=512,this._renderWorldCopies=void 0===T||T,this._minZoom=d||0,this._maxZoom=p||22,this._minPitch=x??0,this._maxPitch=C??60,this.setProjection(P),this.setMaxBounds(F),this.width=0,this.height=0,this._center=new g.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Xu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Si,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const d=new Vo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return d._elevation=this._elevation,d._centerAltitude=this._centerAltitude,d._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,d.tileSize=this.tileSize,d.mercatorFromTransition=this.mercatorFromTransition,d.width=this.width,d.height=this.height,d.cameraElevationReference=this.cameraElevationReference,d._center=this._center,d._setZoom(this.zoom),d._seaLevelZoom=this._seaLevelZoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._nearZ=this._nearZ,d._farZ=this._farZ,d._averageElevation=this._averageElevation,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._camera=this._camera.clone(),d._calcMatrices(),d.freezeTileCoverage=this.freezeTileCoverage,d.frustumCorners=this.frustumCorners,d}get elevation(){return this._elevation}set elevation(d){this._elevation!==d&&(this._elevation=d,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(d,p=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||x)&&this._updateCameraOnTerrain(),(d||x)&&this._constrainCamera(p),this._calcMatrices()}getProjection(){return g.pick(this.projection,["name","center","parallels"])}setProjection(d){this.projectionOptions=d||{name:"mercator"};const p=this.projection?this.getProjection():void 0;this.projection=g.getProjection(this.projectionOptions);const x=!gt(p,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setMercatorFromTransition(){const d=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=g.getProjection({name:"mercator"});const p=d!==this.projection.name;return p&&this._calcMatrices(),p}get minZoom(){return this._minZoom}set minZoom(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))}get maxZoom(){return this._maxZoom}set maxZoom(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))}get minPitch(){return this._minPitch}set minPitch(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))}get maxPitch(){return this._maxPitch}set maxPitch(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(d){void 0===d?d=!0:null===d&&(d=!1),this._renderWorldCopies=d}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get cameraWorldSize(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return g.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new g.Point(this.width,this.height)}get bearing(){return g.wrap(this.rotation,-180,180)}set bearing(d){this.rotation=d}get rotation(){return-this.angle/Math.PI*180}set rotation(d){const p=-d*Math.PI/180;var x,C,T,P,F,z,j,W,K,ne;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(x=new g.ARRAY_TYPE(4),g.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x),C=this.rotationMatrix,P=this.angle,F=(T=this.rotationMatrix)[0],z=T[1],j=T[2],W=T[3],K=Math.sin(P),ne=Math.cos(P),C[0]=F*ne+j*K,C[1]=z*ne+W*K,C[2]=F*-K+j*ne,C[3]=z*-K+W*ne)}get pitch(){return this._pitch/Math.PI*180}set pitch(d){const p=g.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const d=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/d)}set fov(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=g.degToRad(d),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(d){this._averageElevation=d,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(d){const p=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._setZoom(p),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(d){this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const d=this._elevation;this._centerAltitude=d.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=d.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const d=this._elevation,p=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let C=0,T=0;for(let P=0;P<p.length;P++){const F=new g.Point(p[P][0]*this.width,x+p[P][1]*(this.height-x)),z=d.pointCoordinate(F);if(!z)continue;const j=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);C+=z[3]*j,T+=j}return 0===T?NaN:C/T}get center(){return this._center}set center(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const d=this._seaLevelZoom,p=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*p,C=this._mercatorZfromZoom(d),T=this._mercatorZfromZoom(this._maxZoom),P=Math.max(C-x,T);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())}computeZoomRelativeTo(d){const p=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,d.toAltitude()));let x;x=d.z<this._camera.position[2]?[p.x,p.y,p.z]:[d.x,d.y,d.z];const C=g.length(g.sub([],this._camera.position,x));return g.clamp(this._zoomFromMercatorZ(C),this._minZoom,this._maxZoom)}setFreeCameraOptions(d){if(!this.height||!d.position&&!d.orientation)return;this._updateCameraState();let p=!1;if(d.orientation&&!g.exactEquals(d.orientation,this._camera.orientation)&&(p=this._setCameraOrientation(d.orientation)),d.position){const x=[d.position.x,d.position.y,d.position.z];g.exactEquals$1(x,this._camera.position)||(this._setCameraPosition(x),p=!0)}p&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const d=this._camera.position,p=new ls;return p.position=new g.MercatorCoordinate(d[0],d[1],d[2]),p.orientation=this._camera.orientation,p._elevation=this.elevation,p._renderWorldCopies=this.renderWorldCopies,p}_setCameraOrientation(d){if(!g.length$1(d))return!1;g.normalize$1(d,d);const p=g.transformQuat([],[0,0,-1],d),x=g.transformQuat([],[0,-1,0],d);if(x[2]<0)return!1;const C=Ef(p,x);return!!C&&(this._camera.orientation=C,!0)}_setCameraPosition(d){const p=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,C=this.cameraToCenterDistance;d[2]=g.clamp(d[2],C/x,C/p),this._camera.position=d}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(d){return this._edgeInsets.equals(d)}interpolatePadding(d,p,x){this._unmodified=!1,this._edgeInsets.interpolate(d,p,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(d){const p=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(d){const p=[new g.UnwrappedTileID(0,d)];if(this.renderWorldCopies){const x=this.pointCoordinate(new g.Point(0,0)),C=this.pointCoordinate(new g.Point(this.width,0)),T=this.pointCoordinate(new g.Point(this.width,this.height)),P=this.pointCoordinate(new g.Point(0,this.height)),F=Math.floor(Math.min(x.x,C.x,T.x,P.x)),z=Math.floor(Math.max(x.x,C.x,T.x,P.x)),j=1;for(let W=F-j;W<=z+j;W++)0!==W&&p.push(new g.UnwrappedTileID(W,d))}return p}coveringTiles(d){let p=this.coveringZoomLevel(d);const x=p,C=this.elevation&&!d.isTerrainDEM,T="mercator"===this.projection.name;if(void 0!==d.minzoom&&p<d.minzoom)return[];void 0!==d.maxzoom&&p>d.maxzoom&&(p=d.maxzoom);const P=this.locationCoordinate(this.center),F=this.center.lat,z=1<<p,j=[z*P.x,z*P.y,0],W="globe"===this.projection.name,K=!W,ne=g.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p,K),he=W?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),pe=z*g.mercatorZfromAltitude(1,this.center.lat),le=this._camera.position[2]/g.mercatorZfromAltitude(1,this.center.lat),me=[z*he.x,z*he.y,le*(K?1:pe)],J=this.cameraToCenterDistance/d.tileSize*(d.roundZoom?1:.502),de=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?p:0,be=d.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,xe=d.isTerrainDEM?-be:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ne=this.projection.isReprojectedInTileSpace?Yo(this):1,Be=tt=>{const Nt=new g.MercatorCoordinate(tt.x+25e-6,tt.y,tt.z),Bt=new g.MercatorCoordinate(tt.x,tt.y+25e-6,tt.z),Zt=tt.toLngLat(),$i=Nt.toLngLat(),Qi=Bt.toLngLat(),Ai=this.locationCoordinate(Zt),nn=this.locationCoordinate($i),sr=this.locationCoordinate(Qi),Bn=Math.hypot(nn.x-Ai.x,nn.y-Ai.y),Bi=Math.hypot(sr.x-Ai.x,sr.y-Ai.y);return Math.sqrt(Bn*Bi)*Ne/25e-6},ke=tt=>{const Mt=be,Nt=xe;return{aabb:g.tileAABB(this,z,0,0,0,tt,Nt,Mt,this.projection),zoom:0,x:0,y:0,minZ:Nt,maxZ:Mt,wrap:tt,fullyVisible:!1}},We=[];let $e=[];const Ye=p,St=d.reparseOverscaled?x:p,Je=tt=>tt*tt,vt=Je((le-this._centerAltitude)*pe),et=tt=>{if(!this._elevation||!tt.tileID||!T)return;const Mt=this._elevation.getMinMaxForTile(tt.tileID),Nt=tt.aabb;Mt?(Nt.min[2]=Mt.min,Nt.max[2]=Mt.max,Nt.center[2]=(Nt.min[2]+Nt.max[2])/2):(tt.shouldSplit=Rt(tt),tt.shouldSplit||(Nt.min[2]=Nt.max[2]=Nt.center[2]=this._centerAltitude))},Rt=tt=>{if(tt.zoom<de)return!0;if(tt.zoom===Ye)return!1;if(null!=tt.shouldSplit)return tt.shouldSplit;const Mt=tt.aabb.distanceX(me),Nt=tt.aabb.distanceY(me);let Bt=vt,Zt=1;if(W){Bt=Je(tt.aabb.distanceZ(me));const Ai=Math.pow(2,tt.zoom),nn=g.latFromMercatorY((tt.y+1)/Ai),sr=g.latFromMercatorY(tt.y/Ai),Bn=Math.min(Math.max(F,nn),sr),Bi=g.circumferenceAtLatitude(Bn)/g.circumferenceAtLatitude(F);if(Zt=Bn===F?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Bi/this._mercatorScaleRatio),this.zoom<=g.GLOBE_ZOOM_THRESHOLD_MIN&&tt.zoom===Ye-1&&Bi>=.9)return!0}else if(C&&(Bt=Je(tt.aabb.distanceZ(me)*pe)),this.projection.isReprojectedInTileSpace&&x<=5){const Ai=Math.pow(2,tt.zoom),nn=Be(new g.MercatorCoordinate((tt.x+.5)/Ai,(tt.y+.5)/Ai));Zt=nn>.85?1:nn}const $i=Mt*Mt+Nt*Nt+Bt;return $i<Je((1<<Ye-tt.zoom)*J*Zt*((Ai,nn)=>{if(nn*Je(.707)<Ai)return 1;const sr=Math.sqrt(nn/Ai);return sr/(1.4144271570014144+(Math.pow(1.1,sr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Bt,vt),$i))};if(this.renderWorldCopies)for(let tt=1;tt<=3;tt++)We.push(ke(-tt)),We.push(ke(tt));for(We.push(ke(0));We.length>0;){const tt=We.pop(),Mt=tt.x,Nt=tt.y;let Bt=tt.fullyVisible;if(!Bt){const Zt=tt.aabb.intersects(ne);if(0===Zt)continue;Bt=2===Zt}if(tt.zoom!==Ye&&Rt(tt))for(let Zt=0;Zt<4;Zt++){const $i=(Mt<<1)+Zt%2,Qi=(Nt<<1)+(Zt>>1),Ai={aabb:T?tt.aabb.quadrant(Zt):g.tileAABB(this,z,tt.zoom+1,$i,Qi,tt.wrap,tt.minZ,tt.maxZ,this.projection),zoom:tt.zoom+1,x:$i,y:Qi,wrap:tt.wrap,fullyVisible:Bt,tileID:void 0,shouldSplit:void 0,minZ:tt.minZ,maxZ:tt.maxZ};C&&!W&&(Ai.tileID=new g.OverscaledTileID(tt.zoom+1===Ye?St:tt.zoom+1,tt.wrap,tt.zoom+1,$i,Qi),et(Ai)),We.push(Ai)}else{const Zt=tt.zoom===Ye?St:tt.zoom;if(d.minzoom&&d.minzoom>Zt)continue;const $i=j[0]-(.5+Mt+(tt.wrap<<tt.zoom))*(1<<p-tt.zoom),Qi=j[1]-.5-Nt,Ai=tt.tileID?tt.tileID:new g.OverscaledTileID(Zt,tt.wrap,tt.zoom,Mt,Nt);$e.push({tileID:Ai,distanceSq:$i*$i+Qi*Qi})}}if(this.fogCullDistSq){const tt=this.fogCullDistSq,Mt=this.horizonLineFromTop();$e=$e.filter(Nt=>{const Bt=[0,0,0,1],Zt=[g.EXTENT,g.EXTENT,0,1],$i=this.calculateFogTileMatrix(Nt.tileID.toUnwrapped());g.transformMat4$1(Bt,Bt,$i),g.transformMat4$1(Zt,Zt,$i);const Qi=g.getAABBPointSquareDist(Bt,Zt);if(0===Qi)return!0;let Ai=!1;const nn=this._elevation;if(nn&&Qi>tt&&0!==Mt){const sr=this.calculateProjMatrix(Nt.tileID.toUnwrapped());let Bn;d.isTerrainDEM||(Bn=nn.getMinMaxForTile(Nt.tileID)),Bn||(Bn={min:xe,max:be});const Bi=g.furthestTileCorner(this.rotation),Jr=[Bi[0]*g.EXTENT,Bi[1]*g.EXTENT,Bn.max];g.transformMat4(Jr,Jr,sr),Ai=(1-Jr[1])*this.height*.5<Mt}return Qi<tt||Ai})}return $e.sort((tt,Mt)=>tt.distanceSq-Mt.distanceSq).map(tt=>tt.tileID)}resize(d,p){this.width=d,this.height=p,this.pixelsToGLUnits=[2/d,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(d){return Math.pow(2,d)}scaleZoom(d){return Math.log(d)/Math.LN2}project(d){const p=g.clamp(d.lat,-g.MAX_MERCATOR_LATITUDE,g.MAX_MERCATOR_LATITUDE),x=this.projection.project(d.lng,p);return new g.Point(x.x*this.worldSize,x.y*this.worldSize)}unproject(d){return this.projection.unproject(d.x/this.worldSize,d.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/g.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(d,p){let x,C;const T=this.centerPoint;if("globe"===this.projection.name){const F=this.worldSize;x=(p.x-T.x)/F,C=(p.y-T.y)/F}else{const F=this.pointCoordinate(p),z=this.pointCoordinate(T);x=F.x-z.x,C=F.y-z.y}const P=this.locationCoordinate(d);this.setLocation(new g.MercatorCoordinate(P.x-x,P.y-C))}setLocation(d){this.center=this.coordinateLocation(d),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(d){return this.projection.locationPoint(this,d)}locationPoint3D(d){return this.projection.locationPoint(this,d,!0)}pointLocation(d){return this.coordinateLocation(this.pointCoordinate(d))}pointLocation3D(d){return this.coordinateLocation(this.pointCoordinate3D(d))}locationCoordinate(d,p){const x=p?g.mercatorZfromAltitude(p,d.lat):void 0,C=this.projection.project(d.lng,d.lat);return new g.MercatorCoordinate(C.x,C.y,x)}coordinateLocation(d){return this.projection.unproject(d.x,d.y)}pointRayIntersection(d,p){const x=p??this._centerAltitude,C=[d.x,d.y,0,1],T=[d.x,d.y,1,1];g.transformMat4$1(C,C,this.pixelMatrixInverse),g.transformMat4$1(T,T,this.pixelMatrixInverse);const P=T[3];g.scale$1(C,C,1/C[3]),g.scale$1(T,T,1/P);const F=C[2],z=T[2];return{p0:C,p1:T,t:F===z?0:(x-F)/(z-F)}}screenPointToMercatorRay(d){const p=[d.x,d.y,0,1],x=[d.x,d.y,1,1];return g.transformMat4$1(p,p,this.pixelMatrixInverse),g.transformMat4$1(x,x,this.pixelMatrixInverse),g.scale$1(p,p,1/p[3]),g.scale$1(x,x,1/x[3]),p[2]=g.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,x[2]=g.mercatorZfromAltitude(x[2],this._center.lat)*this.worldSize,g.scale$1(p,p,1/this.worldSize),g.scale$1(x,x,1/this.worldSize),new g.Ray([p[0],p[1],p[2]],g.normalize([],g.sub([],x,p)))}rayIntersectionCoordinate(d){const{p0:p,p1:x,t:C}=d,T=g.mercatorZfromAltitude(p[2],this._center.lat),P=g.mercatorZfromAltitude(x[2],this._center.lat);return new g.MercatorCoordinate(g.number(p[0],x[0],C)/this.worldSize,g.number(p[1],x[1],C)/this.worldSize,g.number(T,P,C))}pointCoordinate(d,p=this._centerAltitude){return this.projection.pointCoordinate(this,d.x,d.y,p)}pointCoordinate3D(d){if(!this.elevation)return this.pointCoordinate(d);let p=this.projection.pointCoordinate3D(this,d.x,d.y);if(p)return new g.MercatorCoordinate(p[0],p[1],p[2]);let x=0,C=this.horizonLineFromTop();if(d.y>C)return this.pointCoordinate(d);const T=.02*C,P=d.clone();for(let F=0;F<10&&C-x>T;F++){P.y=g.number(x,C,.66);const z=this.projection.pointCoordinate3D(this,P.x,P.y);z?(C=P.y,p=z):x=P.y}return p?new g.MercatorCoordinate(p[0],p[1],p[2]):this.pointCoordinate(d)}isPointAboveHorizon(d){return this.projection.isPointAboveHorizon(this,d)}isPointOnSurface(d){if(d.y<0||d.y>this.height||d.x<0||d.x>this.width)return!1;if(this.elevation||this.zoom>=g.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(d);const p=this.pointCoordinate(d);return p.y>=0&&p.y<=1}_coordinatePoint(d,p){const x=p&&this.elevation?this.elevation.getAtPointOrZero(d,this._centerAltitude):this._centerAltitude,C=[d.x*this.worldSize,d.y*this.worldSize,x+d.toAltitude(),1];return g.transformMat4$1(C,C,this.pixelMatrix),C[3]>0?new g.Point(C[0]/C[3],C[1]/C[3]):new g.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:d,left:p}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,T=this.pointLocation3D(new g.Point(p,d)),P=this.pointLocation3D(new g.Point(C,d)),F=this.pointLocation3D(new g.Point(C,x)),z=this.pointLocation3D(new g.Point(p,x));let j=Math.min(T.lng,P.lng,F.lng,z.lng),W=Math.max(T.lng,P.lng,F.lng,z.lng),K=Math.min(T.lat,P.lat,F.lat,z.lat),ne=Math.max(T.lat,P.lat,F.lat,z.lat);const he=Math.pow(2,-this.zoom)/16*270,pe="globe"===this.projection.name?1:4,le=(me,J,de,be,xe)=>{const Ne=(me+de)/2,Be=(J+be)/2,ke=new g.Point(Ne,Be),{lng:We,lat:$e}=this.pointLocation3D(ke),Ye=Math.max(0,j-We,K-$e,We-W,$e-ne);j=Math.min(j,We),W=Math.max(W,We),K=Math.min(K,$e),ne=Math.max(ne,$e),(xe<pe||Ye>he)&&(le(me,J,Ne,Be,xe+1),le(Ne,Be,de,be,xe+1))};if(le(p,d,C,d,1),le(C,d,C,x,1),le(C,x,p,x,1),le(p,x,p,d,1),"globe"===this.projection.name){const[me,J]=g.polesInViewport(this);me?(ne=90,W=180,j=-180):J&&(K=-90,W=180,j=-180)}return new g.LngLatBounds(new g.LngLat(j,K),new g.LngLat(W,ne))}_getBoundsRectangular(d,p){const{top:x,left:C}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,F=new g.Point(C,x),z=new g.Point(P,x),j=new g.Point(P,T),W=new g.Point(C,T);let K=this.pointCoordinate(F,d),ne=this.pointCoordinate(z,d);const he=this.pointCoordinate(j,p),pe=this.pointCoordinate(W,p),le=(me,J)=>(J.y-me.y)/(J.x-me.x);return K.y>1&&ne.y>=0?K=new g.MercatorCoordinate((1-pe.y)/le(pe,K)+pe.x,1):K.y<0&&ne.y<=1&&(K=new g.MercatorCoordinate(-pe.y/le(pe,K)+pe.x,0)),ne.y>1&&K.y>=0?ne=new g.MercatorCoordinate((1-he.y)/le(he,ne)+he.x,1):ne.y<0&&K.y<=1&&(ne=new g.MercatorCoordinate(-he.y/le(he,ne)+he.x,0)),(new g.LngLatBounds).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(pe)).extend(this.coordinateLocation(he))}_getBoundsRectangularTerrain(){const d=this.elevation;if(!d.visibleDemTiles.length||d.isUsingMockSource())return this._getBoundsRectangular(0,0);const p=d.visibleDemTiles.reduce((x,C)=>{if(C.dem){const T=C.dem.tree;x.min=Math.min(x.min,T.minimums[0]),x.max=Math.max(x.max,T.maximums[0])}return x},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(p.min*d.exaggeration(),p.max*d.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(d=!0){const p=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,x=this.height/2-p*(1-this._horizonShift);return d?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(d){this.maxBounds=d,this.minLat=-g.MAX_MERCATOR_LATITUDE,this.maxLat=g.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,d&&(this.minLat=d.getSouth(),this.maxLat=d.getNorth(),this.minLng=d.getWest(),this.maxLng=d.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=g.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=g.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=g.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=g.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(d,p){return this.projection.createTileMatrix(this,p,d)}calculateDistanceTileData(d){const p=d.key,x=this._distanceTileDataCache;if(x[p])return x[p];const C=d.canonical,T=1/this.height,P=this.cameraWorldSize,F=P/this.zoomScale(C.z),z=(C.x+Math.pow(2,C.z)*d.wrap)*F,j=C.y*F,W=this.point;W.x*=P/this.worldSize,W.y*=P/this.worldSize;const K=this.angle,ne=Math.sin(-K),he=-Math.cos(-K);return x[p]={bearing:[ne,he],center:[(W.x-z)*T,(W.y-j)*T],scale:F/g.EXTENT*T},x[p]}calculateFogTileMatrix(d){const p=d.key,x=this._fogTileMatrixCache;if(x[p])return x[p];const C=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,d);return g.multiply(C,this.worldToFogMatrix,C),x[p]=new Float32Array(C),x[p]}calculateProjMatrix(d,p=!1){const x=d.key,C=p?this._alignedProjMatrixCache:this._projMatrixCache;if(C[x])return C[x];const T=this.calculatePosMatrix(d,this.worldSize);return g.multiply(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.alignedProjMatrix:this.projMatrix,T),C[x]=new Float32Array(T),C[x]}calculatePixelsToTileUnitsMatrix(d){const p=d.tileID.key,x=this._pixelsToTileUnitsCache;if(x[p])return x[p];const C=function(T,P){const{scale:F}=T.tileTransform,z=F*g.EXTENT/(T.tileSize*Math.pow(2,P.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return j=new Float32Array(4),ne=(W=P.inverseAdjustmentMatrix)[1],he=W[2],pe=W[3],me=(K=[z,z])[1],j[0]=W[0]*(le=K[0]),j[1]=ne*le,j[2]=he*me,j[3]=pe*me,j;var j,W,K,ne,he,pe,le,me}(d,this);return x[p]=C,x[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const d=1/this.worldSize,p=g.fromScaling([],[d,d,d]);return g.multiply(p,p,this.globeMatrix),p}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const d=this._elevation;this._updateCameraState();const p=g.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(p),C=this._camera.forward(),T=g.mercatorZfromAltitude(1,this._center.lat);x[2]/=T,C[2]/=T,g.normalize(C,C);const P=d.raycast(x,C,d.exaggeration());if(P){const F=g.scaleAndAdd([],x,C,P),z=new g.MercatorCoordinate(F[0],F[1],g.mercatorZfromAltitude(F[2],g.latFromMercatorY(F[1]))),j=(z.z+g.length([z.x-x[0],z.y-x[1],z.z-x[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(j),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(d=!1){if(!this._elevation)return;const p=this._elevation,x=g.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,C=this._computeCameraPosition(x),T=p.getAtPointOrZero(new g.MercatorCoordinate(...C)),P=this.pixelsPerMeter/this.worldSize*T,F=this._minimumHeightOverTerrain(),z=C[2]-P;if(z<=F)if(z<0||d){const j=this.locationCoordinate(this._center,this._centerAltitude),W=[C[0],C[1],j.z-C[2]],K=g.length(W);W[2]-=(F-z)/this._pixelsPerMercatorPixel;const ne=g.length(W);if(0===ne)return;g.scale$2(W,W,K/ne*this._pixelsPerMercatorPixel),this._camera.position=[C[0],C[1],j.z*this._pixelsPerMercatorPixel-W[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const d="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||d){const ne=this.center;return ne.lat=g.clamp(ne.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!d)&&(ne.lng=g.clamp(ne.lng,this.minLng,this.maxLng)),this.center=ne,void(this._constraining=!1)}const p=this._unmodified,{x,y:C}=this.point;let T=0,P=x,F=C;const z=this.width/2,j=this.height/2,W=this.worldMinY*this.scale,K=this.worldMaxY*this.scale;if(C-j<W&&(F=W+j),C+j>K&&(F=K-j),K-W<this.height&&(T=Math.max(T,this.height/(K-W)),F=(K+W)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ne=this.worldMinX*this.scale,he=this.worldMaxX*this.scale,pe=this.worldSize/2-(ne+he)/2;P=(x+pe+this.worldSize)%this.worldSize-pe,P-z<ne&&(P=ne+z),P+z>he&&(P=he-z),he-ne<this.width&&(T=Math.max(T,this.width/(he-ne)),P=(he+ne)/2)}P===x&&F===C||(this.center=this.unproject(new g.Point(P,F))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=p,this._constraining=!1}_minZoomForBounds(){let d=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(d=Math.max(d,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),d}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const d=this.centerOffset,p=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=g.mercatorZfromAltitude(1,this.center.lat)/g.mercatorZfromAltitude(1,g.GLOBE_SCALE_MATCH_LATITUDE));const x=Ca(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const C="meters"===this.projection.zAxisUnit?p:1,T=this._camera.getWorldToCamera(this.worldSize,C),P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);P[8]=2*-d.x/this.width,P[9]=2*d.y/this.height;let F=g.mul([],P,T);if(this.projection.isReprojectedInTileSpace){const Be=this.locationCoordinate(this.center),ke=g.identity([]);g.translate(ke,ke,[Be.x*this.worldSize,Be.y*this.worldSize,0]),g.multiply(ke,ke,Sn(this)),g.translate(ke,ke,[-Be.x*this.worldSize,-Be.y*this.worldSize,0]),g.multiply(F,F,ke),this.inverseAdjustmentMatrix=function(We){const $e=Sn(We,!0);return pi([],[$e[0],$e[1],$e[4],$e[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=g.scale([],F,[this.worldSize,this.worldSize,this.worldSize/C,1]),this.projMatrix=F,this.invProjMatrix=g.invert(new Float64Array(16),this.projMatrix);const z=g.invert([],P);this.frustumCorners=g.FrustumCorners.fromInvProjectionMatrix(z,this.horizonLineFromTop(),this.height);const j=new Float32Array(16);g.identity(j),g.scale(j,j,[1,-1,1]),g.rotateX(j,j,this._pitch),g.rotateZ(j,j,this.angle);const W=g.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),K=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-d.x/this.width,W[9]=2*(d.y+K)/this.height,this.skyboxMatrix=g.multiply(j,W,j);const ne=this.point,he=ne.x,pe=ne.y,le=this.width%2/2,me=this.height%2/2,J=Math.cos(this.angle),de=Math.sin(this.angle),be=he-Math.round(he)+J*le+de*me,xe=pe-Math.round(pe)+J*me+de*le,Ne=new Float64Array(F);if(g.translate(Ne,Ne,[be>.5?be-1:be,xe>.5?xe-1:xe,0]),this.alignedProjMatrix=Ne,F=g.create(),g.scale(F,F,[this.width/2,-this.height/2,1]),g.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=g.create(),g.scale(F,F,[1,-1,1]),g.translate(F,F,[-1,-1,0]),g.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=g.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},F=g.invert(new Float64Array(16),this.pixelMatrix),!F)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=F,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=g.calculateGlobeMatrix(this);const Be=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=g.transformMat4(Be,Be,T),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=F;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const d=this.cameraWorldSizeForFog,p=this.cameraPixelsPerMeter,x=this._camera.position,C=1/this.height/this._pixelsPerMercatorPixel,T=[d,d,p];g.scale$2(T,T,C),g.scale$2(x,x,-1),g.multiply$2(x,x,T);const P=g.create();g.translate(P,P,x),g.scale(P,P,T),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(d,p,C)}_computeCameraPosition(d){const p=(d=d||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),C=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*p-d/this.worldSize*this._centerAltitude;return[C.x/this.worldSize-x[0]*T,C.y/this.worldSize-x[1]*T,d/this.worldSize*this._centerAltitude-x[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(d){const p=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],C=d[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),C>0&&(T=Math.min((p-x)/C,1)),this._camera.position=g.scaleAndAdd([],this._camera.position,d,T),this._updateStateFromCamera()}_updateStateFromCamera(){const d=this._camera.position,p=this._camera.forward(),{pitch:x,bearing:C}=this._camera.getPitchBearing(),T=g.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(g.degToRad(this._maxPitch)),F=Math.max((d[2]-T)/Math.cos(x),P),z=this._zoomFromMercatorZ(F);g.scaleAndAdd(d,d,p,F),this._pitch=g.clamp(x,g.degToRad(this.minPitch),g.degToRad(this.maxPitch)),this.angle=g.wrap(C,-Math.PI,Math.PI),this._setZoom(g.clamp(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new g.MercatorCoordinate(d[0],d[1],d[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(d){return Math.pow(2,d)*this.tileSize}_mercatorZfromZoom(d){return this.cameraToCenterDistance/this._worldSizeFromZoom(d)}_minimumHeightOverTerrain(){const d=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(d)}_zoomFromMercatorZ(d){return this.scaleZoom(this.cameraToCenterDistance/(d*this.tileSize))}zoomFromMercatorZAdjusted(d){let p=0,x=g.GLOBE_ZOOM_THRESHOLD_MAX,C=0,T=1/0;for(;x-p>1e-6&&x>p;){const P=p+.5*(x-p),F=this.tileSize*Math.pow(2,P),z=this.getCameraToCenterDistance(this.projection,P,F),j=this.scaleZoom(z/(d*this.tileSize)),W=Math.abs(P-j);W<T&&(T=W,C=P),P<j?p=P:x=P}return C}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(g.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(d,p){const x=Math.min(d.x,p.x),C=Math.max(d.x,p.x),T=Math.min(d.y,p.y),P=Math.max(d.y,p.y);if(T<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const F=[new g.Point(x,T),new g.Point(C,P),new g.Point(x,P),new g.Point(C,T)],z=this.renderWorldCopies?-3:0,j=this.renderWorldCopies?4:1;for(const W of F){const K=this.pointRayIntersection(W);if(K.t<0)return!0;const ne=this.rayIntersectionCoordinate(K);if(ne.x<z||ne.y<0||ne.x>j||ne.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+g.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new g.Point(0,0),new g.Point(this.width,this.height))}zoomDeltaToMovement(d,p){const x=g.length(g.sub([],this._camera.position,d)),C=this._zoomFromMercatorZ(x)+p;return x-this._mercatorZfromZoom(C)}getCameraPoint(){if("globe"===this.projection.name){const d=function([p,x,C],T){const P=[p,x,C,1];g.transformMat4$1(P,P,T);const F=P[3]=Math.max(P[3],1e-6);return P[0]/=F,P[1]/=F,P[2]/=F,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new g.Point(d[0],d[1])}{const d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new g.Point(0,d))}}getCameraToCenterDistance(d,p=this.zoom,x=this.worldSize){const C=Ca(d,p,this.width,this.height,1024),T=d.pixelSpaceConversion(this.center.lat,x,C);return.5/Math.tan(.5*this._fov)*this.height*T}getWorldToCameraMatrix(){const d=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&g.multiply(d,d,this.globeMatrix),d}}function al(v,d){let p=!1,x=null;const C=()=>{x=null,p&&(v(),x=setTimeout(C,d),p=!1)};return()=>(p=!0,x||C(),x)}class ll{constructor(d){this._hashName=d&&encodeURIComponent(d),g.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=al(this._updateHashUnthrottled.bind(this),300)}addTo(d){return this._map=d,g.window.addEventListener("hashchange",this._onHashChange,!1),d.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),g.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const d=this._map;if(!d)return"";const p=In(d);if(this._hashName){const x=this._hashName;let C=!1;const T=g.window.location.hash.slice(1).split("&").map(P=>{const F=P.split("=")[0];return F===x?(C=!0,`${F}=${p}`):P}).filter(P=>P);return C||T.push(`${x}=${p}`),`#${T.join("&")}`}return`#${p}`}_getCurrentHash(){const d=g.window.location.hash.replace("#","");if(this._hashName){let p;return d.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(p=x)}),(p&&p[1]||"").split("/")}return d.split("/")}_onHashChange(){const d=this._map;if(!d)return!1;const p=this._getCurrentHash();if(p.length>=3&&!p.some(x=>isNaN(x))){const x=d.dragRotate.isEnabled()&&d.touchZoomRotate.isEnabled()?+(p[3]||0):d.getBearing();return d.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:x,pitch:+(p[4]||0)}),!0}return!1}_updateHashUnthrottled(){const d=g.window.location.href.replace(/(#.+)?$/,this.getHashString());g.window.history.replaceState(g.window.history.state,null,d)}}function In(v,d){const p=v.getCenter(),x=Math.round(100*v.getZoom())/100,C=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,C),P=Math.round(p.lng*T)/T,F=Math.round(p.lat*T)/T,z=v.getBearing(),j=v.getPitch();let W=d?`/${P}/${F}/${x}`:`${x}/${F}/${P}`;return(z||j)&&(W+="/"+Math.round(10*z)/10),j&&(W+=`/${Math.round(j)}`),W}const Jd={linearity:.3,easing:g.bezier(0,0,.3,1)},Cf=g.extend({deceleration:2500,maxSpeed:1400},Jd),Qd=g.extend({deceleration:20,maxSpeed:1400},Jd),ii=g.extend({deceleration:1e3,maxSpeed:360},Jd),la=g.extend({deceleration:1e3,maxSpeed:90},Jd);class eu{constructor(d){this._map=d,this.clear()}clear(){this._inertiaBuffer=[]}record(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:g.exported.now(),settings:d})}_drainInertiaBuffer(){const d=this._inertiaBuffer,p=g.exported.now();for(;d.length>0&&p-d[0].time>160;)d.shift()}_onMoveEnd(d){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const p={zoom:0,bearing:0,pitch:0,pan:new g.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)p.zoom+=T.zoomDelta||0,p.bearing+=T.bearingDelta||0,p.pitch+=T.pitchDelta||0,T.panDelta&&p.pan._add(T.panDelta),T.around&&(p.around=T.around),T.pinchAround&&(p.pinchAround=T.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(p.pan.mag()){const T=Ed(p.pan.mag(),x,g.extend({},Cf,d||{}));C.offset=p.pan.mult(T.amount/p.pan.mag()),C.center=this._map.transform.center,Pl(C,T)}if(p.zoom){const T=Ed(p.zoom,x,Qd);C.zoom=this._map.transform.zoom+T.amount,Pl(C,T)}if(p.bearing){const T=Ed(p.bearing,x,ii);C.bearing=this._map.transform.bearing+g.clamp(T.amount,-179,179),Pl(C,T)}if(p.pitch){const T=Ed(p.pitch,x,la);C.pitch=this._map.transform.pitch+T.amount,Pl(C,T)}if(C.zoom||C.bearing){const T=void 0===p.pinchAround?p.around:p.pinchAround;C.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),C.noMoveStart=!0,C}}function Pl(v,d){(!v.duration||v.duration<d.duration)&&(v.duration=d.duration,v.easing=d.easing)}function Ed(v,d,p){const{maxSpeed:x,linearity:C,deceleration:T}=p,P=g.clamp(v*C/(d/1e3),-x,x),F=Math.abs(P)/(T*C);return{easing:p.easing,duration:1e3*F,amount:P*(F/2)}}class $s extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,p,x,C={}){const T=nl(p.getCanvasContainer(),x),P=p.unproject(T);super(d,g.extend({point:T,lngLat:P,originalEvent:x},C)),this._defaultPrevented=!1,this.target=p}}class Dc extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,p,x){const C="touchend"===d?x.changedTouches:x.touches,T=ka(p.getCanvasContainer(),C),P=T.map(z=>p.unproject(z)),F=T.reduce((z,j,W,K)=>z.add(j.div(K.length)),new g.Point(0,0));super(d,{points:T,point:F,lngLats:P,lngLat:p.unproject(F),originalEvent:x}),this._defaultPrevented=!1}}class bo extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,p,x){super(d,{originalEvent:x}),this._defaultPrevented=!1}}class Ss{constructor(d,p){this._map=d,this._clickTolerance=p.clickTolerance}reset(){this._mousedownPos=void 0}wheel(d){return this._firePreventable(new bo(d.type,this._map,d))}mousedown(d,p){return this._mousedownPos=p,this._firePreventable(new $s(d.type,this._map,d))}mouseup(d){this._map.fire(new $s(d.type,this._map,d))}preclick(d){const p=g.extend({},d);p.type="preclick",this._map.fire(new $s(p.type,this._map,p))}click(d,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||(this.preclick(d),this._map.fire(new $s(d.type,this._map,d)))}dblclick(d){return this._firePreventable(new $s(d.type,this._map,d))}mouseover(d){this._map.fire(new $s(d.type,this._map,d))}mouseout(d){this._map.fire(new $s(d.type,this._map,d))}touchstart(d){return this._firePreventable(new Dc(d.type,this._map,d))}touchmove(d){this._map.fire(new Dc(d.type,this._map,d))}touchend(d){this._map.fire(new Dc(d.type,this._map,d))}touchcancel(d){this._map.fire(new Dc(d.type,this._map,d))}_firePreventable(d){if(this._map.fire(d),d.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Vh{constructor(d){this._map=d}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(d){this._map.fire(new $s(d.type,this._map,d))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $s("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new $s(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Er{constructor(d,p){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(d,p){this.isEnabled()&&d.shiftKey&&0===d.button&&(pd(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(d,p){if(!this._active)return;const x=p,C=this._startPos,T=this._lastPos;if(!C||!T||T.equals(x)||!this._box&&x.dist(C)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=jn("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));const P=Math.min(C.x,x.x),F=Math.max(C.x,x.x),z=Math.min(C.y,x.y),j=Math.max(C.y,x.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${z}px)`,this._box.style.width=F-P+"px",this._box.style.height=j-z+"px")})}mouseupWindow(d,p){if(!this._active)return;const x=this._startPos,C=p;if(x&&0===d.button){if(this.reset(),ta(),x.x!==C.x||x.y!==C.y)return this._map.fire(new g.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:T=>T.fitScreenCoordinates(x,C,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",d)}}keydown(d){this._active&&27===d.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",d))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Gd(),delete this._startPos,delete this._lastPos}_fireEvent(d,p){return this._map.fire(new g.Event(d,{originalEvent:p}))}}function Cm(v,d){const p={};for(let x=0;x<v.length;x++)p[v[x].identifier]=d[x];return p}class Zu{constructor(d){this.reset(),this.numTouches=d.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(d,p,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=d.timeStamp),x.length===this.numTouches&&(this.centroid=function(C){const T=new g.Point(0,0);for(const P of C)T._add(P);return T.div(C.length)}(p),this.touches=Cm(x,p)))}touchmove(d,p,x){if(this.aborted||!this.centroid)return;const C=Cm(x,p);for(const T in this.touches){const P=C[T];(!P||P.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(d,p,x){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),0===x.length){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class Op{constructor(d){this.singleTap=new Zu(d),this.numTaps=d.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(d,p,x){this.singleTap.touchstart(d,p,x)}touchmove(d,p,x){this.singleTap.touchmove(d,p,x)}touchend(d,p,x){const C=this.singleTap.touchend(d,p,x);if(C){const T=d.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(C)<30;if(T&&P||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Ll{constructor(){this._zoomIn=new Op({numTouches:1,numTaps:2}),this._zoomOut=new Op({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(d,p,x){this._zoomIn.touchstart(d,p,x),this._zoomOut.touchstart(d,p,x)}touchmove(d,p,x){this._zoomIn.touchmove(d,p,x),this._zoomOut.touchmove(d,p,x)}touchend(d,p,x){const C=this._zoomIn.touchend(d,p,x),T=this._zoomOut.touchend(d,p,x);return C?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(C)},{originalEvent:d})}):T?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(T)},{originalEvent:d})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Hh={0:1,2:2};class Ba{constructor(d){this.reset(),this._clickTolerance=d.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(d,p){return!1}_move(d,p){return{}}mousedown(d,p){if(this._lastPoint)return;const x=Sl(d);this._correctButton(d,x)&&(this._lastPoint=p,this._eventButton=x)}mousemoveWindow(d,p){const x=this._lastPoint;if(x)if(d.preventDefault(),null!=this._eventButton&&function(C,T){const P=Hh[T];return void 0===C.buttons||(C.buttons&P)!==P}(d,this._eventButton))this.reset();else if(this._moved||!(p.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(x,p)}mouseupWindow(d){this._lastPoint&&Sl(d)===this._eventButton&&(this._moved&&ta(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qc extends Ba{mousedown(d,p){super.mousedown(d,p),this._lastPoint&&(this._active=!0)}_correctButton(d,p){return 0===p&&!d.ctrlKey}_move(d,p){return{around:p,panDelta:p.sub(d)}}}class ms extends Ba{_correctButton(d,p){return 0===p&&d.ctrlKey||2===p}_move(d,p){const x=.8*(p.x-d.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(d){d.preventDefault()}}class Sf extends Ba{_correctButton(d,p){return 0===p&&d.ctrlKey||2===p}_move(d,p){const x=-.5*(p.y-d.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(d){d.preventDefault()}}class Ts{constructor(d,p){this._map=d,this._el=d.getCanvasContainer(),this._minTouches=1,this._clickTolerance=p.clickTolerance||1,this.reset(),g.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new g.Point(0,0)}touchstart(d,p,x){return this._calculateTransform(d,p,x)}touchmove(d,p,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===x.length&&!g.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return d.cancelable&&d.preventDefault(),this._calculateTransform(d,p,x)}}touchend(d,p,x){this._calculateTransform(d,p,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(d,p,x){x.length>0&&(this._active=!0);const C=Cm(x,p),T=new g.Point(0,0),P=new g.Point(0,0);let F=0;for(const j in C){const W=C[j],K=this._touches[j];K&&(T._add(W),P._add(W.sub(K)),F++,C[j]=W)}if(this._touches=C,F<this._minTouches||!P.mag())return;const z=P.div(F);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(F),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=jn("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ca{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(d){}_move(d,p,x){return{}}touchstart(d,p,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([p[0],p[1]]))}touchmove(d,p,x){const C=this._firstTwoTouches;if(!C)return;d.preventDefault();const[T,P]=C,F=Gh(x,p,T),z=Gh(x,p,P);if(!F||!z)return;const j=this._aroundCenter?null:F.add(z).div(2);return this._move([F,z],j,d)}touchend(d,p,x){if(!this._firstTwoTouches)return;const[C,T]=this._firstTwoTouches,P=Gh(x,p,C),F=Gh(x,p,T);P&&F||(this._active&&ta(),this.reset())}touchcancel(){this.reset()}enable(d){this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Gh(v,d,p){for(let x=0;x<v.length;x++)if(v[x].identifier===p)return d[x]}function tu(v,d){return Math.log(v/d)/Math.LN2}class Tf extends ca{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(d){this._startDistance=this._distance=d[0].dist(d[1])}_move(d,p){const x=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(tu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:tu(this._distance,x),pinchAround:p}}}function ic(v,d){return 180*v.angleWith(d)/Math.PI}class jh extends ca{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])}_move(d,p){const x=this._vector;if(this._vector=d[0].sub(d[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ic(this._vector,x),pinchAround:p}}_isBelowThreshold(d){this._minDiameter=Math.min(this._minDiameter,d.mag());const p=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const C=ic(d,x);return Math.abs(C)<p}}function Ic(v){return Math.abs(v.y)>Math.abs(v.x)}class Ig extends ca{constructor(d){super(),this._map=d}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(d){this._lastPoints=d,Ic(d[0].sub(d[1]))&&(this._valid=!1)}_move(d,p,x){const C=this._lastPoints;if(!C)return;const T=d[0].sub(C[0]),P=d[1].sub(C[1]);return this._map._cooperativeGestures&&!g.isFullscreen()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(T,P,x.timeStamp),!this._valid)?void 0:(this._lastPoints=d,this._active=!0,{pitchDelta:(T.y+P.y)/2*-.5})}gestureBeginsVertically(d,p,x){if(void 0!==this._valid)return this._valid;const C=d.mag()>=2,T=p.mag()>=2;if(!C&&!T)return;if(!C||!T)return null==this._firstMove&&(this._firstMove=x),x-this._firstMove<100&&void 0;const P=d.y>0==p.y>0;return Ic(d)&&Ic(p)&&P}}const ue={panStep:100,bearingStep:15,pitchStep:10};class Np{constructor(){const d=ue;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(d){if(d.altKey||d.ctrlKey||d.metaKey)return;let p=0,x=0,C=0,T=0,P=0;switch(d.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:d.shiftKey?x=-1:(d.preventDefault(),T=-1);break;case 39:d.shiftKey?x=1:(d.preventDefault(),T=1);break;case 38:d.shiftKey?C=1:(d.preventDefault(),P=-1);break;case 40:d.shiftKey?C=-1:(d.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(x=0,C=0),{cameraAnimation:F=>{const z=F.getZoom();F.easeTo({duration:300,easeId:"keyboardHandler",easing:Af,zoom:p?Math.round(z)+p*(d.shiftKey?2:1):z,bearing:F.getBearing()+x*this._bearingStep,pitch:F.getPitch()+C*this._pitchStep,offset:[-T*this._panStep,-P*this._panStep],center:F.getCenter()},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Af(v){return v*(2-v)}const nc=4.000244140625;class Dr{constructor(d,p){this._map=d,this._el=d.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,g.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(d){this._defaultZoomRate=d}setWheelZoomRate(d){this._wheelZoomRate=d}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(d){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(d.ctrlKey||d.metaKey||this.isZooming()||g.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let p=d.deltaMode===g.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY;const x=g.exported.now(),C=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,0!==p&&p%nc==0?this._type="wheel":0!==p&&Math.abs(p)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(C*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),d.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=d,this._delta-=p,this._active||this._start(d)),d.preventDefault()}_onTimeout(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)}_start(d){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=nl(this._el,d);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:p,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const d=this._map.transform;"wheel"===this._type&&d.projection.wrap&&(d._center.lng>=180||d._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const p=()=>d._terrainEnabled()&&this._aroundCoord?d.computeZoomRelativeTo(this._aroundCoord):d.zoom;if(0!==this._delta){const z="wheel"===this._type&&Math.abs(this._delta)>nc?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&0!==j&&(j=1/j);const W=p(),K=Math.pow(2,W),ne="number"==typeof this._targetZoom?d.zoomScale(this._targetZoom):K;this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(ne*j))),"wheel"===this._type&&(this._startZoom=W,this._easing=this._smoothOutEasing(200)),this._delta=0}const x="number"==typeof this._targetZoom?this._targetZoom:p(),C=this._startZoom,T=this._easing;let P,F=!1;if("wheel"===this._type&&C&&T){const z=Math.min((g.exported.now()-this._lastWheelEventTime)/200,1),j=T(z);P=g.number(C,x,j),z<1?this._frameId||(this._frameId=!0):F=!0}else P=x,F=!0;return this._active=!0,F&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!F,zoomDelta:P-p(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(d){let p=g.ease;if(this._prevEase){const x=this._prevEase,C=(g.exported.now()-x.start)/x.duration,T=x.easing(C+.01)-x.easing(C),P=.27/Math.sqrt(T*T+1e-4)*.01,F=Math.sqrt(.0729-P*P);p=g.bezier(P,F,.25,1)}return this._prevEase={start:g.exported.now(),duration:d,easing:p},p}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=jn("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(g.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Nv{constructor(d,p){this._clickZoom=d,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class cl{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(d,p){return d.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(d.shiftKey?-1:1),around:x.unproject(p)},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ux{constructor(){this._tap=new Op({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(d,p,x){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=p[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(d,p,x))}touchmove(d,p,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const C=p[0],T=C.y-this._swipePoint.y;return this._swipePoint=C,d.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(d,p,x)}touchend(d,p,x){this._tapTime?this._swipePoint&&0===x.length&&this.reset():this._tap.touchend(d,p,x)&&(this._tapTime=d.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wh{constructor(d,p,x){this._el=d,this._mousePan=p,this._touchPan=x}enable(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class hx{constructor(d,p,x){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=p,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class px{constructor(d,p,x,C){this._el=d,this._touchZoom=p,this._touchRotate=x,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ed=v=>v.zoom||v.drag||v.pitch||v.rotate;class Bv extends g.Event{}class fx{constructor(){this.constants=[1,1,.01],this.radius=0}setup(d,p){const x=g.sub([],p,d);this.radius=g.length(x[2]<0?g.div([],x,this.constants):[x[0],x[1],0])}projectRay(d){g.div(d,d,this.constants),g.normalize(d,d),g.mul$1(d,d,this.constants);const p=g.scale$2([],d,this.radius);if(p[2]>0){const x=g.scale$2([],[0,0,1],g.dot(p,[0,0,1])),C=g.scale$2([],g.normalize([],[p[0],p[1],0]),this.radius),T=g.add([],p,g.scale$2([],g.sub([],g.add([],C,x),p),2));p[0]=T[0],p[1]=T[1]}return p}}function da(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class td{constructor(d,p){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new eu(d),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new fx,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(p),g.bindAll(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[g.window.document,"mousemove",{capture:!0}],[g.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[g.window,"blur",void 0]];for(const[C,T,P]of this._listeners)C.addEventListener(T,C===g.window.document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[d,p,x]of this._listeners)d.removeEventListener(p,d===g.window.document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(d){const p=this._map,x=p.getCanvasContainer();this._add("mapEvent",new Ss(p,d));const C=p.boxZoom=new Er(p,d);this._add("boxZoom",C);const T=new Ll,P=new cl;p.doubleClickZoom=new Nv(P,T),this._add("tapZoom",T),this._add("clickZoom",P);const F=new ux;this._add("tapDragZoom",F);const z=p.touchPitch=new Ig(p);this._add("touchPitch",z);const j=new ms(d),W=new Sf(d);p.dragRotate=new hx(d,j,W),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",W,["mouseRotate"]);const K=new Qc(d),ne=new Ts(p,d);p.dragPan=new Wh(x,K,ne),this._add("mousePan",K),this._add("touchPan",ne,["touchZoom","touchRotate"]);const he=new jh,pe=new Tf;p.touchZoomRotate=new px(x,pe,he,F),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",pe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Vh(p));const le=p.scrollZoom=new Dr(p,this);this._add("scrollZoom",le,["mousePan"]);const me=p.keyboard=new Np;this._add("keyboard",me);for(const J of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])d.interactive&&d[J]&&p[J].enable(d[J])}_add(d,p,x){this._handlers.push({handlerName:d,handler:p,allowed:x}),this._handlersById[d]=p}stop(d){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}}isActive(){for(const{handler:d}of this._handlers)if(d.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ed(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(d,p,x){for(const C in d)if(C!==x&&(!p||p.indexOf(C)<0))return!0;return!1}handleWindowEvent(d){this.handleEvent(d,`${d.type}Window`)}_getMapTouches(d){const p=[];for(const x of d)this._el.contains(x.target)&&p.push(x);return p}handleEvent(d,p){this._updatingCamera=!0;const x="renderFrame"===d.type,C=x?void 0:d,T={needsRenderFrame:!1},P={},F={},z=d.touches?this._getMapTouches(d.touches):void 0,j=z?ka(this._el,z):x?void 0:nl(this._el,d);for(const{handlerName:ne,handler:he,allowed:pe}of this._handlers){if(!he.isEnabled())continue;let le;this._blockedByActive(F,pe,ne)?he.reset():he[p||d.type]&&(le=he[p||d.type](d,j,z),this.mergeHandlerResult(T,P,le,ne,C),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||he.isActive())&&(F[ne]=he)}const W={};for(const ne in this._previousActiveHandlers)F[ne]||(W[ne]=C);this._previousActiveHandlers=F,(Object.keys(W).length||da(T))&&(this._changes.push([T,P,W]),this._triggerRenderFrame()),(Object.keys(F).length||da(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=T;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))}mergeHandlerResult(d,p,x,C,T){if(!x)return;g.extend(d,x);const P={handlerName:C,originalEvent:x.originalEvent||T};void 0!==x.zoomDelta&&(p.zoom=P),void 0!==x.panDelta&&(p.drag=P),void 0!==x.pitchDelta&&(p.pitch=P),void 0!==x.bearingDelta&&(p.rotate=P)}_applyChanges(){const d={},p={},x={};for(const[C,T,P]of this._changes)C.panDelta&&(d.panDelta=(d.panDelta||new g.Point(0,0))._add(C.panDelta)),C.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+C.pitchDelta),void 0!==C.around&&(d.around=C.around),void 0!==C.aroundCoord&&(d.aroundCoord=C.aroundCoord),void 0!==C.pinchAround&&(d.pinchAround=C.pinchAround),C.noInertia&&(d.noInertia=C.noInertia),g.extend(p,T),g.extend(x,P);this._updateMapTransform(d,p,x),this._changes=[]}_updateMapTransform(d,p,x){const C=this._map,T=C.transform,P=de=>[de.x,de.y,de.z];if((de=>{const be=this._eventsInProgress.drag;return be&&!this._handlersById[be.handlerName].isActive()})()&&!da(d)){const de=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",de!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&C._stop(!0),!da(d))return void this._fireEvents(p,x,!0);let{panDelta:F,zoomDelta:z,bearingDelta:j,pitchDelta:W,around:K,aroundCoord:ne,pinchAround:he}=d;T._isCameraConstrained&&(z>0&&(z=0),T._isCameraConstrained=!1),void 0!==he&&(K=he),(z||(de=>p.drag&&!this._eventsInProgress.drag)())&&K&&(this._dragOrigin=P(T.pointCoordinate3D(K)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",C._stop(!0),K=K||C.transform.centerPoint,j&&(T.bearing+=j),W&&(T.pitch+=W),T._updateCameraState();const pe=[0,0,0];if(F)if("mercator"===T.projection.name){const de=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(K).dir),be=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(K.sub(F)).dir);pe[0]=be[0]-de[0],pe[1]=be[1]-de[1]}else{const de=T.pointCoordinate(K);if("globe"===T.projection.name){F=F.rotate(-T.angle);const be=T._pixelsPerMercatorPixel/T.worldSize;pe[0]=-F.x*g.mercatorScale(g.latFromMercatorY(de.y))*be,pe[1]=-F.y*g.mercatorScale(T.center.lat)*be}else{const be=T.pointCoordinate(K.sub(F));de&&be&&(pe[0]=be.x-de.x,pe[1]=be.y-de.y)}}const le=T.zoom,me=[0,0,0];if(z){const de=P(ne||T.pointCoordinate3D(K)),be={dir:g.normalize([],g.sub([],de,T._camera.position))};if(be.dir[2]<0){const xe=T.zoomDeltaToMovement(de,z);g.scale$2(me,be.dir,xe)}}const J=g.add(pe,pe,me);T._translateCameraConstrained(J),z&&Math.abs(T.zoom-le)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(p,x,!0)}_fireEvents(d,p,x){const C=ed(this._eventsInProgress),T=ed(d),P={};for(const W in d){const{originalEvent:K}=d[W];this._eventsInProgress[W]||(P[`${W}start`]=K),this._eventsInProgress[W]=d[W]}!C&&T&&this._fireEvent("movestart",T.originalEvent);for(const W in P)this._fireEvent(W,P[W]);T&&this._fireEvent("move",T.originalEvent);for(const W in d){const{originalEvent:K}=d[W];this._fireEvent(W,K)}const F={};let z;for(const W in this._eventsInProgress){const{handlerName:K,originalEvent:ne}=this._eventsInProgress[W];this._handlersById[K].isActive()||(delete this._eventsInProgress[W],z=p[K]||ne,F[`${W}end`]=z)}for(const W in F)this._fireEvent(W,F[W]);const j=ed(this._eventsInProgress);if(x&&(C||T)&&!j){this._updatingCamera=!0;const W=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=ne=>0!==ne&&-this._bearingSnap<ne&&ne<this._bearingSnap;W?(K(W.bearing||this._map.getBearing())&&(W.bearing=0),this._map.easeTo(W,{originalEvent:z})):(this._map.fire(new g.Event("moveend",{originalEvent:z})),K(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(d,p){this._map.fire(new g.Event(d,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(d=>{this._frameId=void 0,this.handleEvent(new Bv("renderFrame",{timeStamp:d})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Yu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class kg extends g.Evented{constructor(d,p){super(),this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=p.bearingSnap,this._respectPrefersReducedMotion=!1!==p.respectPrefersReducedMotion,g.bindAll(["_renderFrameCallback"],this)}getCenter(){return new g.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(d,p){return this.jumpTo({center:d},p)}panBy(d,p,x){return d=g.Point.convert(d).mult(-1),this.panTo(this.transform.center,g.extend({offset:d},p),x)}panTo(d,p,x){return this.easeTo(g.extend({center:d},p),x)}getZoom(){return this.transform.zoom}setZoom(d,p){return this.jumpTo({zoom:d},p),this}zoomTo(d,p,x){return this.easeTo(g.extend({zoom:d},p),x)}zoomIn(d,p){return this.zoomTo(this.getZoom()+1,d,p),this}zoomOut(d,p){return this.zoomTo(this.getZoom()-1,d,p),this}getBearing(){return this.transform.bearing}setBearing(d,p){return this.jumpTo({bearing:d},p),this}getPadding(){return this.transform.padding}setPadding(d,p){return this.jumpTo({padding:d},p),this}rotateTo(d,p,x){return this.easeTo(g.extend({bearing:d},p),x)}resetNorth(d,p){return this.rotateTo(0,g.extend({duration:1e3},d),p),this}resetNorthPitch(d,p){return this.easeTo(g.extend({bearing:0,pitch:0,duration:1e3},d),p),this}snapToNorth(d,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,p):this}getPitch(){return this.transform.pitch}setPitch(d,p){return this.jumpTo({pitch:d},p),this}cameraForBounds(d,p){d=g.LngLatBounds.convert(d);const x=p&&p.bearing||0,C=p&&p.pitch||0,T=d.getNorthWest(),P=d.getSouthEast();return this._cameraForBounds(this.transform,T,P,x,C,p)}_extendCameraOptions(d){const p={top:0,bottom:0,right:0,left:0};if("number"==typeof(d=g.extend({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding){const x=d.padding;d.padding={top:x,bottom:x,right:x,left:x}}return d.padding=g.extend(p,d.padding),d}_minimumAABBFrustumDistance(d,p){const x=p.max[0]-p.min[0],C=p.max[1]-p.min[1];return x/C>d.aspect?x/(2*Math.tan(.5*d.fovX)*d.aspect):C/(2*Math.tan(.5*d.fovY)*d.aspect)}_cameraForBoundsOnGlobe(d,p,x,C,T,P){const F=d.clone(),z=this._extendCameraOptions(P);F.bearing=C,F.pitch=T;const j=g.LngLat.convert(p),W=g.LngLat.convert(x),K=.5*(j.lat+W.lat),ne=.5*(j.lng+W.lng),he=g.latLngToECEF(K,ne),pe=g.normalize([],he),le=g.normalize([],g.cross([],pe,[0,1,0])),me=g.cross([],le,pe),J=[le[0],le[1],le[2],0,me[0],me[1],me[2],0,pe[0],pe[1],pe[2],0,0,0,0,1],de=[he,g.latLngToECEF(j.lat,j.lng),g.latLngToECEF(W.lat,j.lng),g.latLngToECEF(W.lat,W.lng),g.latLngToECEF(j.lat,W.lng),g.latLngToECEF(K,j.lng),g.latLngToECEF(K,W.lng),g.latLngToECEF(j.lat,ne),g.latLngToECEF(W.lat,ne)];let be=g.Aabb.fromPoints(de.map(Bt=>[g.dot(le,Bt),g.dot(me,Bt),g.dot(pe,Bt)]));const xe=g.transformMat4([],be.center,J);0===g.squaredLength(xe)&&g.set(xe,0,0,1),g.normalize(xe,xe),g.scale$2(xe,xe,g.GLOBE_RADIUS),F.center=g.ecefToLatLng(xe);const Ne=F.getWorldToCameraMatrix(),Be=g.invert(new Float64Array(16),Ne);be=g.Aabb.applyTransform(be,g.multiply([],Ne,J)),g.transformMat4(xe,xe,Ne);const ke=.5*(be.max[2]-be.min[2]),We=this._minimumAABBFrustumDistance(F,be),$e=g.scale$2([],[0,0,1],ke),Ye=g.add($e,xe,$e),St=We+(0===F.pitch?0:g.distance(xe,Ye)),Je=F.globeCenterInViewSpace,vt=g.sub([],xe,[Je[0],Je[1],Je[2]]);g.normalize(vt,vt),g.scale$2(vt,vt,St);const et=g.add([],xe,vt);g.transformMat4(et,et,Be);const Rt=g.earthRadius/g.GLOBE_RADIUS,tt=g.length(et),Mt=g.mercatorZfromAltitude(Math.max(tt*Rt-g.earthRadius,Number.EPSILON),0),Nt=Math.min(F.zoomFromMercatorZAdjusted(Mt),z.maxZoom);return Nt>.5*(g.GLOBE_ZOOM_THRESHOLD_MIN+g.GLOBE_ZOOM_THRESHOLD_MAX)?(F.setProjection({name:"mercator"}),F.zoom=Nt,this._cameraForBounds(F,p,x,C,T,P)):{center:F.center,zoom:Nt,bearing:C,pitch:T}}queryTerrainElevation(d,p){const x=this.transform.elevation;return x?(p=g.extend({},{exaggerated:!0},p),x.getAtPoint(g.MercatorCoordinate.fromLngLat(d),null,p.exaggerated)):null}_cameraForBounds(d,p,x,C,T,P){if("globe"===d.projection.name)return this._cameraForBoundsOnGlobe(d,p,x,C,T,P);const F=d.clone(),z=this._extendCameraOptions(P),j=F.padding;F.bearing=C,F.pitch=T;const W=g.LngLat.convert(p),K=g.LngLat.convert(x),ne=new g.LngLat(W.lng,K.lat),he=new g.LngLat(K.lng,W.lat),pe=F.project(W),le=F.project(K),me=this.queryTerrainElevation(W),J=this.queryTerrainElevation(K),de=this.queryTerrainElevation(ne),be=this.queryTerrainElevation(he),xe=[[pe.x,pe.y,Math.min(me||0,J||0,de||0,be||0)],[le.x,le.y,Math.max(me||0,J||0,de||0,be||0)]];let Ne=g.Aabb.fromPoints(xe);const Be=F.getWorldToCameraMatrix(),ke=g.invert(new Float64Array(16),Be);Ne=g.Aabb.applyTransform(Ne,Be);const We=g.sub([],Ne.max,Ne.min),$e=j.left||0,Ye=j.right||0,St=j.bottom||0,Je=j.top||0,{left:vt,right:et,top:Rt,bottom:tt}=z.padding,Mt=.5*($e+Ye),Nt=.5*(Je+St),Bt=Math.min(F.scaleZoom(F.scale*Math.min((F.width-($e+Ye+vt+et))/We[0],(F.height-(St+Je+tt+Rt))/We[1])),z.maxZoom),Zt=F.scale/F.zoomScale(Bt);Ne=new g.Aabb([Ne.min[0]-(vt+Mt)*Zt,Ne.min[1]-(tt+Nt)*Zt,Ne.min[2]],[Ne.max[0]+(et+Mt)*Zt,Ne.max[1]+(Rt+Nt)*Zt,Ne.max[2]]);const $i=.5*We[2],Qi=this._minimumAABBFrustumDistance(F,Ne),Ai=[0,0,1,0];g.transformMat4$1(Ai,Ai,Be),g.normalize$2(Ai,Ai);const nn=g.scale$2([],Ai,Qi+$i),sr=g.add([],Ne.center,nn),Bn=("number"==typeof z.offset.x&&"number"==typeof z.offset.y?new g.Point(z.offset.x,z.offset.y):g.Point.convert(z.offset)).rotate(-g.degToRad(C));Ne.center[0]-=Bn.x*Zt,Ne.center[1]+=Bn.y*Zt,g.transformMat4(Ne.center,Ne.center,ke),g.transformMat4(sr,sr,ke);const Bi=[Ne.center[0],Ne.center[1],sr[2]*F.pixelsPerMeter];g.scale$2(Bi,Bi,1/F.worldSize);const Jr=g.lngFromMercatorX(Bi[0]),Di=g.latFromMercatorY(Bi[1]),no=Math.min(F._zoomFromMercatorZ(Bi[2]),z.maxZoom),To=new g.LngLat(Jr,Di);return F.mercatorFromTransition&&no<.5*(g.GLOBE_ZOOM_THRESHOLD_MIN+g.GLOBE_ZOOM_THRESHOLD_MAX)?(F.setProjection({name:"globe"}),F.zoom=no,this._cameraForBounds(F,p,x,C,T,P)):{center:To,zoom:no,bearing:C,pitch:T}}fitBounds(d,p,x){const C=this.cameraForBounds(d,p);return this._fitInternal(C,p,x)}fitScreenCoordinates(d,p,x,C,T){const P=g.Point.convert(d),F=g.Point.convert(p),z=new g.Point(Math.min(P.x,F.x),Math.min(P.y,F.y)),j=new g.Point(Math.max(P.x,F.x),Math.max(P.y,F.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(P,F))return this;const W=this.transform.pointLocation3D(z),K=this.transform.pointLocation3D(j),ne=this.transform.pointLocation3D(new g.Point(z.x,j.y)),he=this.transform.pointLocation3D(new g.Point(j.x,z.y)),pe=[Math.min(W.lng,K.lng,ne.lng,he.lng),Math.min(W.lat,K.lat,ne.lat,he.lat)],le=[Math.max(W.lng,K.lng,ne.lng,he.lng),Math.max(W.lat,K.lat,ne.lat,he.lat)],me=C&&C.pitch?C.pitch:this.getPitch(),J=this._cameraForBounds(this.transform,pe,le,x,me,C);return this._fitInternal(J,C,T)}_fitInternal(d,p,x){return d?(delete(p=g.extend(d,p)).padding,p.linear?this.easeTo(p,x):this.flyTo(p,x)):this}jumpTo(d,p){this.stop();const x=d.preloadOnly?this.transform.clone():this.transform;let C=!1,T=!1,P=!1;return"zoom"in d&&x.zoom!==+d.zoom&&(C=!0,x.zoom=+d.zoom),void 0!==d.center&&(x.center=g.LngLat.convert(d.center)),"bearing"in d&&x.bearing!==+d.bearing&&(T=!0,x.bearing=+d.bearing),"pitch"in d&&x.pitch!==+d.pitch&&(P=!0,x.pitch=+d.pitch),null==d.padding||x.isPaddingEqual(d.padding)||(x.padding=d.padding),d.preloadOnly?(this._preloadTiles(x),this):(this.fire(new g.Event("movestart",p)).fire(new g.Event("move",p)),C&&this.fire(new g.Event("zoomstart",p)).fire(new g.Event("zoom",p)).fire(new g.Event("zoomend",p)),T&&this.fire(new g.Event("rotatestart",p)).fire(new g.Event("rotate",p)).fire(new g.Event("rotateend",p)),P&&this.fire(new g.Event("pitchstart",p)).fire(new g.Event("pitch",p)).fire(new g.Event("pitchend",p)),this.fire(new g.Event("moveend",p)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||g.warnOnce(Yu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(d,p){const x=this.transform;if(!x.projection.supportsFreeCamera)return g.warnOnce(Yu),this;this.stop();const C=x.zoom,T=x.pitch,P=x.bearing;x.setFreeCameraOptions(d);const F=C!==x.zoom,z=T!==x.pitch,j=P!==x.bearing;return this.fire(new g.Event("movestart",p)).fire(new g.Event("move",p)),F&&this.fire(new g.Event("zoomstart",p)).fire(new g.Event("zoom",p)).fire(new g.Event("zoomend",p)),j&&this.fire(new g.Event("rotatestart",p)).fire(new g.Event("rotate",p)).fire(new g.Event("rotateend",p)),z&&this.fire(new g.Event("pitchstart",p)).fire(new g.Event("pitch",p)).fire(new g.Event("pitchend",p)),this.fire(new g.Event("moveend",p)),this}easeTo(d,p){this._stop(!1,d.easeId),(!1===(d=g.extend({offset:[0,0],duration:500,easing:g.ease},d)).animate||this._prefersReducedMotion(d))&&(d.duration=0);const x=this.transform,C=this.getZoom(),T=this.getBearing(),P=this.getPitch(),F=this.getPadding(),z="zoom"in d?+d.zoom:C,j="bearing"in d?this._normalizeBearing(d.bearing,T):T,W="pitch"in d?+d.pitch:P,K="padding"in d?d.padding:x.padding,ne=g.Point.convert(d.offset);let he,pe,le;if("globe"===x.projection.name){const $e=g.MercatorCoordinate.fromLngLat(x.center),Ye=ne.rotate(-x.angle);$e.x+=Ye.x/x.worldSize,$e.y+=Ye.y/x.worldSize;const St=$e.toLngLat(),Je=g.LngLat.convert(d.center||St);this._normalizeCenter(Je),he=x.centerPoint.add(Ye),pe=new g.Point($e.x,$e.y).mult(x.worldSize),le=new g.Point(g.mercatorXfromLng(Je.lng),g.mercatorYfromLat(Je.lat)).mult(x.worldSize).sub(pe)}else{he=x.centerPoint.add(ne);const $e=x.pointLocation(he),Ye=g.LngLat.convert(d.center||$e);this._normalizeCenter(Ye),pe=x.project($e),le=x.project(Ye).sub(pe)}const me=x.zoomScale(z-C);let J,de;d.around&&(J=g.LngLat.convert(d.around),de=x.locationPoint(J));const be=this._zooming||z!==C,xe=this._rotating||T!==j,Ne=this._pitching||W!==P,Be=!x.isPaddingEqual(K),ke=$e=>Ye=>{if(be&&($e.zoom=g.number(C,z,Ye)),xe&&($e.bearing=g.number(T,j,Ye)),Ne&&($e.pitch=g.number(P,W,Ye)),Be&&($e.interpolatePadding(F,K,Ye),he=$e.centerPoint.add(ne)),J)$e.setLocationAtPoint(J,de);else{const St=$e.zoomScale($e.zoom-C),Je=z>C?Math.min(2,me):Math.max(.5,me),vt=Math.pow(Je,1-Ye),et=$e.unproject(pe.add(le.mult(Ye*vt)).mult(St));$e.setLocationAtPoint($e.renderWorldCopies?et.wrap():et,he)}return d.preloadOnly||this._fireMoveEvents(p),$e};if(d.preloadOnly){const $e=this._emulate(ke,d.duration,x);return this._preloadTiles($e),this}const We={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=be,this._rotating=xe,this._pitching=Ne,this._padding=Be,this._easeId=d.easeId,this._prepareEase(p,d.noMoveStart,We),this._ease(ke(x),$e=>{x.recenterOnTerrain(),this._afterEase(p,$e)},d),this}_prepareEase(d,p,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",p||x.moving||this.fire(new g.Event("movestart",d)),this._zooming&&!x.zooming&&this.fire(new g.Event("zoomstart",d)),this._rotating&&!x.rotating&&this.fire(new g.Event("rotatestart",d)),this._pitching&&!x.pitching&&this.fire(new g.Event("pitchstart",d))}_fireMoveEvents(d){this.fire(new g.Event("move",d)),this._zooming&&this.fire(new g.Event("zoom",d)),this._rotating&&this.fire(new g.Event("rotate",d)),this._pitching&&this.fire(new g.Event("pitch",d))}_afterEase(d,p){if(this._easeId&&p&&this._easeId===p)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,C=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new g.Event("zoomend",d)),C&&this.fire(new g.Event("rotateend",d)),T&&this.fire(new g.Event("pitchend",d)),this.fire(new g.Event("moveend",d))}flyTo(d,p){if(this._prefersReducedMotion(d)){const Bt=g.pick(d,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Bt,p)}this.stop(),d=g.extend({offset:[0,0],speed:1.2,curve:1.42,easing:g.ease},d);const x=this.transform,C=this.getZoom(),T=this.getBearing(),P=this.getPitch(),F=this.getPadding(),z="zoom"in d?g.clamp(+d.zoom,x.minZoom,x.maxZoom):C,j="bearing"in d?this._normalizeBearing(d.bearing,T):T,W="pitch"in d?+d.pitch:P,K="padding"in d?d.padding:x.padding,ne=x.zoomScale(z-C),he=g.Point.convert(d.offset);let pe=x.centerPoint.add(he);const le=x.pointLocation(pe),me=g.LngLat.convert(d.center||le);this._normalizeCenter(me);const J=x.project(le),de=x.project(me).sub(J);let be=d.curve;const xe=Math.max(x.width,x.height),Ne=xe/ne,Be=de.mag();if("minZoom"in d){const Bt=g.clamp(Math.min(d.minZoom,C,z),x.minZoom,x.maxZoom),Zt=xe/x.zoomScale(Bt-C);be=Math.sqrt(Zt/Be*2)}const ke=be*be;function We(Bt){const Zt=(Ne*Ne-xe*xe+(Bt?-1:1)*ke*ke*Be*Be)/(2*(Bt?Ne:xe)*ke*Be);return Math.log(Math.sqrt(Zt*Zt+1)-Zt)}function $e(Bt){return(Math.exp(Bt)-Math.exp(-Bt))/2}function Ye(Bt){return(Math.exp(Bt)+Math.exp(-Bt))/2}const St=We(0);let Je=function(Bt){return Ye(St)/Ye(St+be*Bt)},vt=function(Bt){return xe*((Ye(St)*($e(Zt=St+be*Bt)/Ye(Zt))-$e(St))/ke)/Be;var Zt},et=(We(1)-St)/be;if(Math.abs(Be)<1e-6||!isFinite(et)){if(Math.abs(xe-Ne)<1e-6)return this.easeTo(d,p);const Bt=Ne<xe?-1:1;et=Math.abs(Math.log(Ne/xe))/be,vt=function(){return 0},Je=function(Zt){return Math.exp(Bt*be*Zt)}}d.duration="duration"in d?+d.duration:1e3*et/("screenSpeed"in d?+d.screenSpeed/be:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0);const Rt=T!==j,tt=W!==P,Mt=!x.isPaddingEqual(K),Nt=Bt=>Zt=>{const $i=Zt*et,Qi=1/Je($i);Bt.zoom=1===Zt?z:C+Bt.scaleZoom(Qi),Rt&&(Bt.bearing=g.number(T,j,Zt)),tt&&(Bt.pitch=g.number(P,W,Zt)),Mt&&(Bt.interpolatePadding(F,K,Zt),pe=Bt.centerPoint.add(he));const Ai=1===Zt?me:Bt.unproject(J.add(de.mult(vt($i))).mult(Qi));return Bt.setLocationAtPoint(Bt.renderWorldCopies?Ai.wrap():Ai,pe),Bt._updateCameraOnTerrain(),d.preloadOnly||this._fireMoveEvents(p),Bt};if(d.preloadOnly){const Bt=this._emulate(Nt,d.duration,x);return this._preloadTiles(Bt),this}return this._zooming=!0,this._rotating=Rt,this._pitching=tt,this._padding=Mt,this._prepareEase(p,!1),this._ease(Nt(x),()=>this._afterEase(p),d),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(d,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,p)}if(!d){const x=this.handlers;x&&x.stop(!1)}return this}_ease(d,p,x){!1===x.animate||0===x.duration?(d(1),p()):(this._easeStart=g.exported.now(),this._easeOptions=x,this._onEaseFrame=d,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const d=Math.min((g.exported.now()-this._easeStart)/this._easeOptions.duration,1),p=this._onEaseFrame;p&&p(this._easeOptions.easing(d)),d<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(d,p){d=g.wrap(d,-180,180);const x=Math.abs(d-p);return Math.abs(d-360-p)<x&&(d-=360),Math.abs(d+360-p)<x&&(d+=360),d}_normalizeCenter(d){const p=this.transform;if(!p.renderWorldCopies||p.maxBounds)return;const x=d.lng-p.center.lng;d.lng+=x>180?-360:x<-180?360:0}_prefersReducedMotion(d){return this._respectPrefersReducedMotion&&g.exported.prefersReducedMotion&&!(d&&d.essential)}_emulate(d,p,x){const C=Math.ceil(15*p/1e3),T=[],P=d(x.clone());for(let F=0;F<=C;F++){const z=P(F/C);T.push(z.clone())}return T}}class Ii{constructor(d={}){this.options=d,g.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(d){const p=this.options&&this.options.compact;return this._map=d,this._container=jn("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=jn("button","mapboxgl-ctrl-attrib-button",this._container),jn("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=jn("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===p&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(d,p){const x=this._map._getUIString(`AttributionControl.${p}`);d.setAttribute("aria-label",x),d.removeAttribute("title"),d.firstElementChild&&d.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));const p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||g.config.ACCESS_TOKEN}];if(d){const x=p.reduce((C,T,P)=>(T.value&&(C+=`${T.key}=${T.value}${P<p.length-1?"&":""}`),C),"?");d.href=`${g.config.FEEDBACK_URL}/${x}#${In(this._map,!0)}`,d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}}_updateData(d){!d||"metadata"!==d.sourceDataType&&"visibility"!==d.sourceDataType&&"style"!==d.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let d=[];if(this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const p=this._map.style._sourceCaches;for(const C in p){const T=p[C];if(T.used){const P=T.getSource();P.attribution&&d.indexOf(P.attribution)<0&&d.push(P.attribution)}}d.sort((C,T)=>C.length-T.length),d=d.filter((C,T)=>{for(let P=T+1;P<d.length;P++)if(d[P].indexOf(C)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=[...this.options.customAttribution,...d]:d.unshift(this.options.customAttribution));const x=d.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,d.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class iy{constructor(){g.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(d){this._map=d,this._container=jn("div","mapboxgl-ctrl");const p=jn("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(d){d&&"metadata"!==d.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const d=this._map.style._sourceCaches;if(0===Object.entries(d).length)return!0;for(const p in d){const x=d[p].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const d=this._container.children;if(d.length){const p=d[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}}}class Sa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(d){const p=++this._id;return this._queue.push({callback:d,id:p,cancelled:!1}),p}remove(d){const p=this._currentlyRunning,x=p?this._queue.concat(p):this._queue;for(const C of x)if(C.id===d)return void(C.cancelled=!0)}run(d=0){const p=this._currentlyRunning=this._queue;this._queue=[];for(const x of p)if(!x.cancelled&&(x.callback(d),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function $h(v,d,p){if(v=new g.LngLat(v.lng,v.lat),d){const x=new g.LngLat(v.lng-360,v.lat),C=new g.LngLat(v.lng+360,v.lat),T=360*Math.ceil(Math.abs(v.lng-p.center.lng)/360),P=p.locationPoint(v).distSqr(d),F=d.x<0||d.y<0||d.x>p.width||d.y>p.height;p.locationPoint(x).distSqr(d)<P&&(F||Math.abs(x.lng-p.center.lng)<T)?v=x:p.locationPoint(C).distSqr(d)<P&&(F||Math.abs(C.lng-p.center.lng)<T)&&(v=C)}for(;Math.abs(v.lng-p.center.lng)>180;){const x=p.locationPoint(v);if(x.x>=0&&x.y>=0&&x.x<=p.width&&x.y<=p.height)break;v.lng>p.center.lng?v.lng-=360:v.lng+=360}return v}const Bp={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class yi extends g.Evented{constructor(d,p){if(super(),(d instanceof g.window.HTMLElement||p)&&(d=g.extend({element:d},p)),g.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&d.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=d&&d.occludedOpacity||.2,d&&d.element)this._element=d.element,this._offset=g.Point.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=jn("div");const C=41,T=27,P=hs("svg",{display:"block",height:C*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${C}`},this._element),F=hs("radialGradient",{id:"shadowGradient"},hs("defs",{},P));hs("stop",{offset:"10%","stop-opacity":.4},F),hs("stop",{offset:"100%","stop-opacity":.05},F),hs("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),hs("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),hs("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),hs("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=g.Point.convert(d&&d.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",C=>{C.preventDefault()}),this._element.addEventListener("mousedown",C=>{C.preventDefault()});const x=this._element.classList;for(const C in Bp)x.remove(`mapboxgl-marker-anchor-${C}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(d){return d===this._map||(this.remove(),this._map=d,d.getCanvasContainer().appendChild(this._element),d.on("move",this._updateMoving),d.on("moveend",this._update),d.on("remove",this._clearFadeTimer),d._addMarker(this),this.setDraggable(this._draggable),this._update(),d.on("click",this._onMapClick)),this}remove(){const d=this._map;return d&&(d.off("click",this._onMapClick),d.off("move",this._updateMoving),d.off("moveend",this._update),d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler),d.off("mouseup",this._onUp),d.off("touchend",this._onUp),d.off("mousemove",this._onMove),d.off("touchmove",this._onMove),d.off("remove",this._clearFadeTimer),d._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=g.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(d){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d){if(!("offset"in d.options)){const C=Math.sqrt(Math.pow(13.5,2)/2);d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(24.6+C)],"bottom-right":[-C,-1*(24.6+C)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=d,d._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(d){const p=d.code,x=d.charCode||d.keyCode;"Space"!==p&&"Enter"!==p&&32!==x&&13!==x||this.togglePopup()}_onMapClick(d){const p=d.originalEvent.target,x=this._element;this._popup&&(p===x||x.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const d=this._popup;return d?(d.isOpen()?(d.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(d.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const d=this._map,p=this._pos;if(!d||!p)return!1;const x=d.unproject(p),C=d.getFreeCameraOptions();if(!C.position)return!1;const T=C.position.toLngLat();return T.distanceTo(x)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const d=this._map;if(!d)return;const p=this._pos;if(!p||p.x<0||p.x>d.transform.width||p.y<0||p.y>d.transform.height)return void this._clearFadeTimer();const x=d.unproject(p);let C;d._showingGlobe()&&g.isLngLatBehindGlobe(d.transform,this._lngLat)?C=0:(C=1-d._queryFogOpacity(x),d.transform._terrainEnabled()&&d.getTerrain()&&this._behindTerrain()&&(C*=this._occludedOpacity)),this._element.style.opacity=`${C}`,this._element.style.pointerEvents=C>0?"auto":"none",this._popup&&this._popup._setOpacity(C),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const d=this._pos;if(!d||!this._map)return;const p=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${d.x}px,${d.y}px)\n            ${Bp[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${p.x}px,${p.y}px)\n        `}_calculateXYTransform(){const d=this._pos,p=this._map,x=this.getPitchAlignment();if(!p||!d||"map"!==x)return"";if(!p._showingGlobe()){const z=p.getPitch();return z?`rotateX(${z}deg)`:""}const C=g.radToDeg(g.globeTiltAtLngLat(p.transform,this._lngLat)),T=d.sub(g.globeCenterToScreenPoint(p.transform)),P=Math.abs(T.x)+Math.abs(T.y);if(0===P)return"";const F=C/P;return`rotateX(${-T.y*F}deg) rotateY(${T.x*F}deg)`}_calculateZTransform(){const d=this._pos,p=this._map;if(!p||!d)return"";let x=0;const C=this.getRotationAlignment();if("map"===C)if(p._showingGlobe()){const T=p.project(new g.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),P=p.project(new g.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);x=g.radToDeg(Math.atan2(P.y,P.x))-90}else x=-p.getBearing();else if("horizon"===C){const T=g.smoothstep(4,6,p.getZoom()),P=g.globeCenterToScreenPoint(p.transform);P.y+=T*p.transform.height;const F=d.sub(P),z=g.radToDeg(Math.atan2(F.y,F.x));x=(z>90?z-270:z+90)*(1-T)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(d){g.window.cancelAnimationFrame(this._updateFrameId);const p=this._map;p&&(p.transform.renderWorldCopies&&(this._lngLat=$h(this._lngLat,this._pos,p.transform)),this._pos=p.project(this._lngLat),!0===d?this._updateFrameId=g.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),p._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(p._showingGlobe()||p.getTerrain()||p.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(d){return this._offset=g.Point.convert(d),this._update(),this}_onMove(d){const p=this._map;if(!p)return;const x=this._pointerdownPos,C=this._positionDelta;if(x&&C){if(!this._isDragging){const T=this._clickTolerance||p._clickTolerance;if(d.point.dist(x)<T)return;this._isDragging=!0}this._pos=d.point.sub(C),this._lngLat=p.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new g.Event("dragstart"))),this.fire(new g.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const d=this._map;d&&(d.off("mousemove",this._onMove),d.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new g.Event("dragend")),this._state="inactive"}_addDragHandler(d){const p=this._map,x=this._pos;p&&x&&this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(x),this._pointerdownPos=d.point,this._state="pending",p.on("mousemove",this._onMove),p.on("touchmove",this._onMove),p.once("mouseup",this._onUp),p.once("touchend",this._onUp))}setDraggable(d){this._draggable=!!d;const p=this._map;return p&&(d?(p.on("mousedown",this._addDragHandler),p.on("touchstart",this._addDragHandler)):(p.off("mousedown",this._addDragHandler),p.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(d){return this._rotation=d||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(d){return this._rotationAlignment=d||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(d){return this._pitchAlignment=d||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(d){return this._occludedOpacity=d||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Sm={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},zv=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ku(v=new g.Point(0,0),d="bottom"){if("number"==typeof v){const p=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(d){case"top":return new g.Point(0,v);case"top-left":return new g.Point(p,p);case"top-right":return new g.Point(-p,p);case"bottom":return new g.Point(0,-v);case"bottom-left":return new g.Point(p,-p);case"bottom-right":return new g.Point(-p,-p);case"left":return new g.Point(v,0);case"right":return new g.Point(-v,0)}return new g.Point(0,0)}return v instanceof g.Point||Array.isArray(v)?g.Point.convert(v):g.Point.convert(v[d]||[0,0])}class Rg{constructor(d){this.jumpTo(d)}getValue(d){if(d<=this._startTime)return this._start;if(d>=this._endTime)return this._end;const p=g.easeCubicInOut((d-this._startTime)/(this._endTime-this._startTime));return this._start*(1-p)+this._end*p}isEasing(d){return d>=this._startTime&&d<=this._endTime}jumpTo(d){this._startTime=-1/0,this._endTime=-1/0,this._start=d,this._end=d}easeTo(d,p,x){this._start=this.getValue(p),this._end=d,this._startTime=p,this._endTime=p+x}}const Uv={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},kc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Cd={showCompass:!0,showZoom:!0,visualizePitch:!1};class Tm{constructor(d,p,x=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new ms({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,x&&(this.mousePitch=new Sf({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),g.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),p.addEventListener("mousedown",this.mousedown),p.addEventListener("touchstart",this.touchstart,{passive:!1}),p.addEventListener("touchmove",this.touchmove),p.addEventListener("touchend",this.touchend),p.addEventListener("touchcancel",this.reset)}down(d,p){this.mouseRotate.mousedown(d,p),this.mousePitch&&this.mousePitch.mousedown(d,p),pd()}move(d,p){const x=this.map,C=this.mouseRotate.mousemoveWindow(d,p),T=C&&C.bearingDelta;if(T&&x.setBearing(x.getBearing()+T),this.mousePitch){const P=this.mousePitch.mousemoveWindow(d,p),F=P&&P.pitchDelta;F&&x.setPitch(x.getPitch()+F)}}off(){const d=this.element;d.removeEventListener("mousedown",this.mousedown),d.removeEventListener("touchstart",this.touchstart,{passive:!1}),d.removeEventListener("touchmove",this.touchmove),d.removeEventListener("touchend",this.touchend),d.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Gd(),g.window.removeEventListener("mousemove",this.mousemove),g.window.removeEventListener("mouseup",this.mouseup)}mousedown(d){this.down(g.extend({},d,{ctrlKey:!0,preventDefault:()=>d.preventDefault()}),nl(this.element,d)),g.window.addEventListener("mousemove",this.mousemove),g.window.addEventListener("mouseup",this.mouseup)}mousemove(d){this.move(d,nl(this.element,d))}mouseup(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()}touchstart(d){1!==d.targetTouches.length?this.reset():(this._startPos=this._lastPos=ka(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>d.preventDefault()},this._startPos))}touchmove(d){1!==d.targetTouches.length?this.reset():(this._lastPos=ka(this.element,d.targetTouches)[0],this.move({preventDefault:()=>d.preventDefault()},this._lastPos))}touchend(d){0===d.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Fs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Am={maxWidth:100,unit:"metric"},ny={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},iu={version:g.version,supported:xs,setRTLTextPlugin:g.setRTLTextPlugin,getRTLTextPluginStatus:g.getRTLTextPluginStatus,Map:class extends kg{constructor(v){if(g.LivePerformanceUtils.mark(g.PerformanceMarkers.create),null!=(v=g.extend({},kc,v)).minZoom&&null!=v.maxZoom&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=v.minPitch&&null!=v.maxPitch&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=v.minPitch&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=v.maxPitch&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&g.isSafariWithAntialiasingBug(g.window)&&(v.antialias=!1,g.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Vo(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new Sa,this._domRenderTaskQueue=new Sa,this._controls=[],this._markers=[],this._popups=[],this._mapId=g.uniqueId(),this._locale=g.extend({},Uv,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Rg(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new g.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,"string"==typeof v.container){if(this._container=g.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof g.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&g.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),g.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==g.window&&(g.window.addEventListener("online",this._onWindowOnline,!1),g.window.addEventListener("resize",this._onWindowResize,!1),g.window.addEventListener("orientationchange",this._onWindowResize,!1),g.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),g.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new td(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new ll("string"==typeof v.hash&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,g.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new Ii({customAttribution:v.customAttribution})),this._logoControl=new iy,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update("style"===d.dataType),this.fire(new g.Event(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new g.Event(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(v,d){if(void 0===d&&(d=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=v.onAdd(this);this._controls.push(v);const x=this._controlPositions[d];return-1!==d.indexOf("bottom")?x.insertBefore(p,x.firstChild):x.appendChild(p),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const d=this._controls.indexOf(v);return d>-1&&this._controls.splice(d,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const d=!this._moving;return d&&this.fire(new g.Event("movestart",v)).fire(new g.Event("move",v)),this.fire(new g.Event("resize",v)),d&&this.fire(new g.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(g.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new g.Event("zoomstart")).fire(new g.Event("zoom")).fire(new g.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new g.Event("zoomstart")).fire(new g.Event("zoom")).fire(new g.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new g.Event("pitchstart")).fire(new g.Event("pitch")).fire(new g.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new g.Event("pitchstart")).fire(new g.Event("pitch")).fire(new g.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return"auto"===v?g.window.navigator.language:Array.isArray(v)?0===v.length?void 0:v.map(d=>"auto"===d?g.window.navigator.language:d):v}setLanguage(v){const d=this._parseLanguage(v);if(!this.style||d===this._language)return this;this._language=d,this.style._reloadSources();for(const p of this._controls)p._setLanguage&&p._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(v){return this._lazyInitEmptyStyle(),v?"string"==typeof v&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const v=this.transform,d=v.projection.name;let p;"globe"===d&&v.zoom>=g.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),p=!0):"mercator"===d&&v.zoom<g.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),p=!0),p&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,d){return this._updateProjection(v||d||{name:"mercator"})}_updateProjection(v){let d;if(d="globe"===v.name&&this.transform.zoom>=g.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),d){this.painter.clearBackgroundTiles();for(const p in this.style._sourceCaches)this.style._sourceCaches[p].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(g.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(g.Point.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,d,p){if("mouseenter"===v||"mouseover"===v){let x=!1;const C=P=>{const F=d.filter(j=>this.getLayer(j)),z=F.length?this.queryRenderedFeatures(P.point,{layers:F}):[];z.length?x||(x=!0,p.call(this,new $s(v,this,P.originalEvent,{features:z}))):x=!1},T=()=>{x=!1};return{layers:new Set(d),listener:p,delegates:{mousemove:C,mouseout:T}}}if("mouseleave"===v||"mouseout"===v){let x=!1;const C=P=>{const F=d.filter(z=>this.getLayer(z));(F.length?this.queryRenderedFeatures(P.point,{layers:F}):[]).length?x=!0:x&&(x=!1,p.call(this,new $s(v,this,P.originalEvent)))},T=P=>{x&&(x=!1,p.call(this,new $s(v,this,P.originalEvent)))};return{layers:new Set(d),listener:p,delegates:{mousemove:C,mouseout:T}}}{const x=C=>{const T=d.filter(F=>this.getLayer(F)),P=T.length?this.queryRenderedFeatures(C.point,{layers:T}):[];P.length&&(C.features=P,p.call(this,C),delete C.features)};return{layers:new Set(d),listener:p,delegates:{[v]:x}}}}on(v,d,p){if(void 0===p)return super.on(v,d);Array.isArray(d)||(d=[d]);const x=this._createDelegatedListener(v,d,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(x);for(const C in x.delegates)this.on(C,x.delegates[C]);return this}once(v,d,p){if(void 0===p)return super.once(v,d);Array.isArray(d)||(d=[d]);const x=this._createDelegatedListener(v,d,p);for(const C in x.delegates)this.once(C,x.delegates[C]);return this}off(v,d,p){if(void 0===p)return super.off(v,d);d=new Set(Array.isArray(d)?d:[d]);const x=(T,P)=>{if(T.size!==P.size)return!1;for(const F of T)if(!P.has(F))return!1;return!0},C=this._delegatedListeners?this._delegatedListeners[v]:void 0;return C&&(T=>{for(let P=0;P<T.length;P++){const F=T[P];if(F.listener===p&&x(F.layers,d)){for(const z in F.delegates)this.off(z,F.delegates[z]);return T.splice(P,1),this}}})(C),this}queryRenderedFeatures(v,d){return this.style?(void 0!==d||void 0===v||v instanceof g.Point||Array.isArray(v)||(d=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],d=d||{},this.transform)):[]}querySourceFeatures(v,d){return this.style.querySourceFeatures(v,d)}isPointOnSurface(v){const{name:d}=this.transform.projection;return"globe"!==d&&"mercator"!==d&&g.warnOnce(`${d} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(g.Point.convert(v))}setStyle(v,d){return!1!==(d=g.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},d)).diff&&d.localIdeographFontFamily===this._localIdeographFontFamily&&d.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._localFontFamily=d.localFontFamily,this._updateStyle(v,d))}_getUIString(v){const d=this._locale[v];if(null==d)throw new Error(`Missing UI string '${v}'`);return d}_updateStyle(v,d){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new Xd(this,d||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof v?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Xd(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,d){if("string"==typeof v){const p=this._requestManager.normalizeStyleURL(v),x=this._requestManager.transformRequest(p,g.ResourceType.Style);g.getJSON(x,(C,T)=>{C?this.fire(new g.ErrorEvent(C)):T&&this._updateDiff(T,d)})}else"object"==typeof v&&this._updateDiff(v,d)}_updateDiff(v,d){try{this.style.setState(v)&&this._update(!0)}catch(p){g.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(v,d)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(g.warnOnce("There is no style added to the map."),!1)}addSource(v,d){return this._lazyInitEmptyStyle(),this.style.addSource(v,d),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const d in v){const p=v[d]._tiles;for(const x in p){const C=p[x];if("loaded"!==C.state&&"errored"!==C.state)return!1}}return!0}addSourceType(v,d,p){this._lazyInitEmptyStyle(),this.style.addSourceType(v,d,p)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,d,{pixelRatio:p=1,sdf:x=!1,stretchX:C,stretchY:T,content:P}={}){if(this._lazyInitEmptyStyle(),d instanceof g.window.HTMLImageElement||g.window.ImageBitmap&&d instanceof g.window.ImageBitmap){const{width:F,height:z,data:j}=g.exported.getImageData(d);this.style.addImage(v,{data:new g.RGBAImage({width:F,height:z},j),pixelRatio:p,stretchX:C,stretchY:T,content:P,sdf:x,version:0})}else if(void 0===d.width||void 0===d.height)this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:F,height:z}=d,j=d;this.style.addImage(v,{data:new g.RGBAImage({width:F,height:z},new Uint8Array(j.data)),pixelRatio:p,stretchX:C,stretchY:T,content:P,sdf:x,version:0,userImage:j}),j.onAdd&&j.onAdd(this,v)}}updateImage(v,d){const p=this.style.getImage(v);if(!p)return void this.fire(new g.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=d instanceof g.window.HTMLImageElement||g.window.ImageBitmap&&d instanceof g.window.ImageBitmap?g.exported.getImageData(d):d,{width:C,height:T}=x;void 0!==C&&void 0!==T?C===p.data.width&&T===p.data.height?(p.data.replace(x.data,!(d instanceof g.window.HTMLImageElement||g.window.ImageBitmap&&d instanceof g.window.ImageBitmap)),this.style.updateImage(v,p)):this.fire(new g.ErrorEvent(new Error(`The width and height of the updated image (${C}, ${T})\n                must be that same as the previous version of the image\n                (${p.data.width}, ${p.data.height})`))):this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new g.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,d){g.getImage(this._requestManager.transformRequest(v,g.ResourceType.Image),(p,x)=>{d(p,x instanceof g.window.HTMLImageElement?g.exported.getImageData(x):x)})}listImages(){return this.style.listImages()}addLayer(v,d){return this._lazyInitEmptyStyle(),this.style.addLayer(v,d),this._update(!0)}moveLayer(v,d){return this.style.moveLayer(v,d),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,d,p){return this.style.setLayerZoomRange(v,d,p),this._update(!0)}setFilter(v,d,p={}){return this.style.setFilter(v,d,p),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,d,p,x={}){return this.style.setPaintProperty(v,d,p,x),this._update(!0)}getPaintProperty(v,d){return this.style.getPaintProperty(v,d)}setLayoutProperty(v,d,p,x={}){return this.style.setLayoutProperty(v,d,p,x),this._update(!0)}getLayoutProperty(v,d){return this.style.getLayoutProperty(v,d)}setLight(v,d={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,d),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(g.LngLat.convert(v),this.transform):0}setFeatureState(v,d){return this.style.setFeatureState(v,d),this._update()}removeFeatureState(v,d){return this.style.removeFeatureState(v,d),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,d=this._container.getBoundingClientRect().height||300;let p,x,C,T=this._container;for(;T&&(!x||!C);){const P=g.window.getComputedStyle(T).transform;P&&"none"!==P&&(p=P.match(/matrix.*\((.+)\)/)[1].split(", "),p[0]&&"0"!==p[0]&&"1"!==p[0]&&(x=p[0]),p[3]&&"0"!==p[3]&&"1"!==p[3]&&(C=p[3])),T=T.parentElement}this._containerWidth=x?Math.abs(v/x):v,this._containerHeight=C?Math.abs(d/C):d}_detectMissingCSS(){"rgb(250, 128, 114)"!==g.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&g.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=jn("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const d=this._canvasContainer=jn("div","mapboxgl-canvas-container",v);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=jn("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const p=this._controlContainer=jn("div","mapboxgl-control-container",v),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(C=>{x[C]=jn("div",`mapboxgl-ctrl-${C}`,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,d){const p=g.exported.devicePixelRatio||1;this._canvas.width=p*Math.ceil(v),this._canvas.height=p*Math.ceil(d),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${d}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const d=this._markers.indexOf(v);-1!==d&&this._markers.splice(d,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const d=this._popups.indexOf(v);-1!==d&&this._popups.splice(d,1)}_setupPainter(){const v=g.extend({},xs.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._useWebGL2&&this._canvas.getContext("webgl2",v),p=d||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);p?(this._useWebGL2&&!d&&g.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),g.storeAuthState(p,!0),this.painter=new qu(p,this.transform,!!d),this.on("data",x=>{"source"===x.dataType&&this.painter.setTileLoadedFlag(!0)}),g.exported$1.testSupport(p)):this.fire(new g.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new g.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new g.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let d;const p=this.painter.context.extTimerQuery,x=g.exported.now();if(this.listens("gpu-timing-frame")&&(d=p.createQueryEXT(),p.beginQueryEXT(p.TIME_ELAPSED_EXT,d)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],g.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],g.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const C=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,z=this.transform.pitch,j=g.exported.now(),W=new g.EvaluationParameters(F,{now:j,fadeDuration:C,pitch:z,transition:this.style.getTransition()});this.style.update(W)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(x),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):T=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,C,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:C,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new g.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new g.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),d){const F=g.exported.now()-x;p.endQueryEXT(p.TIME_ELAPSED_EXT,d),setTimeout(()=>{const z=p.getQueryObjectEXT(d,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(d),this.fire(new g.Event("gpu-timing-frame",{cpuTime:F,gpuTime:z})),g.window.performance.mark("frame-gpu",{startTime:x,detail:{gpuTime:z}})},50)}if(this.listens("gpu-timing-layer")){const F=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(F);this.fire(new g.Event("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const F=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(F);this.fire(new g.Event("gpu-timing-deferred-render",{gpuTime:z}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty||T;if(P||this._repaint)this.triggerRepaint();else{const F=!this.isMoving()&&this.loaded();if(F&&(T=this._updateAverageElevation(x,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),F&&(this.fire(new g.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new g.Event("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,g.LivePerformanceUtils.mark(g.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&g.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const d of this._markers)v&&!this.getRenderWorldCopies()&&(d._lngLat=d._lngLat.wrap()),d._update();for(const d of this._popups)!v||this.getRenderWorldCopies()||d._trackPointer||(d._lngLat=d._lngLat.wrap()),d._update()}_updateAverageElevation(v,d=!1){const p=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&p(0);if((d||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const x=this.transform.averageElevation;let C=this.transform.sampleAverageElevation(),T=!1;this.transform.elevation&&(T=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(C)?C=0:this._averageElevationLastSampledAt=v;const P=Math.abs(x-C);if(P>1){if(this._isInitialLoad||T)return this._averageElevation.jumpTo(C),p(C);this._averageElevation.easeTo(C,v,300)}else if(P>1e-4)return this._averageElevation.jumpTo(C),p(C)}return!!this._averageElevation.isEasing(v)&&p(this._averageElevation.getValue(v))}_authenticate(){g.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===g.AUTH_ERR_MSG||401===v.status)){const d=this.painter.context.gl;g.storeAuthState(d,!1),this._logoControl instanceof iy&&this._logoControl._updateLogo(),d&&d.clear(d.DEPTH_BUFFER_BIT|d.COLOR_BUFFER_BIT|d.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new g.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),g.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),d=this.painter.getCanvasCopiesAndTimestamps();d.timeStamps.push(performance.now());const p=this.painter.context.gl,x=p.createFramebuffer();function C(T){p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,T,0);const P=new Uint8Array(p.drawingBufferWidth*p.drawingBufferHeight*4);return p.readPixels(0,0,p.drawingBufferWidth,p.drawingBufferHeight,p.RGBA,p.UNSIGNED_BYTE,P),P}return p.bindFramebuffer(p.FRAMEBUFFER,x),this._canvasPixelComparison(C(v),d.canvasCopies.map(C),d.timeStamps)}_canvasPixelComparison(v,d,p){let x=p[1]-p[0];const C=v.length/4;for(let T=0;T<d.length;T++){const P=d[T];let F=0;for(let z=0;z<P.length;z+=4)P[z]===v[z]&&P[z+1]===v[z+1]&&P[z+2]===v[z+2]&&P[z+3]===v[z+3]&&(F+=1);x+=(p[T+2]-p[T+1])*(1-F/C)}return x}remove(){this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==g.window&&(g.window.removeEventListener("resize",this._onWindowResize,!1),g.window.removeEventListener("orientationchange",this._onWindowResize,!1),g.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),g.window.removeEventListener("online",this._onWindowOnline,!1),g.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),g.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new g.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=g.exported.frame(d=>{const p=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,p&&this._render(d)}))}_preloadTiles(v){const d=this.style?Object.values(this.style._sourceCaches):[];return g.asyncAll(d,(p,x)=>p._preloadTiles(v,x),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){"hidden"===g.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,d){g.setCacheLimits(v,d)}get version(){return g.version}},NavigationControl:class{constructor(v){this.options=g.extend({},Cd,v),this._container=jn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",d=>d.preventDefault()),this.options.showZoom&&(g.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",d=>{this._map&&this._map.zoomIn({},{originalEvent:d})}),jn("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",d=>{this._map&&this._map.zoomOut({},{originalEvent:d})}),jn("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(g.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",d=>{const p=this._map;p&&(this.options.visualizePitch?p.resetNorthPitch({},{originalEvent:d}):p.resetNorth({},{originalEvent:d}))}),this._compassIcon=jn("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const d=v.getZoom(),p=d===v.getMaxZoom(),x=d===v.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Tm(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,d){const p=jn("button",v,this._container);return p.type="button",p.addEventListener("click",d),p}_setButtonTitle(v,d){if(!this._map)return;const p=this._map._getUIString(`NavigationControl.${d}`);v.setAttribute("aria-label",p),v.firstElementChild&&v.firstElementChild.setAttribute("title",p)}},GeolocateControl:class extends g.Evented{constructor(v){super(),this.options=g.extend({geolocation:g.window.navigator.geolocation},Fs,v),g.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=al(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=jn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const d=(p=!!this.options.geolocation)=>{this._supportsGeolocation=p,v(p)};void 0!==this._supportsGeolocation?v(this._supportsGeolocation):void 0!==g.window.navigator.permissions?g.window.navigator.permissions.query({name:"geolocation"}).then(p=>d("denied"!==p.state)).catch(()=>d()):d()}_isOutOfMapMaxBounds(v){const d=this._map.getMaxBounds(),p=v.coords;return!!d&&(p.longitude<d.getWest()||p.longitude>d.getEast()||p.latitude<d.getSouth()||p.latitude>d.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new g.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(v),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new g.Event("geolocate",v)),this._finish()}}_updateCamera(v){const d=new g.LngLat(v.coords.longitude,v.coords.latitude),p=v.coords.accuracy,x=this._map.getBearing(),C=g.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(p),C,{geolocateSource:!0})}_updateMarker(v){if(v){const d=new g.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,d=g.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,p=Math.ceil(2*this._accuracy*d);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(1===v.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===v.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new g.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=jn("button","mapboxgl-ctrl-geolocate",this._container),jn("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===v){g.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=jn("div","mapboxgl-user-location"),this._dotElement.appendChild(jn("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(jn("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new yi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=jn("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new yi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||"ACTIVE_LOCK"!==this._watchState||d.originalEvent&&"resize"===d.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new g.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:!0===v.absolute&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return g.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new g.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new g.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new g.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{g.window.addEventListener("ondeviceorientationabsolute"in g.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==g.window.DeviceMotionEvent&&"function"==typeof g.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(d=>{"granted"===d&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),g.window.removeEventListener("deviceorientation",this._onDeviceOrientation),g.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ii,ScaleControl:class{constructor(v){this.options=g.extend({},Am,v),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),g.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,d=this._map,p=d._containerHeight/2,x=d._containerWidth/2-v/2,C=d.unproject([x,p]),T=d.unproject([x+v,p]),P=C.distanceTo(T);if("imperial"===this.options.unit){const F=3.2808*P;F>5280?this._setScale(v,F/5280,"mile"):this._setScale(v,F,"foot")}else"nautical"===this.options.unit?this._setScale(v,P/1852,"nautical-mile"):P>=1e3?this._setScale(v,P/1e3,"kilometer"):this._setScale(v,P,"meter")}_setScale(v,d,p){this._map._requestDomTask(()=>{const x=function(T){const P=Math.pow(10,`${Math.floor(T)}`.length-1);let F=T/P;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(z){const j=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*j)/j}(F),P*F}(d),C=x/d;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==p?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:p}).format(x):`${x}&nbsp;${ny[p]}`,this._container.style.width=v*C+"px"})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=jn("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof g.window.HTMLElement?this._container=v.container:g.warnOnce("Full screen control 'container' must be a DOM element.")),g.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in g.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in g.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=jn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",g.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,g.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!g.window.document.fullscreenEnabled&&!g.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=jn("button","mapboxgl-ctrl-fullscreen",this._controlContainer);jn("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),g.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(g.window.document.fullscreenElement||g.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?g.window.document.exitFullscreen?g.window.document.exitFullscreen():g.window.document.webkitCancelFullScreen&&g.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends g.Evented{constructor(v){super(),this.options=g.extend(Object.create(Sm),v),g.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new g.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new g.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=g.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const d=this._map;return d&&(d.on("move",this._update),d.off("mousemove",this._onMouseEvent),d._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(g.window.document.createTextNode(v))}setHTML(v){const d=g.window.document.createDocumentFragment(),p=g.window.document.createElement("body");let x;for(p.innerHTML=v;x=p.firstChild,x;)d.appendChild(x);return this.setDOMContent(d)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let d=this._content;if(d)for(;d.hasChildNodes();)d.firstChild&&d.removeChild(d.firstChild);else d=this._content=jn("div","mapboxgl-popup-content",this._container||void 0);if(d.appendChild(v),this.options.closeButton){const p=this._closeButton=jn("button","mapboxgl-popup-close-button",d);p.type="button",p.setAttribute("aria-label","Close popup"),p.setAttribute("aria-hidden","true"),p.innerHTML="&#215;",p.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let d;return this._classList.delete(v)?d=!1:(this._classList.add(v),d=!0),this._updateClassList(),d}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const d=this._map,p=this._container,x=this._pos;if(!d||!p||!x)return"bottom";const C=p.offsetWidth,T=p.offsetHeight,P=x.x<C/2,F=x.x>d.transform.width-C/2;if(x.y+v<T)return P?"top-left":F?"top-right":"top";if(x.y>d.transform.height-T){if(P)return"bottom-left";if(F)return"bottom-right"}return P?"left":F?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),v.className=d.join(" ")}_update(v){const d=this._map,p=this._content;if(!d||!this._lngLat&&!this._trackPointer||!p)return;let x=this._container;if(x||(x=this._container=jn("div","mapboxgl-popup",d.getContainer()),this._tip=jn("div","mapboxgl-popup-tip",x),x.appendChild(p)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),d.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$h(this._lngLat,this._pos,d.transform)),!this._trackPointer||v){const C=this._pos=this._trackPointer&&v?v:d.project(this._lngLat),T=Ku(this.options.offset),P=this._anchor=this._getAnchor(T.y),F=Ku(this.options.offset,P),z=C.add(F).round();d._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${Bp[P]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&d._showingGlobe()){const C=g.isLngLatBehindGlobe(d.transform,this._lngLat)?0:1;this._setOpacity(C)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(zv);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:yi,Style:Xd,LngLat:g.LngLat,LngLatBounds:g.LngLatBounds,Point:g.Point,MercatorCoordinate:g.MercatorCoordinate,FreeCameraOptions:ls,Evented:g.Evented,config:g.config,prewarm:function(){Tp().acquire(gd)},clearPrewarmedResources:function(){const v=La;v&&(v.isPreloaded()&&1===v.numActive()?(v.release(gd),La=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return g.config.ACCESS_TOKEN},set accessToken(v){g.config.ACCESS_TOKEN=v},get baseApiUrl(){return g.config.API_URL},set baseApiUrl(v){g.config.API_URL=v},get workerCount(){return na.workerCount},set workerCount(v){na.workerCount=v},get maxParallelImageRequests(){return g.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){g.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){g.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:g.exported.setNow,restoreNow:g.exported.restoreNow};return iu}),Sr}()}},Ch=>{Ch(Ch.s=435)}]);